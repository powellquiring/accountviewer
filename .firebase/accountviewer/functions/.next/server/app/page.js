(()=>{var exports={};exports.id=974,exports.ids=[974],exports.modules={15:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.RoundRobinLoadBalancer=void 0;let n=r(6239),i=r(8155),s=r(2910),a=r(3356),o=r(1359),l=r(1271),c="round_robin";function u(e){o.trace(l.LogVerbosity.DEBUG,c,e)}let d="round_robin";class h{getLoadBalancerName(){return d}constructor(){}toJsonObject(){return{[d]:{}}}static createFromJson(e){return new h}}class f{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:s.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class p{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=i.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(e,t,r,n,s)=>{this.calculateAndUpdateState(),(r===i.ConnectivityState.TRANSIENT_FAILURE||r===i.ConnectivityState.IDLE)&&(s&&(this.lastError=s),this.channelControlHelper.requestReresolution(),e.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(i.ConnectivityState.READY)>0){let e=this.subchannels.filter(e=>e.getConnectivityState()===i.ConnectivityState.READY),t=0;null!==this.currentReadyPicker&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(t=0),this.updateState(i.ConnectivityState.READY,new f(e,t))}else this.countSubchannelsWithState(i.ConnectivityState.CONNECTING)>0?this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this)):this.countSubchannelsWithState(i.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this))}updateState(e,t){u(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]),e===i.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){for(let t of(this.resetSubchannelList(),u("Connect to address list "+e.map(e=>(0,a.subchannelAddressToString)(e))),this.subchannels=e.map(e=>this.channelControlHelper.createSubchannel(e,{})),this.subchannels)){t.ref(),t.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(t.getChannelzRef());let e=t.getConnectivityState();(e===i.ConnectivityState.IDLE||e===i.ConnectivityState.TRANSIENT_FAILURE)&&t.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return d}}t.RoundRobinLoadBalancer=p,t.setup=function(){(0,n.registerLoadBalancerType)(d,p,h)}},40:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"FileDescriptorSet":{"fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}}},"FileDescriptorProto":{"fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10,"options":{"packed":false}},"weakDependency":{"rule":"repeated","type":"int32","id":11,"options":{"packed":false}},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12}}},"DescriptorProto":{"fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"FieldDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REQUIRED":2,"LABEL_REPEATED":3}}}},"OneofDescriptorProto":{"fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3}}},"EnumValueDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[38,38]],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[8,8]]},"FieldOptions":{"fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}}}},"OneofOptions":{"fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumValueOptions":{"fields":{"deprecated":{"type":"bool","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"UninterpretedOption":{"fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"SourceCodeInfo":{"fields":{"location":{"rule":"repeated","type":"Location","id":1}},"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"span":{"rule":"repeated","type":"int32","id":2},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4}}}}}}}}}}}')},70:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InterceptingListenerImpl=t.isInterceptingListener=void 0,t.isInterceptingListener=function(e){return void 0!==e.onReceiveMetadata&&1===e.onReceiveMetadata.length};class r{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,e=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(e),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,e=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=e,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(e),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,e=>{this.processingMetadata||this.processingMessage?this.pendingStatus=e:this.nextListener.onReceiveStatus(e)})}}t.InterceptingListenerImpl=r},158:e=>{"use strict";e.exports=d;var t=/[\s{}=;:[\],'"()<>]/g,r=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,n=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,i=/^ *[*/]+ */,s=/^\s*\*?\/*/,a=/\n/g,o=/\s/,l=/\\(.?)/g,c={0:"\0",r:"\r",n:"\n",t:"	"};function u(e){return e.replace(l,function(e,t){switch(t){case"\\":case"":return t;default:return c[t]||""}})}function d(e,l){e=e.toString();var c=0,d=e.length,h=1,f=0,p={},m=[],g=null;function y(e){return Error("illegal "+e+" (line "+h+")")}function v(){var t="'"===g?n:r;t.lastIndex=c-1;var i=t.exec(e);if(!i)throw y("string");return c=t.lastIndex,C(g),g=null,u(i[1])}function b(t){return e.charAt(t)}function S(t,r,n){var o,c={type:e.charAt(t++),lineEmpty:!1,leading:n},u=t-(l?2:3);do if(--u<0||"\n"===(o=e.charAt(u))){c.lineEmpty=!0;break}while(" "===o||"	"===o);for(var d=e.substring(t,r).split(a),m=0;m<d.length;++m)d[m]=d[m].replace(l?s:i,"").trim();c.text=d.join("\n").trim(),p[h]=c,f=h}function w(t){var r=T(t),n=e.substring(t,r);return/^\s*\/\//.test(n)}function T(e){for(var t=e;t<d&&"\n"!==b(t);)t++;return t}function E(){if(m.length>0)return m.shift();if(g)return v();var r,n,i,s,a,u=0===c;do{if(c===d)return null;for(r=!1;o.test(i=b(c));)if("\n"===i&&(u=!0,++h),++c===d)return null;if("/"===b(c)){if(++c===d)throw y("comment");if("/"===b(c))if(l){if(s=c,a=!1,w(c-1)){a=!0;do if((c=T(c))===d||(c++,!u))break;while(w(c))}else c=Math.min(d,T(c)+1);a&&(S(s,c,u),u=!0),h++,r=!0}else{for(a="/"===b(s=c+1);"\n"!==b(++c);)if(c===d)return null;++c,a&&(S(s,c-1,u),u=!0),++h,r=!0}else{if("*"!==(i=b(c)))return"/";s=c+1,a=l||"*"===b(s);do{if("\n"===i&&++h,++c===d)throw y("comment");n=i,i=b(c)}while("*"!==n||"/"!==i);++c,a&&(S(s,c-2,u),u=!0),r=!0}}}while(r);var f=c;if(t.lastIndex=0,!t.test(b(f++)))for(;f<d&&!t.test(b(f));)++f;var p=e.substring(c,c=f);return('"'===p||"'"===p)&&(g=p),p}function C(e){m.push(e)}function _(){if(!m.length){var e=E();if(null===e)return null;C(e)}return m[0]}function I(e,t){var r=_();if(r===e)return E(),!0;if(!t)throw y("token '"+r+"', '"+e+"' expected");return!1}function x(e){var t,r=null;return void 0===e?(t=p[h-1],delete p[h-1],t&&(l||"*"===t.type||t.lineEmpty)&&(r=t.leading?t.text:null)):(f<e&&_(),t=p[e],delete p[e],t&&!t.lineEmpty&&(l||"/"===t.type)&&(r=t.leading?null:t.text)),r}return Object.defineProperty({next:E,peek:_,push:C,skip:I,cmnt:x},"line",{get:function(){return h}})}d.unescape=u},268:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackoffTimeout=void 0;let r=1e3,n=1.6,i=12e4,s=.2;function a(e,t){return Math.random()*(t-e)+e}class o{constructor(e,t){this.callback=e,this.initialDelay=r,this.multiplier=n,this.maxDelay=i,this.jitter=s,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,r;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||null==(r=(t=this.timerId).unref)||r.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+a(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,null==(t=(e=this.timerId).ref)||t.call(e)}unref(){var e,t;this.hasRef=!1,null==(t=(e=this.timerId).unref)||t.call(e)}getEndTime(){return this.endTime}}t.BackoffTimeout=o},324:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDuration=t.durationToMs=t.msToDuration=void 0,t.msToDuration=function(e){return{seconds:e/1e3|0,nanos:e%1e3*1e6|0}},t.durationToMs=function(e){return 1e3*e.seconds+e.nanos/1e6|0},t.isDuration=function(e){return"number"==typeof e.seconds&&"number"==typeof e.nanos}},388:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6444,23)),Promise.resolve().then(r.t.bind(r,6042,23)),Promise.resolve().then(r.t.bind(r,8170,23)),Promise.resolve().then(r.t.bind(r,9477,23)),Promise.resolve().then(r.t.bind(r,9345,23)),Promise.resolve().then(r.t.bind(r,2089,23)),Promise.resolve().then(r.t.bind(r,6577,23)),Promise.resolve().then(r.t.bind(r,1307,23))},440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(1658);let i=async e=>{let t={type:"image/x-icon",sizes:"16x16"},r=(0,n.fillMetadataSegment)(".",await e.params,"favicon.ico");return[{...t,url:r+""}]}},504:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractAndSelectServiceConfig=t.validateServiceConfig=t.validateRetryThrottling=void 0;let n=r(1820),i=r(1271),s=r(6239),a=/^\d+(\.\d{1,9})?s$/,o="node";function l(e){if("service"in e&&""!==e.service){if("string"!=typeof e.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof e.service}`);if(!("method"in e)||""===e.method)return{service:e.service};if("string"!=typeof e.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof e.service}`);return{service:e.service,method:e.method}}if("method"in e&&void 0!==e.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function c(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in e)||"string"!=typeof e.initialBackoff||!a.test(e.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in e)||"string"!=typeof e.maxBackoff||!a.test(e.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in e)||"number"!=typeof e.backoffMultiplier||e.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in e&&Array.isArray(e.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===e.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let t of e.retryableStatusCodes)if("number"==typeof t){if(!Object.values(i.Status).includes(t))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof t){if(!Object.values(i.Status).includes(t.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:e.maxAttempts,initialBackoff:e.initialBackoff,maxBackoff:e.maxBackoff,backoffMultiplier:e.backoffMultiplier,retryableStatusCodes:e.retryableStatusCodes}}function u(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in e&&("string"!=typeof e.hedgingDelay||!a.test(e.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in e&&Array.isArray(e.nonFatalStatusCodes))for(let t of e.nonFatalStatusCodes)if("number"==typeof t){if(!Object.values(i.Status).includes(t))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof t){if(!Object.values(i.Status).includes(t.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let t={maxAttempts:e.maxAttempts};return e.hedgingDelay&&(t.hedgingDelay=e.hedgingDelay),e.nonFatalStatusCodes&&(t.nonFatalStatusCodes=e.nonFatalStatusCodes),t}function d(e){var t;let r={name:[]};if(!("name"in e)||!Array.isArray(e.name))throw Error("Invalid method config: invalid name array");for(let t of e.name)r.name.push(l(t));if("waitForReady"in e){if("boolean"!=typeof e.waitForReady)throw Error("Invalid method config: invalid waitForReady");r.waitForReady=e.waitForReady}if("timeout"in e)if("object"==typeof e.timeout){if(!("seconds"in e.timeout)||"number"!=typeof e.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in e.timeout)||"number"!=typeof e.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");r.timeout=e.timeout}else if("string"==typeof e.timeout&&a.test(e.timeout)){let n=e.timeout.substring(0,e.timeout.length-1).split(".");r.timeout={seconds:0|n[0],nanos:(null!=(t=n[1])?t:0)|0}}else throw Error("Invalid method config: invalid timeout");if("maxRequestBytes"in e){if("number"!=typeof e.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");r.maxRequestBytes=e.maxRequestBytes}if("maxResponseBytes"in e){if("number"!=typeof e.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");r.maxResponseBytes=e.maxResponseBytes}if("retryPolicy"in e)if("hedgingPolicy"in e)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");else r.retryPolicy=c(e.retryPolicy);else"hedgingPolicy"in e&&(r.hedgingPolicy=u(e.hedgingPolicy));return r}function h(e){if(!("maxTokens"in e)||"number"!=typeof e.maxTokens||e.maxTokens<=0||e.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in e)||"number"!=typeof e.tokenRatio||e.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+e.maxTokens.toFixed(3),tokenRatio:+e.tokenRatio.toFixed(3)}}function f(e){let t={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in e)if("string"==typeof e.loadBalancingPolicy)t.loadBalancingPolicy=e.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in e)if(Array.isArray(e.loadBalancingConfig))for(let r of e.loadBalancingConfig)t.loadBalancingConfig.push((0,s.validateLoadBalancingConfig)(r));else throw Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in e&&Array.isArray(e.methodConfig))for(let r of e.methodConfig)t.methodConfig.push(d(r));"retryThrottling"in e&&(t.retryThrottling=h(e.retryThrottling));let r=[];for(let e of t.methodConfig)for(let t of e.name){for(let e of r)if(t.service===e.service&&t.method===e.method)throw Error(`Invalid service config: duplicate name ${t.service}/${t.method}`);r.push(t)}return t}function p(e){if(!("serviceConfig"in e))throw Error("Invalid service config choice: missing service config");let t={serviceConfig:f(e.serviceConfig)};if("clientLanguage"in e)if(Array.isArray(e.clientLanguage))for(let r of(t.clientLanguage=[],e.clientLanguage))if("string"==typeof r)t.clientLanguage.push(r);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in e)if(Array.isArray(e.clientHostname))for(let r of(t.clientHostname=[],e.clientHostname))if("string"==typeof r)t.clientHostname.push(r);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname");if("percentage"in e)if("number"==typeof e.percentage&&0<=e.percentage&&e.percentage<=100)t.percentage=e.percentage;else throw Error("Invalid service config choice: invalid percentage");let r=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let t in e)if(!r.includes(t))throw Error(`Invalid service config choice: unexpected field ${t}`);return t}function m(e,t){if(!Array.isArray(e))throw Error("Invalid service config list");for(let r of e){let e=p(r);if("number"!=typeof e.percentage||!(t>e.percentage)){if(Array.isArray(e.clientHostname)){let t=!1;for(let r of e.clientHostname)r===n.hostname()&&(t=!0);if(!t)continue}if(Array.isArray(e.clientLanguage)){let t=!1;for(let r of e.clientLanguage)r===o&&(t=!0);if(!t)continue}return e.serviceConfig}}throw Error("No matching service config found")}t.validateRetryThrottling=h,t.validateServiceConfig=f,t.extractAndSelectServiceConfig=function(e,t){for(let r of e)if(r.length>0&&r[0].startsWith("grpc_config="))return m(JSON.parse(r.join("").substring(12)),t);return null}},554:(e,t)=>{"use strict";function r(e){return e.endsWith("/route")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isAppRouteRoute",{enumerable:!0,get:function(){return r}})},603:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2SubchannelConnector=void 0;let n=r(3496),i=r(4631),s=r(6827),a=r(1271),o=r(8620),l=r(1359),c=r(5674),u=r(3356),d=r(6786),h=r(1645),f=r(3474),p=r(1260),m="transport",g="transport_flowctrl",y=r(8592).rE,{HTTP2_HEADER_AUTHORITY:v,HTTP2_HEADER_CONTENT_TYPE:b,HTTP2_HEADER_METHOD:S,HTTP2_HEADER_PATH:w,HTTP2_HEADER_TE:T,HTTP2_HEADER_USER_AGENT:E}=n.constants,C=2e4,_=Buffer.from("too_many_pings","ascii");class I{constructor(e,t,r,i){this.session=e,this.options=r,this.remoteName=i,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=C,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new s.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,u.subchannelAddressToString)(t),0===r["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,s.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${y}`,r["grpc.secondary_user_agent"]].filter(e=>e).join(" "),"grpc.keepalive_time_ms"in r&&(this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in r&&(this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in r?this.keepaliveWithoutCalls=1===r["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(e,t,r)=>{let i=!1;e===n.constants.NGHTTP2_ENHANCE_YOUR_CALM&&r&&r.equals(_)&&(i=!0),this.trace("connection closed by GOAWAY with code "+e+" and data "+(null==r?void 0:r.toString())),this.reportDisconnectToOwner(i)}),e.once("error",e=>{this.trace("connection closed with error "+e.message)}),l.isTracerEnabled(m)&&(e.on("remoteSettings",t=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))}),e.on("localSettings",t=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,r;let n,i=this.session.socket,s=i.remoteAddress?(0,u.stringToSubchannelAddress)(i.remoteAddress,i.remotePort):null,a=i.localAddress?(0,u.stringToSubchannelAddress)(i.localAddress,i.localPort):null;if(this.session.encrypted){let t=i,r=t.getCipher(),s=t.getCertificate(),a=t.getPeerCertificate();n={cipherSuiteStandardName:null!=(e=r.standardName)?e:null,cipherSuiteOtherName:r.standardName?null:r.name,localCertificate:s&&"raw"in s?s.raw:null,remoteCertificate:a&&"raw"in a?a.raw:null}}else n=null;return{remoteAddress:s,localAddress:a,security:n,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(t=this.session.state.localWindowSize)?t:null,remoteFlowControlWindow:null!=(r=this.session.state.remoteWindowSize)?r:null}}trace(e){l.trace(a.LogVerbosity.DEBUG,m,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){l.trace(a.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){l.trace(a.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){l.trace(a.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null==(t=(e=this.keepaliveTimeoutId).unref)||t.call(e));try{this.session.ping((e,t,r)=>{e&&(this.keepaliveTrace("Ping failed with error "+e.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(e){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null==(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),0===this.activeCalls.size&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),1===this.activeCalls.size&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,r,n,i){let s,a,o,l=e.toHttp2Headers();l[v]=t,l[E]=this.userAgent,l[b]="application/grpc",l[S]="POST",l[w]=r,l[T]="trailers";try{s=this.session.request(l)}catch(e){throw this.handleDisconnect(),e}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),a={addMessageSent:()=>{var e;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null==(e=i.addMessageSent)||e.call(i)},addMessageReceived:()=>{var e;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null==(e=i.addMessageReceived)||e.call(i)},onCallEnd:e=>{var t;null==(t=i.onCallEnd)||t.call(i,e),this.removeActiveCall(o)},onStreamEnd:e=>{var t;e?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null==(t=i.onStreamEnd)||t.call(i,e)}}):a={addMessageSent:()=>{var e;null==(e=i.addMessageSent)||e.call(i)},addMessageReceived:()=>{var e;null==(e=i.addMessageReceived)||e.call(i)},onCallEnd:e=>{var t;null==(t=i.onCallEnd)||t.call(i,e),this.removeActiveCall(o)},onStreamEnd:e=>{var t;null==(t=i.onStreamEnd)||t.call(i,e)}},o=new f.Http2SubchannelCall(s,a,n,this,(0,p.getNextCallNumber)()),this.addActiveCall(o),o}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,s.unregisterChannelzRef)(this.channelzRef)}}class x{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){l.trace(a.LogVerbosity.DEBUG,m,(0,d.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,r,s){return this.isShutdown?Promise.reject():new Promise((a,o)=>{var l,f,p;let m;s.realTarget?(m=(0,d.uriToString)(s.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,d.uriToString)(s.realTarget))):(m=null,this.trace("creating HTTP/2 session to "+(0,u.subchannelAddressToString)(e)));let g=(0,c.getDefaultAuthority)(null!=(l=s.realTarget)?l:this.channelTarget),y=t._getConnectionOptions()||{};y.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in r?y.maxSessionMemory=r["grpc-node.max_session_memory"]:y.maxSessionMemory=Number.MAX_SAFE_INTEGER;let v="http://";if("secureContext"in y){if(v="https://",r["grpc.ssl_target_name_override"]){let e=r["grpc.ssl_target_name_override"];y.checkServerIdentity=(t,r)=>(0,i.checkServerIdentity)(e,r),y.servername=e}else{let e=null!=(p=null==(f=(0,d.splitHostPort)(g))?void 0:f.host)?p:"localhost";y.servername=e}s.socket&&(y.createConnection=(e,t)=>s.socket)}else y.createConnection=(t,r)=>s.socket?s.socket:h.connect(e);y=Object.assign(Object.assign(Object.assign({},y),e),{enableTrace:1===r["grpc-node.tls_enable_trace"]});let b=n.connect(v+g,y);this.session=b;let S="Failed to connect";b.unref(),b.once("connect",()=>{b.removeAllListeners(),a(new I(b,e,r,m)),this.session=null}),b.once("close",()=>{this.session=null,setImmediate(()=>{o(`${S} (${new Date().toISOString()})`)})}),b.once("error",e=>{S=e.message,this.trace("connection failed with error "+S)})})}connect(e,t,r){var n,s;if(this.isShutdown)return Promise.reject();let a=t._getConnectionOptions()||{};if("secureContext"in a){if(a.ALPNProtocols=["h2"],r["grpc.ssl_target_name_override"]){let e=r["grpc.ssl_target_name_override"];a.checkServerIdentity=(t,r)=>(0,i.checkServerIdentity)(e,r),a.servername=e}else if("grpc.http_connect_target"in r){let e=(0,c.getDefaultAuthority)(null!=(n=(0,d.parseUri)(r["grpc.http_connect_target"]))?n:{path:"localhost"}),t=(0,d.splitHostPort)(e);a.servername=null!=(s=null==t?void 0:t.host)?s:e}r["grpc-node.tls_enable_trace"]&&(a.enableTrace=!0)}return(0,o.getProxiedConnection)(e,r,a).then(n=>this.createSession(e,t,r,n))}shutdown(){var e;this.isShutdown=!0,null==(e=this.session)||e.close(),this.session=null}}t.Http2SubchannelConnector=x},660:(e,t)=>{"use strict";function r(e){let t=5381;for(let r=0;r<e.length;r++)t=(t<<5)+t+e.charCodeAt(r)|0;return t>>>0}function n(e){return r(e).toString(36).slice(0,5)}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{djb2Hash:function(){return r},hexHash:function(){return n}})},776:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorCode=t.getErrorMessage=void 0,t.getErrorMessage=function(e){return e instanceof Error?e.message:String(e)},t.getErrorCode=function(e){return"object"==typeof e&&null!==e&&"code"in e&&"number"==typeof e.code?e.code:null}},788:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBuilder=void 0;class r{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return null!==this.code&&(e.code=this.code),null!==this.details&&(e.details=this.details),null!==this.metadata&&(e.metadata=this.metadata),e}}t.StatusBuilder=r},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},847:(e,t,r)=>{"use strict";e.exports=o;var n=r(2110),i=r(1810),s=r(3107);function a(e,t,r,n){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(t.id<<3|2)>>>0)}function o(e){for(var t,r,o=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),l=e.fieldsArray.slice().sort(s.compareFieldsById),t=0;t<l.length;++t){var c=l[t].resolve(),u=e._fieldsArray.indexOf(c),d=c.resolvedType instanceof n?"int32":c.type,h=i.basic[d];r="m"+s.safeProp(c.name),c.map?(o("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,c.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(c.id<<3|2)>>>0,8|i.mapKey[c.keyType],c.keyType),void 0===h?o("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,r):o(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,r),o("}")("}")):c.repeated?(o("if(%s!=null&&%s.length){",r,r),c.packed&&void 0!==i.packed[d]?o("w.uint32(%i).fork()",(c.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",d,r)("w.ldelim()"):(o("for(var i=0;i<%s.length;++i)",r),void 0===h?a(o,c,u,r+"[i]"):o("w.uint32(%i).%s(%s[i])",(c.id<<3|h)>>>0,d,r)),o("}")):(c.optional&&o("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,c.name),void 0===h?a(o,c,u,r):o("w.uint32(%i).%s(%s)",(c.id<<3|h)>>>0,d,r))}return o("return w")}},962:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseFilter=void 0;class r{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}}t.BaseFilter=r},1037:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.StreamDecoder=void 0,function(e){e[e.NO_DATA=0]="NO_DATA",e[e.READING_SIZE=1]="READING_SIZE",e[e.READING_MESSAGE=2]="READING_MESSAGE"}(r||(r={}));class n{constructor(e){this.maxReadMessageLength=e,this.readState=r.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t,n=0,i=[];for(;n<e.length;)switch(this.readState){case r.NO_DATA:this.readCompressFlag=e.slice(n,n+1),n+=1,this.readState=r.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case r.READING_SIZE:if(t=Math.min(e.length-n,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,n,n+t),this.readSizeRemaining-=t,n+=t,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=r.READING_MESSAGE;else{let e=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=r.NO_DATA,i.push(e)}}break;case r.READING_MESSAGE:if(t=Math.min(e.length-n,this.readMessageRemaining),this.readPartialMessage.push(e.slice(n,n+t)),this.readMessageRemaining-=t,n+=t,0===this.readMessageRemaining){let e=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),t=Buffer.concat(e,this.readMessageSize+5);this.readState=r.NO_DATA,i.push(t)}break;default:throw Error("Unexpected read state")}return i}}t.StreamDecoder=n},1135:()=>{},1140:(e,t)=>{"use strict";var r=t,n=r.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},i=r.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),r=n(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)".."===t[s]?s>0&&".."!==t[s-1]?t.splice(--s,2):r?t.splice(s,1):++s:"."===t[s]?t.splice(s,1):++s;return i+t.join("/")};r.resolve=function(e,t,r){return(r||(t=i(t)),n(t))?t:(r||(e=i(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?i(e+"/"+t):t)}},1156:(e,t,r)=>{"use strict";e.exports=i;var n=r(8707);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=i.zero=new i(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/0x100000000>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>0xffffffff&&(r=0,++n>0xffffffff&&(n=0))),new i(r,n)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(n.isString(e))if(!n.Long)return i.fromNumber(parseInt(e,10));else e=n.Long.fromString(e);return e.low||e.high?new i(e.low>>>0,e.high>>>0):s},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+0x100000000*r)}return this.lo+0x100000000*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var o=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?s:new i((o.call(e,0)|o.call(e,1)<<8|o.call(e,2)<<16|o.call(e,3)<<24)>>>0,(o.call(e,4)|o.call(e,5)<<8|o.call(e,6)<<16|o.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},1171:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>d,pages:()=>u,routeModule:()=>h,tree:()=>c});var n=r(5239),i=r(8088),s=r(8170),a=r.n(s),o=r(893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1204)),"/Users/powellquiring/github.com/powellquiring/accountviewer/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/Users/powellquiring/github.com/powellquiring/accountviewer/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,u=["/Users/powellquiring/github.com/powellquiring/accountviewer/src/app/page.tsx"],d={require:r,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1202:(e,t,r)=>{"use strict";e.exports=s;var n=r(4824);((s.prototype=Object.create(n.prototype)).constructor=s).className="Method";var i=r(3107);function s(e,t,r,s,a,o,l,c,u){if(i.isObject(a)?(l=a,a=o=void 0):i.isObject(o)&&(l=o,o=void 0),!(void 0===t||i.isString(t)))throw TypeError("type must be a string");if(!i.isString(r))throw TypeError("requestType must be a string");if(!i.isString(s))throw TypeError("responseType must be a string");n.call(this,e,l),this.type=t||"rpc",this.requestType=r,this.requestStream=!!a||void 0,this.responseType=s,this.responseStream=!!o||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c,this.parsedOptions=u}s.fromJSON=function(e,t){return new s(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},s.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return i.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},s.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))}},1204:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});let n=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/powellquiring/github.com/powellquiring/accountviewer/src/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/powellquiring/github.com/powellquiring/accountviewer/src/app/page.tsx","default")},1260:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNextCallNumber=void 0;let r=0;t.getNextCallNumber=function(){return r++}},1271:(e,t)=>{"use strict";var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=t.Propagate=t.LogVerbosity=t.Status=void 0,function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(r||(t.Status=r={})),function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.ERROR=2]="ERROR",e[e.NONE=3]="NONE"}(n||(t.LogVerbosity=n={})),function(e){e[e.DEADLINE=1]="DEADLINE",e[e.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",e[e.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",e[e.CANCELLATION=8]="CANCELLATION",e[e.DEFAULTS=65535]="DEFAULTS"}(i||(t.Propagate=i={})),t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},1309:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvingLoadBalancer=void 0;let n=r(6239),i=r(504),s=r(8155),a=r(5674),o=r(2910),l=r(268),c=r(1271),u=r(6777),d=r(1359),h=r(1271),f=r(6786),p=r(2309),m="resolving_load_balancer";function g(e){d.trace(h.LogVerbosity.DEBUG,m,e)}let y=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function v(e,t,r,n){for(let i of r.name)switch(n){case"EMPTY":if(!i.service&&!i.method)return!0;break;case"SERVICE":if(i.service===e&&!i.method)return!0;break;case"SERVICE_AND_METHOD":if(i.service===e&&i.method===t)return!0}return!1}function b(e,t,r,n){for(let i of r)if(v(e,t,i,n))return i;return null}function S(e){return function(t,r){var n,i;let s=t.split("/").filter(e=>e.length>0),a=null!=(n=s[0])?n:"",o=null!=(i=s[1])?i:"";if(e&&e.methodConfig)for(let t of y){let r=b(a,o,e.methodConfig,t);if(r)return{methodConfig:r,pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}}class w{constructor(e,t,r,d,h){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=d,this.onFailedResolution=h,this.latestChildState=s.ConnectivityState.IDLE,this.latestChildPicker=new o.QueuePicker(this),this.currentState=s.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,r["grpc.service_config"]?this.defaultServiceConfig=(0,i.validateServiceConfig)(JSON.parse(r["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(s.ConnectivityState.IDLE,new o.QueuePicker(this)),this.childLoadBalancer=new p.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(g("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(e,t)=>{this.latestChildState=e,this.latestChildPicker=t,this.updateState(e,t)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,a.createResolver)(e,{onSuccessfulResolution:(e,t,r,i,s)=>{var a;this.backoffTimeout.stop(),this.backoffTimeout.reset();let o=null;null===t?null===r?(this.previousServiceConfig=null,o=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(r):o=this.previousServiceConfig:(o=t,this.previousServiceConfig=t);let l=null!=(a=null==o?void 0:o.loadBalancingConfig)?a:[],d=(0,n.getFirstUsableConfig)(l,!0);if(null===d)return void this.handleResolutionFailure({code:c.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new u.Metadata});this.childLoadBalancer.updateAddressList(e,d,s);let h=null!=o?o:this.defaultServiceConfig;this.onSuccessfulResolution(h,null!=i?i:S(h))},onError:e=>{this.handleResolutionFailure(e)}},r);let f={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new l.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},f),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===s.ConnectivityState.IDLE&&this.updateState(s.ConnectivityState.CONNECTING,new o.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){g((0,f.uriToString)(this.target)+" "+s.ConnectivityState[this.currentState]+" -> "+s.ConnectivityState[e]),e===s.ConnectivityState.IDLE&&(t=new o.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===s.ConnectivityState.IDLE&&(this.updateState(s.ConnectivityState.TRANSIENT_FAILURE,new o.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===s.ConnectivityState.IDLE||this.currentState===s.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=s.ConnectivityState.IDLE,this.latestChildPicker=new o.QueuePicker(this),this.currentState=s.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}t.ResolvingLoadBalancer=w},1359:(e,t,r)=>{"use strict";var n,i,s,a;Object.defineProperty(t,"__esModule",{value:!0}),t.isTracerEnabled=t.trace=t.log=t.setLoggerVerbosity=t.setLogger=t.getLogger=void 0;let o=r(1271),l=r(9771),c=r(8592).rE,u={error:(e,...t)=>{console.error("E "+e,...t)},info:(e,...t)=>{console.error("I "+e,...t)},debug:(e,...t)=>{console.error("D "+e,...t)}},d=o.LogVerbosity.ERROR;switch((null!=(i=null!=(n=process.env.GRPC_NODE_VERBOSITY)?n:process.env.GRPC_VERBOSITY)?i:"").toUpperCase()){case"DEBUG":d=o.LogVerbosity.DEBUG;break;case"INFO":d=o.LogVerbosity.INFO;break;case"ERROR":d=o.LogVerbosity.ERROR;break;case"NONE":d=o.LogVerbosity.NONE}t.getLogger=()=>u,t.setLogger=e=>{u=e},t.setLoggerVerbosity=e=>{d=e},t.log=(e,...t)=>{let r;if(e>=d){switch(e){case o.LogVerbosity.DEBUG:r=u.debug;break;case o.LogVerbosity.INFO:r=u.info;break;case o.LogVerbosity.ERROR:r=u.error}r||(r=u.error),r&&r.bind(u)(...t)}};let h=null!=(a=null!=(s=process.env.GRPC_NODE_TRACE)?s:process.env.GRPC_TRACE)?a:"",f=new Set,p=new Set;for(let e of h.split(","))e.startsWith("-")?p.add(e.substring(1)):f.add(e);let m=f.has("all");function g(e,r,n){y(r)&&(0,t.log)(e,new Date().toISOString()+" | v"+c+" "+l.pid+" | "+r+" | "+n)}function y(e){return!p.has(e)&&(m||f.has(e))}t.trace=g,t.isTracerEnabled=y},1437:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{INTERCEPTION_ROUTE_MARKERS:function(){return i},extractInterceptionRouteInformation:function(){return a},isInterceptionRouteAppPath:function(){return s}});let n=r(4722),i=["(..)(..)","(.)","(..)","(...)"];function s(e){return void 0!==e.split("/").find(e=>i.find(t=>e.startsWith(t)))}function a(e){let t,r,s;for(let n of e.split("/"))if(r=i.find(e=>n.startsWith(e))){[t,s]=e.split(r,2);break}if(!t||!r||!s)throw Object.defineProperty(Error("Invalid interception route: "+e+". Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>"),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(t=(0,n.normalizeAppPath)(t),r){case"(.)":s="/"===t?"/"+s:t+"/"+s;break;case"(..)":if("/"===t)throw Object.defineProperty(Error("Invalid interception route: "+e+". Cannot use (..) marker at the root level, use (.) instead."),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});s=t.split("/").slice(0,-1).concat(s).join("/");break;case"(...)":s="/"+s;break;case"(..)(..)":let a=t.split("/");if(a.length<=2)throw Object.defineProperty(Error("Invalid interception route: "+e+". Cannot use (..)(..) marker at the root level or one level up."),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});s=a.slice(0,-2).concat(s).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:t,interceptedRoute:s}}},1470:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;let n=r(1645),i=r(1271),s=r(6777),a=r(5674),o=r(6786),l=r(1359),c="ip_resolver";function u(e){l.trace(i.LogVerbosity.DEBUG,c,e)}let d="ipv4",h="ipv6",f=443;class p{constructor(e,t,r){var a;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,u("Resolver constructed for target "+(0,o.uriToString)(e));let l=[];if(e.scheme!==d&&e.scheme!==h){this.error={code:i.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new s.Metadata};return}for(let t of e.path.split(",")){let r=(0,o.splitHostPort)(t);if(null===r||e.scheme===d&&!(0,n.isIPv4)(r.host)||e.scheme===h&&!(0,n.isIPv6)(r.host)){this.error={code:i.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new s.Metadata};return}l.push({host:r.host,port:null!=(a=r.port)?a:f})}this.addresses=l,u("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}}t.setup=function(){(0,a.registerResolver)(d,p),(0,a.registerResolver)(h,p)}},1480:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPackageDefinition=t.makeClientConstructor=void 0;let n=r(7775),i={unary:n.Client.prototype.makeUnaryRequest,server_stream:n.Client.prototype.makeServerStreamRequest,client_stream:n.Client.prototype.makeClientStreamRequest,bidi:n.Client.prototype.makeBidiStreamRequest};function s(e){return["__proto__","prototype","constructor"].includes(e)}function a(e,t,r){r||(r={});class a extends n.Client{}return Object.keys(e).forEach(t=>{let r;if(s(t))return;let n=e[t];if("string"==typeof t&&"$"===t.charAt(0))throw Error("Method names cannot start with $");r=n.requestStream?n.responseStream?"bidi":"client_stream":n.responseStream?"server_stream":"unary";let l=n.requestSerialize,c=n.responseDeserialize,u=o(i[r],n.path,l,c);a.prototype[t]=u,Object.assign(a.prototype[t],n),n.originalName&&!s(n.originalName)&&(a.prototype[n.originalName]=a.prototype[t])}),a.service=e,a.serviceName=t,a}function o(e,t,r,n){return function(...i){return e.call(this,t,r,n,...i)}}function l(e){return"format"in e}t.makeClientConstructor=a,t.loadPackageDefinition=function(e){let t={};for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let n=e[r],i=r.split(".");if(i.some(e=>s(e)))continue;let o=i[i.length-1],c=t;for(let e of i.slice(0,-1))c[e]||(c[e]={}),c=c[e];l(n)?c[o]=n:c[o]=a(n,o,{})}return t}},1532:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.OutlierDetectionLoadBalancer=t.OutlierDetectionLoadBalancingConfig=void 0;let i=r(8155),s=r(1271),a=r(324),o=r(6250),l=r(6239),c=r(2309),u=r(2910),d=r(3356),h=r(4719),f=r(1359),p="outlier_detection";function m(e){f.trace(s.LogVerbosity.DEBUG,p,e)}let g="outlier_detection",y=(null!=(n=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)?n:"true")==="true",v={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},b={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function S(e,t,r,n){if(t in e&&typeof e[t]!==r){let i=n?`${n}.${t}`:t;throw Error(`outlier detection config ${i} parse error: expected ${r}, got ${typeof e[t]}`)}}function w(e,t,r){let n=r?`${r}.${t}`:t;if(t in e){if(!(0,a.isDuration)(e[t]))throw Error(`outlier detection config ${n} parse error: expected Duration, got ${typeof e[t]}`);if(!(e[t].seconds>=0&&e[t].seconds<=315576e6&&e[t].nanos>=0&&e[t].nanos<=0x3b9ac9ff))throw Error(`outlier detection config ${n} parse error: values out of range for non-negative Duaration`)}}function T(e,t,r){let n=r?`${r}.${t}`:t;if(S(e,t,"number",r),t in e&&!(e[t]>=0&&e[t]<=100))throw Error(`outlier detection config ${n} parse error: value out of range for percentage (0-100)`)}class E{constructor(e,t,r,n,i,s,a){if(this.childPolicy=a,a.length>0&&"pick_first"===a[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=e?e:1e4,this.baseEjectionTimeMs=null!=t?t:3e4,this.maxEjectionTimeMs=null!=r?r:3e5,this.maxEjectionPercent=null!=n?n:10,this.successRateEjection=i?Object.assign(Object.assign({},v),i):null,this.failurePercentageEjection=s?Object.assign(Object.assign({},b),s):null}getLoadBalancerName(){return g}toJsonObject(){return{interval:(0,a.msToDuration)(this.intervalMs),base_ejection_time:(0,a.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,a.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new E(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(w(e,"interval"),w(e,"base_ejection_time"),w(e,"max_ejection_time"),T(e,"max_ejection_percent"),"success_rate_ejection"in e){if("object"!=typeof e.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");S(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),T(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),S(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),S(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if("object"!=typeof e.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");T(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),T(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),S(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),S(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new E(e.interval?(0,a.durationToMs)(e.interval):null,e.base_ejection_time?(0,a.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,a.durationToMs)(e.max_ejection_time):null,null!=(t=e.max_ejection_percent)?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(l.validateLoadBalancingConfig))}}t.OutlierDetectionLoadBalancingConfig=E;class C extends h.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((e,t,r,n)=>{if(this.childSubchannelState=r,!this.ejected)for(let e of this.stateListeners)e(this,t,r,n)})}getConnectivityState(){return this.ejected?i.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){for(let e of(this.ejected=!0,this.stateListeners))e(this,this.childSubchannelState,i.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let e of(this.ejected=!1,this.stateListeners))e(this,i.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function _(){return{success:0,failure:0}}class I{constructor(){this.activeBucket=_(),this.inactiveBucket=_()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=_()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class x{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType!==u.PickResultType.COMPLETE)return t;{let e=t.subchannel,r=e.getMapEntry();if(!r)return Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel()});{let n=t.onCallEnded;return this.countCalls&&(n=e=>{var n;e===s.Status.OK?r.counter.addSuccess():r.counter.addFailure(),null==(n=t.onCallEnded)||n.call(t,e)}),Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel(),onCallEnded:n})}}}}class R{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new c.ChildLoadBalancerHandler((0,o.createChildChannelControlHelper)(e,{createSubchannel:(t,r)=>{let n=e.createSubchannel(t,r),i=this.addressMap.get((0,d.subchannelAddressToString)(t)),s=new C(n,i);return(null==i?void 0:i.currentEjectionTimestamp)!==null&&s.eject(),null==i||i.subchannelWrappers.push(s),s},updateState:(t,r)=>{t===i.ConnectivityState.READY?e.updateState(t,new x(r,this.isCountingEnabled())):e.updateState(t,r)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())null!==t.currentEjectionTimestamp&&(e+=1);return 100*e/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;m("Running success rate check");let r=t.request_volume,n=0,i=[];for(let[e,t]of this.addressMap){let s=t.counter.getLastSuccesses(),a=t.counter.getLastFailures();m("Stats for "+e+": successes="+s+" failures="+a+" targetRequestVolume="+r),s+a>=r&&(n+=1,i.push(s/(s+a)))}if(m("Found "+n+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+i+"]"),n<t.minimum_hosts)return;let s=i.reduce((e,t)=>e+t)/i.length,a=0;for(let e of i){let t=e-s;a+=t*t}let o=Math.sqrt(a/i.length),l=s-o*(t.stdev_factor/1e3);for(let[n,i]of(m("stdev="+o+" ejectionThreshold="+l),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let s=i.counter.getLastSuccesses(),a=i.counter.getLastFailures();if(s+a<r)continue;let o=s/(s+a);if(m("Checking candidate "+n+" successRate="+o),o<l){let r=100*Math.random();m("Candidate "+n+" randomNumber="+r+" enforcement_percentage="+t.enforcement_percentage),r<t.enforcement_percentage&&(m("Ejecting candidate "+n),this.eject(i,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;m("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let r=0;for(let e of this.addressMap.values())e.counter.getLastSuccesses()+e.counter.getLastFailures()>=t.request_volume&&(r+=1);if(!(r<t.minimum_hosts))for(let[r,n]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let i=n.counter.getLastSuccesses(),s=n.counter.getLastFailures();if((m("Candidate successes="+i+" failures="+s),!(i+s<t.request_volume))&&100*s/(s+i)>t.threshold){let i=100*Math.random();m("Candidate "+r+" randomNumber="+i+" enforcement_percentage="+t.enforcement_percentage),i<t.enforcement_percentage&&(m("Ejecting candidate "+r),this.eject(n,e))}}}eject(e,t){for(let t of(e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1,e.subchannelWrappers))t.eject()}uneject(e){for(let t of(e.currentEjectionTimestamp=null,e.subchannelWrappers))t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,r;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),null==(r=(t=this.ejectionTimer).unref)||r.call(t)}runChecks(){let e=new Date;if(m("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[t,r]of(this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e),this.addressMap.entries()))if(null===r.currentEjectionTimestamp)r.ejectionTimeMultiplier>0&&(r.ejectionTimeMultiplier-=1);else{let e=this.latestConfig.getBaseEjectionTimeMs(),n=this.latestConfig.getMaxEjectionTimeMs(),i=new Date(r.currentEjectionTimestamp.getTime());i.setMilliseconds(i.getMilliseconds()+Math.min(e*r.ejectionTimeMultiplier,Math.max(e,n))),i<new Date&&(m("Unejecting "+t),this.uneject(r))}}updateAddressList(e,t,r){if(!(t instanceof E))return;let n=new Set;for(let t of e)n.add((0,d.subchannelAddressToString)(t));for(let e of n)this.addressMap.has(e)||(m("Adding map entry for "+e),this.addressMap.set(e,{counter:new I,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let e of this.addressMap.keys())n.has(e)||(m("Removing map entry for "+e),this.addressMap.delete(e));let i=(0,l.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,i,r),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){m("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let e=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(e)}else m("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else for(let e of(m("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(e),e.ejectionTimeMultiplier=0;this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return g}}t.OutlierDetectionLoadBalancer=R,t.setup=function(){y&&(0,o.registerLoadBalancerType)(g,R,E)}},1614:(e,t,r)=>{"use strict";var n=r(8474);e.exports=t=n.descriptor=n.Root.fromJSON(r(40)).lookup(".google.protobuf");var i=n.Namespace,s=n.Root,a=n.Enum,o=n.Type,l=n.Field,c=n.MapField,u=n.OneOf,d=n.Service,h=n.Method;function f(e,r,n){var c=t.FileDescriptorProto.create({name:e.filename||(e.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});n&&(c.syntax=n),e instanceof s||(c.package=e.fullName.substring(1));for(var u,h=0;h<e.nestedArray.length;++h)(u=e._nestedArray[h])instanceof o?c.messageType.push(u.toDescriptor(n)):u instanceof a?c.enumType.push(u.toDescriptor()):u instanceof l?c.extension.push(u.toDescriptor(n)):u instanceof d?c.service.push(u.toDescriptor()):u instanceof i&&f(u,r,n);c.options=C(e.options,t.FileOptions),c.messageType.length+c.enumType.length+c.extension.length+c.service.length&&r.push(c)}s.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.FileDescriptorSet.decode(e));var r=new s;if(e.file)for(var n,i,c,u=0;u<e.file.length;++u){if(i=r,(n=e.file[u]).package&&n.package.length&&(i=r.define(n.package)),n.name&&n.name.length&&r.files.push(i.filename=n.name),n.messageType)for(c=0;c<n.messageType.length;++c)i.add(o.fromDescriptor(n.messageType[c],n.syntax));if(n.enumType)for(c=0;c<n.enumType.length;++c)i.add(a.fromDescriptor(n.enumType[c]));if(n.extension)for(c=0;c<n.extension.length;++c)i.add(l.fromDescriptor(n.extension[c]));if(n.service)for(c=0;c<n.service.length;++c)i.add(d.fromDescriptor(n.service[c]));var h=E(n.options,t.FileOptions);if(h){var f=Object.keys(h);for(c=0;c<f.length;++c)i.setOption(f[c],h[f[c]])}}return r},s.prototype.toDescriptor=function(e){var r=t.FileDescriptorSet.create();return f(this,r.file,e),r};var p=0;o.fromDescriptor=function(e,r){"number"==typeof e.length&&(e=t.DescriptorProto.decode(e));var n,i=new o(e.name.length?e.name:"Type"+p++,E(e.options,t.MessageOptions));if(e.oneofDecl)for(n=0;n<e.oneofDecl.length;++n)i.add(u.fromDescriptor(e.oneofDecl[n]));if(e.field)for(n=0;n<e.field.length;++n){var s=l.fromDescriptor(e.field[n],r);i.add(s),e.field[n].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[n].oneofIndex].add(s)}if(e.extension)for(n=0;n<e.extension.length;++n)i.add(l.fromDescriptor(e.extension[n],r));if(e.nestedType)for(n=0;n<e.nestedType.length;++n)i.add(o.fromDescriptor(e.nestedType[n],r)),e.nestedType[n].options&&e.nestedType[n].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(n=0;n<e.enumType.length;++n)i.add(a.fromDescriptor(e.enumType[n]));if(e.extensionRange&&e.extensionRange.length)for(n=0,i.extensions=[];n<e.extensionRange.length;++n)i.extensions.push([e.extensionRange[n].start,e.extensionRange[n].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(n=0;n<e.reservedRange.length;++n)i.reserved.push([e.reservedRange[n].start,e.reservedRange[n].end]);if(e.reservedName)for(n=0;n<e.reservedName.length;++n)i.reserved.push(e.reservedName[n])}return i},o.prototype.toDescriptor=function(e){var r,n,i=t.DescriptorProto.create({name:this.name});for(n=0;n<this.fieldsArray.length;++n)if(i.field.push(r=this._fieldsArray[n].toDescriptor(e)),this._fieldsArray[n]instanceof c){var s=T(this._fieldsArray[n].keyType,this._fieldsArray[n].resolvedKeyType),u=T(this._fieldsArray[n].type,this._fieldsArray[n].resolvedType),d=11===u||14===u?this._fieldsArray[n].resolvedType&&_(this.parent,this._fieldsArray[n].resolvedType)||this._fieldsArray[n].type:void 0;i.nestedType.push(t.DescriptorProto.create({name:r.typeName,field:[t.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),t.FieldDescriptorProto.create({name:"value",number:2,label:1,type:u,typeName:d})],options:t.MessageOptions.create({mapEntry:!0})}))}for(n=0;n<this.oneofsArray.length;++n)i.oneofDecl.push(this._oneofsArray[n].toDescriptor());for(n=0;n<this.nestedArray.length;++n)this._nestedArray[n]instanceof l?i.field.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof o?i.nestedType.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof a&&i.enumType.push(this._nestedArray[n].toDescriptor());if(this.extensions)for(n=0;n<this.extensions.length;++n)i.extensionRange.push(t.DescriptorProto.ExtensionRange.create({start:this.extensions[n][0],end:this.extensions[n][1]}));if(this.reserved)for(n=0;n<this.reserved.length;++n)"string"==typeof this.reserved[n]?i.reservedName.push(this.reserved[n]):i.reservedRange.push(t.DescriptorProto.ReservedRange.create({start:this.reserved[n][0],end:this.reserved[n][1]}));return i.options=C(this.options,t.MessageOptions),i};var m=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function(e,r){if("number"==typeof e.length&&(e=t.DescriptorProto.decode(e)),"number"!=typeof e.number)throw Error("missing field id");switch(n=e.typeName&&e.typeName.length?e.typeName:S(e.type),e.label){case 1:i=void 0;break;case 2:i="required";break;case 3:i="repeated";break;default:throw Error("illegal label: "+e.label)}var n,i,s=e.extendee;void 0!==e.extendee&&(s=s.length?s:void 0);var a=new l(e.name.length?e.name:"field"+e.number,e.number,n,i,s);if(a.options=E(e.options,t.FieldOptions),e.defaultValue&&e.defaultValue.length){var o=e.defaultValue;switch(o){case"true":case"TRUE":o=!0;break;case"false":case"FALSE":o=!1;break;default:m.exec(o)&&(o=parseInt(o))}a.setOption("default",o)}return w(e.type)&&("proto3"===r?e.options&&!e.options.packed&&a.setOption("packed",!1):e.options&&e.options.packed||a.setOption("packed",!1)),a},l.prototype.toDescriptor=function(e){var r=t.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)r.type=11,r.typeName=n.util.ucFirst(this.name),r.label=3;else{switch(r.type=T(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:r.typeName=this.resolvedType?_(this.parent,this.resolvedType):this.type}switch(this.rule){case"repeated":r.label=3;break;case"required":r.label=2;break;default:r.label=1}}if(r.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(r.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(r.options=C(this.options,t.FieldOptions),null!=this.options.default&&(r.defaultValue=String(this.options.default))),"proto3"===e?this.packed||((r.options||(r.options=t.FieldOptions.create())).packed=!1):this.packed&&((r.options||(r.options=t.FieldOptions.create())).packed=!0),r};var g=0;a.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.EnumDescriptorProto.decode(e));var r={};if(e.value)for(var n=0;n<e.value.length;++n){var i=e.value[n].name,s=e.value[n].number||0;r[i&&i.length?i:"NAME"+s]=s}return new a(e.name&&e.name.length?e.name:"Enum"+g++,r,E(e.options,t.EnumOptions))},a.prototype.toDescriptor=function(){for(var e=[],r=0,n=Object.keys(this.values);r<n.length;++r)e.push(t.EnumValueDescriptorProto.create({name:n[r],number:this.values[n[r]]}));return t.EnumDescriptorProto.create({name:this.name,value:e,options:C(this.options,t.EnumOptions)})};var y=0;u.fromDescriptor=function(e){return"number"==typeof e.length&&(e=t.OneofDescriptorProto.decode(e)),new u(e.name&&e.name.length?e.name:"oneof"+y++)},u.prototype.toDescriptor=function(){return t.OneofDescriptorProto.create({name:this.name})};var v=0;d.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.ServiceDescriptorProto.decode(e));var r=new d(e.name&&e.name.length?e.name:"Service"+v++,E(e.options,t.ServiceOptions));if(e.method)for(var n=0;n<e.method.length;++n)r.add(h.fromDescriptor(e.method[n]));return r},d.prototype.toDescriptor=function(){for(var e=[],r=0;r<this.methodsArray.length;++r)e.push(this._methodsArray[r].toDescriptor());return t.ServiceDescriptorProto.create({name:this.name,method:e,options:C(this.options,t.ServiceOptions)})};var b=0;function S(e){switch(e){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+e)}function w(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function T(e,t){switch(e){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(t instanceof a)return 14;if(t instanceof o)return t.group?10:11;throw Error("illegal type: "+e)}function E(e,t){if(e){for(var r,i,s,o=[],l=0;l<t.fieldsArray.length;++l)"uninterpretedOption"!==(i=(r=t._fieldsArray[l]).name)&&e.hasOwnProperty(i)&&(s=e[i],r.resolvedType instanceof a&&"number"==typeof s&&void 0!==r.resolvedType.valuesById[s]&&(s=r.resolvedType.valuesById[s]),o.push(I(i),s));return o.length?n.util.toObject(o):void 0}}function C(e,t){if(e){for(var r,i,s=[],a=0,o=Object.keys(e);a<o.length;++a)if(i=e[r=o[a]],"default"!==r){var l=t.fields[r];(l||(l=t.fields[r=n.util.camelCase(r)]))&&s.push(r,i)}return s.length?t.fromObject(n.util.toObject(s)):void 0}}function _(e,t){var r=e.fullName.split("."),n=t.fullName.split("."),a=0,o=0,l=n.length-1;if(!(e instanceof s)&&t instanceof i)for(;a<r.length&&o<l&&r[a]===n[o];){var c=t.lookup(r[a++],!0);if(null!==c&&c!==t)break;++o}else for(;a<r.length&&o<l&&r[a]===n[o];++a,++o);return n.slice(o).join(".")}function I(e){return e.substring(0,1)+e.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}h.fromDescriptor=function(e){return"number"==typeof e.length&&(e=t.MethodDescriptorProto.decode(e)),new h(e.name&&e.name.length?e.name:"Method"+b++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,E(e.options,t.MethodOptions))},h.prototype.toDescriptor=function(){return t.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:C(this.options,t.MethodOptions)})}},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1658:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{fillMetadataSegment:function(){return f},normalizeMetadataPageToRoute:function(){return m},normalizeMetadataRoute:function(){return p}});let n=r(8304),i=d(r(8671)),s=r(6341),a=r(4396),o=r(660),l=r(4722),c=r(2958),u=r(5499);function d(e){return e&&e.__esModule?e:{default:e}}function h(e){let t=i.default.dirname(e);if(e.endsWith("/sitemap"))return"";let r="";return t.split("/").some(e=>(0,u.isGroupSegment)(e)||(0,u.isParallelRouteSegment)(e))&&(r=(0,o.djb2Hash)(t).toString(36).slice(0,6)),r}function f(e,t,r){let n=(0,l.normalizeAppPath)(e),o=(0,a.getNamedRouteRegex)(n,{prefixRouteKeys:!1}),u=(0,s.interpolateDynamicPath)(n,t,o),{name:d,ext:f}=i.default.parse(r),p=h(i.default.posix.join(e,d)),m=p?`-${p}`:"";return(0,c.normalizePathSep)(i.default.join(u,`${d}${m}${f}`))}function p(e){if(!(0,n.isMetadataPage)(e))return e;let t=e,r="";if("/robots"===e?t+=".txt":"/manifest"===e?t+=".webmanifest":r=h(e),!t.endsWith("/route")){let{dir:e,name:n,ext:s}=i.default.parse(t);t=i.default.posix.join(e,`${n}${r?`-${r}`:""}${s}`,"route")}return t}function m(e,t){let r=e.endsWith("/route"),n=r?e.slice(0,-6):e,i=n.endsWith("/sitemap")?".xml":"";return(t?`${n}/[__metadata_id__]`:`${n}${i}`)+(r?"/route":"")}},1810:(e,t,r)=>{"use strict";var n=t,i=r(3107),s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var r=0,n={};for(t|=0;r<e.length;)n[s[r+t]]=e[r++];return n}n.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),n.long=a([0,0,0,1,1],7),n.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},1820:e=>{"use strict";e.exports=require("os")},1996:(e,t)=>{"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:(64512&r)==55296&&(64512&e.charCodeAt(n+1))==56320?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,s=[],a=0;t<r;)(n=e[t++])<128?s[a++]=n:n>191&&n<224?s[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[a++]=55296+(n>>10),s[a++]=56320+(1023&n)):s[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))},r.write=function(e,t,r){for(var n,i,s=r,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:((64512&n)==55296&&(64512&(i=e.charCodeAt(a+1)))==56320?(n=65536+((1023&n)<<10)+(1023&i),++a,t[r++]=n>>18|240,t[r++]=n>>12&63|128):t[r++]=n>>12|224,t[r++]=n>>6&63|128),t[r++]=63&n|128);return r-s}},2110:(e,t,r)=>{"use strict";e.exports=a;var n=r(4824);((a.prototype=Object.create(n.prototype)).constructor=a).className="Enum";var i=r(7968),s=r(3107);function a(e,t,r,i,s,a){if(n.call(this,e,r),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=s||{},this.valuesOptions=a,this.reserved=void 0,t)for(var o=Object.keys(t),l=0;l<o.length;++l)"number"==typeof t[o[l]]&&(this.valuesById[this.values[o[l]]=t[o[l]]]=o[l])}a.fromJSON=function(e,t){var r=new a(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,r,n){if(!s.isString(e))throw TypeError("name must be a string");if(!s.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return n&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=n||null),this.comments[e]=r||null,this},a.prototype.remove=function(e){if(!s.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},a.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},2309:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChildLoadBalancerHandler=void 0;let n=r(6239),i=r(8155),s="child_load_balancer_helper";class a{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(e){this.parent=e,this.child=null}createSubchannel(e,t){return this.parent.channelControlHelper.createSubchannel(e,t)}updateState(e,t){var r;if(this.calledByPendingChild()){if(e===i.ConnectivityState.CONNECTING)return;null==(r=this.parent.currentChild)||r.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(e,t)}requestReresolution(){var e;let t=null!=(e=this.parent.pendingChild)?e:this.parent.currentChild;this.child===t&&this.parent.channelControlHelper.requestReresolution()}setChild(e){this.child=e}addChannelzChild(e){this.parent.channelControlHelper.addChannelzChild(e)}removeChannelzChild(e){this.parent.channelControlHelper.removeChannelzChild(e)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,r){let i;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let e=new this.ChildPolicyHelper(this),r=(0,n.createLoadBalancer)(t,e);e.setChild(r),null===this.currentChild?(this.currentChild=r,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=r,i=this.pendingChild)}else i=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=t,i.updateAddressList(e,t,r)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return s}}t.ChildLoadBalancerHandler=a},2437:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getPathMatch",{enumerable:!0,get:function(){return i}});let n=r(5362);function i(e,t){let r=[],i=(0,n.pathToRegexp)(e,r,{delimiter:"/",sensitive:"boolean"==typeof(null==t?void 0:t.sensitive)&&t.sensitive,strict:null==t?void 0:t.strict}),s=(0,n.regexpToFunction)((null==t?void 0:t.regexModifier)?new RegExp(t.regexModifier(i.source),i.flags):i,r);return(e,n)=>{if("string"!=typeof e)return!1;let i=s(e);if(!i)return!1;if(null==t?void 0:t.removeUnnamedParams)for(let e of r)"number"==typeof e.name&&delete i.params[e.name];return{...n,...i.params}}}},2566:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},2630:(e,t,r)=>{"use strict";e.exports=a;var n=r(4824);((a.prototype=Object.create(n.prototype)).constructor=a).className="OneOf";var i=r(3267),s=r(3107);function a(e,t,r,i){if(Array.isArray(t)||(r=t,t=void 0),n.call(this,e,r),!(void 0===t||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function o(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,o(this),this},a.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){n.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}o(this)},a.prototype.onRemove=function(e){for(var t,r=0;r<this.fieldsArray.length;++r)(t=this.fieldsArray[r]).parent&&t.parent.remove(t);n.prototype.onRemove.call(this,e)},a.d=function(){for(var e=Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,r){s.decorateType(t.constructor).add(new a(r,e)),Object.defineProperty(t,r,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},2703:(e,t,r)=>{"use strict";e.exports=d;var n,i,s,a=r(7968);((d.prototype=Object.create(a.prototype)).constructor=d).className="Root";var o=r(3267),l=r(2110),c=r(2630),u=r(3107);function d(e){a.call(this,"",e),this.deferred=[],this.files=[]}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=u.path.resolve,d.prototype.fetch=u.fetch,d.prototype.load=function e(t,r,n){"function"==typeof r&&(n=r,r=void 0);var a=this;if(!n)return u.asPromise(e,a,t,r);var o=n===h;function l(e,t){if(n){if(o)throw e;var r=n;n=null,r(e,t)}}function c(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var r=e.substring(t);if(r in s)return r}return null}function d(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){i.filename=e;var n,s=i(t,a,r),d=0;if(s.imports)for(;d<s.imports.length;++d)(n=c(s.imports[d])||a.resolvePath(e,s.imports[d]))&&f(n);if(s.weakImports)for(d=0;d<s.weakImports.length;++d)(n=c(s.weakImports[d])||a.resolvePath(e,s.weakImports[d]))&&f(n,!0)}else a.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}o||p||l(null,a)}function f(e,t){if(e=c(e)||e,!(a.files.indexOf(e)>-1)){if(a.files.push(e),e in s)return void(o?d(e,s[e]):(++p,setTimeout(function(){--p,d(e,s[e])})));if(o){var r;try{r=u.fs.readFileSync(e).toString("utf8")}catch(e){t||l(e);return}d(e,r)}else++p,a.fetch(e,function(r,i){if(--p,n){if(r)return void(t?p||l(null,a):l(r));d(e,i)}})}}var p=0;u.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=a.resolvePath("",t[g]))&&f(m);if(o)return a;p||l(null,a)},d.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return a.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(e,t){var r=t.parent.lookup(t.extend);if(r){var n=new o(t.fullName,t.id,t.type,t.rule,void 0,t.options);return!!r.get(n.name)||(n.declaringField=t,t.extensionField=n,r.add(n),!0)}return!1}d.prototype._handleAdd=function(e){if(e instanceof o)void 0===e.extend||e.extensionField||p(this,e)||this.deferred.push(e);else if(e instanceof l)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof n)for(var t=0;t<this.deferred.length;)p(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);f.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof o){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof a){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);f.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,r){n=e,i=t,s=r}},2727:(e,t)=>{"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=Array(64),i=Array(123),s=0;s<64;)i[n[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function(e,t,r){for(var i,s=null,a=[],o=0,l=0;t<r;){var c=e[t++];switch(l){case 0:a[o++]=n[c>>2],i=(3&c)<<4,l=1;break;case 1:a[o++]=n[i|c>>4],i=(15&c)<<2,l=2;break;case 2:a[o++]=n[i|c>>6],a[o++]=n[63&c],l=0}o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0)}return(l&&(a[o++]=n[i],a[o++]=61,1===l&&(a[o++]=61)),s)?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};var a="invalid encoding";r.decode=function(e,t,r){for(var n,s=r,o=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&o>1)break;if(void 0===(c=i[c]))throw Error(a);switch(o){case 0:n=c,o=1;break;case 1:t[r++]=n<<2|(48&c)>>4,n=c,o=2;break;case 2:t[r++]=(15&n)<<4|(60&c)>>2,n=c,o=3;break;case 3:t[r++]=(3&n)<<6|c,o=0}}if(1===o)throw Error(a);return r-s},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},2785:(e,t)=>{"use strict";function r(e){let t={};for(let[r,n]of e.entries()){let e=t[r];void 0===e?t[r]=n:Array.isArray(e)?e.push(n):t[r]=[e,n]}return t}function n(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let t=new URLSearchParams;for(let[r,i]of Object.entries(e))if(Array.isArray(i))for(let e of i)t.append(r,n(e));else t.set(r,n(i));return t}function s(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(let t of r){for(let r of t.keys())e.delete(r);for(let[r,n]of t.entries())e.append(r,n)}return e}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{assign:function(){return s},searchParamsToUrlQuery:function(){return r},urlQueryToSearchParams:function(){return i}})},2823:(e,t,r)=>{"use strict";e.exports=o;var n=r(2110),i=r(1810),s=r(3107);function a(e){return"missing required '"+e.name+"'"}function o(e){var t=s.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter(function(e){return e.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var r=0;r<e.fieldsArray.length;++r){var o=e._fieldsArray[r].resolve(),l=o.resolvedType instanceof n?"int32":o.type,c="m"+s.safeProp(o.name);t("case %i: {",o.id),o.map?(t("if(%s===util.emptyObject)",c)("%s={}",c)("var c2 = r.uint32()+r.pos"),void 0!==i.defaults[o.keyType]?t("k=%j",i.defaults[o.keyType]):t("k=null"),void 0!==i.defaults[l]?t("value=%j",i.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",o.keyType)("case 2:"),void 0===i.basic[l]?t("value=types[%i].decode(r,r.uint32())",r):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),t(void 0!==i.long[o.keyType]?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",c)):o.repeated?(t("if(!(%s&&%s.length))",c,c)("%s=[]",c),void 0!==i.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",c,l)("}else"),void 0===i.basic[l]?t(o.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",c,r):t("%s.push(r.%s())",c,l)):void 0===i.basic[l]?t(o.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",c,r):t("%s=r.%s()",c,l),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<e._fieldsArray.length;++r){var u=e._fieldsArray[r];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",a(u))}return t("return m")}},2910:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.QueuePicker=t.UnavailablePicker=t.PickResultType=void 0;let i=r(6777),s=r(1271);!function(e){e[e.COMPLETE=0]="COMPLETE",e[e.QUEUE=1]="QUEUE",e[e.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",e[e.DROP=3]="DROP"}(n||(t.PickResultType=n={}));class a{constructor(e){this.status=Object.assign({code:s.Status.UNAVAILABLE,details:"No connection established",metadata:new i.Metadata},e)}pick(e){return{pickResultType:n.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}t.UnavailablePicker=a;class o{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:n.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}t.QueuePicker=o},2958:(e,t)=>{"use strict";function r(e){return e.replace(/\\/g,"/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizePathSep",{enumerable:!0,get:function(){return r}})},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3076:(e,t,r)=>{"use strict";e.exports=o;var n=r(7968);((o.prototype=Object.create(n.prototype)).constructor=o).className="Service";var i=r(1202),s=r(3107),a=r(7236);function o(e,t){n.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}o.fromJSON=function(e,t){var r=new o(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),s=0;s<n.length;++s)r.add(i.fromJSON(n[s],t.methods[n[s]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r},o.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&!!e.keepComments;return s.toObject(["options",t&&t.options||void 0,"methods",n.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},Object.defineProperty(o.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),o.prototype.get=function(e){return this.methods[e]||n.prototype.get.call(this,e)},o.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return n.prototype.resolve.call(this)},o.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,l(this)):n.prototype.add.call(this,e)},o.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return n.prototype.remove.call(this,e)},o.prototype.create=function(e,t,r){for(var n,i=new a.Service(e,t,r),o=0;o<this.methodsArray.length;++o){var l=s.lcFirst((n=this._methodsArray[o]).resolve().name).replace(/[^$\w_]/g,"");i[l]=s.codegen(["r","c"],s.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:n,q:n.resolvedRequestType.ctor,s:n.resolvedResponseType.ctor})}return i}},3107:(e,t,r)=>{"use strict";var n,i,s=e.exports=r(8707),a=r(6642);s.codegen=r(8344),s.fetch=r(7757),s.path=r(1140),s.fs=s.inquire("fs"),s.toArray=function(e){if(e){for(var t=Object.keys(e),r=Array(t.length),n=0;n<t.length;)r[n]=e[t[n++]];return r}return[]},s.toObject=function(e){for(var t={},r=0;r<e.length;){var n=e[r++],i=e[r++];void 0!==i&&(t[n]=i)}return t};var o=/\\/g,l=/"/g;s.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},s.safeProp=function(e){return!/^[$\w_]+$/.test(e)||s.isReserved(e)?'["'+e.replace(o,"\\\\").replace(l,'\\"')+'"]':"."+e},s.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;s.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(c,function(e,t){return t.toUpperCase()})},s.compareFieldsById=function(e,t){return e.id-t.id},s.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(s.decorateRoot.remove(e.$type),e.$type.name=t,s.decorateRoot.add(e.$type)),e.$type;n||(n=r(4351));var i=new n(t||e.name);return s.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var u=0;s.decorateEnum=function(e){if(e.$type)return e.$type;i||(i=r(2110));var t=new i("Enum"+u++,e);return s.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},s.setProperty=function(e,t,r){function n(e,t,r){var i=t.shift();if("__proto__"===i||"prototype"===i)return e;if(t.length>0)e[i]=n(e[i]||{},t,r);else{var s=e[i];s&&(r=[].concat(s).concat(r)),e[i]=r}return e}if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return n(e,t=t.split("."),r)},Object.defineProperty(s,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(r(2703)))}})},3127:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?!function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function s(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function o(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i,e.readFloatLE=n?a:o,e.readFloatBE=n?o:a}():!function(){function t(e,t,r,n){var i=+(t<0);if(i&&(t=-t),0===t)e(1/t>0?0:0x80000000,r,n);else if(isNaN(t))e(0x7fc00000,r,n);else if(t>34028234663852886e22)e((i<<31|0x7f800000)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var s=Math.floor(Math.log(t)/Math.LN2),a=8388607&Math.round(t*Math.pow(2,-s)*8388608);e((i<<31|s+127<<23|a)>>>0,r,n)}}function a(e,t,r){var n=e(t,r),i=(n>>31)*2+1,s=n>>>23&255,a=8388607&n;return 255===s?a?NaN:1/0*i:0===s?1401298464324817e-60*i*a:i*Math.pow(2,s-150)*(a+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=a.bind(null,i),e.readFloatBE=a.bind(null,s)}(),"undefined"!=typeof Float64Array?!function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function s(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function o(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i,e.readDoubleLE=n?a:o,e.readDoubleBE=n?o:a}():!function(){function t(e,t,r,n,i,s){var a,o=+(n<0);if(o&&(n=-n),0===n)e(0,i,s+t),e(1/n>0?0:0x80000000,i,s+r);else if(isNaN(n))e(0,i,s+t),e(0x7ff80000,i,s+r);else if(n>17976931348623157e292)e(0,i,s+t),e((o<<31|0x7ff00000)>>>0,i,s+r);else if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,i,s+t),e((o<<31|a/0x100000000)>>>0,i,s+r);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(0x10000000000000*(a=n*Math.pow(2,-l))>>>0,i,s+t),e((o<<31|l+1023<<20|1048576*a&1048575)>>>0,i,s+r)}}function a(e,t,r,n,i){var s=e(n,i+t),a=e(n,i+r),o=(a>>31)*2+1,l=a>>>20&2047,c=0x100000000*(1048575&a)+s;return 2047===l?c?NaN:1/0*o:0===l?5e-324*o*c:o*Math.pow(2,l-1075)*(c+0x10000000000000)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=a.bind(null,i,0,4),e.readDoubleBE=a.bind(null,s,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},3267:(e,t,r)=>{"use strict";e.exports=c;var n,i=r(4824);((c.prototype=Object.create(i.prototype)).constructor=c).className="Field";var s=r(2110),a=r(1810),o=r(3107),l=/^required|optional|repeated$/;function c(e,t,r,n,s,c,u){if(o.isObject(n)?(u=s,c=n,n=s=void 0):o.isObject(s)&&(u=c,c=s,s=void 0),i.call(this,e,c),!o.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!o.isString(r))throw TypeError("type must be a string");if(void 0!==n&&!l.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==s&&!o.isString(s))throw TypeError("extend must be a string");"proto3_optional"===n&&(n="optional"),this.rule=n&&"optional"!==n?n:void 0,this.type=r,this.id=t,this.extend=s||void 0,this.required="required"===n,this.optional=!this.required,this.repeated="repeated"===n,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!o.Long&&void 0!==a.long[r],this.bytes="bytes"===r,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}c.fromJSON=function(e,t){return new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(c.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),c.prototype.setOption=function(e,t,r){return"packed"===e&&(this._packed=null),i.prototype.setOption.call(this,e,t,r)},c.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return o.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof n?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof s&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof s)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=o.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;o.base64.test(this.typeDefault)?o.base64.decode(this.typeDefault,e=o.newBuffer(o.base64.length(this.typeDefault)),0):o.utf8.write(this.typeDefault,e=o.newBuffer(o.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=o.emptyObject:this.repeated?this.defaultValue=o.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof n&&(this.parent.ctor.prototype[this.name]=this.defaultValue),i.prototype.resolve.call(this)},c.d=function(e,t,r,n){return"function"==typeof t?t=o.decorateType(t).name:t&&"object"==typeof t&&(t=o.decorateEnum(t).name),function(i,s){o.decorateType(i.constructor).add(new c(s,e,t,r,{default:n}))}},c._configure=function(e){n=e}},3273:e=>{"use strict";e.exports=function e(e,t,r){var n=r||8192,i=n>>>1,s=null,a=n;return function(r){if(r<1||r>i)return e(r);a+r>n&&(s=e(n),a=0);var o=t.call(s,a,a+=r);return 7&a&&(a=(7|a)+1),o}}},3293:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"escapeStringRegexp",{enumerable:!0,get:function(){return i}});let r=/[|\\{}()[\]^$+*?.-]/,n=/[|\\{}()[\]^$+*?.-]/g;function i(e){return r.test(e)?e.replace(n,"\\$&"):e}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3356:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToSubchannelAddress=t.subchannelAddressToString=t.subchannelAddressEqual=t.isTcpSubchannelAddress=void 0;let n=r(1645);function i(e){return"port"in e}t.isTcpSubchannelAddress=i,t.subchannelAddressEqual=function(e,t){return!e&&!t||!!e&&!!t&&(i(e)?i(t)&&e.host===t.host&&e.port===t.port:!i(t)&&e.path===t.path)},t.subchannelAddressToString=function(e){return i(e)?e.host+":"+e.port:e.path};let s=443;t.stringToSubchannelAddress=function(e,t){return(0,n.isIP)(e)?{host:e,port:null!=t?t:s}:{path:e}}},3474:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2SubchannelCall=void 0;let n=r(3496),i=r(1820),s=r(1271),a=r(6777),o=r(1037),l=r(1359),c=r(1271),u="subchannel_call";function d(e){for(let[t,r]of Object.entries(i.constants.errno))if(r===e)return t;return"Unknown system error "+e}class h{constructor(e,t,r,i,l){var c;this.http2Stream=e,this.callEventTracker=t,this.listener=r,this.transport=i,this.callId=l,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=s.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let u=null!=(c=i.getOptions()["grpc.max_receive_message_length"])?c:s.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new o.StreamDecoder(u),e.on("response",(e,t)=>{let r="";for(let t of Object.keys(e))r+="		"+t+": "+e[t]+"\n";switch(this.trace("Received server headers:\n"+r),e[":status"]){case 400:this.mappedStatusCode=s.Status.INTERNAL;break;case 401:this.mappedStatusCode=s.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=s.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=s.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=s.Status.UNAVAILABLE;break;default:this.mappedStatusCode=s.Status.UNKNOWN}if(t&n.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(e);else{let t;try{t=a.Metadata.fromHttp2Headers(e)}catch(e){this.endCall({code:s.Status.UNKNOWN,details:e.message,metadata:new a.Metadata});return}this.listener.onReceiveMetadata(t)}}),e.on("trailers",e=>{this.handleTrailers(e)}),e.on("data",e=>{let t;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+e.length);try{t=this.decoder.write(e)}catch(e){this.cancelWithStatus(s.Status.RESOURCE_EXHAUSTED,e.message);return}for(let e of t)this.trace("parsed message of length "+e.length),this.callEventTracker.addMessageReceived(),this.tryPush(e)}}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var t;let r;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),(null==(t=this.finalStatus)?void 0:t.code)===s.Status.OK)return;let i="";switch(e.rstCode){case n.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;r=s.Status.INTERNAL,i=`Received RST_STREAM with code ${e.rstCode}`;break;case n.constants.NGHTTP2_REFUSED_STREAM:r=s.Status.UNAVAILABLE,i="Stream refused by server";break;case n.constants.NGHTTP2_CANCEL:r=s.Status.CANCELLED,i="Call cancelled";break;case n.constants.NGHTTP2_ENHANCE_YOUR_CALM:r=s.Status.RESOURCE_EXHAUSTED,i="Bandwidth exhausted or memory limit exceeded";break;case n.constants.NGHTTP2_INADEQUATE_SECURITY:r=s.Status.PERMISSION_DENIED,i="Protocol not secure enough";break;case n.constants.NGHTTP2_INTERNAL_ERROR:r=s.Status.INTERNAL,null===this.internalError?i=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(r=s.Status.UNAVAILABLE,i=this.internalError.message):i=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:r=s.Status.INTERNAL,i=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:r,details:i,metadata:new a.Metadata,rstCode:e.rstCode})})}),e.on("error",e=>{"ERR_HTTP2_STREAM_ERROR"!==e.code&&(this.trace("Node error event: message="+e.message+" code="+e.code+" errno="+d(e.errno)+" syscall="+e.syscall),this.internalError=e),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:s.Status.UNAVAILABLE,details:"Connection dropped",metadata:new a.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){l.trace(c.LogVerbosity.DEBUG,u,"["+this.callId+"] "+e)}endCall(e){(null===this.finalStatus||this.finalStatus.code===s.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===s.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){let t;this.callEventTracker.onStreamEnd(!0);let r="";for(let t of Object.keys(e))r+="		"+t+": "+e[t]+"\n";this.trace("Received server trailers:\n"+r);try{t=a.Metadata.fromHttp2Headers(e)}catch(e){t=new a.Metadata}let n=t.getMap(),i=this.mappedStatusCode;if(i===s.Status.UNKNOWN&&"string"==typeof n["grpc-status"]){let e=Number(n["grpc-status"]);e in s.Status&&(i=e,this.trace("received status code "+e+" from server")),t.remove("grpc-status")}let o="";if("string"==typeof n["grpc-message"]){try{o=decodeURI(n["grpc-message"])}catch(e){o=n["grpc-message"]}t.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let l={code:i,details:o,metadata:t};this.endCall(l)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;t=(null==(e=this.finalStatus)?void 0:e.code)===s.Status.OK?n.constants.NGHTTP2_NO_ERROR:n.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new a.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==s.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let r=t=>{process.nextTick(()=>{var r;let n=s.Status.UNAVAILABLE;(null==t?void 0:t.code)==="ERR_STREAM_WRITE_AFTER_END"&&(n=s.Status.INTERNAL),t&&this.cancelWithStatus(n,`Write error: ${t.message}`),null==(r=e.callback)||r.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,r)}catch(e){this.endCall({code:s.Status.UNAVAILABLE,details:`Write failed with error ${e.message}`,metadata:new a.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}t.Http2SubchannelCall=h},3496:e=>{"use strict";e.exports=require("http2")},3516:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompressionFilterFactory=t.CompressionFilter=void 0;let n=r(4075),i=r(8655),s=r(1271),a=r(962),o=r(1359),l=e=>"number"==typeof e&&"string"==typeof i.CompressionAlgorithms[e];class c{async writeMessage(e,t){let r=e;t&&(r=await this.compressMessage(r));let n=Buffer.allocUnsafe(r.length+5);return n.writeUInt8(+!!t,0),n.writeUInt32BE(r.length,1),r.copy(n,5),n}async readMessage(e){let t=1===e.readUInt8(0),r=e.slice(5);return t&&(r=await this.decompressMessage(r)),r}}class u extends c{async compressMessage(e){return e}async writeMessage(e,t){let r=Buffer.allocUnsafe(e.length+5);return r.writeUInt8(0,0),r.writeUInt32BE(e.length,1),e.copy(r,5),r}decompressMessage(e){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class d extends c{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{n.deflate(e,(e,n)=>{e?r(e):t(n)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,a=[],o=n.createInflate();o.on("data",e=>{a.push(e),i+=e.byteLength,-1!==this.maxRecvMessageLength&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:s.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(a))}),o.write(e),o.end()})}}class h extends c{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{n.gzip(e,(e,n)=>{e?r(e):t(n)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,a=[],o=n.createGunzip();o.on("data",e=>{a.push(e),i+=e.byteLength,-1!==this.maxRecvMessageLength&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:s.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(a))}),o.write(e),o.end()})}}class f extends c{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function p(e,t){switch(e){case"identity":return new u;case"deflate":return new d(t);case"gzip":return new h(t);default:return new f(e)}}class m extends a.BaseFilter{constructor(e,t){var r,n;super(),this.sharedFilterConfig=t,this.sendCompression=new u,this.receiveCompression=new u,this.currentCompressionAlgorithm="identity";let a=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!=(r=e["grpc.max_receive_message_length"])?r:s.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==a)if(l(a)){let e=i.CompressionAlgorithms[a],r=null==(n=t.serverSupportedEncodingHeader)?void 0:n.split(",");(!r||r.includes(e))&&(this.currentCompressionAlgorithm=e,this.sendCompression=p(this.currentCompressionAlgorithm,-1))}else o.log(s.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${a}`)}async sendMetadata(e){let t=await e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let e=t[0];"string"==typeof e&&(this.receiveCompression=p(e,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let r=e.get("grpc-accept-encoding")[0];return r&&(this.sharedFilterConfig.serverSupportedEncodingHeader=r,r.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new u,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var t;let r,n=await e;return r=!(this.sendCompression instanceof u)&&((null!=(t=n.flags)?t:0)&2)==0,{message:await this.sendCompression.writeMessage(n.message,r),flags:n.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}}t.CompressionFilter=m;class g{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new m(this.options,this.sharedFilterConfig)}}t.CompressionFilterFactory=g},3689:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelCredentials=void 0;let n=r(4631),i=r(9772),s=r(9227);function a(e,t){if(e&&!(e instanceof Buffer))throw TypeError(`${t}, if provided, must be a Buffer.`)}class o{constructor(e){this.callCredentials=e||i.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,i){var o;if(a(e,"Root certificate"),a(t,"Private key"),a(r,"Certificate chain"),t&&!r)throw Error("Private key must be given with accompanying certificate chain");if(!t&&r)throw Error("Certificate chain must be given with accompanying private key");return new c((0,n.createSecureContext)({ca:null!=(o=null!=e?e:(0,s.getDefaultRootsData)())?o:void 0,key:null!=t?t:void 0,cert:null!=r?r:void 0,ciphers:s.CIPHER_SUITES}),null!=i?i:{})}static createFromSecureContext(e,t){return new c(e,null!=t?t:{})}static createInsecure(){return new l}}t.ChannelCredentials=o;class l extends o{constructor(e){super(e)}compose(e){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof l}}class c extends o{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},(null==t?void 0:t.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){return new u(this,this.callCredentials.compose(e))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e||e instanceof c&&this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity}}class u extends o{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new u(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e||e instanceof u&&this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials)}}},3695:(e,t,r)=>{"use strict";var n=t,i=r(8920);n[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),r=this.lookup(t);if(r){var n="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return -1===n.indexOf("/")&&(n="/"+n),this.create({type_url:n,value:r.encode(r.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var r="type.googleapis.com/",n="",s="";if(t&&t.json&&e.type_url&&e.value){s=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var a=this.lookup(s);a&&(e=a.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var o=e.$type.toObject(e,t),l="."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName;return""===n&&(n=r),s=n+l,o["@type"]=s,o}return this.toObject(e,t)}}},3712:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInterceptingCall=t.InterceptingCall=t.RequesterBuilder=t.ListenerBuilder=t.InterceptorConfigurationError=void 0;let n=r(6777),i=r(70),s=r(1271),a=r(776);class o extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,o)}}t.InterceptorConfigurationError=o;class l{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}t.ListenerBuilder=l;class c{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}t.RequesterBuilder=c;let u={onReceiveMetadata:(e,t)=>{t(e)},onReceiveMessage:(e,t)=>{t(e)},onReceiveStatus:(e,t)=>{t(e)}},d={start:(e,t,r)=>{r(e,t)},sendMessage:(e,t)=>{t(e)},halfClose:e=>{e()},cancel:e=>{e()}};class h{constructor(e,t){var r,n,i,s;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:null!=(r=t.start)?r:d.start,sendMessage:null!=(n=t.sendMessage)?n:d.sendMessage,halfClose:null!=(i=t.halfClose)?i:d.halfClose,cancel:null!=(s=t.cancel)?s:d.cancel}:this.requester=d}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var r,n,s,a,o,l;let c={onReceiveMetadata:null!=(n=null==(r=null==t?void 0:t.onReceiveMetadata)?void 0:r.bind(t))?n:e=>{},onReceiveMessage:null!=(a=null==(s=null==t?void 0:t.onReceiveMessage)?void 0:s.bind(t))?a:e=>{},onReceiveStatus:null!=(l=null==(o=null==t?void 0:t.onReceiveStatus)?void 0:o.bind(t))?l:e=>{}};this.processingMetadata=!0,this.requester.start(e,c,(e,t)=>{var r,n,s;let a;if(this.processingMetadata=!1,(0,i.isInterceptingListener)(t))a=t;else{let e={onReceiveMetadata:null!=(r=t.onReceiveMetadata)?r:u.onReceiveMetadata,onReceiveMessage:null!=(n=t.onReceiveMessage)?n:u.onReceiveMessage,onReceiveStatus:null!=(s=t.onReceiveStatus)?s:u.onReceiveStatus};a=new i.InterceptingListenerImpl(e,c)}this.nextCall.start(e,a),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,r),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function f(e,t,r){var n,i;let s=null!=(n=r.deadline)?n:1/0,a=r.host,o=null!=(i=r.parent)?i:null,l=r.propagate_flags,c=r.credentials,u=e.createCall(t,s,a,o,l);return c&&u.setCredentials(c),u}t.InterceptingCall=h;class p{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let r;try{r=this.methodDefinition.requestSerialize(t)}catch(e){this.call.cancelWithStatus(s.Status.INTERNAL,`Request message serialization failure: ${(0,a.getErrorMessage)(e)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let r=null;this.call.start(e,{onReceiveMetadata:e=>{var r;null==(r=null==t?void 0:t.onReceiveMetadata)||r.call(t,e)},onReceiveMessage:e=>{var i;let o;try{o=this.methodDefinition.responseDeserialize(e)}catch(e){r={code:s.Status.INTERNAL,details:`Response message parsing error: ${(0,a.getErrorMessage)(e)}`,metadata:new n.Metadata},this.call.cancelWithStatus(r.code,r.details);return}null==(i=null==t?void 0:t.onReceiveMessage)||i.call(t,o)},onReceiveStatus:e=>{var n,i;r?null==(n=null==t?void 0:t.onReceiveStatus)||n.call(t,r):null==(i=null==t?void 0:t.onReceiveStatus)||i.call(t,e)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class m extends p{constructor(e,t){super(e,t)}start(e,t){var r,n;let i=!1,s={onReceiveMetadata:null!=(n=null==(r=null==t?void 0:t.onReceiveMetadata)?void 0:r.bind(t))?n:e=>{},onReceiveMessage:e=>{var r;i=!0,null==(r=null==t?void 0:t.onReceiveMessage)||r.call(t,e)},onReceiveStatus:e=>{var r,n;i||null==(r=null==t?void 0:t.onReceiveMessage)||r.call(t,null),null==(n=null==t?void 0:t.onReceiveStatus)||n.call(t,e)}};super.start(e,s),this.call.startRead()}}class g extends p{}function y(e,t,r){let n=f(e,r.path,t);return r.responseStream?new g(n,r):new m(n,r)}t.getInterceptingCall=function(e,t,r,n){if(e.clientInterceptors.length>0&&e.clientInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(e.callInterceptors.length>0&&e.callInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];i=e.callInterceptors.length>0||e.callInterceptorProviders.length>0?[].concat(e.callInterceptors,e.callInterceptorProviders.map(e=>e(t))).filter(e=>e):[].concat(e.clientInterceptors,e.clientInterceptorProviders.map(e=>e(t))).filter(e=>e);let s=Object.assign({},r,{method_definition:t});return i.reduceRight((e,t)=>r=>t(r,e),e=>y(n,e,t))(s)}},3736:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseRelativeUrl",{enumerable:!0,get:function(){return i}}),r(4827);let n=r(2785);function i(e,t,r){void 0===r&&(r=!0);let i=new URL("http://n"),s=t?new URL(t,i):e.startsWith(".")?new URL("http://n"):i,{pathname:a,searchParams:o,search:l,hash:c,href:u,origin:d}=new URL(e,s);if(d!==i.origin)throw Object.defineProperty(Error("invariant: invalid relative URL, router received "+e),"__NEXT_ERROR_CODE",{value:"E159",enumerable:!1,configurable:!0});return{pathname:a,query:r?(0,n.searchParamsToUrlQuery)(o):void 0,search:l,hash:c,href:u.slice(d.length)}}},3873:e=>{"use strict";e.exports=require("path")},3911:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restrictControlPlaneStatusCode=void 0;let n=r(1271),i=[n.Status.OK,n.Status.INVALID_ARGUMENT,n.Status.NOT_FOUND,n.Status.ALREADY_EXISTS,n.Status.FAILED_PRECONDITION,n.Status.ABORTED,n.Status.OUT_OF_RANGE,n.Status.DATA_LOSS];t.restrictControlPlaneStatusCode=function(e,t){return i.includes(e)?{code:n.Status.INTERNAL,details:`Invalid status from control plane: ${e} ${n.Status[e]} ${t}`}:{code:e,details:t}}},4003:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterStackFactory=t.FilterStack=void 0;class r{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMessage(t);return t}receiveMessage(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}}t.FilterStack=r;class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new r(this.factories.map(e=>e.createFilter()))}}t.FilterStackFactory=n},4075:e=>{"use strict";e.exports=require("zlib")},4168:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientDuplexStreamImpl=t.ClientWritableStreamImpl=t.ClientReadableStreamImpl=t.ClientUnaryCallImpl=t.callErrorFromStatus=void 0;let n=r(4735),i=r(7910),s=r(1271);t.callErrorFromStatus=function(e,t){let r=`${e.code} ${s.Status[e.code]}: ${e.details}`,n=Error(r),i=`${n.stack}
for call at
${t}`;return Object.assign(Error(r),e,{stack:i})};class a extends n.EventEmitter{constructor(){super()}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}}t.ClientUnaryCallImpl=a;class o extends i.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}_read(e){var t;null==(t=this.call)||t.startRead()}}t.ClientReadableStreamImpl=o;class l extends i.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}_write(e,t,r){var n;let i={callback:r},s=Number(t);Number.isNaN(s)||(i.flags=s),null==(n=this.call)||n.sendMessageWithContext(i,e)}_final(e){var t;null==(t=this.call)||t.halfClose(),e()}}t.ClientWritableStreamImpl=l;class c extends i.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}_read(e){var t;null==(t=this.call)||t.startRead()}_write(e,t,r){var n;let i={callback:r},s=Number(t);Number.isNaN(s)||(i.flags=s),null==(n=this.call)||n.sendMessageWithContext(i,e)}_final(e){var t;null==(t=this.call)||t.halfClose(),e()}}t.ClientDuplexStreamImpl=c},4227:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Server=void 0;let n=r(3496),i=r(1271),s=r(7492),a=r(9420),o=r(5674),l=r(1359),c=r(3356),u=r(6786),d=r(6827),h=0x7fffffff,f=0x7fffffff,p=2e4,{HTTP2_HEADER_PATH:m}=n.constants,g="server";function y(){}function v(e){return{code:i.Status.UNIMPLEMENTED,details:`The server does not implement the method ${e}`}}function b(e,t){let r=v(t);switch(e){case"unary":return(e,t)=>{t(r,null)};case"clientStream":return(e,t)=>{t(r,null)};case"serverStream":return e=>{e.emit("error",r)};case"bidi":return e=>{e.emit("error",r)};default:throw Error(`Invalid handlerType ${e}`)}}class S{constructor(e){var t,r,n,i;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new d.ChannelzTrace,this.callTracker=new d.ChannelzCallTracker,this.listenerChildrenTracker=new d.ChannelzChildrenTracker,this.sessionChildrenTracker=new d.ChannelzChildrenTracker,this.options=null!=e?e:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,d.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!=(t=this.options["grpc.max_connection_age_ms"])?t:h,this.maxConnectionAgeGraceMs=null!=(r=this.options["grpc.max_connection_age_grace_ms"])?r:h,this.keepaliveTimeMs=null!=(n=this.options["grpc.keepalive_time_ms"])?n:f,this.keepaliveTimeoutMs=null!=(i=this.options["grpc.keepalive_timeout_ms"])?i:p,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,r,n;let i,s=this.sessions.get(e),a=e.socket,o=a.remoteAddress?(0,c.stringToSubchannelAddress)(a.remoteAddress,a.remotePort):null,l=a.localAddress?(0,c.stringToSubchannelAddress)(a.localAddress,a.localPort):null;if(e.encrypted){let e=a,r=e.getCipher(),n=e.getCertificate(),s=e.getPeerCertificate();i={cipherSuiteStandardName:null!=(t=r.standardName)?t:null,cipherSuiteOtherName:r.standardName?null:r.name,localCertificate:n&&"raw"in n?n.raw:null,remoteCertificate:s&&"raw"in s?s.raw:null}}else i=null;return{remoteAddress:o,localAddress:l,security:i,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(r=e.state.localWindowSize)?r:null,remoteFlowControlWindow:null!=(n=e.state.remoteWindowSize)?n:null}}}trace(e){l.trace(i.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+e)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(e,t){if(null===e||"object"!=typeof e||null===t||"object"!=typeof t)throw Error("addService() requires two objects as arguments");let r=Object.keys(e);if(0===r.length)throw Error("Cannot add an empty service to a server");r.forEach(r=>{let n,i,s=e[r];n=s.requestStream?s.responseStream?"bidi":"clientStream":s.responseStream?"serverStream":"unary";let a=t[r];if(void 0===a&&"string"==typeof s.originalName&&(a=t[s.originalName]),i=void 0!==a?a.bind(t):b(n,r),!1===this.register(s.path,i,s.responseSerialize,s.requestDeserialize,n))throw Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(null===e||"object"!=typeof e)throw Error("removeService() requires object as argument");Object.keys(e).forEach(t=>{let r=e[t];this.unregister(r.path)})}bind(e,t){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,r){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof e)throw TypeError("port must be a string");if(null===t||!(t instanceof a.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof r)throw TypeError("callback must be a function");let s=(0,u.parseUri)(e);if(null===s)throw Error(`Could not parse port "${e}"`);let h=(0,o.mapUriDefaultScheme)(s);if(null===h)throw Error(`Could not get a default scheme for port "${e}"`);let f={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?f.maxSessionMemory=this.options["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(f.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let p=(e,t)=>{process.nextTick(()=>r(e,t))},m=()=>{let e;if(t._isSecure()){let r=Object.assign(f,t._getSettings());r.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(e=n.createSecureServer(r)).on("secureConnection",e=>{e.on("error",e=>{this.trace("An incoming TLS connection closed with error: "+e.message)})})}else e=n.createServer(f);return e.setTimeout(0,y),this._setupHandlers(e),e},g=(e,t,r)=>0===e.length?Promise.resolve({port:t,count:r}):Promise.all(e.map(e=>{let r;this.trace("Attempting to bind "+(0,c.subchannelAddressToString)(e)),r=(0,c.isTcpSubchannelAddress)(e)?{host:e.host,port:t}:e;let n=m();return new Promise((i,s)=>{let a=t=>{this.trace("Failed to bind "+(0,c.subchannelAddressToString)(e)+" with error "+t.message),i(t)};n.once("error",a),n.listen(r,()=>{let e;if(this.shutdown){n.close(),i(Error("bindAsync failed because server is shutdown"));return}let r=n.address();e="string"==typeof r?{path:r}:{host:r.address,port:r.port};let s=(0,d.registerChannelzSocket)((0,c.subchannelAddressToString)(e),()=>({localAddress:e,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(s),this.http2ServerList.push({server:n,channelzRef:s}),this.trace("Successfully bound "+(0,c.subchannelAddressToString)(e)),i("port"in e?e.port:t),n.removeListener("error",a)})})})).then(e=>{let n=0;for(let r of e)if("number"==typeof r&&(n+=1,r!==t))throw Error("Invalid state: multiple port numbers added from single address");return{port:t,count:n+r}}),v=e=>{if(0===e.length)return Promise.resolve({port:0,count:0});let t=e[0],r=m();return new Promise((n,i)=>{let s=r=>{this.trace("Failed to bind "+(0,c.subchannelAddressToString)(t)+" with error "+r.message),n(v(e.slice(1)))};r.once("error",s),r.listen(t,()=>{if(this.shutdown){r.close(),n({port:0,count:0});return}let t=r.address(),i={host:t.address,port:t.port},a=(0,d.registerChannelzSocket)((0,c.subchannelAddressToString)(i),()=>({localAddress:i,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(a),this.http2ServerList.push({server:r,channelzRef:a}),this.trace("Successfully bound "+(0,c.subchannelAddressToString)(i)),n(g(e.slice(1),t.port,1)),r.removeListener("error",s)})})},b={onSuccessfulResolution:(t,r,n)=>{let s;if(b.onSuccessfulResolution=()=>{},this.shutdown&&p(Error("bindAsync failed because server is shutdown"),0),0===t.length)return void p(Error(`No addresses resolved for port ${e}`),0);(s=(0,c.isTcpSubchannelAddress)(t[0])?0===t[0].port?v(t):g(t,t[0].port,0):g(t,1,0)).then(e=>{if(0===e.count){let e=`No address added out of total ${t.length} resolved`;l.log(i.LogVerbosity.ERROR,e),p(Error(e),0)}else e.count<t.length&&l.log(i.LogVerbosity.INFO,`WARNING Only ${e.count} addresses added out of total ${t.length} resolved`),p(null,e.port)},e=>{let r=`No address added out of total ${t.length} resolved`;l.log(i.LogVerbosity.ERROR,r),p(Error(r),0)})},onError:e=>{p(Error(e.details),0)}};(0,o.createResolver)(h,b,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,d.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(n.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,d.unregisterChannelzRef)(this.channelzRef)}register(e,t,r,n,i){return!this.handlers.has(e)&&(this.handlers.set(e,{func:t,serialize:r,deserialize:n,type:i,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:e})=>!0!==e.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=t=>{this.channelzEnabled&&(0,d.unregisterChannelzRef)(this.channelzRef),e(t)},r=0;function n(){0==--r&&t()}for(let{server:e,channelzRef:t}of(this.started=!1,this.shutdown=!0,this.http2ServerList))e.listening&&(r++,e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,d.unregisterChannelzRef)(t)),n()}));this.sessions.forEach((e,t)=>{t.closed||(r+=1,t.close(n))}),0===r&&t()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let r=t[n.constants.HTTP2_HEADER_CONTENT_TYPE];return"string"==typeof r&&!!r.startsWith("application/grpc")||(e.respond({[n.constants.HTTP2_HEADER_STATUS]:n.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return void 0===t?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,r=null){let n=new s.Http2ServerCallStream(t,null,this.options);void 0===e.code&&(e.code=i.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==r||r.streamTracker.addCallFailed()),n.sendError(e)}_channelzHandler(e,t){let r=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),null==r||r.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),null==r||r.streamTracker.addCallFailed();return}let n=t[m],a=this._retrieveHandler(n);if(!a)return void this._respondWithError(v(n),e,r);let o=new s.Http2ServerCallStream(e,a,this.options);o.once("callEnd",e=>{e===i.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),r&&(o.once("streamEnd",e=>{e?r.streamTracker.addCallSucceeded():r.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{r.messagesSent+=1,r.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{r.messagesReceived+=1,r.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,a,t)||(this.callTracker.addCallFailed(),null==r||r.streamTracker.addCallFailed(),o.sendError({code:i.Status.INTERNAL,details:`Unknown handler type: ${a.type}`}))}_streamHandler(e,t){if(!0!==this._verifyContentType(e,t))return;let r=t[m],n=this._retrieveHandler(r);if(!n)return void this._respondWithError(v(r),e,null);let a=new s.Http2ServerCallStream(e,n,this.options);this._runHandlerForCall(a,n,t)||a.sendError({code:i.Status.INTERNAL,details:`Unknown handler type: ${n.type}`})}_runHandlerForCall(e,t,r){var n;let i=e.receiveMetadata(r),s=null!=(n=i.get("grpc-encoding")[0])?n:"identity";i.remove("grpc-encoding");let{type:a}=t;if("unary"===a)w(e,t,i,s);else if("clientStream"===a)T(e,t,i,s);else if("serverStream"===a)E(e,t,i,s);else{if("bidi"!==a)return!1;C(e,t,i,s)}return!0}_setupHandlers(e){if(null===e)return;let t=e.address(),r="null";t&&(r="string"==typeof t?t:t.address+":"+t.port),this.serverAddressString=r;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",e=>{var t,r,i,s,a;if(!this.started)return void e.destroy();let o=(0,d.registerChannelzSocket)(null!=(t=e.socket.remoteAddress)?t:"unknown",this.getChannelzSessionInfoGetter(e),this.channelzEnabled),l={ref:o,streamTracker:new d.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(e,l);let c=e.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+c),this.sessionChildrenTracker.refChild(o));let u=null,f=null,p=!1;if(this.maxConnectionAgeMs!==h){let t=this.maxConnectionAgeMs/10,s=Math.random()*t*2-t;u=null==(i=(r=setTimeout(()=>{var t,r;p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+c);try{e.goaway(n.constants.NGHTTP2_NO_ERROR,0x7fffffff,Buffer.from("max_age"))}catch(t){e.destroy();return}e.close(),this.maxConnectionAgeGraceMs!==h&&(f=null==(r=(t=setTimeout(()=>{e.destroy()},this.maxConnectionAgeGraceMs)).unref)?void 0:r.call(t))},this.maxConnectionAgeMs+s)).unref)?void 0:i.call(r)}let m=null==(a=(s=setInterval(()=>{var t,r;let n=null==(r=(t=setTimeout(()=>{p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+c),e.close()},this.keepaliveTimeoutMs)).unref)?void 0:r.call(t);try{e.ping((e,t,r)=>{clearTimeout(n)})}catch(t){e.destroy()}},this.keepaliveTimeMs)).unref)?void 0:a.call(s);e.on("close",()=>{this.channelzEnabled&&(p||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+c),this.sessionChildrenTracker.unrefChild(o),(0,d.unregisterChannelzRef)(o)),u&&clearTimeout(u),f&&clearTimeout(f),m&&clearTimeout(m),this.sessions.delete(e)})})}}async function w(e,t,r,n){try{let i=await e.receiveUnaryMessage(n);if(void 0===i||e.cancelled)return;let a=new s.ServerUnaryCallImpl(e,r,i);t.func(a,(t,r,n,i)=>{e.sendUnaryMessage(t,r,n,i)})}catch(t){e.sendError(t)}}function T(e,t,r,n){let i=new s.ServerReadableStreamImpl(e,r,t.deserialize,n);function a(t,r,n,s){i.destroy(),e.sendUnaryMessage(t,r,n,s)}e.cancelled||(i.on("error",a),t.func(i,a))}async function E(e,t,r,n){try{let i=await e.receiveUnaryMessage(n);if(void 0===i||e.cancelled)return;let a=new s.ServerWritableStreamImpl(e,r,t.serialize,i);t.func(a)}catch(t){e.sendError(t)}}function C(e,t,r,n){let i=new s.ServerDuplexStreamImpl(e,r,t.serialize,t.deserialize,n);e.cancelled||t.func(i)}t.Server=S},4346:e=>{"use strict";e.exports=n;var t,r=/\/|\./;function n(e,t){r.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),n[e]=t}n("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),n("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),n("timestamp",{Timestamp:t}),n("empty",{Empty:{fields:{}}}),n("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),n("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),n("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),n.get=function(e){return n[e]||null}},4351:(e,t,r)=>{"use strict";e.exports=v;var n=r(7968);((v.prototype=Object.create(n.prototype)).constructor=v).className="Type";var i=r(2110),s=r(2630),a=r(3267),o=r(5585),l=r(3076),c=r(8920),u=r(6996),d=r(6120),h=r(3107),f=r(847),p=r(2823),m=r(6973),g=r(7659),y=r(3695);function v(e,t){n.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var r=this.fields[e[t]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof c||((e.prototype=new c).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,c,!0),this._ctor=e;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:h.oneOfGetter(this._oneofsArray[r].oneof),set:h.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(e.prototype,n)}}}),v.generateConstructor=function(e){for(var t,r=h.codegen(["p"],e.name),n=0;n<e.fieldsArray.length;++n)(t=e._fieldsArray[n]).map?r("this%s={}",h.safeProp(t.name)):t.repeated&&r("this%s=[]",h.safeProp(t.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},v.fromJSON=function(e,t){var r=new v(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var c=Object.keys(t.fields),u=0;u<c.length;++u)r.add((void 0!==t.fields[c[u]].keyType?o.fromJSON:a.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)r.add(s.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var d=t.nested[c[u]];r.add((void 0!==d.id?a.fromJSON:void 0!==d.fields?v.fromJSON:void 0!==d.values?i.fromJSON:void 0!==d.methods?l.fromJSON:n.fromJSON)(c[u],d))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r},v.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&!!e.keepComments;return h.toObject(["options",t&&t.options||void 0,"oneofs",n.arrayToJSON(this.oneofsArray,e),"fields",n.arrayToJSON(this.fieldsArray.filter(function(e){return!e.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},v.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var r=this.oneofsArray;for(t=0;t<r.length;)r[t++].resolve();return n.prototype.resolveAll.call(this)},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):n.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return n.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=f(this)({Writer:d,types:t,util:h}),this.decode=p(this)({Reader:u,types:t,util:h}),this.verify=m(this)({types:t,util:h}),this.fromObject=g.fromObject(this)({types:t,util:h}),this.toObject=g.toObject(this)({types:t,util:h});var n=y[e];if(n){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(i),i.toObject=this.toObject,this.toObject=n.toObject.bind(i)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){h.decorateType(t,e)}}},4353:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Subchannel=void 0;let n=r(8155),i=r(268),s=r(1359),a=r(1271),o=r(6786),l=r(3356),c=r(6827),u="subchannel",d=0x7fffffff;class h{constructor(e,t,r,s,a){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=r,this.credentials=s,this.connector=a,this.connectivityState=n.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new c.ChannelzCallTracker,this.childrenTracker=new c.ChannelzChildrenTracker,this.streamTracker=new c.ChannelzCallTracker;let u={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new i.BackoffTimeout(()=>{this.handleBackoffTimer()},u),this.backoffTimeout.unref(),this.subchannelAddressString=(0,l.subchannelAddressToString)(t),this.keepaliveTime=null!=(o=r["grpc.keepalive_time_ms"])?o:-1,0===r["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new c.ChannelzTrace,this.channelzRef=(0,c.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(r,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){s.trace(a.LogVerbosity.DEBUG,u,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){s.trace(a.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([n.ConnectivityState.TRANSIENT_FAILURE],n.ConnectivityState.CONNECTING):this.transitionToState([n.ConnectivityState.TRANSIENT_FAILURE],n.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,d);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(e=>{this.transitionToState([n.ConnectivityState.CONNECTING],n.ConnectivityState.READY)?(this.transport=e,this.channelzEnabled&&this.childrenTracker.refChild(e.getChannelzRef()),e.addDisconnectListener(e=>{this.transitionToState([n.ConnectivityState.READY],n.ConnectivityState.IDLE),e&&this.keepaliveTime>0&&(this.keepaliveTime*=2,s.log(a.LogVerbosity.ERROR,`Connection to ${(0,o.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):e.shutdown()},e=>{this.transitionToState([n.ConnectivityState.CONNECTING],n.ConnectivityState.TRANSIENT_FAILURE,`${e}`)})}transitionToState(e,t,r){var i,s;if(-1===e.indexOf(this.connectivityState))return!1;this.trace(n.ConnectivityState[this.connectivityState]+" -> "+n.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+n.ConnectivityState[t]);let a=this.connectivityState;switch(this.connectivityState=t,t){case n.ConnectivityState.READY:this.stopBackoff();break;case n.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case n.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(i=this.transport)||i.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case n.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(s=this.transport)||s.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let e of this.stateListeners)e(this,a,t,this.keepaliveTime,r);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,c.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([n.ConnectivityState.CONNECTING,n.ConnectivityState.READY],n.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(e,t,r,n){let i;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),i={onCallEnd:e=>{e.code===a.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):i={},this.transport.createCall(e,t,r,n,i)}startConnecting(){process.nextTick(()=>{this.transitionToState([n.ConnectivityState.IDLE],n.ConnectivityState.CONNECTING)||this.connectivityState!==n.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([n.ConnectivityState.TRANSIENT_FAILURE],n.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}}t.Subchannel=h},4369:(e,t,r)=>{"use strict";e.exports=s;var n=r(6120);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(8707);function s(){n.call(this)}function a(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}s._configure=function(){s.alloc=i._Buffer_allocUnsafe,s.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},s.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},s._configure()},4396:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getNamedMiddlewareRegex:function(){return g},getNamedRouteRegex:function(){return m},getRouteRegex:function(){return d},parseParameter:function(){return l}});let n=r(6143),i=r(1437),s=r(3293),a=r(2887),o=/^([^[]*)\[((?:\[[^\]]*\])|[^\]]+)\](.*)$/;function l(e){let t=e.match(o);return t?c(t[2]):c(e)}function c(e){let t=e.startsWith("[")&&e.endsWith("]");t&&(e=e.slice(1,-1));let r=e.startsWith("...");return r&&(e=e.slice(3)),{key:e,repeat:r,optional:t}}function u(e,t,r){let n={},l=1,u=[];for(let d of(0,a.removeTrailingSlash)(e).slice(1).split("/")){let e=i.INTERCEPTION_ROUTE_MARKERS.find(e=>d.startsWith(e)),a=d.match(o);if(e&&a&&a[2]){let{key:t,optional:r,repeat:i}=c(a[2]);n[t]={pos:l++,repeat:i,optional:r},u.push("/"+(0,s.escapeStringRegexp)(e)+"([^/]+?)")}else if(a&&a[2]){let{key:e,repeat:t,optional:i}=c(a[2]);n[e]={pos:l++,repeat:t,optional:i},r&&a[1]&&u.push("/"+(0,s.escapeStringRegexp)(a[1]));let o=t?i?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)";r&&a[1]&&(o=o.substring(1)),u.push(o)}else u.push("/"+(0,s.escapeStringRegexp)(d));t&&a&&a[3]&&u.push((0,s.escapeStringRegexp)(a[3]))}return{parameterizedRoute:u.join(""),groups:n}}function d(e,t){let{includeSuffix:r=!1,includePrefix:n=!1,excludeOptionalTrailingSlash:i=!1}=void 0===t?{}:t,{parameterizedRoute:s,groups:a}=u(e,r,n),o=s;return i||(o+="(?:/)?"),{re:RegExp("^"+o+"$"),groups:a}}function h(){let e=0;return()=>{let t="",r=++e;for(;r>0;)t+=String.fromCharCode(97+(r-1)%26),r=Math.floor((r-1)/26);return t}}function f(e){let t,{interceptionMarker:r,getSafeRouteKey:n,segment:i,routeKeys:a,keyPrefix:o,backreferenceDuplicateKeys:l}=e,{key:u,optional:d,repeat:h}=c(i),f=u.replace(/\W/g,"");o&&(f=""+o+f);let p=!1;(0===f.length||f.length>30)&&(p=!0),isNaN(parseInt(f.slice(0,1)))||(p=!0),p&&(f=n());let m=f in a;o?a[f]=""+o+u:a[f]=u;let g=r?(0,s.escapeStringRegexp)(r):"";return t=m&&l?"\\k<"+f+">":h?"(?<"+f+">.+?)":"(?<"+f+">[^/]+?)",d?"(?:/"+g+t+")?":"/"+g+t}function p(e,t,r,l,c){let u=h(),d={},p=[];for(let h of(0,a.removeTrailingSlash)(e).slice(1).split("/")){let e=i.INTERCEPTION_ROUTE_MARKERS.some(e=>h.startsWith(e)),a=h.match(o);if(e&&a&&a[2])p.push(f({getSafeRouteKey:u,interceptionMarker:a[1],segment:a[2],routeKeys:d,keyPrefix:t?n.NEXT_INTERCEPTION_MARKER_PREFIX:void 0,backreferenceDuplicateKeys:c}));else if(a&&a[2]){l&&a[1]&&p.push("/"+(0,s.escapeStringRegexp)(a[1]));let e=f({getSafeRouteKey:u,segment:a[2],routeKeys:d,keyPrefix:t?n.NEXT_QUERY_PARAM_PREFIX:void 0,backreferenceDuplicateKeys:c});l&&a[1]&&(e=e.substring(1)),p.push(e)}else p.push("/"+(0,s.escapeStringRegexp)(h));r&&a&&a[3]&&p.push((0,s.escapeStringRegexp)(a[3]))}return{namedParameterizedRoute:p.join(""),routeKeys:d}}function m(e,t){var r,n,i;let s=p(e,t.prefixRouteKeys,null!=(r=t.includeSuffix)&&r,null!=(n=t.includePrefix)&&n,null!=(i=t.backreferenceDuplicateKeys)&&i),a=s.namedParameterizedRoute;return t.excludeOptionalTrailingSlash||(a+="(?:/)?"),{...d(e,t),namedRegex:"^"+a+"$",routeKeys:s.routeKeys}}function g(e,t){let{parameterizedRoute:r}=u(e,!1,!1),{catchAll:n=!0}=t;if("/"===r)return{namedRegex:"^/"+(n?".*":"")+"$"};let{namedParameterizedRoute:i}=p(e,!1,!1,!1,!1);return{namedRegex:"^"+i+(n?"(?:(/.*)?)":"")+"$"}}},4431:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u,metadata:()=>c});var n=r(7413),i=r(2202),s=r.n(i),a=r(4988),o=r.n(a);r(1135);var l=r(9737);let c={title:"AccountViewer",description:"View your accounts progressively."};function u({children:e}){return(0,n.jsx)("html",{lang:"en",suppressHydrationWarning:!0,children:(0,n.jsxs)("body",{className:`${s().variable} ${o().variable} antialiased`,suppressHydrationWarning:!0,children:[e,(0,n.jsx)(l.Toaster,{})]})})}},4442:(e,t,r)=>{Promise.resolve().then(r.bind(r,7369))},4461:(e,t,r)=>{Promise.resolve().then(r.bind(r,9737))},4553:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},4631:e=>{"use strict";e.exports=require("tls")},4660:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.DEFAULT_PORT=void 0;let n=r(5674),i=r(7366),s=r(8354),a=r(504),o=r(1271),l=r(6777),c=r(1359),u=r(1271),d=r(6786),h=r(1645),f=r(268),p="dns_resolver";function m(e){c.trace(u.LogVerbosity.DEBUG,p,e)}t.DEFAULT_PORT=443;let g=3e4,y=s.promisify(i.resolveTxt),v=s.promisify(i.lookup);function b(...e){let t=[];for(let r=0;r<Math.max.apply(null,e.map(e=>e.length));r++)for(let n of e)r<n.length&&t.push(n[r]);return t}class S{constructor(e,r,n){var i,s,a;this.target=e,this.listener=r,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,m("Resolver constructed for target "+(0,d.uriToString)(e));let c=(0,d.splitHostPort)(e.path);null===c?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,h.isIPv4)(c.host)||(0,h.isIPv6)(c.host)?(this.ipResult=[{host:c.host,port:null!=(i=c.port)?i:t.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=c.host,this.port=null!=(s=c.port)?s:t.DEFAULT_PORT),this.percentage=100*Math.random(),1===n["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:o.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,d.uriToString)(this.target)}`,metadata:new l.Metadata};let u={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoff=new f.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},u),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!=(a=n["grpc.dns_min_time_between_resolutions_ms"])?a:g,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(m("Returning IP address for target "+(0,d.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)m("Failed to parse DNS address "+(0,d.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:o.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,d.uriToString)(this.target)}`,metadata:new l.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;m("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=v(e,{all:!0}),this.pendingLookupPromise.then(e=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let t=e.filter(e=>4===e.family),r=e.filter(e=>6===e.family);this.latestLookupResult=b(r,t).map(e=>({host:e.address,port:+this.port}));let n="["+this.latestLookupResult.map(e=>e.host+":"+e.port).join(",")+"]";if(m("Resolved addresses for target "+(0,d.uriToString)(this.target)+": "+n),0===this.latestLookupResult.length)return void this.listener.onError(this.defaultResolutionError);this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},e=>{null!==this.pendingLookupPromise&&(m("Resolution error for target "+(0,d.uriToString)(this.target)+": "+e.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=y(e),this.pendingTxtPromise.then(e=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,a.extractAndSelectServiceConfig)(e,this.percentage)}catch(e){this.latestServiceConfigError={code:o.Status.UNAVAILABLE,details:`Parsing service config failed with error ${e.message}`,metadata:new l.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},e=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null==(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?m('resolution update delayed by "min time between resolutions" rate limit'):m("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}}t.setup=function(){(0,n.registerResolver)("dns",S),(0,n.registerDefaultScheme)("dns")}},4719:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseSubchannelWrapper=void 0;class r{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}}t.BaseSubchannelWrapper=r},4722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{normalizeAppPath:function(){return s},normalizeRscURL:function(){return a}});let n=r(5531),i=r(5499);function s(e){return(0,n.ensureLeadingSlash)(e.split("/").reduce((e,t,r,n)=>!t||(0,i.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&r===n.length-1?e:e+"/"+t,""))}function a(e){return e.replace(/\.rsc($|\?)/,"$1")}},4735:e=>{"use strict";e.exports=require("events")},4780:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var n=r(9384),i=r(2348);function s(...e){return(0,i.QP)((0,n.$)(e))}},4824:(e,t,r)=>{"use strict";e.exports=s,s.className="ReflectionObject";var n,i=r(3107);function s(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(s.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),s.prototype.toJSON=function(){throw Error()},s.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof n&&t._handleAdd(this)},s.prototype.onRemove=function(e){var t=e.root;t instanceof n&&t._handleRemove(this),this.parent=null,this.resolved=!1},s.prototype.resolve=function(){return this.resolved||this.root instanceof n&&(this.resolved=!0),this},s.prototype.getOption=function(e){if(this.options)return this.options[e]},s.prototype.setOption=function(e,t,r){return r&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},s.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(r){var s=n.find(function(t){return Object.prototype.hasOwnProperty.call(t,e)});if(s){var a=s[e];i.setProperty(a,r,t)}else(s={})[e]=i.setProperty({},r,t),n.push(s)}else{var o={};o[e]=t,n.push(o)}return this},s.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)this.setOption(r[n],e[r[n]],t);return this},s.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},s._configure=function(e){n=e}},4827:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DecodeError:function(){return p},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return y},NormalizeError:function(){return m},PageNotFoundError:function(){return g},SP:function(){return h},ST:function(){return f},WEB_VITALS:function(){return r},execOnce:function(){return n},getDisplayName:function(){return l},getLocationOrigin:function(){return a},getURL:function(){return o},isAbsoluteUrl:function(){return s},isResSent:function(){return c},loadGetInitialProps:function(){return d},normalizeRepeatedSlashes:function(){return u},stringifyError:function(){return b}});let r=["CLS","FCP","FID","INP","LCP","TTFB"];function n(e){let t,r=!1;return function(){for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];return r||(r=!0,t=e(...i)),t}}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,s=e=>i.test(e);function a(){let{protocol:e,hostname:t,port:r}=window.location;return e+"//"+t+(r?":"+r:"")}function o(){let{href:e}=window.location,t=a();return e.substring(t.length)}function l(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function c(e){return e.finished||e.headersSent}function u(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?"+t.slice(1).join("?"):"")}async function d(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await d(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&c(r))return n;if(!n)throw Object.defineProperty(Error('"'+l(e)+'.getInitialProps()" should resolve to an object. But found "'+n+'" instead.'),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let h="undefined"!=typeof performance,f=h&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class p extends Error{}class m extends Error{}class g extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class y extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: "+e+" "+t}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function b(e){return JSON.stringify({message:e.message,stack:e.stack})}},4947:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>y});var n=r(687),i=r(9867),s=r(3210),a=r(5084),o=r(4224),l=r(8726),c=r(4780);let u=a.Kq,d=s.forwardRef(({className:e,...t},r)=>(0,n.jsx)(a.LM,{ref:r,className:(0,c.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));d.displayName=a.LM.displayName;let h=(0,o.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),f=s.forwardRef(({className:e,variant:t,...r},i)=>(0,n.jsx)(a.bL,{ref:i,className:(0,c.cn)(h({variant:t}),e),...r}));f.displayName=a.bL.displayName,s.forwardRef(({className:e,...t},r)=>(0,n.jsx)(a.rc,{ref:r,className:(0,c.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t})).displayName=a.rc.displayName;let p=s.forwardRef(({className:e,...t},r)=>(0,n.jsx)(a.bm,{ref:r,className:(0,c.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:(0,n.jsx)(l.A,{className:"h-4 w-4"})}));p.displayName=a.bm.displayName;let m=s.forwardRef(({className:e,...t},r)=>(0,n.jsx)(a.hE,{ref:r,className:(0,c.cn)("text-sm font-semibold",e),...t}));m.displayName=a.hE.displayName;let g=s.forwardRef(({className:e,...t},r)=>(0,n.jsx)(a.VY,{ref:r,className:(0,c.cn)("text-sm opacity-90",e),...t}));function y(){let{toasts:e}=(0,i.dj)();return(0,n.jsxs)(u,{children:[e.map(function({id:e,title:t,description:r,action:i,...s}){return(0,n.jsxs)(f,{...s,children:[(0,n.jsxs)("div",{className:"grid gap-1",children:[t&&(0,n.jsx)(m,{children:t}),r&&(0,n.jsx)(g,{children:r})]}),i,(0,n.jsx)(p,{})]},e)}),(0,n.jsx)(d,{})]})}g.displayName=a.VY.displayName},5058:(e,t,r)=>{Promise.resolve().then(r.bind(r,1204))},5108:e=>{"use strict";e.exports=function e(e,t){for(var r=Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(i,a){r[n]=function(e){if(s)if(s=!1,e)a(e);else{for(var t=Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){s&&(s=!1,a(e))}})}},5362:e=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var t={};(()=>{var e=t;function r(e){for(var t=[],r=0;r<e.length;){var n=e[r];if("*"===n||"+"===n||"?"===n){t.push({type:"MODIFIER",index:r,value:e[r++]});continue}if("\\"===n){t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});continue}if("{"===n){t.push({type:"OPEN",index:r,value:e[r++]});continue}if("}"===n){t.push({type:"CLOSE",index:r,value:e[r++]});continue}if(":"===n){for(var i="",s=r+1;s<e.length;){var a=e.charCodeAt(s);if(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||95===a){i+=e[s++];continue}break}if(!i)throw TypeError("Missing parameter name at "+r);t.push({type:"NAME",index:r,value:i}),r=s;continue}if("("===n){var o=1,l="",s=r+1;if("?"===e[s])throw TypeError('Pattern cannot start with "?" at '+s);for(;s<e.length;){if("\\"===e[s]){l+=e[s++]+e[s++];continue}if(")"===e[s]){if(0==--o){s++;break}}else if("("===e[s]&&(o++,"?"!==e[s+1]))throw TypeError("Capturing groups are not allowed at "+s);l+=e[s++]}if(o)throw TypeError("Unbalanced pattern at "+r);if(!l)throw TypeError("Missing pattern at "+r);t.push({type:"PATTERN",index:r,value:l}),r=s;continue}t.push({type:"CHAR",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}function n(e,t){void 0===t&&(t={});for(var n=r(e),i=t.prefixes,s=void 0===i?"./":i,o="[^"+a(t.delimiter||"/#?")+"]+?",l=[],c=0,u=0,d="",h=function(e){if(u<n.length&&n[u].type===e)return n[u++].value},f=function(e){var t=h(e);if(void 0!==t)return t;var r=n[u];throw TypeError("Unexpected "+r.type+" at "+r.index+", expected "+e)},p=function(){for(var e,t="";e=h("CHAR")||h("ESCAPED_CHAR");)t+=e;return t};u<n.length;){var m=h("CHAR"),g=h("NAME"),y=h("PATTERN");if(g||y){var v=m||"";-1===s.indexOf(v)&&(d+=v,v=""),d&&(l.push(d),d=""),l.push({name:g||c++,prefix:v,suffix:"",pattern:y||o,modifier:h("MODIFIER")||""});continue}var b=m||h("ESCAPED_CHAR");if(b){d+=b;continue}if(d&&(l.push(d),d=""),h("OPEN")){var v=p(),S=h("NAME")||"",w=h("PATTERN")||"",T=p();f("CLOSE"),l.push({name:S||(w?c++:""),pattern:S&&!w?o:w,prefix:v,suffix:T,modifier:h("MODIFIER")||""});continue}f("END")}return l}function i(e,t){void 0===t&&(t={});var r=o(t),n=t.encode,i=void 0===n?function(e){return e}:n,s=t.validate,a=void 0===s||s,l=e.map(function(e){if("object"==typeof e)return RegExp("^(?:"+e.pattern+")$",r)});return function(t){for(var r="",n=0;n<e.length;n++){var s=e[n];if("string"==typeof s){r+=s;continue}var o=t?t[s.name]:void 0,c="?"===s.modifier||"*"===s.modifier,u="*"===s.modifier||"+"===s.modifier;if(Array.isArray(o)){if(!u)throw TypeError('Expected "'+s.name+'" to not repeat, but got an array');if(0===o.length){if(c)continue;throw TypeError('Expected "'+s.name+'" to not be empty')}for(var d=0;d<o.length;d++){var h=i(o[d],s);if(a&&!l[n].test(h))throw TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but got "'+h+'"');r+=s.prefix+h+s.suffix}continue}if("string"==typeof o||"number"==typeof o){var h=i(String(o),s);if(a&&!l[n].test(h))throw TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but got "'+h+'"');r+=s.prefix+h+s.suffix;continue}if(!c){var f=u?"an array":"a string";throw TypeError('Expected "'+s.name+'" to be '+f)}}return r}}function s(e,t,r){void 0===r&&(r={});var n=r.decode,i=void 0===n?function(e){return e}:n;return function(r){var n=e.exec(r);if(!n)return!1;for(var s=n[0],a=n.index,o=Object.create(null),l=function(e){if(void 0===n[e])return"continue";var r=t[e-1];"*"===r.modifier||"+"===r.modifier?o[r.name]=n[e].split(r.prefix+r.suffix).map(function(e){return i(e,r)}):o[r.name]=i(n[e],r)},c=1;c<n.length;c++)l(c);return{path:s,index:a,params:o}}}function a(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function o(e){return e&&e.sensitive?"":"i"}function l(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:"",suffix:"",modifier:"",pattern:""});return e}function c(e,t,r){return RegExp("(?:"+e.map(function(e){return h(e,t,r).source}).join("|")+")",o(r))}function u(e,t,r){return d(n(e,r),t,r)}function d(e,t,r){void 0===r&&(r={});for(var n=r.strict,i=void 0!==n&&n,s=r.start,l=void 0===s||s,c=r.end,u=void 0===c||c,d=r.encode,h=void 0===d?function(e){return e}:d,f="["+a(r.endsWith||"")+"]|$",p="["+a(r.delimiter||"/#?")+"]",m=l?"^":"",g=0,y=e;g<y.length;g++){var v=y[g];if("string"==typeof v)m+=a(h(v));else{var b=a(h(v.prefix)),S=a(h(v.suffix));if(v.pattern)if(t&&t.push(v),b||S)if("+"===v.modifier||"*"===v.modifier){var w="*"===v.modifier?"?":"";m+="(?:"+b+"((?:"+v.pattern+")(?:"+S+b+"(?:"+v.pattern+"))*)"+S+")"+w}else m+="(?:"+b+"("+v.pattern+")"+S+")"+v.modifier;else m+="("+v.pattern+")"+v.modifier;else m+="(?:"+b+S+")"+v.modifier}}if(u)i||(m+=p+"?"),m+=r.endsWith?"(?="+f+")":"$";else{var T=e[e.length-1],E="string"==typeof T?p.indexOf(T[T.length-1])>-1:void 0===T;i||(m+="(?:"+p+"(?="+f+"))?"),E||(m+="(?="+p+"|"+f+")")}return new RegExp(m,o(r))}function h(e,t,r){return e instanceof RegExp?l(e,t):Array.isArray(e)?c(e,t,r):u(e,t,r)}Object.defineProperty(e,"__esModule",{value:!0}),e.parse=n,e.compile=function(e,t){return i(n(e,t),t)},e.tokensToFunction=i,e.match=function(e,t){var r=[];return s(h(e,r,t),r,t)},e.regexpToFunction=s,e.tokensToRegexp=d,e.pathToRegexp=h})(),e.exports=t})()},5477:(e,t,r)=>{"use strict";var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(6120),n.BufferWriter=r(4369),n.Reader=r(6996),n.BufferReader=r(5677),n.util=r(8707),n.rpc=r(7236),n.roots=r(6642),n.configure=i,i()},5481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;let n=r(5674);class i{constructor(e,t,r){let n;this.listener=t,this.addresses=[],this.hasReturnedResult=!1,n=""===e.authority?"/"+e.path:e.path,this.addresses=[{path:n}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}}t.setup=function(){(0,n.registerResolver)("unix",i)}},5526:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{compileNonPath:function(){return h},matchHas:function(){return d},parseDestination:function(){return f},prepareDestination:function(){return p}});let n=r(5362),i=r(3293),s=r(6759),a=r(1437),o=r(8212);function l(e){let t="";for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);(n>64&&n<91||n>96&&n<123)&&(t+=e[r])}return t}function c(e,t){return e.replace(RegExp(":"+(0,i.escapeStringRegexp)(t),"g"),"__ESC_COLON_"+t)}function u(e){return e.replace(/__ESC_COLON_/gi,":")}function d(e,t,r,n){void 0===r&&(r=[]),void 0===n&&(n=[]);let i={},s=r=>{let n,s=r.key;switch(r.type){case"header":s=s.toLowerCase(),n=e.headers[s];break;case"cookie":n="cookies"in e?e.cookies[r.key]:(0,o.getCookieParser)(e.headers)()[r.key];break;case"query":n=t[s];break;case"host":{let{host:t}=(null==e?void 0:e.headers)||{};n=null==t?void 0:t.split(":",1)[0].toLowerCase()}}if(!r.value&&n)return i[l(s)]=n,!0;if(n){let e=RegExp("^"+r.value+"$"),t=Array.isArray(n)?n.slice(-1)[0].match(e):n.match(e);if(t)return Array.isArray(t)&&(t.groups?Object.keys(t.groups).forEach(e=>{i[e]=t.groups[e]}):"host"===r.type&&t[0]&&(i.host=t[0])),!0}return!1};return!(!r.every(e=>s(e))||n.some(e=>s(e)))&&i}function h(e,t){if(!e.includes(":"))return e;for(let r of Object.keys(t))e.includes(":"+r)&&(e=e.replace(RegExp(":"+r+"\\*","g"),":"+r+"--ESCAPED_PARAM_ASTERISKS").replace(RegExp(":"+r+"\\?","g"),":"+r+"--ESCAPED_PARAM_QUESTION").replace(RegExp(":"+r+"\\+","g"),":"+r+"--ESCAPED_PARAM_PLUS").replace(RegExp(":"+r+"(?!\\w)","g"),"--ESCAPED_PARAM_COLON"+r));return e=e.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,n.compile)("/"+e,{validate:!1})(t).slice(1)}function f(e){let t=e.destination;for(let r of Object.keys({...e.params,...e.query}))r&&(t=c(t,r));let r=(0,s.parseUrl)(t),n=r.pathname;n&&(n=u(n));let i=r.href;i&&(i=u(i));let a=r.hostname;a&&(a=u(a));let o=r.hash;return o&&(o=u(o)),{...r,pathname:n,hostname:a,href:i,hash:o}}function p(e){let t,r,i=Object.assign({},e.query),s=f(e),{hostname:o,query:l}=s,c=s.pathname;s.hash&&(c=""+c+s.hash);let d=[],p=[];for(let e of((0,n.pathToRegexp)(c,p),p))d.push(e.name);if(o){let e=[];for(let t of((0,n.pathToRegexp)(o,e),e))d.push(t.name)}let m=(0,n.compile)(c,{validate:!1});for(let[r,i]of(o&&(t=(0,n.compile)(o,{validate:!1})),Object.entries(l)))Array.isArray(i)?l[r]=i.map(t=>h(u(t),e.params)):"string"==typeof i&&(l[r]=h(u(i),e.params));let g=Object.keys(e.params).filter(e=>"nextInternalLocale"!==e);if(e.appendParamsToQuery&&!g.some(e=>d.includes(e)))for(let t of g)t in l||(l[t]=e.params[t]);if((0,a.isInterceptionRouteAppPath)(c))for(let t of c.split("/")){let r=a.INTERCEPTION_ROUTE_MARKERS.find(e=>t.startsWith(e));if(r){"(..)(..)"===r?(e.params["0"]="(..)",e.params["1"]="(..)"):e.params["0"]=r;break}}try{let[n,i]=(r=m(e.params)).split("#",2);t&&(s.hostname=t(e.params)),s.pathname=n,s.hash=(i?"#":"")+(i||""),delete s.search}catch(e){if(e.message.match(/Expected .*? to not repeat, but got an array/))throw Object.defineProperty(Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match"),"__NEXT_ERROR_CODE",{value:"E329",enumerable:!1,configurable:!0});throw e}return s.query={...i,...s.query},{newUrl:r,destQuery:l,parsedDestination:s}}},5531:(e,t)=>{"use strict";function r(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureLeadingSlash",{enumerable:!0,get:function(){return r}})},5585:(e,t,r)=>{"use strict";e.exports=a;var n=r(3267);((a.prototype=Object.create(n.prototype)).constructor=a).className="MapField";var i=r(1810),s=r(3107);function a(e,t,r,i,a,o){if(n.call(this,e,t,i,void 0,void 0,a,o),!s.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},a.d=function(e,t,r){return"function"==typeof r?r=s.decorateType(r).name:r&&"object"==typeof r&&(r=s.decorateEnum(r).name),function(n,i){s.decorateType(n.constructor).add(new a(i,e,t,r))}}},5674:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapUriDefaultScheme=t.getDefaultAuthority=t.createResolver=t.registerDefaultScheme=t.registerResolver=void 0;let n=r(6786),i={},s=null;t.registerResolver=function(e,t){i[e]=t},t.registerDefaultScheme=function(e){s=e},t.createResolver=function(e,t,r){if(void 0!==e.scheme&&e.scheme in i)return new i[e.scheme](e,t,r);throw Error(`No resolver could be created for target ${(0,n.uriToString)(e)}`)},t.getDefaultAuthority=function(e){if(void 0!==e.scheme&&e.scheme in i)return i[e.scheme].getDefaultAuthority(e);throw Error(`Invalid target ${(0,n.uriToString)(e)}`)},t.mapUriDefaultScheme=function(e){if(void 0===e.scheme||!(e.scheme in i))if(null!==s)return{scheme:s,authority:void 0,path:(0,n.uriToString)(e)};else return null;return e}},5677:(e,t,r)=>{"use strict";e.exports=s;var n=r(6996);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(8707);function s(e){n.call(this,e)}s._configure=function(){i.Buffer&&(s.prototype._slice=i.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},6061:(e,t)=>{var r,n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}function i(e){var t=Math.clz32(e&-e);return e?31-t:t}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var s={},a={};function o(e,t){var r,n,i;if(t)return(e>>>=0,(i=0<=e&&e<256)&&(n=a[e]))?n:(r=c(e,0,!0),i&&(a[e]=r),r);return(e|=0,(i=-128<=e&&e<128)&&(n=s[e]))?n:(r=c(e,e<0?-1:0,!1),i&&(s[e]=r),r)}function l(e,t){if(isNaN(e))return t?v:y;if(t){if(e<0)return v;if(e>=p)return E}else{if(e<=-m)return C;if(e+1>=m)return T}return e<0?l(-e,t).neg():c(e%f|0,e/f|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=o,r.fromNumber=l,r.fromBits=c;var u=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?v:y;if((r=r||10)<2||36<r)throw RangeError("radix");if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return d(e.substring(1),t,r).neg();for(var n,i=l(u(r,8)),s=y,a=0;a<e.length;a+=8){var o=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+o),r);if(o<8){var h=l(u(r,o));s=s.mul(h).add(l(c))}else s=(s=s.mul(i)).add(l(c))}return s.unsigned=t,s}function h(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?d(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=h;var f=0x100000000,p=0xffffffffffffffff,m=0x8000000000000000,g=o(0x1000000),y=o(0);r.ZERO=y;var v=o(0,!0);r.UZERO=v;var b=o(1);r.ONE=b;var S=o(1,!0);r.UONE=S;var w=o(-1);r.NEG_ONE=w;var T=c(-1,0x7fffffff,!1);r.MAX_VALUE=T;var E=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=E;var C=c(0,-0x80000000,!1);r.MIN_VALUE=C;var _=r.prototype;return _.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},_.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(C))return"-"+this.neg().toString(e);else{var t=l(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}for(var i=l(u(e,6),this.unsigned),s=this,a="";;){var o=s.div(i),c=(s.sub(o.mul(i)).toInt()>>>0).toString(e);if((s=o).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},_.isSafeInteger=function(){var e=this.high>>21;return!e||!this.unsigned&&-1===e&&(0!==this.low||-2097152!==this.high)},_.isZero=function(){return 0===this.high&&0===this.low},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return(1&this.low)==1},_.isEven=function(){return(1&this.low)==0},_.equals=function(e){return n(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},_.eq=_.equals,_.notEquals=function(e){return!this.eq(e)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(e){return 0>this.comp(e)},_.lt=_.lessThan,_.lessThanOrEqual=function(e){return 0>=this.comp(e)},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(e){return this.comp(e)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(e){return this.comp(e)>=0},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(e){if(n(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(b)},_.neg=_.negate,_.add=function(e){n(e)||(e=h(e));var t,r,i=this.high>>>16,s=65535&this.high,a=this.low>>>16,o=65535&this.low,l=e.high>>>16,u=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,m=0;return t=0+((r=0+(o+f))>>>16),r&=65535,t+=a+d,m+=t>>>16,t&=65535,m+=s+u,p+=m>>>16,m&=65535,p+=i+l,c(t<<16|r,(p&=65535)<<16|m,this.unsigned)},_.subtract=function(e){return n(e)||(e=h(e)),this.add(e.neg())},_.sub=_.subtract,_.multiply=function(e){if(this.isZero())return this;if(n(e)||(e=h(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?v:y;if(this.eq(C))return e.isOdd()?C:y;if(e.eq(C))return this.isOdd()?C:y;if(this.isNegative())if(e.isNegative())return this.neg().mul(e.neg());else return this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return l(this.toNumber()*e.toNumber(),this.unsigned);var r,i,s=this.high>>>16,a=65535&this.high,o=this.low>>>16,u=65535&this.low,d=e.high>>>16,f=65535&e.high,p=e.low>>>16,m=65535&e.low,b=0,S=0;return r=0+((i=0+u*m)>>>16),i&=65535,r+=o*m,S+=r>>>16,r&=65535,r+=u*p,S+=r>>>16,r&=65535,S+=a*m,b+=S>>>16,S&=65535,S+=o*p,b+=S>>>16,S&=65535,S+=u*f,b+=S>>>16,S&=65535,b+=s*m+a*p+o*f+u*d,c(r<<16|i,(b&=65535)<<16|S,this.unsigned)},_.mul=_.multiply,_.divide=function(e){if(n(e)||(e=h(e)),e.isZero())throw Error("division by zero");if(t){var r,i,s;return this.unsigned||-0x80000000!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?v:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return S;s=v}else{if(this.eq(C))if(e.eq(b)||e.eq(w))return C;else return e.eq(C)?b:(r=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?b:w:(i=this.sub(e.mul(r)),s=r.add(i.div(e)));if(e.eq(C))return this.unsigned?v:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=y}for(i=this;i.gte(e);){for(var a=Math.ceil(Math.log(r=Math.max(1,Math.floor(i.toNumber()/e.toNumber())))/Math.LN2),o=a<=48?1:u(2,a-48),d=l(r),f=d.mul(e);f.isNegative()||f.gt(i);)r-=o,f=(d=l(r,this.unsigned)).mul(e);d.isZero()&&(d=b),s=s.add(d),i=i.sub(f)}return s},_.div=_.divide,_.modulo=function(e){return(n(e)||(e=h(e)),t)?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return c(~this.low,~this.high,this.unsigned)},_.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},_.clz=_.countLeadingZeros,_.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},_.ctz=_.countTrailingZeros,_.and=function(e){return n(e)||(e=h(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},_.or=function(e){return n(e)||(e=h(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},_.xor=function(e){return n(e)||(e=h(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},_.shiftLeft=function(e){return(n(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(e){return(n(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(e){return(n(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):32===e?c(this.high,0,this.unsigned):c(this.high>>>e-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.rotateLeft=function(e){var t;return(n(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?c(this.high,this.low,this.unsigned):e<32?(t=32-e,c(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,c(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},_.rotl=_.rotateLeft,_.rotateRight=function(e){var t;return(n(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?c(this.high,this.low,this.unsigned):e<32?(t=32-e,c(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,c(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},_.rotr=_.rotateRight,_.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},_.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},_.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},"function"==typeof BigInt&&(r.fromBigInt=function(e,t){return c(Number(BigInt.asIntN(32,e)),Number(BigInt.asIntN(32,e>>BigInt(32))),t)},r.fromValue=function(e,t){return"bigint"==typeof e?fromBigInt(e,t):h(e,t)},_.toBigInt=function(){var e=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|e}),e.default=r,"default"in e?e.default:e}({});void 0===(r=(function(){return n}).apply(t,[]))||(e.exports=r)},6120:(e,t,r)=>{"use strict";e.exports=d;var n,i=r(8707),s=i.LongBits,a=i.base64,o=i.utf8;function l(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var h=function(){return i.Buffer?function(){return(d.create=function(){return new n})()}:function(){return new d}};function f(e,t,r){t[r]=255&e}function p(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}function m(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function y(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}d.create=h(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,r){return this.tail=this.tail.next=new l(e,t,r),this.len+=t,this},m.prototype=Object.create(l.prototype),m.prototype.fn=p,d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new m((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(g,10,s.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=s.from(e);return this._push(g,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(g,t.length(),t)},d.prototype.bool=function(e){return this._push(f,1,+!!e)},d.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=s.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var v=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var r=d.alloc(t=a.length(e));a.decode(e,r,0),e=r}return this.uint32(t)._push(v,t,e)},d.prototype.string=function(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(f,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){n=e,d.create=h(),n._configure()}},6138:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},6142:(e,t,r)=>{"use strict";g={value:!0},g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=g=t.ex=g=g=g=g=g=g=t.OS=t.z3=void 0;let n=r(9772);g={enumerable:!0,get:function(){return n.CallCredentials}};let i=r(8453);g={enumerable:!0,get:function(){return i.ChannelImplementation}};let s=r(8655);g={enumerable:!0,get:function(){return s.CompressionAlgorithms}};let a=r(8155);g={enumerable:!0,get:function(){return a.ConnectivityState}};let o=r(3689);g={enumerable:!0,get:function(){return o.ChannelCredentials}};let l=r(7775);g={enumerable:!0,get:function(){return l.Client}};let c=r(1271);g={enumerable:!0,get:function(){return c.LogVerbosity}},g={enumerable:!0,get:function(){return c.Status}},g={enumerable:!0,get:function(){return c.Propagate}};let u=r(1359),d=r(1480);Object.defineProperty(t,"ex",{enumerable:!0,get:function(){return d.loadPackageDefinition}}),g={enumerable:!0,get:function(){return d.makeClientConstructor}},g={enumerable:!0,get:function(){return d.makeClientConstructor}};let h=r(6777);Object.defineProperty(t,"OS",{enumerable:!0,get:function(){return h.Metadata}});let f=r(4227);g={enumerable:!0,get:function(){return f.Server}};let p=r(9420);g={enumerable:!0,get:function(){return p.ServerCredentials}};let m=r(788);g={enumerable:!0,get:function(){return m.StatusBuilder}},t.z3={combineChannelCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e),combineCallCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e),createInsecure:o.ChannelCredentials.createInsecure,createSsl:o.ChannelCredentials.createSsl,createFromSecureContext:o.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:n.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:n.CallCredentials.createFromGoogleCredential,createEmpty:n.CallCredentials.createEmpty},g=e=>e.close(),g=(e,t,r)=>e.waitForReady(t,r),g=(e,t)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},g=(e,t,r)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},g=e=>{u.setLogger(e)},g=e=>{u.setLoggerVerbosity(e)};var g=e=>l.Client.prototype.getChannel.call(e),y=r(3712);g={enumerable:!0,get:function(){return y.ListenerBuilder}},g={enumerable:!0,get:function(){return y.RequesterBuilder}},g={enumerable:!0,get:function(){return y.InterceptingCall}},g={enumerable:!0,get:function(){return y.InterceptorConfigurationError}};var v=r(6827);g={enumerable:!0,get:function(){return v.getChannelzServiceDefinition}},g={enumerable:!0,get:function(){return v.getChannelzHandlers}};var b=r(7061);g={enumerable:!0,get:function(){return b.addAdminServicesToServer}},g=r(6250);let S=r(4660),w=r(5481),T=r(1470),E=r(7386),C=r(15),_=r(1532),I=r(6827);(()=>{S.setup(),w.setup(),T.setup(),E.setup(),C.setup(),_.setup(),I.setup()})()},6239:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateLoadBalancingConfig=t.getFirstUsableConfig=t.isLoadBalancerNameRegistered=t.createLoadBalancer=t.registerDefaultLoadBalancerType=t.registerLoadBalancerType=t.createChildChannelControlHelper=void 0,t.createChildChannelControlHelper=function(e,t){var r,n,i,s,a,o,l,c,u,d;return{createSubchannel:null!=(n=null==(r=t.createSubchannel)?void 0:r.bind(t))?n:e.createSubchannel.bind(e),updateState:null!=(s=null==(i=t.updateState)?void 0:i.bind(t))?s:e.updateState.bind(e),requestReresolution:null!=(o=null==(a=t.requestReresolution)?void 0:a.bind(t))?o:e.requestReresolution.bind(e),addChannelzChild:null!=(c=null==(l=t.addChannelzChild)?void 0:l.bind(t))?c:e.addChannelzChild.bind(e),removeChannelzChild:null!=(d=null==(u=t.removeChannelzChild)?void 0:u.bind(t))?d:e.removeChannelzChild.bind(e)}};let r={},n=null;t.registerLoadBalancerType=function(e,t,n){r[e]={LoadBalancer:t,LoadBalancingConfig:n}},t.registerDefaultLoadBalancerType=function(e){n=e},t.createLoadBalancer=function(e,t){let n=e.getLoadBalancerName();return n in r?new r[n].LoadBalancer(t):null},t.isLoadBalancerNameRegistered=function(e){return e in r},t.getFirstUsableConfig=function(e,t=!1){for(let t of e)if(t.getLoadBalancerName()in r)return t;return t&&n?new r[n].LoadBalancingConfig:null},t.validateLoadBalancingConfig=function(e){if(null===e||"object"!=typeof e)throw Error("Load balancing config must be an object");let t=Object.keys(e);if(1!==t.length)throw Error("Provided load balancing config has multiple conflicting entries");let n=t[0];if(n in r)return r[n].LoadBalancingConfig.createFromJson(e[n]);throw Error(`Unrecognized load balancing config name ${n}`)}},6250:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlierDetectionLoadBalancingConfig=t.BaseSubchannelWrapper=t.registerAdminService=t.FilterStackFactory=t.BaseFilter=t.PickResultType=t.QueuePicker=t.UnavailablePicker=t.ChildLoadBalancerHandler=t.subchannelAddressToString=t.validateLoadBalancingConfig=t.getFirstUsableConfig=t.registerLoadBalancerType=t.createChildChannelControlHelper=t.BackoffTimeout=t.durationToMs=t.uriToString=t.createResolver=t.registerResolver=t.log=t.trace=void 0;var n=r(1359);Object.defineProperty(t,"trace",{enumerable:!0,get:function(){return n.trace}}),Object.defineProperty(t,"log",{enumerable:!0,get:function(){return n.log}});var i=r(5674);Object.defineProperty(t,"registerResolver",{enumerable:!0,get:function(){return i.registerResolver}}),Object.defineProperty(t,"createResolver",{enumerable:!0,get:function(){return i.createResolver}});var s=r(6786);Object.defineProperty(t,"uriToString",{enumerable:!0,get:function(){return s.uriToString}});var a=r(324);Object.defineProperty(t,"durationToMs",{enumerable:!0,get:function(){return a.durationToMs}});var o=r(268);Object.defineProperty(t,"BackoffTimeout",{enumerable:!0,get:function(){return o.BackoffTimeout}});var l=r(6239);Object.defineProperty(t,"createChildChannelControlHelper",{enumerable:!0,get:function(){return l.createChildChannelControlHelper}}),Object.defineProperty(t,"registerLoadBalancerType",{enumerable:!0,get:function(){return l.registerLoadBalancerType}}),Object.defineProperty(t,"getFirstUsableConfig",{enumerable:!0,get:function(){return l.getFirstUsableConfig}}),Object.defineProperty(t,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return l.validateLoadBalancingConfig}});var c=r(3356);Object.defineProperty(t,"subchannelAddressToString",{enumerable:!0,get:function(){return c.subchannelAddressToString}});var u=r(2309);Object.defineProperty(t,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return u.ChildLoadBalancerHandler}});var d=r(2910);Object.defineProperty(t,"UnavailablePicker",{enumerable:!0,get:function(){return d.UnavailablePicker}}),Object.defineProperty(t,"QueuePicker",{enumerable:!0,get:function(){return d.QueuePicker}}),Object.defineProperty(t,"PickResultType",{enumerable:!0,get:function(){return d.PickResultType}});var h=r(962);Object.defineProperty(t,"BaseFilter",{enumerable:!0,get:function(){return h.BaseFilter}});var f=r(4003);Object.defineProperty(t,"FilterStackFactory",{enumerable:!0,get:function(){return f.FilterStackFactory}});var p=r(7061);Object.defineProperty(t,"registerAdminService",{enumerable:!0,get:function(){return p.registerAdminService}});var m=r(4719);Object.defineProperty(t,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return m.BaseSubchannelWrapper}});var g=r(1532);Object.defineProperty(t,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return g.OutlierDetectionLoadBalancingConfig}})},6271:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},6341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getPreviouslyRevalidatedTags:function(){return y},getUtils:function(){return g},interpolateDynamicPath:function(){return p},normalizeDynamicRouteParams:function(){return m},normalizeVercelUrl:function(){return f}});let n=r(9551),i=r(1959),s=r(2437),a=r(4396),o=r(8034),l=r(5526),c=r(2887),u=r(4722),d=r(6143),h=r(7912);function f(e,t,r){let i=(0,n.parse)(e.url,!0);for(let e of(delete i.search,Object.keys(i.query))){let n=e!==d.NEXT_QUERY_PARAM_PREFIX&&e.startsWith(d.NEXT_QUERY_PARAM_PREFIX),s=e!==d.NEXT_INTERCEPTION_MARKER_PREFIX&&e.startsWith(d.NEXT_INTERCEPTION_MARKER_PREFIX);(n||s||t.includes(e)||r&&Object.keys(r.groups).includes(e))&&delete i.query[e]}e.url=(0,n.format)(i)}function p(e,t,r){if(!r)return e;for(let n of Object.keys(r.groups)){let i,{optional:s,repeat:a}=r.groups[n],o=`[${a?"...":""}${n}]`;s&&(o=`[${o}]`);let l=t[n];i=Array.isArray(l)?l.map(e=>e&&encodeURIComponent(e)).join("/"):l?encodeURIComponent(l):"",e=e.replaceAll(o,i)}return e}function m(e,t,r,n){let i=!0,s={};for(let i of Object.keys(t.groups)){let a=e[i];"string"==typeof a?a=(0,u.normalizeRscURL)(a):Array.isArray(a)&&(a=a.map(u.normalizeRscURL));let o=r[i],l=t.groups[i].optional;if((Array.isArray(o)?o.some(e=>Array.isArray(a)?a.some(t=>t.includes(e)):null==a?void 0:a.includes(e)):null==a?void 0:a.includes(o))||void 0===a&&!(l&&n))return{params:{},hasValidParams:!1};l&&(!a||Array.isArray(a)&&1===a.length&&("index"===a[0]||a[0]===`[[...${i}]]`))&&(a=void 0,delete e[i]),a&&"string"==typeof a&&t.groups[i].repeat&&(a=a.split("/")),a&&(s[i]=a)}return{params:s,hasValidParams:i}}function g({page:e,i18n:t,basePath:r,rewrites:n,pageIsDynamic:u,trailingSlash:d,caseSensitive:g}){let y,v,b;function S(e){if(!y)return null;let{groups:t,routeKeys:r}=y,n=(0,o.getRouteMatcher)({re:{exec:e=>{let n=Object.fromEntries(new URLSearchParams(e));for(let[e,t]of Object.entries(n)){let r=(0,h.normalizeNextQueryParam)(e);r&&(n[r]=t,delete n[e])}let i={};for(let e of Object.keys(r)){let s=r[e];if(!s)continue;let a=t[s],o=n[e];if(!a.optional&&!o)return null;i[a.pos]=o}return i}},groups:t})(e);return n||null}return u&&(y=(0,a.getNamedRouteRegex)(e,{prefixRouteKeys:!1}),b=(v=(0,o.getRouteMatcher)(y))(e)),{handleRewrites:function(a,o){let h={},f=o.pathname,p=()=>{let t=(0,c.removeTrailingSlash)(f||"");return t===(0,c.removeTrailingSlash)(e)||(null==v?void 0:v(t))},m=n=>{let c=(0,s.getPathMatch)(n.source+(d?"(/)?":""),{removeUnnamedParams:!0,strict:!0,sensitive:!!g});if(!o.pathname)return!1;let p=c(o.pathname);if((n.has||n.missing)&&p){let e=(0,l.matchHas)(a,o.query,n.has,n.missing);e?Object.assign(p,e):p=!1}if(p){let{parsedDestination:s,destQuery:a}=(0,l.prepareDestination)({appendParamsToQuery:!0,destination:n.destination,params:p,query:o.query});if(s.protocol)return!0;if(Object.assign(h,a,p),Object.assign(o.query,s.query),delete s.query,Object.assign(o,s),!(f=o.pathname))return!1;if(r&&(f=f.replace(RegExp(`^${r}`),"")||"/"),t){let e=(0,i.normalizeLocalePath)(f,t.locales);f=e.pathname,o.query.nextInternalLocale=e.detectedLocale||p.nextInternalLocale}if(f===e)return!0;if(u&&v){let e=v(f);if(e)return o.query={...o.query,...e},!0}}return!1};for(let e of n.beforeFiles||[])m(e);if(f!==e){let e=!1;for(let t of n.afterFiles||[])if(e=m(t))break;if(!e&&!p()){for(let t of n.fallback||[])if(e=m(t))break}}return h},defaultRouteRegex:y,dynamicRouteMatcher:v,defaultRouteMatches:b,getParamsFromRouteMatches:S,normalizeDynamicRouteParams:(e,t)=>y&&b?m(e,y,b,t):{params:{},hasValidParams:!1},normalizeVercelUrl:(e,t)=>f(e,t,y),interpolateDynamicPath:(e,t)=>p(e,t,y)}}function y(e,t){return"string"==typeof e[d.NEXT_CACHE_REVALIDATED_TAGS_HEADER]&&e[d.NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER]===t?e[d.NEXT_CACHE_REVALIDATED_TAGS_HEADER].split(","):[]}},6412:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deadlineToString=t.getRelativeTimeout=t.getDeadlineTimeoutString=t.minDeadline=void 0,t.minDeadline=function(...e){let t=1/0;for(let r of e){let e=r instanceof Date?r.getTime():r;e<t&&(t=e)}return t};let r=[["m",1],["S",1e3],["M",6e4],["H",36e5]];t.getDeadlineTimeoutString=function(e){let t=new Date().getTime();e instanceof Date&&(e=e.getTime());let n=Math.max(e-t,0);for(let[e,t]of r){let r=n/t;if(r<1e8)return String(Math.ceil(r))+e}throw Error("Deadline is too far in the future")};let n=0x7fffffff;t.getRelativeTimeout=function(e){let t=(e instanceof Date?e.getTime():e)-new Date().getTime();return t<0?0:t>n?1/0:t},t.deadlineToString=function(e){if(e instanceof Date)return e.toISOString();{let t=new Date(e);return Number.isNaN(t.getTime())?""+e:t.toISOString()}}},6415:e=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var t={};(()=>{var e=t;e.parse=a,e.serialize=o;var r=decodeURIComponent,n=encodeURIComponent,i=/; */,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function a(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var n={},s=t||{},a=e.split(i),o=s.decode||r,c=0;c<a.length;c++){var u=a[c],d=u.indexOf("=");if(!(d<0)){var h=u.substr(0,d).trim(),f=u.substr(++d,u.length).trim();'"'==f[0]&&(f=f.slice(1,-1)),void 0==n[h]&&(n[h]=l(f,o))}}return n}function o(e,t,r){var i=r||{},a=i.encode||n;if("function"!=typeof a)throw TypeError("option encode is invalid");if(!s.test(e))throw TypeError("argument name is invalid");var o=a(t);if(o&&!s.test(o))throw TypeError("argument val is invalid");var l=e+"="+o;if(null!=i.maxAge){var c=i.maxAge-0;if(isNaN(c)||!isFinite(c))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(c)}if(i.domain){if(!s.test(i.domain))throw TypeError("option domain is invalid");l+="; Domain="+i.domain}if(i.path){if(!s.test(i.path))throw TypeError("option path is invalid");l+="; Path="+i.path}if(i.expires){if("function"!=typeof i.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(l+="; HttpOnly"),i.secure&&(l+="; Secure"),i.sameSite)switch("string"==typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l}function l(e,t){try{return t(e)}catch(t){return e}}})(),e.exports=t})()},6420:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6346,23)),Promise.resolve().then(r.t.bind(r,7924,23)),Promise.resolve().then(r.t.bind(r,5656,23)),Promise.resolve().then(r.t.bind(r,99,23)),Promise.resolve().then(r.t.bind(r,8243,23)),Promise.resolve().then(r.t.bind(r,8827,23)),Promise.resolve().then(r.t.bind(r,2763,23)),Promise.resolve().then(r.t.bind(r,7173,23))},6642:e=>{"use strict";e.exports={}},6683:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryingCall=t.MessageBufferTracker=t.RetryThrottler=void 0;let n=r(1271),i=r(6777),s=r(1359),a="retrying_call";class o{constructor(e,t,r){this.maxTokens=e,this.tokenRatio=t,r?this.tokens=r.tokens*(e/r.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}t.RetryThrottler=o;class l{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var r;let n=null!=(r=this.allocatedPerCall.get(t))?r:0;return!(this.limitPerCall-n<e)&&!(this.totalLimit-this.totalAllocated<e)&&(this.allocatedPerCall.set(t,n+e),this.totalAllocated+=e,!0)}free(e,t){var r;if(this.totalAllocated<e)throw Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let n=null!=(r=this.allocatedPerCall.get(t))?r:0;if(n<e)throw Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${n}`);this.allocatedPerCall.set(t,n-e)}freeAll(e){var t;let r=null!=(t=this.allocatedPerCall.get(e))?t:0;if(this.totalAllocated<r)throw Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`);this.totalAllocated-=r,this.allocatedPerCall.delete(e)}}t.MessageBufferTracker=l;let c="grpc-previous-rpc-attempts";class u{constructor(e,t,r,n,i,s,a,o,l){if(this.channel=e,this.callConfig=t,this.methodName=r,this.host=n,this.credentials=i,this.deadline=s,this.callNumber=a,this.bufferTracker=o,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let e=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(e.initialBackoff.substring(0,e.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){s.trace(n.LogVerbosity.DEBUG,a,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;null==(t=this.listener)||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){for(let{call:r}of(this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new i.Metadata}),this.underlyingCalls))r.cancelWithStatus(e,t)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return null!=(t=this.writeBuffer[e-this.writeBufferOffset])?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let e=this.getBufferEntry(t);e.allocated&&this.bufferTracker.free(e.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[e].state){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&"COMPLETED"!==this.underlyingCalls[t].state&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(n.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let e=-1,t=-1;for(let[r,n]of this.underlyingCalls.entries())"ACTIVE"===n.state&&n.nextMessageToSend>e&&(e=n.nextMessageToSend,t=r);-1===t?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(e=>e===t||e.toString().toLowerCase()===n.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=null==(e=this.callConfig)?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let r=Math.random()*this.nextRetryBackoffSec*1e3,n=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,n),r}maybeRetryCall(e,t){let r;if("RETRY"!==this.state)return void t(!1);let n=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(n.maxAttempts,5))return void t(!1);if(null===e)r=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else r=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var e,r;if("RETRY"!==this.state)return void t(!1);(null==(r=null==(e=this.retryThrottler)?void 0:e.canRetryCall())||r)&&(t(!0),this.attempts+=1,this.startNewAttempt())},r)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)(null==t?void 0:t.state)==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,r){var n,i,s;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList(null!=(n=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)?n:[],e.code)){let n;if(null==(i=this.retryThrottler)||i.addCallFailed(),null===r)n=0;else if(r<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else n=r;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(t),this.reportStatus(e))},n)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?(null==(s=this.retryThrottler)||s.addCallFailed(),this.maybeRetryCall(r,r=>{r||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e))}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(0===t.length)return null;try{return parseInt(t[0])}catch(e){return -1}}handleChildStatus(e,t){var r;if("COMPLETED"===this.underlyingCalls[t].state)return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===n.Status.OK){null==(r=this.retryThrottler)||r.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if("COMMITTED"===this.state)return void this.reportStatus(e);let i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,i):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,i)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,r;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let n=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(n.maxAttempts,5))return;let i=null!=(e=n.hedgingDelay)?e:"0s",s=Number(i.substring(0,i.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*s),null==(r=(t=this.hedgingTimer).unref)||r.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let r=this.attempts-1,n=this.initialMetadata.clone();r>0&&n.set(c,`${r}`);let i=!1;e.start(n,{onReceiveMetadata:n=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),i=!0,r>0&&n.set(c,`${r}`),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMetadata(n)},onReceiveMessage:r=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMessage(r)},onReceiveStatus:n=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!i&&r>0&&n.metadata.set(c,`${r}`),this.handleChildStatus(n,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,r;let n=this.underlyingCalls[e],i=n.nextMessageToSend;null==(r=(t=this.getBufferEntry(i)).callback)||r.call(t),this.clearSentMessages(),n.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if("COMPLETED"!==t.state&&this.getBufferEntry(t.nextMessageToSend)){let r=this.getBufferEntry(t.nextMessageToSend);switch(r.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:t=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose()}}}sendMessageWithContext(e,t){var r;this.trace("write() called with message of length "+t.length);let n={message:t,flags:e.flags},i=this.getNextBufferIndex(),s={entryType:"MESSAGE",message:n,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(s),s.allocated)for(let[n,s]of(null==(r=e.callback)||r.call(e),this.underlyingCalls.entries()))"ACTIVE"===s.state&&s.nextMessageToSend===i&&s.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(n)}},t);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let r=this.underlyingCalls[this.committedCallIndex];s.callback=e.callback,"ACTIVE"===r.state&&r.nextMessageToSend===i&&r.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){for(let e of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==e?void 0:e.state)==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();for(let t of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==t?void 0:t.state)==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}t.RetryingCall=u},6759:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseUrl",{enumerable:!0,get:function(){return s}});let n=r(2785),i=r(3736);function s(e){if(e.startsWith("/"))return(0,i.parseRelativeUrl)(e);let t=new URL(e);return{hash:t.hash,hostname:t.hostname,href:t.href,pathname:t.pathname,port:t.port,protocol:t.protocol,query:(0,n.searchParamsToUrlQuery)(t.searchParams),search:t.search}}},6771:(e,t,r)=>{"use strict";var n=e.exports=r(9374);n.build="full",n.tokenize=r(158),n.parse=r(7408),n.common=r(4346),n.Root._configure(n.Type,n.parse,n.common)},6777:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;let n=r(1359),i=r(1271),s=r(776),a=/^[0-9a-z_.-]+$/,o=/^[ -~]*$/;function l(e){return a.test(e)}function c(e){return o.test(e)}function u(e){return e.endsWith("-bin")}function d(e){return!e.startsWith("grpc-")}function h(e){return e.toLowerCase()}function f(e,t){if(!l(e))throw Error('Metadata key "'+e+'" contains illegal characters');if(null!=t)if(u(e)){if(!Buffer.isBuffer(t))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(t))throw Error("keys that don't end with '-bin' must have String values");if(!c(t))throw Error('Metadata string value "'+t+'" contains illegal characters')}}class p{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){f(e=h(e),t),this.internalRepr.set(e,[t])}add(e,t){f(e=h(e),t);let r=this.internalRepr.get(e);void 0===r?this.internalRepr.set(e,[t]):r.push(t)}remove(e){e=h(e),this.internalRepr.delete(e)}get(e){return e=h(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,r]of this.internalRepr)if(r.length>0){let n=r[0];e[t]=Buffer.isBuffer(n)?Buffer.from(n):n}return e}clone(){let e=new p(this.options),t=e.internalRepr;for(let[e,r]of this.internalRepr){let n=r.map(e=>Buffer.isBuffer(e)?Buffer.from(e):e);t.set(e,n)}return e}merge(e){for(let[t,r]of e.internalRepr){let e=(this.internalRepr.get(t)||[]).concat(r);this.internalRepr.set(t,e)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,r]of this.internalRepr)e[t]=r.map(m);return e}toJSON(){let e={};for(let[t,r]of this.internalRepr)e[t]=r;return e}static fromHttp2Headers(e){let t=new p;for(let r of Object.keys(e)){if(":"===r.charAt(0))continue;let a=e[r];try{u(r)?Array.isArray(a)?a.forEach(e=>{t.add(r,Buffer.from(e,"base64"))}):void 0!==a&&(d(r)?a.split(",").forEach(e=>{t.add(r,Buffer.from(e.trim(),"base64"))}):t.add(r,Buffer.from(a,"base64"))):Array.isArray(a)?a.forEach(e=>{t.add(r,e)}):void 0!==a&&t.add(r,a)}catch(t){let e=`Failed to add metadata entry ${r}: ${a}. ${(0,s.getErrorMessage)(t)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,n.log)(i.LogVerbosity.ERROR,e)}}return t}}t.Metadata=p;let m=e=>Buffer.isBuffer(e)?e.toString("base64"):e},6786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uriToString=t.splitHostPort=t.parseUri=void 0;let r=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;t.parseUri=function(e){let t=r.exec(e);return null===t?null:{scheme:t[1],authority:t[2],path:t[3]}};let n=/^\d+$/;t.splitHostPort=function(e){if(e.startsWith("[")){let t=e.indexOf("]");if(-1===t)return null;let r=e.substring(1,t);if(-1===r.indexOf(":"))return null;if(!(e.length>t+1))return{host:r};if(":"!==e[t+1])return null;{let i=e.substring(t+2);return n.test(i)?{host:r,port:+i}:null}}{let t=e.split(":");return 2!==t.length?{host:e}:n.test(t[1])?{host:t[0],port:+t[1]}:null}},t.uriToString=function(e){let t="";return void 0!==e.scheme&&(t+=e.scheme+":"),void 0!==e.authority&&(t+="//"+e.authority+"/"),t+=e.path}},6827:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.getChannelzServiceDefinition=t.getChannelzHandlers=t.unregisterChannelzRef=t.registerChannelzSocket=t.registerChannelzServer=t.registerChannelzSubchannel=t.registerChannelzChannel=t.ChannelzCallTracker=t.ChannelzChildrenTracker=t.ChannelzTrace=void 0;let n=r(1645),i=r(8155),s=r(1271),a=r(3356),o=r(7061),l=r(1480);function c(e){return{channel_id:e.id,name:e.name}}function u(e){return{subchannel_id:e.id,name:e.name}}function d(e){return{server_id:e.id}}function h(e){return{socket_id:e.id,name:e.name}}let f=32;class p{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,r){let n=new Date;this.events.push({description:t,severity:e,timestamp:n,childChannel:(null==r?void 0:r.kind)==="channel"?r:void 0,childSubchannel:(null==r?void 0:r.kind)==="subchannel"?r:void 0}),this.events.length>=2*f&&(this.events=this.events.slice(f)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:x(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:x(e.timestamp),channel_ref:e.childChannel?c(e.childChannel):null,subchannel_ref:e.childSubchannel?u(e.childSubchannel):null}))}}}t.ChannelzTrace=p;class m{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,r,n;switch(e.kind){case"channel":{let r=null!=(t=this.channelChildren.get(e.id))?t:{ref:e,count:0};r.count+=1,this.channelChildren.set(e.id,r);break}case"subchannel":{let t=null!=(r=this.subchannelChildren.get(e.id))?r:{ref:e,count:0};t.count+=1,this.subchannelChildren.set(e.id,t);break}case"socket":{let t=null!=(n=this.socketChildren.get(e.id))?n:{ref:e,count:0};t.count+=1,this.socketChildren.set(e.id,t)}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t))}}}getChildLists(){let e=[];for(let{ref:t}of this.channelChildren.values())e.push(t);let t=[];for(let{ref:e}of this.subchannelChildren.values())t.push(e);let r=[];for(let{ref:e}of this.socketChildren.values())r.push(e);return{channels:e,subchannels:t,sockets:r}}}t.ChannelzChildrenTracker=m;class g{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}t.ChannelzCallTracker=g;let y=1;function v(){return y++}let b=[],S=[],w=[],T=[];function E(e){let t=Number.parseInt(e,16);return[t/256|0,t%256]}function C(e){return""===e?[]:[].concat(...e.split(":").map(e=>E(e)))}function _(e){if((0,n.isIPv4)(e))return Buffer.from(Uint8Array.from(e.split(".").map(e=>Number.parseInt(e))));if(!(0,n.isIPv6)(e))return null;{let t,r,n=e.indexOf("::");-1===n?(t=e,r=""):(t=e.substring(0,n),r=e.substring(n+2));let i=Buffer.from(C(t)),s=Buffer.from(C(r)),a=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,a,s])}}function I(e){switch(e){case i.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case i.ConnectivityState.IDLE:return{state:"IDLE"};case i.ConnectivityState.READY:return{state:"READY"};case i.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case i.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function x(e){if(!e)return null;let t=e.getTime();return{seconds:t/1e3|0,nanos:t%1e3*1e6}}function R(e){let t=e.getInfo();return{ref:c(e.ref),data:{target:t.target,state:I(t.state),calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:x(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},channel_ref:t.children.channels.map(e=>c(e)),subchannel_ref:t.children.subchannels.map(e=>u(e))}}function k(e,t){let r=Number.parseInt(e.request.channel_id),n=b[r];if(void 0===n)return void t({code:s.Status.NOT_FOUND,details:"No channel data found for id "+r});t(null,{channel:R(n)})}function A(e,t){let r=Number.parseInt(e.request.max_results),n=[],i=Number.parseInt(e.request.start_channel_id);for(;i<b.length;i++){let e=b[i];if(void 0!==e&&(n.push(R(e)),n.length>=r))break}t(null,{channel:n,end:i>=w.length})}function N(e){let t=e.getInfo();return{ref:d(e.ref),data:{calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:x(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},listen_socket:t.listenerChildren.sockets.map(e=>h(e))}}function D(e,t){let r=Number.parseInt(e.request.server_id),n=w[r];if(void 0===n)return void t({code:s.Status.NOT_FOUND,details:"No server data found for id "+r});t(null,{server:N(n)})}function O(e,t){let r=Number.parseInt(e.request.max_results),n=[],i=Number.parseInt(e.request.start_server_id);for(;i<w.length;i++){let e=w[i];if(void 0!==e&&(n.push(N(e)),n.length>=r))break}t(null,{server:n,end:i>=w.length})}function P(e,t){let r=Number.parseInt(e.request.subchannel_id),n=S[r];if(void 0===n)return void t({code:s.Status.NOT_FOUND,details:"No subchannel data found for id "+r});let i=n.getInfo();t(null,{subchannel:{ref:u(n.ref),data:{target:i.target,state:I(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:x(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(e=>h(e))}})}function M(e){var t;return(0,a.isTcpSubchannelAddress)(e)?{address:"tcpip_address",tcpip_address:{ip_address:null!=(t=_(e.host))?t:void 0,port:e.port}}:{address:"uds_address",uds_address:{filename:e.path}}}function L(e,t){var r,n,i,a,o;let l=Number.parseInt(e.request.socket_id),c=T[l];if(void 0===c)return void t({code:s.Status.NOT_FOUND,details:"No socket data found for id "+l});let u=c.getInfo(),d=u.security?{model:"tls",tls:{cipher_suite:u.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!=(r=u.security.cipherSuiteStandardName)?r:void 0,other_name:null!=(n=u.security.cipherSuiteOtherName)?n:void 0,local_certificate:null!=(i=u.security.localCertificate)?i:void 0,remote_certificate:null!=(a=u.security.remoteCertificate)?a:void 0}}:null;t(null,{socket:{ref:h(c.ref),local:u.localAddress?M(u.localAddress):null,remote:u.remoteAddress?M(u.remoteAddress):null,remote_name:null!=(o=u.remoteName)?o:void 0,security:d,data:{keep_alives_sent:u.keepAlivesSent,streams_started:u.streamsStarted,streams_succeeded:u.streamsSucceeded,streams_failed:u.streamsFailed,last_local_stream_created_timestamp:x(u.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:x(u.lastRemoteStreamCreatedTimestamp),messages_received:u.messagesReceived,messages_sent:u.messagesSent,last_message_received_timestamp:x(u.lastMessageReceivedTimestamp),last_message_sent_timestamp:x(u.lastMessageSentTimestamp),local_flow_control_window:u.localFlowControlWindow?{value:u.localFlowControlWindow}:null,remote_flow_control_window:u.remoteFlowControlWindow?{value:u.remoteFlowControlWindow}:null}}})}function F(e,t){let r=Number.parseInt(e.request.server_id),n=w[r];if(void 0===n)return void t({code:s.Status.NOT_FOUND,details:"No server data found for id "+r});let i=Number.parseInt(e.request.start_socket_id),a=Number.parseInt(e.request.max_results),o=n.getInfo().sessionChildren.sockets.sort((e,t)=>e.id-t.id),l=[],c=0;for(;c<o.length&&(!(o[c].id>=i)||(l.push(h(o[c])),!(l.length>=a)));c++);t(null,{socket_ref:l,end:c>=o.length})}function j(){return{GetChannel:k,GetTopChannels:A,GetServer:D,GetServers:O,GetSubchannel:P,GetSocket:L,GetServerSockets:F}}t.registerChannelzChannel=function(e,t,r){let n=v(),i={id:n,name:e,kind:"channel"};return r&&(b[n]={ref:i,getInfo:t}),i},t.registerChannelzSubchannel=function(e,t,r){let n=v(),i={id:n,name:e,kind:"subchannel"};return r&&(S[n]={ref:i,getInfo:t}),i},t.registerChannelzServer=function(e,t){let r=v(),n={id:r,kind:"server"};return t&&(w[r]={ref:n,getInfo:e}),n},t.registerChannelzSocket=function(e,t,r){let n=v(),i={id:n,name:e,kind:"socket"};return r&&(T[n]={ref:i,getInfo:t}),i},t.unregisterChannelzRef=function(e){switch(e.kind){case"channel":delete b[e.id];return;case"subchannel":delete S[e.id];return;case"server":delete w[e.id];return;case"socket":delete T[e.id];return}},t.getChannelzHandlers=j;let B=null;function U(){if(B)return B;let e=(0,r(7587).Yi)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return B=(0,l.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service}t.getChannelzServiceDefinition=U,t.setup=function(){(0,o.registerAdminService)(U,j)}},6973:(e,t,r)=>{"use strict";e.exports=l;var n=r(2110),i=r(3107);function s(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,r,i){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(%s){",i)("default:")("return%j",s(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),o=0;o<a.length;++o)e("case %i:",t.resolvedType.values[a[o]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",r,i)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",s(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",s(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",s(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",s(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",s(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",s(t,"buffer"))}return e}function o(e,t,r){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",r)("return%j",s(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",r)("return%j",s(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",r)("return%j",s(t,"boolean key"))}return e}function l(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=e.oneofsArray,n={};r.length&&t("var p={}");for(var l=0;l<e.fieldsArray.length;++l){var c=e._fieldsArray[l].resolve(),u="m"+i.safeProp(c.name);if(c.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,c.name),c.map)t("if(!util.isObject(%s))",u)("return%j",s(c,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),o(t,c,"k[i]"),a(t,c,l,u+"[k[i]]")("}");else if(c.repeated)t("if(!Array.isArray(%s))",u)("return%j",s(c,"array"))("for(var i=0;i<%s.length;++i){",u),a(t,c,l,u+"[i]")("}");else{if(c.partOf){var d=i.safeProp(c.partOf.name);1===n[c.partOf.name]&&t("if(p%s===1)",d)("return%j",c.partOf.name+": multiple values"),n[c.partOf.name]=1,t("p%s=1",d)}a(t,c,l,u)}c.optional&&t("}")}return t("return null")}},6984:(e,t,r)=>{"use strict";e.exports=i;var n=r(8707);function i(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!r}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,s,a){if(!s)throw TypeError("request must be specified");var o=this;if(!a)return n.asPromise(e,o,t,r,i,s);if(!o.rpcImpl)return void setTimeout(function(){a(Error("already ended"))},0);try{return o.rpcImpl(t,r[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(e,r){if(e)return o.emit("error",e,t),a(e);if(null===r)return void o.end(!0);if(!(r instanceof i))try{r=i[o.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return o.emit("error",e,t),a(e)}return o.emit("data",r,t),a(null,r)})}catch(e){o.emit("error",e,t),setTimeout(function(){a(e)},0);return}},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},6996:(e,t,r)=>{"use strict";e.exports=l;var n,i=r(8707),s=i.LongBits,a=i.utf8;function o(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},u=function(){return i.Buffer?function(e){return(l.create=function(e){return i.Buffer.isBuffer(e)?new n(e):c(e)})(e)}:c};function d(){var e=new s(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw o(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw o(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw o(this,8);return new s(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}l.create=u(),l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,l.prototype.uint32=function(){var e=0xffffffff;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return e}}(),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return h(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|h(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw o(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var n=i.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw o(this,e);this.pos+=e}else do if(this.pos>=this.len)throw o(this);while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){n=e,l.create=u(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},7061:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addAdminServicesToServer=t.registerAdminService=void 0;let r=[];t.registerAdminService=function(e,t){r.push({getServiceDefinition:e,getHandlers:t})},t.addAdminServicesToServer=function(e){for(let{getServiceDefinition:t,getHandlers:n}of r)e.addService(t(),n())}},7099:e=>{var t=1/0,r="[object Symbol]",n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,i=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s="\ud800-\udfff",a="\\u0300-\\u036f\\ufe20-\\ufe23",o="\\u20d0-\\u20f0",l="\\u2700-\\u27bf",c="a-z\\xdf-\\xf6\\xf8-\\xff",u="A-Z\\xc0-\\xd6\\xd8-\\xde",d="\\ufe0e\\ufe0f",h="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",f="[']",p="["+s+"]",m="["+h+"]",g="["+a+o+"]",y="\\d+",v="["+l+"]",b="["+c+"]",S="[^"+s+h+y+l+c+u+"]",w="\ud83c[\udffb-\udfff]",T="[^"+s+"]",E="(?:\ud83c[\udde6-\uddff]){2}",C="[\ud800-\udbff][\udc00-\udfff]",_="["+u+"]",I="\\u200d",x="(?:"+b+"|"+S+")",R="(?:"+_+"|"+S+")",k="(?:"+f+"(?:d|ll|m|re|s|t|ve))?",A="(?:"+f+"(?:D|LL|M|RE|S|T|VE))?",N="(?:"+g+"|"+w+")?",D="["+d+"]?",O="(?:"+I+"(?:"+[T,E,C].join("|")+")"+D+N+")*",P=D+N+O,M="(?:"+[v,E,C].join("|")+")"+P,L="(?:"+[T+g+"?",g,E,C,p].join("|")+")",F=RegExp(f,"g"),j=RegExp(g,"g"),B=RegExp(w+"(?="+w+")|"+L+P,"g"),U=RegExp([_+"?"+b+"+"+k+"(?="+[m,_,"$"].join("|")+")",R+"+"+A+"(?="+[m,_+x,"$"].join("|")+")",_+"?"+x+"+"+k,_+"+"+A,y,M].join("|"),"g"),V=RegExp("["+I+s+a+o+d+"]"),z=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,q={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},$="object"==typeof global&&global&&global.Object===Object&&global,G="object"==typeof self&&self&&self.Object===Object&&self,H=$||G||Function("return this")();function W(e,t,r,n){var i=-1,s=e?e.length:0;for(n&&s&&(r=e[++i]);++i<s;)r=t(r,e[i],i,e);return r}function K(e){return e.split("")}function Q(e){return e.match(n)||[]}var Y=function(e){return function(t){return null==e?void 0:e[t]}}(q);function J(e){return V.test(e)}function X(e){return z.test(e)}function Z(e){return J(e)?ee(e):K(e)}function ee(e){return e.match(B)||[]}function et(e){return e.match(U)||[]}var er=Object.prototype.toString,en=H.Symbol,ei=en?en.prototype:void 0,es=ei?ei.toString:void 0;function ea(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(i);++n<i;)s[n]=e[n+t];return s}function eo(e){if("string"==typeof e)return e;if(ed(e))return es?es.call(e):"";var r=e+"";return"0"==r&&1/e==-t?"-0":r}function el(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:ea(e,t,r)}function ec(e){return function(t){var r=J(t=eh(t))?Z(t):void 0,n=r?r[0]:t.charAt(0),i=r?el(r,1).join(""):t.slice(1);return n[e]()+i}}function eu(e){return!!e&&"object"==typeof e}function ed(e){return"symbol"==typeof e||eu(e)&&er.call(e)==r}function eh(e){return null==e?"":eo(e)}var ef=function(e){return function(t){return W(ey(em(t).replace(F,"")),e,"")}}(function(e,t,r){return t=t.toLowerCase(),e+(r?ep(t):t)});function ep(e){return eg(eh(e).toLowerCase())}function em(e){return(e=eh(e))&&e.replace(i,Y).replace(j,"")}var eg=ec("toUpperCase");function ey(e,t,r){return(e=eh(e),void 0===(t=r?void 0:t))?X(e)?et(e):Q(e):e.match(t)||[]}e.exports=ef},7236:(e,t,r)=>{"use strict";t.Service=r(6984)},7354:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.channelOptionsEqual=t.recognizedOptions=void 0,t.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},t.channelOptionsEqual=function(e,t){let r=Object.keys(e).sort(),n=Object.keys(t).sort();if(r.length!==n.length)return!1;for(let i=0;i<r.length;i+=1)if(r[i]!==n[i]||e[r[i]]!==t[n[i]])return!1;return!0}},7366:e=>{"use strict";e.exports=require("dns")},7369:(e,t,r)=>{"use strict";let n,i;r.r(t),r.d(t,{default:()=>xD});var s,a,o,l,c,u,d=r(687),h=r(3210),f=r.t(h,2),p=r(4780);let m=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{ref:r,className:(0,p.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));m.displayName="Card";let g=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{ref:r,className:(0,p.cn)("flex flex-col space-y-1.5 p-6",e),...t}));g.displayName="CardHeader";let y=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{ref:r,className:(0,p.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));y.displayName="CardTitle",h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{ref:r,className:(0,p.cn)("text-sm text-muted-foreground",e),...t})).displayName="CardDescription";let v=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{ref:r,className:(0,p.cn)("p-6 pt-0",e),...t}));v.displayName="CardContent",h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{ref:r,className:(0,p.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter";var b=r(4163),S=r(6059),w=r(1273),T=r(8599),E=r(3495),C=h.createContext(void 0);function _(e){let t=h.useContext(C);return e||t||"ltr"}var I=r(6156);function x(e,[t,r]){return Math.min(r,Math.max(t,e))}var R=r(569);function k(e,t){return h.useReducer((e,r)=>t[e][r]??e,e)}var A="ScrollArea",[N,D]=(0,w.A)(A),[O,P]=N(A),M=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,type:n="hover",dir:i,scrollHideDelay:s=600,...a}=e,[o,l]=h.useState(null),[c,u]=h.useState(null),[f,p]=h.useState(null),[m,g]=h.useState(null),[y,v]=h.useState(null),[S,w]=h.useState(0),[E,C]=h.useState(0),[I,x]=h.useState(!1),[R,k]=h.useState(!1),A=(0,T.s)(t,e=>l(e)),N=_(i);return(0,d.jsx)(O,{scope:r,type:n,dir:N,scrollHideDelay:s,scrollArea:o,viewport:c,onViewportChange:u,content:f,onContentChange:p,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:I,onScrollbarXEnabledChange:x,scrollbarY:y,onScrollbarYChange:v,scrollbarYEnabled:R,onScrollbarYEnabledChange:k,onCornerWidthChange:w,onCornerHeightChange:C,children:(0,d.jsx)(b.sG.div,{dir:N,...a,ref:A,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":E+"px",...e.style}})})});M.displayName=A;var L="ScrollAreaViewport",F=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,children:n,nonce:i,...s}=e,a=P(L,r),o=h.useRef(null),l=(0,T.s)(t,o,a.onViewportChange);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),(0,d.jsx)(b.sG.div,{"data-radix-scroll-area-viewport":"",...s,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,d.jsx)("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});F.displayName=L;var j="ScrollAreaScrollbar",B=h.forwardRef((e,t)=>{let{forceMount:r,...n}=e,i=P(j,e.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:a}=i,o="horizontal"===e.orientation;return h.useEffect(()=>(o?s(!0):a(!0),()=>{o?s(!1):a(!1)}),[o,s,a]),"hover"===i.type?(0,d.jsx)(U,{...n,ref:t,forceMount:r}):"scroll"===i.type?(0,d.jsx)(V,{...n,ref:t,forceMount:r}):"auto"===i.type?(0,d.jsx)(z,{...n,ref:t,forceMount:r}):"always"===i.type?(0,d.jsx)(q,{...n,ref:t}):null});B.displayName=j;var U=h.forwardRef((e,t)=>{let{forceMount:r,...n}=e,i=P(j,e.__scopeScrollArea),[s,a]=h.useState(!1);return h.useEffect(()=>{let e=i.scrollArea,t=0;if(e){let r=()=>{window.clearTimeout(t),a(!0)},n=()=>{t=window.setTimeout(()=>a(!1),i.scrollHideDelay)};return e.addEventListener("pointerenter",r),e.addEventListener("pointerleave",n),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",r),e.removeEventListener("pointerleave",n)}}},[i.scrollArea,i.scrollHideDelay]),(0,d.jsx)(S.C,{present:r||s,children:(0,d.jsx)(z,{"data-state":s?"visible":"hidden",...n,ref:t})})}),V=h.forwardRef((e,t)=>{let{forceMount:r,...n}=e,i=P(j,e.__scopeScrollArea),s="horizontal"===e.orientation,a=ec(()=>l("SCROLL_END"),100),[o,l]=k("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return h.useEffect(()=>{if("idle"===o){let e=window.setTimeout(()=>l("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(e)}},[o,i.scrollHideDelay,l]),h.useEffect(()=>{let e=i.viewport,t=s?"scrollLeft":"scrollTop";if(e){let r=e[t],n=()=>{let n=e[t];r!==n&&(l("SCROLL"),a()),r=n};return e.addEventListener("scroll",n),()=>e.removeEventListener("scroll",n)}},[i.viewport,s,l,a]),(0,d.jsx)(S.C,{present:r||"hidden"!==o,children:(0,d.jsx)(q,{"data-state":"hidden"===o?"hidden":"visible",...n,ref:t,onPointerEnter:(0,R.m)(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:(0,R.m)(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),z=h.forwardRef((e,t)=>{let r=P(j,e.__scopeScrollArea),{forceMount:n,...i}=e,[s,a]=h.useState(!1),o="horizontal"===e.orientation,l=ec(()=>{if(r.viewport){let e=r.viewport.offsetWidth<r.viewport.scrollWidth,t=r.viewport.offsetHeight<r.viewport.scrollHeight;a(o?e:t)}},10);return eu(r.viewport,l),eu(r.content,l),(0,d.jsx)(S.C,{present:n||s,children:(0,d.jsx)(q,{"data-state":s?"visible":"hidden",...i,ref:t})})}),q=h.forwardRef((e,t)=>{let{orientation:r="vertical",...n}=e,i=P(j,e.__scopeScrollArea),s=h.useRef(null),a=h.useRef(0),[o,l]=h.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=er(o.viewport,o.content),u={...n,sizes:o,onSizesChange:l,hasThumb:!!(c>0&&c<1),onThumbChange:e=>s.current=e,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:e=>a.current=e};function f(e,t){return ei(e,a.current,o,t)}return"horizontal"===r?(0,d.jsx)($,{...u,ref:t,onThumbPositionChange:()=>{if(i.viewport&&s.current){let e=es(i.viewport.scrollLeft,o,i.dir);s.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollLeft=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollLeft=f(e,i.dir))}}):"vertical"===r?(0,d.jsx)(G,{...u,ref:t,onThumbPositionChange:()=>{if(i.viewport&&s.current){let e=es(i.viewport.scrollTop,o);s.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollTop=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollTop=f(e))}}):null}),$=h.forwardRef((e,t)=>{let{sizes:r,onSizesChange:n,...i}=e,s=P(j,e.__scopeScrollArea),[a,o]=h.useState(),l=h.useRef(null),c=(0,T.s)(t,l,s.onScrollbarXChange);return h.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),(0,d.jsx)(K,{"data-orientation":"horizontal",...i,ref:c,sizes:r,style:{bottom:0,left:"rtl"===s.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===s.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":en(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,r)=>{if(s.viewport){let n=s.viewport.scrollLeft+t.deltaX;e.onWheelScroll(n),eo(n,r)&&t.preventDefault()}},onResize:()=>{l.current&&s.viewport&&a&&n({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:et(a.paddingLeft),paddingEnd:et(a.paddingRight)}})}})}),G=h.forwardRef((e,t)=>{let{sizes:r,onSizesChange:n,...i}=e,s=P(j,e.__scopeScrollArea),[a,o]=h.useState(),l=h.useRef(null),c=(0,T.s)(t,l,s.onScrollbarYChange);return h.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),(0,d.jsx)(K,{"data-orientation":"vertical",...i,ref:c,sizes:r,style:{top:0,right:"ltr"===s.dir?0:void 0,left:"rtl"===s.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":en(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,r)=>{if(s.viewport){let n=s.viewport.scrollTop+t.deltaY;e.onWheelScroll(n),eo(n,r)&&t.preventDefault()}},onResize:()=>{l.current&&s.viewport&&a&&n({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:et(a.paddingTop),paddingEnd:et(a.paddingBottom)}})}})}),[H,W]=N(j),K=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,sizes:n,hasThumb:i,onThumbChange:s,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:f,...p}=e,m=P(j,r),[g,y]=h.useState(null),v=(0,T.s)(t,e=>y(e)),S=h.useRef(null),w=h.useRef(""),C=m.viewport,_=n.content-n.viewport,I=(0,E.c)(u),x=(0,E.c)(l),k=ec(f,10);function A(e){S.current&&c({x:e.clientX-S.current.left,y:e.clientY-S.current.top})}return h.useEffect(()=>{let e=e=>{let t=e.target;g?.contains(t)&&I(e,_)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[C,g,_,I]),h.useEffect(x,[n,x]),eu(g,k),eu(m.content,k),(0,d.jsx)(H,{scope:r,scrollbar:g,hasThumb:i,onThumbChange:(0,E.c)(s),onThumbPointerUp:(0,E.c)(a),onThumbPositionChange:x,onThumbPointerDown:(0,E.c)(o),children:(0,d.jsx)(b.sG.div,{...p,ref:v,style:{position:"absolute",...p.style},onPointerDown:(0,R.m)(e.onPointerDown,e=>{let t=0;e.button===t&&(e.target.setPointerCapture(e.pointerId),S.current=g.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),A(e))}),onPointerMove:(0,R.m)(e.onPointerMove,A),onPointerUp:(0,R.m)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),S.current=null})})})}),Q="ScrollAreaThumb",Y=h.forwardRef((e,t)=>{let{forceMount:r,...n}=e,i=W(Q,e.__scopeScrollArea);return(0,d.jsx)(S.C,{present:r||i.hasThumb,children:(0,d.jsx)(J,{ref:t,...n})})}),J=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,style:n,...i}=e,s=P(Q,r),a=W(Q,r),{onThumbPositionChange:o}=a,l=(0,T.s)(t,e=>a.onThumbChange(e)),c=h.useRef(void 0),u=ec(()=>{c.current&&(c.current(),c.current=void 0)},100);return h.useEffect(()=>{let e=s.viewport;if(e){let t=()=>{u(),c.current||(c.current=el(e,o),o())};return o(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[s.viewport,u,o]),(0,d.jsx)(b.sG.div,{"data-state":a.hasThumb?"visible":"hidden",...i,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:(0,R.m)(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),r=e.clientX-t.left,n=e.clientY-t.top;a.onThumbPointerDown({x:r,y:n})}),onPointerUp:(0,R.m)(e.onPointerUp,a.onThumbPointerUp)})});Y.displayName=Q;var X="ScrollAreaCorner",Z=h.forwardRef((e,t)=>{let r=P(X,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&n?(0,d.jsx)(ee,{...e,ref:t}):null});Z.displayName=X;var ee=h.forwardRef((e,t)=>{let{__scopeScrollArea:r,...n}=e,i=P(X,r),[s,a]=h.useState(0),[o,l]=h.useState(0),c=!!(s&&o);return eu(i.scrollbarX,()=>{let e=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(e),l(e)}),eu(i.scrollbarY,()=>{let e=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(e),a(e)}),c?(0,d.jsx)(b.sG.div,{...n,ref:t,style:{width:s,height:o,position:"absolute",right:"ltr"===i.dir?0:void 0,left:"rtl"===i.dir?0:void 0,bottom:0,...e.style}}):null});function et(e){return e?parseInt(e,10):0}function er(e,t){let r=e/t;return isNaN(r)?0:r}function en(e){let t=er(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-r)*t,18)}function ei(e,t,r,n="ltr"){let i=en(r),s=i/2,a=t||s,o=i-a,l=r.scrollbar.paddingStart+a,c=r.scrollbar.size-r.scrollbar.paddingEnd-o,u=r.content-r.viewport;return ea([l,c],"ltr"===n?[0,u]:[-1*u,0])(e)}function es(e,t,r="ltr"){let n=en(t),i=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=t.scrollbar.size-i,a=t.content-t.viewport,o=s-n,l=x(e,"ltr"===r?[0,a]:[-1*a,0]);return ea([0,a],[0,o])(l)}function ea(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function eo(e,t){return e>0&&e<t}var el=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return!function i(){let s={left:e.scrollLeft,top:e.scrollTop},a=r.left!==s.left,o=r.top!==s.top;(a||o)&&t(),r=s,n=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(n)};function ec(e,t){let r=(0,E.c)(e),n=h.useRef(0);return h.useEffect(()=>()=>window.clearTimeout(n.current),[]),h.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function eu(e,t){let r=(0,E.c)(t);(0,I.N)(()=>{let t=0;if(e){let n=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(r)});return n.observe(e),()=>{window.cancelAnimationFrame(t),n.unobserve(e)}}},[e,r])}var ed=M,eh=F,ef=Z;let ep=h.forwardRef(({className:e,children:t,...r},n)=>(0,d.jsxs)(ed,{ref:n,className:(0,p.cn)("relative overflow-hidden",e),...r,children:[(0,d.jsx)(eh,{className:"h-full w-full rounded-[inherit]",children:t}),(0,d.jsx)(em,{}),(0,d.jsx)(ef,{})]}));ep.displayName=ed.displayName;let em=h.forwardRef(({className:e,orientation:t="vertical",...r},n)=>(0,d.jsx)(B,{ref:n,orientation:t,className:(0,p.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:(0,d.jsx)(Y,{className:"relative flex-1 rounded-full bg-border"})}));em.displayName=B.displayName;let eg=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{className:"relative w-full overflow-auto",children:(0,d.jsx)("table",{ref:r,className:(0,p.cn)("w-full caption-bottom text-sm",e),...t})}));eg.displayName="Table";let ey=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("thead",{ref:r,className:(0,p.cn)("[&_tr]:border-b",e),...t}));ey.displayName="TableHeader";let ev=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("tbody",{ref:r,className:(0,p.cn)("[&_tr:last-child]:border-0",e),...t}));ev.displayName="TableBody",h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("tfoot",{ref:r,className:(0,p.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let eb=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("tr",{ref:r,className:(0,p.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));eb.displayName="TableRow";let eS=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("th",{ref:r,className:(0,p.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));eS.displayName="TableHead";let ew=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("td",{ref:r,className:(0,p.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));function eT({account:e,className:t,style:r,marketPrices:n={}}){let[i,s]=(0,h.useState)(null),[a,o]=(0,h.useState)("asc"),l=e=>{i===e?o("asc"===a?"desc":"asc"):(s(e),o("asc"))};return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(m,{className:(0,p.cn)("shadow-lg hover:shadow-xl transition-shadow duration-300 flex flex-col",t),style:r,children:[(0,d.jsx)(g,{className:"px-2 py-1",children:(0,d.jsx)("div",{className:"flex items-center justify-start",children:(0,d.jsx)(y,{className:"text-sm font-semibold",children:e.name})})}),e.securities&&e.securities.length>0&&(0,d.jsx)(v,{className:"pt-1 pb-2 px-0 flex-grow",children:(0,d.jsx)(ep,{className:"rounded-md border w-full overflow-x-auto",children:(0,d.jsxs)(eg,{children:[(0,d.jsx)(ey,{children:(0,d.jsxs)(eb,{className:"[&>th]:text-[10px] [&>th]:font-semibold",children:[(0,d.jsxs)(eS,{className:"h-8 px-2 cursor-pointer w-1/12",onClick:()=>l("symbol"),children:["Sym ","symbol"===i&&("asc"===a?"":"")]}),(0,d.jsx)(eS,{className:"h-8 px-2 hidden md:table-cell",children:"Description"}),(0,d.jsxs)(eS,{className:"h-8 px-2 text-right cursor-pointer hidden md:table-cell",onClick:()=>l("quantity"),children:["Qty ","quantity"===i&&("asc"===a?"":"")]}),(0,d.jsxs)(eS,{className:"h-8 px-2 text-right cursor-pointer hidden lg:table-cell w-[80px]",onClick:()=>l("unitcost"),children:["Unit Cost ","unitcost"===i&&("asc"===a?"":"")]}),(0,d.jsxs)(eS,{className:"h-8 px-2 text-right cursor-pointer w-[100px]",onClick:()=>l("totalCost"),children:["Total Cost ","totalCost"===i&&("asc"===a?"":"")]}),(0,d.jsxs)(eS,{className:"h-8 px-2 text-right cursor-pointer w-[80px]",onClick:()=>l("price"),children:["Price ","price"===i&&("asc"===a?"":"")]}),(0,d.jsxs)(eS,{className:"h-8 px-2 text-right cursor-pointer w-[100px]",onClick:()=>l("value"),children:["Value ","value"===i&&("asc"===a?"":"")]}),(0,d.jsxs)(eS,{className:"h-8 px-2 text-right cursor-pointer w-[100px]",onClick:()=>l("return"),children:["Return ","return"===i&&("asc"===a?"":"")]})]})}),(0,d.jsx)(ev,{children:(0,h.useMemo)(()=>{let t=[...e.securities||[]].sort((e,t)=>{let r="number"==typeof e.unitcost?e.unitcost:0,s="number"==typeof t.unitcost?t.unitcost:0,o="number"==typeof e.quantity?e.quantity:0,l="number"==typeof t.quantity?t.quantity:0,c=n[e.symbol||""]||0,u=n[t.symbol||""]||0,d=o*c,h=l*u,f=o*r,p=l*s,m=d-f,g=h-p;if("value"===i)return"asc"===a?d-h:h-d;if("symbol"===i){let r=e.symbol||"",n=t.symbol||"";return"asc"===a?r.localeCompare(n):n.localeCompare(r)}if("price"===i)return"asc"===a?c-u:u-c;if("totalCost"===i)return"asc"===a?f-p:p-f;if("return"===i)return"asc"===a?m-g:g-m;if(i&&"description"!==i&&i in e&&i in t){let r="number"==typeof e[i]?e[i]:"asc"===a?1/0:-1/0,n="number"==typeof t[i]?t[i]:"asc"===a?1/0:-1/0;return r===n?0:"asc"===a?r<n?-1:1:n<r?-1:1}return 0});return t.map((e,t)=>{let r="number"==typeof e.unitcost?e.unitcost:0,i="number"==typeof e.quantity?e.quantity:0,s=e.symbol||"N/A",a=e.description||"No description",o=n[s]||0,l=i*o,c=i*r,u=l-c;return(0,d.jsxs)(eb,{className:"[&>td]:px-2 [&>td]:py-1 [&>td]:text-xs",children:[(0,d.jsx)(ew,{className:"font-medium",children:s}),(0,d.jsx)(ew,{className:"hidden md:table-cell",children:a}),(0,d.jsx)(ew,{className:"text-right tabular-nums hidden md:table-cell",children:i.toFixed(2)}),(0,d.jsx)(ew,{className:"text-right tabular-nums hidden lg:table-cell w-[80px]",children:r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[100px]",children:c.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[80px]",children:o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[100px]",children:l.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[100px]",children:u.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]},t)}).concat((0,d.jsxs)(eb,{className:"[&>td]:px-2 [&>td]:py-1 [&>td]:text-xs font-bold",children:[(0,d.jsx)(ew,{className:"font-medium",children:"Total"}),(0,d.jsx)(ew,{className:"hidden md:table-cell"}),(0,d.jsx)(ew,{className:"text-right tabular-nums hidden md:table-cell"}),(0,d.jsx)(ew,{className:"text-right tabular-nums hidden lg:table-cell w-[80px]"}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[100px]",children:t.reduce((e,t)=>e+("number"==typeof t.quantity?t.quantity:0)*("number"==typeof t.unitcost?t.unitcost:0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[80px]"}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[100px]",children:t.reduce((e,t)=>e+("number"==typeof t.quantity?t.quantity:0)*(n[t.symbol||""]||0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,d.jsx)(ew,{className:"text-right tabular-nums w-[100px]",children:t.reduce((e,t)=>{let r="number"==typeof t.quantity?t.quantity:0,i="number"==typeof t.unitcost?t.unitcost:0;return e+r*(n[t.symbol||""]||0)-r*i},0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]},"total"))},[e.securities,n,i,a])})]})})}),(!e.securities||0===e.securities.length)&&(0,d.jsx)(v,{className:"pt-1 pb-2 text-center",children:(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"No securities for this account."})})]})})}ew.displayName="TableCell",h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("caption",{ref:r,className:(0,p.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption";var eE=r(2614);let eC=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],e_=(0,eE.A)("LoaderCircle",eC);function eI({size:e=48,className:t}){return(0,d.jsx)("div",{className:(0,p.cn)("flex justify-center items-center",t),children:(0,d.jsx)(e_,{className:"animate-spin text-primary",style:{width:e,height:e}})})}let ex=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],eR=(0,eE.A)("CircleAlert",ex);var ek=r(4224);let eA=(0,ek.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eN=h.forwardRef(({className:e,variant:t,...r},n)=>(0,d.jsx)("div",{ref:n,role:"alert",className:(0,p.cn)(eA({variant:t}),e),...r}));eN.displayName="Alert";let eD=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("h5",{ref:r,className:(0,p.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));eD.displayName="AlertTitle";let eO=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("div",{ref:r,className:(0,p.cn)("text-sm [&_p]:leading-relaxed",e),...t}));function eP({title:e="An Error Occurred",message:t}){return(0,d.jsxs)(eN,{variant:"destructive",className:"max-w-md mx-auto",children:[(0,d.jsx)(eR,{className:"h-4 w-4"}),(0,d.jsx)(eD,{children:e}),(0,d.jsx)(eO,{children:t})]})}eO.displayName="AlertDescription";var eM=r(8730);let eL=(0,ek.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),eF=h.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},s)=>{let a=n?eM.DX:"button";return(0,d.jsx)(a,{className:(0,p.cn)(eL({variant:t,size:r,className:e})),ref:s,...i})});eF.displayName="Button";let ej=()=>void 0,eB={NODE_CLIENT:!1,SDK_VERSION:"${JSCORE_VERSION}"},eU=function(e){return Error("Firebase Database ("+eB.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},eV=function(e){let t=[],r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:((64512&i)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,t[r++]=i>>6&63|128),t[r++]=63&i|128)}return t},ez=function(e){let t=[],r=0,n=0;for(;r<e.length;){let i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=e[r++],a=((7&i)<<18|(63&s)<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(a>>10)),t[n++]=String.fromCharCode(56320+(1023&a))}else{let s=e[r++],a=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")},eq={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,c=i>>2,u=(3&i)<<4|a>>4,d=(15&a)<<2|l>>6,h=63&l;!o&&(h=64,s||(d=64)),n.push(r[c],r[u],r[d],r[h])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(eV(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):ez(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){let i=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==o)throw new e$;let l=i<<2|s>>4;if(n.push(l),64!==a){let e=s<<4&240|a>>2;if(n.push(e),64!==o){let e=a<<6&192|o;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class e$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let eG=function(e){let t=eV(e);return eq.encodeByteArray(t,!0)},eH=function(e){return eG(e).replace(/\./g,"")},eW=function(e){try{return eq.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function eK(e){return"__proto__"!==e}function eQ(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}let eY=()=>eQ().__FIREBASE_DEFAULTS__,eJ=()=>{if("undefined"==typeof process||void 0===process.env)return;let e=process.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},eX=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&eW(e[1]);return t&&JSON.parse(t)},eZ=()=>{try{return ej()||eY()||eJ()||eX()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},e0=e=>{var t,r;return null==(r=null==(t=eZ())?void 0:t.emulatorHosts)?void 0:r[e]},e1=e=>{let t=e0(e);if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]},e2=()=>{var e;return null==(e=eZ())?void 0:e.config};class e3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function e6(e){return e.endsWith(".cloudworkstations.dev")}async function e4(e){return(await fetch(e,{credentials:"include"})).ok}function e5(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e),o="";return[eH(JSON.stringify(r)),eH(JSON.stringify(a)),o].join(".")}let e8={};function e7(){let e={prod:[],emulator:[]};for(let t of Object.keys(e8))e8[t]?e.emulator.push(t):e.prod.push(t);return e}function e9(e){let t=document.getElementById(e),r=!1;return t||((t=document.createElement("div")).setAttribute("id",e),r=!0),{created:r,element:t}}let te=!1;function tt(e,t){if("undefined"==typeof window||"undefined"==typeof document||!e6(window.location.host)||e8[e]===t||e8[e]||te)return;function r(e){return`__firebase__banner__${e}`}e8[e]=t;let n="__firebase__banner",i=e7().prod.length>0;function s(){let e=document.getElementById(n);e&&e.remove()}function a(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}function o(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}function l(){let e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{te=!0,s()},e}function c(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}function u(){let e=e9(n),t=r("text"),s=document.getElementById(t)||document.createElement("span"),u=r("learnmore"),d=document.getElementById(u)||document.createElement("a"),h=r("preprendIcon"),f=document.getElementById(h)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){let t=e.element;a(t),c(d,u);let r=l();o(f,h),t.append(f,s,d,r),document.body.appendChild(t)}i?(s.innerText="Preview backend disconnected.",f.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(f.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,s.innerText="Preview backend running in this workspace."),s.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",u):u()}function tr(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function tn(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tr())}function ti(){var e;let t=null==(e=eZ())?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function ts(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function ta(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function to(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function tl(){return!ti()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tc(){try{return"object"==typeof indexedDB}catch(e){return!1}}function tu(){return new Promise((e,t)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var e;t((null==(e=i.error)?void 0:e.message)||"")}}catch(e){t(e)}})}let td="FirebaseError";class th extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=td,Object.setPrototypeOf(this,th.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tf.prototype.create)}}class tf{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},n=`${this.service}/${e}`,i=this.errors[e],s=i?tp(i,r):"Error",a=`${this.serviceName}: ${s} (${n}).`;return new th(n,a,r)}}function tp(e,t){return e.replace(tm,(e,r)=>{let n=t[r];return null!=n?String(n):`<${r}?>`})}let tm=/\{\$([^}]+)}/g;function tg(e){return JSON.parse(e)}function ty(e,t){if(e===t)return!0;let r=Object.keys(e),n=Object.keys(t);for(let i of r){if(!n.includes(i))return!1;let r=e[i],s=t[i];if(tv(r)&&tv(s)){if(!ty(r,s))return!1}else if(r!==s)return!1}for(let e of n)if(!r.includes(e))return!1;return!0}function tv(e){return null!==e&&"object"==typeof e}function tb(e){let t=[];for(let[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function tS(e){let t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[r,n]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(n)}}),t}function tw(e){let t=e.indexOf("?");if(!t)return"";let r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}function tT(e,t){let r=new tE(e,t);return r.subscribe.bind(r)}class tE{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw Error("Missing Observer.");void 0===(n=tC(e,["next","error","complete"])?e:{next:e,error:t,complete:r}).next&&(n.next=t_),void 0===n.error&&(n.error=t_),void 0===n.complete&&(n.complete=t_);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tC(e,t){if("object"!=typeof e||null===e)return!1;for(let r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}function t_(){}function tI(e){return e&&e._delegate?e._delegate:e}eB.NODE_CLIENT=!0;class tx{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let tR="[DEFAULT]";class tk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new e3;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),n=null!=(t=null==e?void 0:e.optional)&&t;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(e){if(n)return null;throw e}if(n)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(tN(e))try{this.getOrInitializeService({instanceIdentifier:tR})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=tR){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=tR){return this.instances.has(e)}getOptions(e=tR){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(n);return n}onInit(e,t){var r;let n=this.normalizeInstanceIdentifier(t),i=null!=(r=this.onInitCallbacks.get(n))?r:new Set;i.add(e),this.onInitCallbacks.set(n,i);let s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let n of r)try{n(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:tA(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(e){}return r||null}normalizeInstanceIdentifier(e=tR){return this.component?this.component.multipleInstances?e:tR:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function tA(e){return e===tR?void 0:e}function tN(e){return"EAGER"===e.instantiationMode}class tD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new tk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let tO=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s||(s={}));let tP={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},tM=s.INFO,tL={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},tF=(e,t,...r)=>{if(t<e.logLevel)return;let n=new Date().toISOString(),i=tL[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class tj{constructor(e){this.name=e,this._logLevel=tM,this._logHandler=tF,this._userLogHandler=null,tO.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in s))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?tP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...e),this._logHandler(this,s.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...e),this._logHandler(this,s.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,s.INFO,...e),this._logHandler(this,s.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,s.WARN,...e),this._logHandler(this,s.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,s.ERROR,...e),this._logHandler(this,s.ERROR,...e)}}let tB=(e,t)=>t.some(t=>e instanceof t);function tU(){return n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tV(){return i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let tz=new WeakMap,tq=new WeakMap,t$=new WeakMap,tG=new WeakMap,tH=new WeakMap;function tW(e){let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(tZ(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&tz.set(t,e)}).catch(()=>{}),tH.set(t,e),t}function tK(e){if(tq.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});tq.set(e,t)}let tQ={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return tq.get(e);if("objectStoreNames"===t)return e.objectStoreNames||t$.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return tZ(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function tY(e){tQ=e(tQ)}function tJ(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?tV().includes(e)?function(...t){return e.apply(t0(this),t),tZ(tz.get(this))}:function(...t){return tZ(e.apply(t0(this),t))}:function(t,...r){let n=e.call(t0(this),t,...r);return t$.set(n,t.sort?t.sort():[t]),tZ(n)}}function tX(e){return"function"==typeof e?tJ(e):(e instanceof IDBTransaction&&tK(e),tB(e,tU()))?new Proxy(e,tQ):e}function tZ(e){if(e instanceof IDBRequest)return tW(e);if(tG.has(e))return tG.get(e);let t=tX(e);return t!==e&&(tG.set(e,t),tH.set(t,e)),t}let t0=e=>tH.get(e);function t1(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(e,t),o=tZ(a);return n&&a.addEventListener("upgradeneeded",e=>{n(tZ(a.result),e.oldVersion,e.newVersion,tZ(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}let t2=["get","getKey","getAll","getAllKeys","count"],t3=["put","add","delete","clear"],t6=new Map;function t4(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(t6.get(t))return t6.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,i=t3.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||t2.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),a=s.store;return n&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),i&&s.done]))[0]};return t6.set(t,s),s}tY(e=>({...e,get:(t,r,n)=>t4(t,r)||e.get(t,r,n),has:(t,r)=>!!t4(t,r)||e.has(t,r)}));class t5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(!t8(e))return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}function t8(e){let t=e.getComponent();return(null==t?void 0:t.type)==="VERSION"}let t7="@firebase/app",t9="0.12.3",re=new tj("@firebase/app"),rt="11.7.3",rr="[DEFAULT]",rn={[t7]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ri=new Map,rs=new Map,ra=new Map;function ro(e,t){try{e.container.addComponent(t)}catch(r){re.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function rl(e){let t=e.name;if(ra.has(t))return re.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(ra.set(t,e),ri.values()))ro(r,e);for(let t of rs.values())ro(t,e);return!0}function rc(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function ru(e){return null!=e&&void 0!==e.settings}let rd=new tf("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class rh{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new tx("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw rd.create("app-deleted",{appName:this._name})}}function rf(e,t){let r=eW(e.split(".")[1]);return null===r?void console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?void console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):void(1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`))}let rp=rt;function rm(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let n=Object.assign({name:rr,automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!=typeof i||!i)throw rd.create("bad-app-name",{appName:String(i)});if(r||(r=e2()),!r)throw rd.create("no-options");let s=ri.get(i);if(s)if(ty(r,s.options)&&ty(n,s.config))return s;else throw rd.create("duplicate-app",{appName:i});let a=new tD(i);for(let e of ra.values())a.addComponent(e);let o=new rh(r,n,a);return ri.set(i,o),o}function rg(e=rr){let t=ri.get(e);if(!t&&e===rr&&e2())return rm();if(!t)throw rd.create("no-app",{appName:e});return t}function ry(){return Array.from(ri.values())}async function rv(e){let t=!1,r=e.name;ri.has(r)?(t=!0,ri.delete(r)):rs.has(r)&&0>=e.decRefCount()&&(rs.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function rb(e,t,r){var n;let i=null!=(n=rn[e])?n:e;r&&(i+=`-${r}`);let s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){let e=[`Unable to register library "${i}" with version "${t}":`];s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),re.warn(e.join(" "));return}rl(new tx(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}let rS="firebase-heartbeat-database",rw=1,rT="firebase-heartbeat-store",rE=null;function rC(){return rE||(rE=t1(rS,rw,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(rT)}catch(e){console.warn(e)}}}).catch(e=>{throw rd.create("idb-open",{originalErrorMessage:e.message})})),rE}async function r_(e){try{let t=(await rC()).transaction(rT),r=await t.objectStore(rT).get(rx(e));return await t.done,r}catch(e){if(e instanceof th)re.warn(e.message);else{let t=rd.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});re.warn(t.message)}}}async function rI(e,t){try{let r=(await rC()).transaction(rT,"readwrite"),n=r.objectStore(rT);await n.put(t,rx(e)),await r.done}catch(e){if(e instanceof th)re.warn(e.message);else{let t=rd.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});re.warn(t.message)}}}function rx(e){return`${e.name}!${e.options.appId}`}let rR=1024,rk=30;class rA{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new rO(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=rN();if((null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null==(t=this._heartbeatsCache)?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(e=>e.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>rk){let e=rM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){re.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let t=rN(),{heartbeatsToSend:r,unsentEntries:n}=rD(this._heartbeatsCache.heartbeats),i=eH(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return re.warn(e),""}}}function rN(){return new Date().toISOString().substring(0,10)}function rD(e,t=rR){let r=[],n=e.slice();for(let i of e){let e=r.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),rP(r)>t){e.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),rP(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class rO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!tc()&&tu().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await r_(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let r=await this.read();return rI(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){let r=await this.read();return rI(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function rP(e){return eH(JSON.stringify({version:2,heartbeats:e})).length}function rM(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}!function(e){rl(new tx("platform-logger",e=>new t5(e),"PRIVATE")),rl(new tx("heartbeat",e=>new rA(e),"PRIVATE")),rb(t7,t9,""),rb(t7,t9,"esm2017"),rb("fire-js","")}("");var rL=r(8354);let rF=require("crypto");var rj="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},rB={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function t(e,t,r){r||(r=0);var n=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;16>i;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^r&(i^s))+n[0]+0xd76aa478|0;a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[1]+0xe8c7b756|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[2]+0x242070db|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[3]+0xc1bdceee|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[4]+0xf57c0faf|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[5]+0x4787c62a|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[6]+0xa8304613|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[7]+0xfd469501|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[8]+0x698098d8|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[9]+0x8b44f7af|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[10]+0xffff5bb1|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[11]+0x895cd7be|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[12]+0x6b901122|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[13]+0xfd987193|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[14]+0xa679438e|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[15]+0x49b40821|0,r=i+(a<<22|a>>>10),a=t+(i^s&(r^i))+n[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[11]+0x265e5a51|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[0]+0xe9b6c7aa|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[15]+0xd8a1e681|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[4]+0xe7d3fbc8|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[3]+0xf4d50d87|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[8]+0x455a14ed|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[7]+0x676f02d9|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[12]+0x8d2a4c8a|0,a=t+((r=i+(a<<20|a>>>12))^i^s)+n[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[8]+0x8771f681|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[11]+0x6d9d6122|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[14]+0xfde5380c|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[4]+0x4bdecfa9|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[7]+0xf6bb4b60|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[10]+0xbebfbc70|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[0]+0xeaa127fa|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[3]+0xd4ef3085|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[6]+0x4881d05|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[12]+0xe6db99e5|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[15]+0x1fa27cf8|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[2]+0xc4ac5665|0,r=i+(a<<23|a>>>9),a=t+(i^(r|~s))+n[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[14]+0xab9423a7|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[5]+0xfc93a039|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[10]+0xffeff47d|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[1]+0x85845dd1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[6]+0xa3014314|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[13]+0x4e0811a1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[2]+0x2ad7d2bb|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(i+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+i|0,e.g[3]=e.g[3]+s|0}function r(e,t){var r=s;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}function n(e,t){this.h=t;for(var r=[],n=!0,i=e.length-1;0<=i;i--){var s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}(function(e,t){function r(){}r.prototype=t.prototype,e.D=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.C=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}})(e,function(){this.blockSize=-1}),e.prototype.s=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.u=function(e,r){void 0===r&&(r=e.length);for(var n=r-this.blockSize,i=this.B,s=this.h,a=0;a<r;){if(0==s)for(;a<=n;)t(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<r;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){t(this,i),s=0;break}}else for(;a<r;)if(i[s++]=e[a++],s==this.blockSize){t(this,i),s=0;break}}this.h=s,this.o+=r},e.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};var i,s={};function l(e){return -128<=e&&128>e?r(e,function(e){return new n([0|e],0>e?-1:0)}):new n([0|e],0>e?-1:0)}function c(e){if(isNaN(e)||!isFinite(e))return d;if(0>e)return g(c(-e));for(var t=[],r=1,i=0;e>=r;i++)t[i]=e/r|0,r*=0x100000000;return new n(t,0)}function u(e,t){if(0==e.length)throw Error("number format error: empty string");if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if("-"==e.charAt(0))return g(u(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=c(Math.pow(t,8)),n=d,i=0;i<e.length;i+=8){var s=Math.min(8,e.length-i),a=parseInt(e.substring(i,i+s),t);8>s?(s=c(Math.pow(t,s)),n=n.j(s).add(c(a))):n=(n=n.j(r)).add(c(a))}return n}var d=l(0),h=l(1),f=l(0x1000000);function p(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function m(e){return -1==e.h}function g(e){for(var t=e.g.length,r=[],i=0;i<t;i++)r[i]=~e.g[i];return new n(r,~e.h).add(h)}function y(e,t){return e.add(g(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function b(e,t){this.g=e,this.h=t}function S(e,t){if(p(t))throw Error("division by zero");if(p(e))return new b(d,d);if(m(e))return t=S(g(e),t),new b(g(t.g),g(t.h));if(m(t))return t=S(e,g(t)),new b(g(t.g),t.h);if(30<e.g.length){if(m(e)||m(t))throw Error("slowDivide_ only works with positive integers.");for(var r=h,n=t;0>=n.l(e);)r=w(r),n=w(n);var i=T(r,1),s=T(n,1);for(n=T(n,2),r=T(r,2);!p(n);){var a=s.add(n);0>=a.l(e)&&(i=i.add(r),s=a),n=T(n,1),r=T(r,1)}return t=y(e,i.j(t)),new b(i,t)}for(i=d;0<=e.l(t);){for(n=48>=(n=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))?1:Math.pow(2,n-48),a=(s=c(r)).j(t);m(a)||0<a.l(e);)r-=n,a=(s=c(r)).j(t);p(s)&&(s=h),i=i.add(s),e=y(e,a)}return new b(i,e)}function w(e){for(var t=e.g.length+1,r=[],i=0;i<t;i++)r[i]=e.i(i)<<1|e.i(i-1)>>>31;return new n(r,e.h)}function T(e,t){var r=t>>5;t%=32;for(var i=e.g.length-r,s=[],a=0;a<i;a++)s[a]=0<t?e.i(a+r)>>>t|e.i(a+r+1)<<32-t:e.i(a+r);return new n(s,e.h)}(i=n.prototype).m=function(){if(m(this))return-g(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.i(r);e+=(0<=n?n:0x100000000+n)*t,t*=0x100000000}return e},i.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(p(this))return"0";if(m(this))return"-"+g(this).toString(e);for(var t=c(Math.pow(e,6)),r=this,n="";;){var i=S(r,t).g,s=((0<(r=y(r,i.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(p(r=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},i.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},i.l=function(e){return m(e=y(this,e))?-1:+!p(e)},i.abs=function(){return m(this)?g(this):this},i.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0,s=0;s<=t;s++){var a=i+(65535&this.i(s))+(65535&e.i(s)),o=(a>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=o>>>16,a&=65535,o&=65535,r[s]=o<<16|a}return new n(r,-0x80000000&r[r.length-1]?-1:0)},i.j=function(e){if(p(this)||p(e))return d;if(m(this))return m(e)?g(this).j(g(e)):g(g(this).j(e));if(m(e))return g(this.j(g(e)));if(0>this.l(f)&&0>e.l(f))return c(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],i=0;i<2*t;i++)r[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var a=this.i(i)>>>16,o=65535&this.i(i),l=e.i(s)>>>16,u=65535&e.i(s);r[2*i+2*s]+=o*u,v(r,2*i+2*s),r[2*i+2*s+1]+=a*u,v(r,2*i+2*s+1),r[2*i+2*s+1]+=o*l,v(r,2*i+2*s+1),r[2*i+2*s+2]+=a*l,v(r,2*i+2*s+2)}for(i=0;i<t;i++)r[i]=r[2*i+1]<<16|r[2*i];for(i=t;i<2*t;i++)r[i]=0;return new n(r,0)},i.A=function(e){return S(this,e).h},i.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.i(i)&e.i(i);return new n(r,this.h&e.h)},i.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.i(i)|e.i(i);return new n(r,this.h|e.h)},i.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.i(i)^e.i(i);return new n(r,this.h^e.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,o=rB.Md5=e,n.prototype.add=n.prototype.add,n.prototype.multiply=n.prototype.j,n.prototype.modulo=n.prototype.A,n.prototype.compare=n.prototype.l,n.prototype.toNumber=n.prototype.m,n.prototype.toString=n.prototype.toString,n.prototype.getBits=n.prototype.i,n.fromNumber=c,n.fromString=u,a=rB.Integer=n}).apply(void 0!==rj?rj:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var rU=r(6142),rV=r(7587);let rz="@firebase/firestore",rq="4.7.14";class r${constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}r$.UNAUTHENTICATED=new r$(null),r$.GOOGLE_CREDENTIALS=new r$("google-credentials-uid"),r$.FIRST_PARTY=new r$("first-party-uid"),r$.MOCK_USER=new r$("mock-user");let rG="11.7.3";function rH(e){rG=e}function rW(e){return(0,rL.inspect)(e,{depth:100})}let rK=new tj("@firebase/firestore");function rQ(){return rK.logLevel}function rY(e,...t){if(rK.logLevel<=s.DEBUG){let r=t.map(rZ);rK.debug(`Firestore (${rG}): ${e}`,...r)}}function rJ(e,...t){if(rK.logLevel<=s.ERROR){let r=t.map(rZ);rK.error(`Firestore (${rG}): ${e}`,...r)}}function rX(e,...t){if(rK.logLevel<=s.WARN){let r=t.map(rZ);rK.warn(`Firestore (${rG}): ${e}`,...r)}}function rZ(e){if("string"==typeof e)return e;try{return rW(e)}catch(t){return e}}function r0(e,t,r){let n="Unexpected state";"string"==typeof t?n=t:r=t,r1(e,n,r)}function r1(e,t,r){let n=`FIRESTORE (${rG}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{let e=JSON.stringify(r);n+=" CONTEXT: "+e}catch(e){n+=" CONTEXT: "+r}throw rJ(n),Error(n)}function r2(e,t,r,n){let i="Unexpected state";"string"==typeof r?i=r:n=r,e||r1(t,i,n)}function r3(e,t){return e}let r6={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class r4 extends th{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class r5{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class r8{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class r7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(r$.UNAUTHENTICATED))}shutdown(){}}class r9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ne{constructor(e){this.authProvider=e,this.currentUser=r$.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){r2(void 0===this.tokenListener,42304);let r=this.tokenCounter,n=e=>this.tokenCounter!==r?(r=this.tokenCounter,t(e)):Promise.resolve(),i=new r5;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),i.resolve(),i=new r5,e.enqueueRetryable(()=>n(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await n(this.currentUser)})},a=e=>{rY("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),s())};this.authProvider.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.authProvider.getImmediate({optional:!0});e?a(e):(rY("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new r5)}},0),s()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(t).then(t=>this.tokenCounter!==e?(rY("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(r2("string"==typeof t.accessToken,31837,{tokenData:t}),new r8(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return r2(null===e||"string"==typeof e,2055,{currentUid:e}),new r$(e)}}class nt{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r,this.type="FirstParty",this.user=r$.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class nr{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r}getToken(){return Promise.resolve(new nt(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(r$.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nn{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ni{constructor(e,t){this.appCheckProvider=t,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,ru(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken)}start(e,t){r2(void 0===this.tokenListener,3512);let r=e=>{null!=e.error&&rY("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.latestAppCheckToken;return this.latestAppCheckToken=e.token,rY("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.tokenListener=t=>{e.enqueueRetryable(()=>r(t))};let n=e=>{rY("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){let e=this.appCheckProvider.getImmediate({optional:!0});e?n(e):rY("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new nn(this.serverAppAppCheckToken));let e=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(e).then(e=>e?(r2("string"==typeof e.token,44558,{tokenResult:e}),this.latestAppCheckToken=e.token,new nn(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function ns(e){if(!e)return new r7;switch(e.type){case"firstParty":return new nr(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new r4(r6.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function na(e){return(0,rF.randomBytes)(e)}function no(){return new rL.TextEncoder}function nl(){return new TextDecoder("utf-8")}class nc{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="",n=20;for(;r.length<n;){let i=na(40);for(let s=0;s<i.length;++s)r.length<n&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function nu(e,t){return e<t?-1:+(e>t)}function nd(e,t){let r=0;for(;r<e.length&&r<t.length;){let n=e.codePointAt(r),i=t.codePointAt(r);if(n!==i)if(n<128&&i<128)return nu(n,i);else{let s=no(),a=nf(s.encode(nh(e,r)),s.encode(nh(t,r)));if(0!==a)return a;return nu(n,i)}r+=n>65535?2:1}return nu(e.length,t.length)}function nh(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function nf(e,t){for(let r=0;r<e.length&&r<t.length;++r)if(e[r]!==t[r])return nu(e[r],t[r]);return nu(e.length,t.length)}function np(e,t,r){return e.length===t.length&&e.every((e,n)=>r(e,t[n]))}function nm(e){return e+"\0"}let ng=-0xe7791f700,ny=1e6;class nv{static now(){return nv.fromMillis(Date.now())}static fromDate(e){return nv.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ny);return new nv(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new r4(r6.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ng||e>=0x3afff44180)throw new r4(r6.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ny}_compareTo(e){return this.seconds===e.seconds?nu(this.nanoseconds,e.nanoseconds):nu(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds-ng).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class nb{static fromTimestamp(e){return new nb(e)}static min(){return new nb(new nv(0,0))}static max(){return new nb(new nv(0x3afff4417f,1e9-1))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let nS="__name__";class nw{constructor(e,t,r){void 0===t?t=0:t>e.length&&r0(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&r0(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===nw.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof nw?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=nw.compareSegments(e.get(n),t.get(n));if(0!==r)return r}return nu(e.length,t.length)}static compareSegments(e,t){let r=nw.isNumericId(e),n=nw.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?nw.extractNumericId(e).compare(nw.extractNumericId(t)):nd(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return a.fromString(e.substring(4,e.length-2))}}class nT extends nw{construct(e,t,r){return new nT(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new r4(r6.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new nT(t)}static emptyPath(){return new nT([])}}let nE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nC extends nw{construct(e,t,r){return new nC(e,t,r)}static isValidIdentifier(e){return nE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nC.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===nS}static keyField(){return new nC([nS])}static fromServerFormat(e){let t=[],r="",n=0,i=()=>{if(0===r.length)throw new r4(r6.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;n<e.length;){let t=e[n];if("\\"===t){if(n+1===e.length)throw new r4(r6.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new r4(r6.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?s=!s:"."!==t||s?r+=t:i(),n++}if(i(),s)throw new r4(r6.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nC(t)}static emptyPath(){return new nC([])}}class n_{constructor(e){this.path=e}static fromPath(e){return new n_(nT.fromString(e))}static fromName(e){return new n_(nT.fromString(e).popFirst(5))}static empty(){return new n_(nT.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===nT.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return nT.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n_(new nT(e.slice()))}}let nI=-1,nx=0;class nR{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}function nk(e){return e.fields.find(e=>2===e.kind)}function nA(e){return e.fields.filter(e=>2!==e.kind)}function nN(e){let t=nA(e);return 0===t.length?0:t[t.length-1].kind}function nD(e,t){let r=nu(e.collectionGroup,t.collectionGroup);if(0!==r)return r;for(let n=0;n<Math.min(e.fields.length,t.fields.length);++n)if(0!==(r=nM(e.fields[n],t.fields[n])))return r;return nu(e.fields.length,t.fields.length)}function nO(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}nR.UNKNOWN_ID=-1;class nP{constructor(e,t){this.fieldPath=e,this.kind=t}}function nM(e,t){let r=nC.comparator(e.fieldPath,t.fieldPath);return 0!==r?r:nu(e.kind,t.kind)}class nL{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new nL(nx,nB.min())}}function nF(e,t){let r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1;return new nB(nb.fromTimestamp(1e9===n?new nv(r+1,0):new nv(r,n)),n_.empty(),t)}function nj(e){return new nB(e.readTime,e.key,nI)}class nB{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new nB(nb.min(),n_.empty(),nI)}static max(){return new nB(nb.max(),n_.empty(),nI)}}function nU(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=n_.comparator(e.documentKey,t.documentKey))?r:nu(e.largestBatchId,t.largestBatchId)}let nV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function nq(e){if(e.code===r6.FAILED_PRECONDITION&&e.message===nV)rY("LocalStore","Unexpectedly lost primary lease");else throw e}class n${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return(this.callbackAttached&&r0(59440),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n$((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();if(t instanceof n$)return t;return n$.resolve(t)}catch(e){return n$.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n$.reject(t)}static resolve(e){return new n$((t,r)=>{t(e)})}static reject(e){return new n$((t,r)=>{r(e)})}static waitFor(e){return new n$((t,r)=>{let n=0,i=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++i,s&&i===n&&t()},e=>r(e))}),s=!0,i===n&&t()})}static or(e){let t=n$.resolve(!1);for(let r of e)t=t.next(e=>e?n$.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,n)=>{r.push(t.call(this,e,n))}),this.waitFor(r)}static mapArray(e,t){return new n$((r,n)=>{let i=e.length,s=Array(i),a=0;for(let o=0;o<i;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===i&&r(s)},e=>n(e))}})}static doWhile(e,t){return new n$((r,n)=>{let i=()=>{!0===e()?t().next(()=>{i()},n):r()};i()})}}let nG="SimpleDb",nH=3;class nW{static open(e,t,r,n){try{return new nW(t,e.transaction(n,r))}catch(e){throw new nJ(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.completionDeferred=new r5,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{t.error?this.completionDeferred.reject(new nJ(e,t.error)):this.completionDeferred.resolve()},this.transaction.onerror=t=>{let r=n2(t.target.error);this.completionDeferred.reject(new nJ(e,r))}}get completionPromise(){return this.completionDeferred.promise}abort(e){e&&this.completionDeferred.reject(e),this.aborted||(rY(nG,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return new nZ(this.transaction.objectStore(e))}}class nK{static delete(e){return rY(nG,"Removing database:",e),n0(eQ().indexedDB.deleteDatabase(e)).toPromise()}static isAvailable(){if(!tc())return!1;if(nK.isMockPersistence())return!0;let e=tr(),t=nK.getIOSVersion(e),r=0<t&&t<10,n=nQ(e),i=0<n&&n<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0)&&!r&&!i}static isMockPersistence(){var e;return"undefined"!=typeof process&&(null==(e=process.env)?void 0:e.USE_MOCK_PERSISTENCE)==="YES"}static getStore(e,t){return e.store(t)}static getIOSVersion(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(t?t[1].split("_").slice(0,2).join("."):"-1")}constructor(e,t,r){this.name=e,this.version=t,this.schemaConverter=r,this.lastClosedDbVersion=null,12.2===nK.getIOSVersion(tr())&&rJ("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async ensureDb(e){return this.db||(rY(nG,"Opening database:",this.name),this.db=await new Promise((t,r)=>{let n=indexedDB.open(this.name,this.version);n.onsuccess=e=>{t(e.target.result)},n.onblocked=()=>{r(new nJ(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},n.onerror=t=>{let n=t.target.error;"VersionError"===n.name?r(new r4(r6.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new r4(r6.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new nJ(e,n))},n.onupgradeneeded=e=>{rY(nG,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;if(null!==this.lastClosedDbVersion&&this.lastClosedDbVersion!==e.oldVersion)throw Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.lastClosedDbVersion}, event.oldVersion=${e.oldVersion}, event.newVersion=${e.newVersion}, db.version=${t.version}`);this.schemaConverter.createOrUpgrade(t,n.transaction,e.oldVersion,this.version).next(()=>{rY(nG,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",e=>{let t=e.target;this.lastClosedDbVersion=t.version},{passive:!0})),this.versionchangelistener&&(this.db.onversionchange=e=>this.versionchangelistener(e)),this.db}setVersionChangeListener(e){this.versionchangelistener=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,n){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.ensureDb(e);let t=nW.open(this.db,e,i?"readonly":"readwrite",r),s=n(t).next(e=>(t.maybeCommit(),e)).catch(e=>(t.abort(e),n$.reject(e))).toPromise();return s.catch(()=>{}),await t.completionPromise,s}catch(r){let e=r,t="FirebaseError"!==e.name&&s<nH;if(rY(nG,"Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}function nQ(e){let t=e.match(/Android ([\d.]+)/i);return Number(t?t[1].split(".").slice(0,2).join("."):"-1")}class nY{constructor(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(e){this.dbCursor=e}done(){this.shouldStop=!0}skip(e){this.nextKey=e}delete(){return n0(this.dbCursor.delete())}}class nJ extends r4{constructor(e,t){super(r6.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function nX(e){return"IndexedDbTransactionError"===e.name}class nZ{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(rY(nG,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(rY(nG,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),n0(r)}add(e){return rY(nG,"ADD",this.store.name,e,e),n0(this.store.add(e))}get(e){return n0(this.store.get(e)).next(t=>(void 0===t&&(t=null),rY(nG,"GET",this.store.name,e,t),t))}delete(e){return rY(nG,"DELETE",this.store.name,e),n0(this.store.delete(e))}count(){return rY(nG,"COUNT",this.store.name),n0(this.store.count())}loadAll(e,t){let r=this.options(e,t),n=r.index?this.store.index(r.index):this.store;if("function"==typeof n.getAll){let e=n.getAll(r.range);return new n$((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{let e=this.cursor(r),t=[];return this.iterateCursor(e,(e,r)=>{t.push(r)}).next(()=>t)}}loadFirst(e,t){let r=this.store.getAll(e,null===t?void 0:t);return new n$((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}})}deleteAll(e,t){rY(nG,"DELETE ALL",this.store.name);let r=this.options(e,t);r.keysOnly=!1;let n=this.cursor(r);return this.iterateCursor(n,(e,t,r)=>r.delete())}iterate(e,t){let r;t?r=e:(r={},t=e);let n=this.cursor(r);return this.iterateCursor(n,t)}iterateSerial(e){let t=this.cursor({});return new n$((r,n)=>{t.onerror=e=>{n(n2(e.target.error))},t.onsuccess=t=>{let n=t.target.result;if(!n)return void r();e(n.primaryKey,n.value).next(e=>{e?n.continue():r()})}})}iterateCursor(e,t){let r=[];return new n$((n,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i)return void n();let s=new nY(i),a=t(i.primaryKey,i.value,s);if(a instanceof n$){let e=a.catch(e=>(s.done(),n$.reject(e)));r.push(e)}s.isDone?n():null===s.skipToKey?i.continue():i.continue(s.skipToKey)}}).next(()=>n$.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),!e.index)return this.store.openCursor(e.range,t);{let r=this.store.index(e.index);return e.keysOnly?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}}}function n0(e){return new n$((t,r)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{r(n2(e.target.error))}})}let n1=!1;function n2(e){let t=nK.getIOSVersion(tr());if(t>=12.2&&t<13){let t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){let e=new r4("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return n1||(n1=!0,setTimeout(()=>{throw e},0)),e}}return e}let n3="IndexBackfiller",n6=15e3,n4=6e4,n5=50;class n8{constructor(e,t){this.asyncQueue=e,this.backfiller=t,this.task=null}start(){this.schedule(n6)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(e){rY(n3,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let e=await this.backfiller.backfill();rY(n3,`Documents written: ${e}`)}catch(e){nX(e)?rY(n3,"Ignoring IndexedDB error during index backfill: ",e):await nq(e)}await this.schedule(n4)})}}class n7{constructor(e,t){this.localStore=e,this.persistence=t}async backfill(e=n5){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.writeIndexEntries(t,e))}writeIndexEntries(e,t){let r=new Set,n=t,i=!0;return n$.doWhile(()=>!0===i&&n>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(!(null===t||r.has(t)))return rY(n3,`Processing collection: ${t}`),this.writeEntriesForCollectionGroup(e,t,n).next(e=>{n-=e,r.add(t)});i=!1})).next(()=>t-n)}writeEntriesForCollectionGroup(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(n=>this.localStore.localDocuments.getNextDocuments(e,t,n,r).next(r=>{let i=r.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.getNewOffset(n,r)).next(r=>(rY(n3,`Updating offset: ${r}`),this.localStore.indexManager.updateCollectionGroup(e,t,r))).next(()=>i.size)}))}getNewOffset(e,t){let r=e;return t.changes.forEach((e,t)=>{let n=nj(t);nU(n,r)>0&&(r=n)}),new nB(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class n9{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.setPreviousValue(e),this.writeNewSequenceNumber=e=>t.writeSequenceNumber(e))}setPreviousValue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e}}n9.INVALID=-1;let ie="\x01",it="\x01",ir="\x10",ii="\x11";function is(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=io(t)),t=ia(e.get(r),t);return io(t)}function ia(e,t){let r=t,n=e.length;for(let t=0;t<n;t++){let n=e.charAt(t);switch(n){case"\0":r+=ie+ir;break;case ie:r+=ie+ii;break;default:r+=n}}return r}function io(e){return e+ie+it}function il(e){let t=e.length;if(r2(t>=2,64408,{path:e}),2===t)return r2(e.charAt(0)===ie&&e.charAt(1)===it,56145,{path:e}),nT.emptyPath();let r=t-2,n=[],i="";for(let s=0;s<t;){let t=e.indexOf(ie,s);switch((t<0||t>r)&&r0(50515,{path:e}),e.charAt(t+1)){case it:let a,o=e.substring(s,t);0===i.length?a=o:(i+=o,a=i,i=""),n.push(a);break;case ir:i+=e.substring(s,t),i+="\0";break;case ii:i+=e.substring(s,t+1);break;default:r0(61167,{path:e})}s=t+2}return new nT(n)}let ic="remoteDocuments",iu="owner",id="owner",ih="mutationQueues",ip="userId",im="mutations",ig="batchId",iy="userMutationsIndex",iv=["userId","batchId"];function ib(e){return[e]}function iS(e,t){return[e,is(t)]}function iw(e,t,r){return[e,is(t),r]}let iT={},iE="documentMutations",iC="remoteDocumentsV14",i_=["prefixPath","collectionGroup","readTime","documentId"],iI="documentKeyIndex",ix=["prefixPath","collectionGroup","documentId"],iR="collectionGroupIndex",ik=["collectionGroup","readTime","prefixPath","documentId"],iA="remoteDocumentGlobal",iN="remoteDocumentGlobalKey",iD="targets",iO="targetId",iP="queryTargetsIndex",iM=["canonicalId","targetId"],iL="targetDocuments",iF=["targetId","path"],ij="documentTargetsIndex",iB=["path","targetId"],iU="targetGlobalKey",iV="targetGlobal",iz="collectionParents",iq=["collectionId","parent"],i$="clientMetadata",iG="clientId",iH="bundles",iW="bundleId",iK="namedQueries",iQ="name",iY="indexConfiguration",iJ="indexId",iX="collectionGroupIndex",iZ="collectionGroup",i0="indexState",i1=["indexId","uid"],i2="sequenceNumberIndex",i3=["uid","sequenceNumber"],i6="indexEntries",i4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],i5="documentKeyIndex",i8=["indexId","uid","orderedDocumentKey"],i7="documentOverlays",i9=["userId","collectionPath","documentId"],se="collectionPathOverlayIndex",st=["userId","collectionPath","largestBatchId"],sr="collectionGroupOverlayIndex",sn=["userId","collectionGroup","largestBatchId"],si="globals",ss="name",sa=[ih,im,iE,ic,iD,iu,iV,iL,i$,iA,iz,iH,iK],so=[...sa,i7],sl=[ih,im,iE,iC,iD,iu,iV,iL,i$,iA,iz,iH,iK,i7],sc=sl,su=[...sc,iY,i0,i6],sd=su,sh=[...su,si];function sf(e){return 17===e?sh:16===e?sd:15===e?su:14===e?sc:13===e?sl:12===e?so:11===e?sa:void r0(60245)}class sp extends nz{constructor(e,t){super(),this.simpleDbTransaction=e,this.currentSequenceNumber=t}}function sm(e,t){let r=r3(e);return nK.getStore(r.simpleDbTransaction,t)}function sg(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function sy(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function sv(e,t){let r=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.push(t(e[n],n,e));return r}function sb(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class sS{constructor(e,t){this.comparator=e,this.root=t||sT.EMPTY}insert(e,t){return new sS(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sT.BLACK,null,null))}remove(e){return new sS(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sT.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sw(this.root,e,this.comparator,!1)}getReverseIterator(){return new sw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sw(this.root,e,this.comparator,!0)}}class sw{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else if(0===i){this.nodeStack.push(e);break}else this.nodeStack.push(e),e=this.isReverse?e.right:e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sT{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:sT.RED,this.left=null!=n?n:sT.EMPTY,this.right=null!=i?i:sT.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new sT(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return sT.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(0>t(e,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key))if(n.right.isEmpty())return sT.EMPTY;else r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin());n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,sT.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,sT.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw r0(43730,{key:this.key,value:this.value});if(this.right.isRed())throw r0(14113,{key:this.key,value:this.value});let e=this.left.check();if(e===this.right.check())return e+ +!this.isRed();throw r0(27949)}}sT.EMPTY=null,sT.RED=!0,sT.BLACK=!1;class sE{constructor(){this.size=0}get key(){throw r0(57766)}get value(){throw r0(16141)}get color(){throw r0(16727)}get left(){throw r0(29726)}get right(){throw r0(36894)}copy(e,t,r,n,i){return this}insert(e,t,r){return new sT(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}sT.EMPTY=new sE;class sC{constructor(e){this.comparator=e,this.data=new sS(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new s_(this.data.getIterator())}getIteratorFrom(e){return new s_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof sC)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new sC(this.comparator);return t.data=e,t}}class s_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function sI(e,t,r,n,i){let s=e.getIterator(),a=t.getIterator(),o=sx(s),l=sx(a);for(;o||l;){let e=!1,t=!1;if(o&&l){let n=r(o,l);n<0?t=!0:n>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(n(l),l=sx(a)):t?(i(o),o=sx(s)):(o=sx(s),l=sx(a))}}function sx(e){return e.hasNext()?e.getNext():void 0}class sR{constructor(e){this.fields=e,e.sort(nC.comparator)}static empty(){return new sR([])}unionWith(e){let t=new sC(nC.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new sR(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return np(this.fields,e.fields,(e,t)=>e.isEqual(t))}}function sk(e){return Buffer.from(e,"base64").toString("binary")}function sA(e){return Buffer.from(e,"binary").toString("base64")}class sN{constructor(e){this.binaryString=e}static fromBase64String(e){return new sN(sk(e))}static fromUint8Array(e){return new sN(sD(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return sA(this.binaryString)}toUint8Array(){return sO(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nu(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}function sD(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}function sO(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}sN.EMPTY_BYTE_STRING=new sN("");let sP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sM(e){if(r2(!!e,39018),"string"==typeof e){let t=0,r=sP.exec(e);if(r2(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:sL(e.seconds),nanos:sL(e.nanos)}}function sL(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function sF(e){return"string"==typeof e?sN.fromBase64String(e):sN.fromUint8Array(e)}let sj="server_timestamp",sB="__type__",sU="__previous_value__",sV="__local_write_time__";function sz(e){var t,r;return(null==(r=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[sB])?void 0:r.stringValue)===sj}function sq(e,t){let r={fields:{[sB]:{stringValue:sj},[sV]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&sz(t)&&(t=s$(t)),t&&(r.fields[sU]=t),{mapValue:r}}function s$(e){let t=e.mapValue.fields[sU];return sz(t)?s$(t):t}function sG(e){let t=sM(e.mapValue.fields[sV].timestampValue);return new nv(t.seconds,t.nanos)}class sH{constructor(e,t,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}let sW="(default)";class sK{constructor(e,t){this.projectId=e,this.database=t||sW}static empty(){return new sK("","")}get isDefaultDatabase(){return this.database===sW}isEqual(e){return e instanceof sK&&e.projectId===this.projectId&&e.database===this.database}}function sQ(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new r4(r6.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sK(e.options.projectId,t)}let sY=-1;function sJ(e){return null==e}function sX(e){return 0===e&&1/e==-1/0}function sZ(e){return"number"==typeof e&&Number.isInteger(e)&&!sX(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}let s0="__type__",s1="__max__",s2={mapValue:{fields:{__type__:{stringValue:s1}}}},s3="__vector__",s6="value",s4={nullValue:"NULL_VALUE"};function s5(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?sz(e)?4:aP(e)?0x1fffffffffffff:aD(e)?10:11:r0(28295,{value:e})}function s8(e,t){if(e===t)return!0;let r=s5(e);if(r!==s5(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return sG(e).isEqual(sG(t));case 3:return s7(e,t);case 5:return e.stringValue===t.stringValue;case 6:return ae(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return s9(e,t);case 2:return at(e,t);case 9:return np(e.arrayValue.values||[],t.arrayValue.values||[],s8);case 10:case 11:return ar(e,t);default:return r0(52216,{left:e})}}function s7(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let r=sM(e.timestampValue),n=sM(t.timestampValue);return r.seconds===n.seconds&&r.nanos===n.nanos}function s9(e,t){return sL(e.geoPointValue.latitude)===sL(t.geoPointValue.latitude)&&sL(e.geoPointValue.longitude)===sL(t.geoPointValue.longitude)}function ae(e,t){return sF(e.bytesValue).isEqual(sF(t.bytesValue))}function at(e,t){if("integerValue"in e&&"integerValue"in t)return sL(e.integerValue)===sL(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=sL(e.doubleValue),n=sL(t.doubleValue);return r===n?sX(r)===sX(n):isNaN(r)&&isNaN(n)}return!1}function ar(e,t){let r=e.mapValue.fields||{},n=t.mapValue.fields||{};if(sg(r)!==sg(n))return!1;for(let e in r)if(r.hasOwnProperty(e)&&(void 0===n[e]||!s8(r[e],n[e])))return!1;return!0}function an(e,t){return void 0!==(e.values||[]).find(e=>s8(e,t))}function ai(e,t){if(e===t)return 0;let r=s5(e),n=s5(t);if(r!==n)return nu(r,n);switch(r){case 0:case 0x1fffffffffffff:return 0;case 1:return nu(e.booleanValue,t.booleanValue);case 2:return as(e,t);case 3:return aa(e.timestampValue,t.timestampValue);case 4:return aa(sG(e),sG(t));case 5:return nd(e.stringValue,t.stringValue);case 6:return ac(e.bytesValue,t.bytesValue);case 7:return ao(e.referenceValue,t.referenceValue);case 8:return al(e.geoPointValue,t.geoPointValue);case 9:return au(e.arrayValue,t.arrayValue);case 10:return ad(e.mapValue,t.mapValue);case 11:return ah(e.mapValue,t.mapValue);default:throw r0(23264,{leftType:r})}}function as(e,t){let r=sL(e.integerValue||e.doubleValue),n=sL(t.integerValue||t.doubleValue);return r<n?-1:r>n?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1}function aa(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return nu(e,t);let r=sM(e),n=sM(t),i=nu(r.seconds,n.seconds);return 0!==i?i:nu(r.nanos,n.nanos)}function ao(e,t){let r=e.split("/"),n=t.split("/");for(let e=0;e<r.length&&e<n.length;e++){let t=nu(r[e],n[e]);if(0!==t)return t}return nu(r.length,n.length)}function al(e,t){let r=nu(sL(e.latitude),sL(t.latitude));return 0!==r?r:nu(sL(e.longitude),sL(t.longitude))}function ac(e,t){let r=sF(e),n=sF(t);return r.compareTo(n)}function au(e,t){let r=e.values||[],n=t.values||[];for(let e=0;e<r.length&&e<n.length;++e){let t=ai(r[e],n[e]);if(t)return t}return nu(r.length,n.length)}function ad(e,t){var r,n,i,s;let a=e.fields||{},o=t.fields||{},l=null==(r=a[s6])?void 0:r.arrayValue,c=null==(n=o[s6])?void 0:n.arrayValue,u=nu((null==(i=null==l?void 0:l.values)?void 0:i.length)||0,(null==(s=null==c?void 0:c.values)?void 0:s.length)||0);return 0!==u?u:au(l,c)}function ah(e,t){if(e===s2.mapValue&&t===s2.mapValue)return 0;if(e===s2.mapValue)return 1;if(t===s2.mapValue)return -1;let r=e.fields||{},n=Object.keys(r),i=t.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let e=0;e<n.length&&e<s.length;++e){let t=nd(n[e],s[e]);if(0!==t)return t;let a=ai(r[n[e]],i[s[e]]);if(0!==a)return a}return nu(n.length,s.length)}function af(e){return ap(e)}function ap(e){if("nullValue"in e)return"null";if("booleanValue"in e)return""+e.booleanValue;if("integerValue"in e)return""+e.integerValue;if("doubleValue"in e)return""+e.doubleValue;if("timestampValue"in e)return ag(e.timestampValue);else if("stringValue"in e)return e.stringValue;else if("bytesValue"in e)return am(e.bytesValue);else if("referenceValue"in e)return av(e.referenceValue);else if("geoPointValue"in e)return ay(e.geoPointValue);else if("arrayValue"in e)return aS(e.arrayValue);else if("mapValue"in e)return ab(e.mapValue);else return r0(61005,{value:e})}function am(e){return sF(e).toBase64()}function ag(e){let t=sM(e);return`time(${t.seconds},${t.nanos})`}function ay(e){return`geo(${e.latitude},${e.longitude})`}function av(e){return n_.fromName(e).toString()}function ab(e){let t=Object.keys(e.fields||{}).sort(),r="{",n=!0;for(let i of t)n?n=!1:r+=",",r+=`${i}:${ap(e.fields[i])}`;return r+"}"}function aS(e){let t="[",r=!0;for(let n of e.values||[])r?r=!1:t+=",",t+=ap(n);return t+"]"}function aw(e){switch(s5(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let t=s$(e);return t?16+aw(t):16;case 5:return 2*e.stringValue.length;case 6:return sF(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return aE(e.arrayValue);case 10:case 11:return aT(e.mapValue);default:throw r0(13486,{value:e})}}function aT(e){let t=0;return sy(e.fields,(e,r)=>{t+=e.length+aw(r)}),t}function aE(e){return(e.values||[]).reduce((e,t)=>e+aw(t),0)}function aC(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function a_(e){return!!e&&"integerValue"in e}function aI(e){return!!e&&"doubleValue"in e}function ax(e){return a_(e)||aI(e)}function aR(e){return!!e&&"arrayValue"in e}function ak(e){return!!e&&"nullValue"in e}function aA(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function aN(e){return!!e&&"mapValue"in e}function aD(e){var t,r;return(null==(r=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[s0])?void 0:r.stringValue)===s3}function aO(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){let t={mapValue:{fields:{}}};return sy(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=aO(r)),t}{if(!e.arrayValue)return Object.assign({},e);let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=aO(e.arrayValue.values[r]);return t}}function aP(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===s1}let aM={mapValue:{fields:{[s0]:{stringValue:s3},[s6]:{arrayValue:{}}}}};function aL(e){if("nullValue"in e)return s4;if("booleanValue"in e)return{booleanValue:!1};if("integerValue"in e||"doubleValue"in e)return{doubleValue:NaN};if("timestampValue"in e)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in e)return{stringValue:""};else if("bytesValue"in e)return{bytesValue:""};else if("referenceValue"in e)return aC(sK.empty(),n_.empty());else if("geoPointValue"in e)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in e)return{arrayValue:{}};else if(!("mapValue"in e))return r0(35942,{value:e});else return aD(e)?aM:{mapValue:{}}}function aF(e){if("nullValue"in e)return{booleanValue:!1};if("booleanValue"in e)return{doubleValue:NaN};if("integerValue"in e||"doubleValue"in e)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in e)return{stringValue:""};if("stringValue"in e)return{bytesValue:""};else if("bytesValue"in e)return aC(sK.empty(),n_.empty());else if("referenceValue"in e)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in e)return{arrayValue:{}};else if("arrayValue"in e)return aM;else if(!("mapValue"in e))return r0(61959,{value:e});else return aD(e)?{mapValue:{}}:s2}function aj(e,t){let r=ai(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function aB(e,t){let r=ai(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class aU{constructor(e){this.value=e}static empty(){return new aU({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!aN(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=aO(t)}setAll(e){let t=nC.emptyPath(),r={},n=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=i.popLast()}e?r[i.lastSegment()]=aO(e):n.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,r,n)}delete(e){let t=this.field(e.popLast());aN(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return s8(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];aN(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){for(let n of(sy(t,(t,r)=>e[t]=r),r))delete e[n]}clone(){return new aU(aO(this.value))}}function aV(e){let t=[];return sy(e.fields,(e,r)=>{let n=new nC([e]);if(aN(r)){let e=aV(r.mapValue).fields;if(0===e.length)t.push(n);else for(let r of e)t.push(n.child(r))}else t.push(n)}),new sR(t)}class az{constructor(e,t,r,n,i,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new az(e,0,nb.min(),nb.min(),nb.min(),aU.empty(),0)}static newFoundDocument(e,t,r,n){return new az(e,1,t,nb.min(),r,n,0)}static newNoDocument(e,t){return new az(e,2,t,nb.min(),nb.min(),aU.empty(),0)}static newUnknownDocument(e,t){return new az(e,3,t,nb.min(),nb.min(),aU.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(nb.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=aU.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=aU.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=nb.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof az&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new az(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function aq(e,t,r){let n=t.data.field(e),i=r.data.field(e);return null!==n&&null!==i?ai(n,i):r0(42886)}class a${constructor(e,t){this.position=e,this.inclusive=t}}function aG(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){let s=t[i],a=e.position[i];if(n=s.field.isKeyField()?n_.comparator(n_.fromName(a.referenceValue),r.key):ai(a,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function aH(e,t,r){let n=aG(e,t,r);return e.inclusive?n>=0:n>0}function aW(e,t,r){let n=aG(e,t,r);return e.inclusive?n<=0:n<0}function aK(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!s8(e.position[r],t.position[r]))return!1;return!0}class aQ{constructor(e,t="asc"){this.field=e,this.dir=t}}function aY(e){return e.field.canonicalString()+e.dir}function aJ(e){return`${e.field.canonicalString()} (${e.dir})`}function aX(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class aZ{}class a0 extends aZ{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){if(e.isKeyField())if("in"===t||"not-in"===t)return this.createKeyFieldInFilter(e,t,r);else return new oi(e,t,r);if("array-contains"===t)return new ol(e,r);if("in"===t)return new oc(e,r);if("not-in"===t)return new ou(e,r);if("array-contains-any"===t)return new od(e,r);else return new a0(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new os(e,r):new oa(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(ai(t,this.value)):null!==t&&s5(this.value)===s5(t)&&this.matchesComparison(ai(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return r0(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class a1 extends aZ{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new a1(e,t)}matches(e){return a2(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function a2(e){return"and"===e.op}function a3(e){return"or"===e.op}function a6(e){return a4(e)&&a2(e)}function a4(e){for(let t of e.filters)if(t instanceof a1)return!1;return!0}function a5(e){if(e instanceof a0)return e.field.canonicalString()+e.op.toString()+af(e.value);{if(a6(e))return e.filters.map(e=>a5(e)).join(",");let t=e.filters.map(e=>a5(e)).join(",");return`${e.op}(${t})`}}function a8(e,t){return e instanceof a0?a7(e,t):e instanceof a1?a9(e,t):void r0(19439)}function a7(e,t){return t instanceof a0&&e.op===t.op&&e.field.isEqual(t.field)&&s8(e.value,t.value)}function a9(e,t){return t instanceof a1&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,r,n)=>e&&a8(r,t.filters[n]),!0)}function oe(e,t){let r=e.filters.concat(t);return a1.create(r,e.op)}function ot(e){return e instanceof a0?on(e):e instanceof a1?or(e):"Filter"}function or(e){return e.op.toString()+" {"+e.getFilters().map(ot).join(" ,")+"}"}function on(e){return`${e.field.canonicalString()} ${e.op} ${af(e.value)}`}class oi extends a0{constructor(e,t,r){super(e,t,r),this.key=n_.fromName(r.referenceValue)}matches(e){let t=n_.comparator(e.key,this.key);return this.matchesComparison(t)}}class os extends a0{constructor(e,t){super(e,"in",t),this.keys=oo("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class oa extends a0{constructor(e,t){super(e,"not-in",t),this.keys=oo("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function oo(e,t){var r;return((null==(r=t.arrayValue)?void 0:r.values)||[]).map(e=>n_.fromName(e.referenceValue))}class ol extends a0{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return aR(t)&&an(t.arrayValue,this.value)}}class oc extends a0{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&an(this.value.arrayValue,t)}}class ou extends a0{constructor(e,t){super(e,"not-in",t)}matches(e){if(an(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!an(this.value.arrayValue,t)}}class od extends a0{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!!aR(t)&&!!t.arrayValue.values&&t.arrayValue.values.some(e=>an(this.value.arrayValue,e))}}class oh{constructor(e,t=null,r=[],n=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.memoizedCanonicalId=null}}function of(e,t=null,r=[],n=[],i=null,s=null,a=null){return new oh(e,t,r,n,i,s,a)}function op(e){let t=r3(e);if(null===t.memoizedCanonicalId){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>a5(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>aY(e)).join(","),sJ(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>af(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>af(e)).join(",")),t.memoizedCanonicalId=e}return t.memoizedCanonicalId}function om(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>ot(e)).join(", ")}]`),sJ(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>aJ(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>af(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>af(e)).join(",")),`Target(${t})`}function og(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!aX(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!a8(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!aK(e.startAt,t.startAt)&&aK(e.endAt,t.endAt)}function oy(e){return n_.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function ov(e,t){return e.filters.filter(e=>e instanceof a0&&e.field.isEqual(t))}function ob(e,t){let r=nk(t);if(void 0===r)return null;for(let t of ov(e,r.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}function oS(e,t){let r=new Map;for(let n of nA(t))for(let t of ov(e,n.fieldPath))switch(t.op){case"==":case"in":r.set(n.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return r.set(n.fieldPath.canonicalString(),t.value),Array.from(r.values())}return null}function ow(e,t){let r=[],n=!0;for(let i of nA(t)){let t=0===i.kind?oE(e,i.fieldPath,e.startAt):oC(e,i.fieldPath,e.startAt);r.push(t.value),n&&(n=t.inclusive)}return new a$(r,n)}function oT(e,t){let r=[],n=!0;for(let i of nA(t)){let t=0===i.kind?oC(e,i.fieldPath,e.endAt):oE(e,i.fieldPath,e.endAt);r.push(t.value),n&&(n=t.inclusive)}return new a$(r,n)}function oE(e,t,r){let n=s4,i=!0;for(let r of ov(e,t)){let e=s4,t=!0;switch(r.op){case"<":case"<=":e=aL(r.value);break;case"==":case"in":case">=":e=r.value;break;case">":e=r.value,t=!1;break;case"!=":case"not-in":e=s4}0>aj({value:n,inclusive:i},{value:e,inclusive:t})&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];0>aj({value:n,inclusive:i},{value:e,inclusive:r.inclusive})&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}function oC(e,t,r){let n=s2,i=!0;for(let r of ov(e,t)){let e=s2,t=!0;switch(r.op){case">=":case">":e=aF(r.value),t=!1;break;case"==":case"in":case"<=":e=r.value;break;case"<":e=r.value,t=!1;break;case"!=":case"not-in":e=s2}aB({value:n,inclusive:i},{value:e,inclusive:t})>0&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];aB({value:n,inclusive:i},{value:e,inclusive:r.inclusive})>0&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}function o_(e){let t=new sC(nC.comparator),r=!1;for(let n of e.filters)for(let e of n.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?r=!0:t=t.add(e.field));for(let r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+ +!!r}function oI(e){return null!==e.limit}class ox{constructor(e,t=null,r=[],n=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function oR(e,t,r,n,i,s,a,o){return new ox(e,t,r,n,i,s,a,o)}function ok(e){return new ox(e)}function oA(e,t){return new ox(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function oN(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function oD(e){let t=new sC(nC.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}function oO(e){return n_.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function oP(e){return null!==e.collectionGroup}function oM(e){let t=r3(e);if(null===t.memoizedNormalizedOrderBy){t.memoizedNormalizedOrderBy=[];let e=new Set;for(let r of t.explicitOrderBy)t.memoizedNormalizedOrderBy.push(r),e.add(r.field.canonicalString());let r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";oD(t).forEach(n=>{e.has(n.canonicalString())||n.isKeyField()||t.memoizedNormalizedOrderBy.push(new aQ(n,r))}),e.has(nC.keyField().canonicalString())||t.memoizedNormalizedOrderBy.push(new aQ(nC.keyField(),r))}return t.memoizedNormalizedOrderBy}function oL(e){let t=r3(e);return t.memoizedTarget||(t.memoizedTarget=oj(t,oM(e))),t.memoizedTarget}function oF(e){let t=r3(e);return t.memoizedAggregateTarget||(t.memoizedAggregateTarget=oj(t,e.explicitOrderBy)),t.memoizedAggregateTarget}function oj(e,t){if("F"===e.limitType)return of(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new aQ(e.field,t)});let r=e.endAt?new a$(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new a$(e.startAt.position,e.startAt.inclusive):null;return of(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function oB(e,t){let r=e.filters.concat([t]);return new ox(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function oU(e,t){let r=e.explicitOrderBy.concat([t]);return new ox(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function oV(e,t,r){return new ox(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function oz(e,t){return new ox(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}function oq(e,t){return new ox(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}function o$(e,t){return og(oL(e),oL(t))&&e.limitType===t.limitType}function oG(e){return`${op(oL(e))}|lt:${e.limitType}`}function oH(e){return`Query(target=${om(oL(e))}; limitType=${e.limitType})`}function oW(e,t){return t.isFoundDocument()&&oK(e,t)&&oQ(e,t)&&oY(e,t)&&oJ(e,t)}function oK(e,t){let r=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):n_.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}function oQ(e,t){for(let r of oM(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}function oY(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}function oJ(e,t){return(!e.startAt||!!aW(e.startAt,oM(e),t))&&(!e.endAt||!!aH(e.endAt,oM(e),t))}function oX(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function oZ(e){return(t,r)=>{let n=!1;for(let i of oM(e)){let e=o0(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}function o0(e,t,r){let n=e.field.isKeyField()?n_.comparator(t.key,r.key):aq(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return -1*n;default:return r0(19790,{direction:e.dir})}}class o1{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,n]of r)if(this.equalsFn(t,e))return n}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n){this.inner[r]=[[e,t]],this.innerSize++;return}for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e)){n[r]=[e,t];return}n.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){sy(this.inner,(t,r)=>{for(let[t,n]of r)e(t,n)})}isEmpty(){return sb(this.inner)}size(){return this.innerSize}}let o2=new sS(n_.comparator);function o3(){return o2}let o6=new sS(n_.comparator);function o4(...e){let t=o6;for(let r of e)t=t.insert(r.key,r);return t}function o5(){return le()}function o8(e){let t=o6;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function o7(){return le()}function o9(){return le()}function le(){return new o1(e=>e.toString(),(e,t)=>e.isEqual(t))}let lt=new sS(n_.comparator);function lr(){return lt}let ln=new sC(n_.comparator);function li(...e){let t=ln;for(let r of e)t=t.add(r);return t}let ls=new sC(nu);function la(){return ls}function lo(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};else if(t===1/0)return{doubleValue:"Infinity"};else if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sX(t)?"-0":t}}function ll(e){return{integerValue:""+e}}function lc(e,t){return sZ(t)?ll(t):lo(e,t)}class lu{constructor(){this._=void 0}}function ld(e,t,r){return e instanceof lm?sq(r,t):e instanceof lg?ly(e,t):e instanceof lv?lb(e,t):lw(e,t)}function lh(e,t,r){return e instanceof lg?ly(e,t):e instanceof lv?lb(e,t):r}function lf(e,t){return e instanceof lS?ax(t)?t:{integerValue:0}:null}function lp(e,t){return e instanceof lg&&t instanceof lg||e instanceof lv&&t instanceof lv?np(e.elements,t.elements,s8):e instanceof lS&&t instanceof lS?s8(e.operand,t.operand):e instanceof lm&&t instanceof lm}class lm extends lu{}class lg extends lu{constructor(e){super(),this.elements=e}}function ly(e,t){let r=lE(t);for(let t of e.elements)r.some(e=>s8(e,t))||r.push(t);return{arrayValue:{values:r}}}class lv extends lu{constructor(e){super(),this.elements=e}}function lb(e,t){let r=lE(t);for(let t of e.elements)r=r.filter(e=>!s8(e,t));return{arrayValue:{values:r}}}class lS extends lu{constructor(e,t){super(),this.serializer=e,this.operand=t}}function lw(e,t){let r=lf(e,t),n=lT(r)+lT(e.operand);return a_(r)&&a_(e.operand)?ll(n):lo(e.serializer,n)}function lT(e){return sL(e.integerValue||e.doubleValue)}function lE(e){return aR(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class lC{constructor(e,t){this.field=e,this.transform=t}}function l_(e,t){return e.field.isEqual(t.field)&&lp(e.transform,t.transform)}function lI(e,t){return void 0===e&&void 0===t||!!e&&!!t&&np(e,t,(e,t)=>l_(e,t))}class lx{constructor(e,t){this.version=e,this.transformResults=t}}class lR{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new lR}static exists(e){return new lR(void 0,e)}static updateTime(e){return new lR(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lk(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class lA{}function lN(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)if(e.isNoDocument())return new lG(e.key,lR.none());else return new lL(e.key,e.data,lR.none());{let r=e.data,n=aU.empty(),i=new sC(nC.comparator);for(let e of t.fields)if(!i.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),i=i.add(e)}return new lB(e.key,n,new sR(i.toArray()),lR.none())}}function lD(e,t,r){e instanceof lL?lF(e,t,r):e instanceof lB?lU(e,t,r):lH(e,t,r)}function lO(e,t,r,n){return e instanceof lL?lj(e,t,r,n):e instanceof lB?lV(e,t,r,n):lW(e,t,r)}function lP(e,t){let r=null;for(let n of e.fieldTransforms){let e=t.data.field(n.field),i=lf(n.transform,e||null);null!=i&&(null===r&&(r=aU.empty()),r.set(n.field,i))}return r||null}function lM(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!lI(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class lL extends lA{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}function lF(e,t,r){let n=e.value.clone(),i=lq(e.fieldTransforms,t,r.transformResults);n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}function lj(e,t,r,n){if(!lk(e.precondition,t))return r;let i=e.value.clone(),s=l$(e.fieldTransforms,n,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}class lB extends lA{constructor(e,t,r,n,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function lU(e,t,r){if(!lk(e.precondition,t))return void t.convertToUnknownDocument(r.version);let n=lq(e.fieldTransforms,t,r.transformResults),i=t.data;i.setAll(lz(e)),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}function lV(e,t,r,n){if(!lk(e.precondition,t))return r;let i=l$(e.fieldTransforms,n,t),s=t.data;return(s.setAll(lz(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}function lz(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=e.data.field(r);t.set(r,n)}}),t}function lq(e,t,r){let n=new Map;r2(e.length===r.length,32656,{serverTransformResultCount:r.length,fieldTransformCount:e.length});for(let i=0;i<r.length;i++){let s=e[i],a=s.transform,o=t.data.field(s.field);n.set(s.field,lh(a,o,r[i]))}return n}function l$(e,t,r){let n=new Map;for(let i of e){let e=i.transform,s=r.data.field(i.field);n.set(i.field,ld(e,s,t))}return n}class lG extends lA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function lH(e,t,r){t.convertToNoDocument(r.version).setHasCommittedMutations()}function lW(e,t,r){return lk(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}class lK extends lA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class lQ{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let n=this.mutations[t];n.key.isEqual(e.key)&&lD(n,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=lO(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=lO(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=o9();return this.mutations.forEach(n=>{let i=e.get(n.key),s=i.overlayedDocument,a=this.applyToLocalView(s,i.mutatedFields),o=lN(s,a=t.has(n.key)?null:a);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument(nb.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),li())}isEqual(e){return this.batchId===e.batchId&&np(this.mutations,e.mutations,(e,t)=>lM(e,t))&&np(this.baseMutations,e.baseMutations,(e,t)=>lM(e,t))}}class lY{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){r2(e.mutations.length===r.length,58842,{mutationsSent:e.mutations.length,resultsReceived:r.length});let n=lr(),i=e.mutations;for(let e=0;e<i.length;e++)n=n.insert(i[e].key,r[e].version);return new lY(e,t,r,n)}}class lJ{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class lX{constructor(e,t){this.count=e,this.unchangedNames=t}}function lZ(e){switch(e){case r6.OK:return r0(64938);case r6.CANCELLED:case r6.UNKNOWN:case r6.DEADLINE_EXCEEDED:case r6.RESOURCE_EXHAUSTED:case r6.INTERNAL:case r6.UNAVAILABLE:case r6.UNAUTHENTICATED:return!1;case r6.INVALID_ARGUMENT:case r6.NOT_FOUND:case r6.ALREADY_EXISTS:case r6.PERMISSION_DENIED:case r6.FAILED_PRECONDITION:case r6.ABORTED:case r6.OUT_OF_RANGE:case r6.UNIMPLEMENTED:case r6.DATA_LOSS:return!0;default:return r0(15467,{code:e})}}function l0(e){return lZ(e)&&e!==r6.ABORTED}function l1(e){if(void 0===e)return rJ("GRPC error has no .code"),r6.UNKNOWN;switch(e){case l.OK:return r6.OK;case l.CANCELLED:return r6.CANCELLED;case l.UNKNOWN:return r6.UNKNOWN;case l.DEADLINE_EXCEEDED:return r6.DEADLINE_EXCEEDED;case l.RESOURCE_EXHAUSTED:return r6.RESOURCE_EXHAUSTED;case l.INTERNAL:return r6.INTERNAL;case l.UNAVAILABLE:return r6.UNAVAILABLE;case l.UNAUTHENTICATED:return r6.UNAUTHENTICATED;case l.INVALID_ARGUMENT:return r6.INVALID_ARGUMENT;case l.NOT_FOUND:return r6.NOT_FOUND;case l.ALREADY_EXISTS:return r6.ALREADY_EXISTS;case l.PERMISSION_DENIED:return r6.PERMISSION_DENIED;case l.FAILED_PRECONDITION:return r6.FAILED_PRECONDITION;case l.ABORTED:return r6.ABORTED;case l.OUT_OF_RANGE:return r6.OUT_OF_RANGE;case l.UNIMPLEMENTED:return r6.UNIMPLEMENTED;case l.DATA_LOSS:return r6.DATA_LOSS;default:return r0(39323,{code:e})}}!function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS"}(l||(l={}));class l2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}let l3=null;function l6(e){if(l3)throw Error("a TestingHooksSpi instance is already set");l3=e}let l4=new a([0xffffffff,0xffffffff],0);function l5(e){let t=no().encode(e),r=new o;return r.update(t),new Uint8Array(r.digest())}function l8(e){let t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new a([r,n],0),new a([i,s],0)]}class l7{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new l9(`Invalid padding: ${t}`);if(r<0||e.length>0&&0===this.hashCount)throw new l9(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new l9(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=8*e.length-t,this.bitCountInInteger=a.fromNumber(this.bitCount)}getBitIndex(e,t,r){let n=e.add(t.multiply(a.fromNumber(r)));return 1===n.compare(l4)&&(n=new a([n.getBits(0),n.getBits(1)],0)),n.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(0===this.bitCount)return!1;let[t,r]=l8(l5(e));for(let e=0;e<this.hashCount;e++){let n=this.getBitIndex(t,r,e);if(!this.isBitSet(n))return!1}return!0}static create(e,t,r){let n=e%8==0?0:8-e%8,i=new l7(new Uint8Array(Math.ceil(e/8)),n,t);return r.forEach(e=>i.insert(e)),i}insert(e){if(0===this.bitCount)return;let[t,r]=l8(l5(e));for(let e=0;e<this.hashCount;e++){let n=this.getBitIndex(t,r,e);this.setBit(n)}}setBit(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class l9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ce{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let n=new Map;return n.set(e,ct.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ce(nb.min(),n,new sS(nu),o3(),li())}}class ct{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ct(r,t,li(),li(),li())}}class cr{constructor(e,t,r,n){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=r,this.newDoc=n}}class cn{constructor(e,t){this.targetId=e,this.existenceFilter=t}}class ci{constructor(e,t,r=sN.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class cs{constructor(){this.pendingResponses=0,this.documentChanges=cc(),this._resumeToken=sN.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=li(),t=li(),r=li();return this.documentChanges.forEach((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:r0(38017,{changeType:i})}}),new ct(this._resumeToken,this._current,e,t,r)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=cc()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,r2(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let ca="WatchChangeAggregator";class co{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=o3(),this.pendingDocumentUpdatesByTarget=cl(),this.pendingDocumentTargetMapping=cl(),this.pendingTargetResets=new sS(nu)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let r=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&r.updateResumeToken(e.resumeToken);break;case 1:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case 2:r.recordTargetResponse(),r.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),r.updateResumeToken(e.resumeToken));break;default:r0(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((e,r)=>{this.isActiveTarget(r)&&t(r)})}handleExistenceFilter(e){let t=e.targetId,r=e.existenceFilter.count,n=this.targetDataForActiveTarget(t);if(n){let i=n.target;if(oy(i))if(0===r){let e=new n_(i.path);this.removeDocumentFromTarget(t,e,az.newNoDocument(e,nb.min()))}else r2(1===r,20013,{expectedCount:r});else{let n=this.getCurrentDocumentCountForTarget(t);if(n!==r){let r=this.parseBloomFilter(e),i=r?this.applyBloomFilter(r,e,n):1;if(0!==i){this.resetTarget(t);let e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,e)}null==l3||l3.notifyOnExistenceFilterMismatch(cu(n,e.existenceFilter,this.metadataProvider.getDatabaseId(),r,i))}}}}parseBloomFilter(e){let t,r,n=e.existenceFilter.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=n;try{t=sF(i).toUint8Array()}catch(e){if(e instanceof l2)return rX("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new l7(t,s,a)}catch(e){return e instanceof l9?rX("BloomFilter error: ",e):rX("Applying bloom filter failed: ",e),null}return 0===r.bitCount?null:r}applyBloomFilter(e,t,r){return 2*(t.existenceFilter.count!==r-this.filterRemovedDocuments(e,t.targetId))}filterRemovedDocuments(e,t){let r=this.metadataProvider.getRemoteKeysForTarget(t),n=0;return r.forEach(r=>{let i=this.metadataProvider.getDatabaseId(),s=`projects/${i.projectId}/databases/${i.database}/documents/${r.path.canonicalString()}`;!e.mightContain(s)&&(this.removeDocumentFromTarget(t,r,null),n++)}),n}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((r,n)=>{let i=this.targetDataForActiveTarget(n);if(i){if(r.current&&oy(i.target)){let t=new n_(i.target.path);this.ensureDocumentUpdateByTarget(t).has(n)||this.targetContainsDocument(n,t)||this.removeDocumentFromTarget(n,t,az.newNoDocument(t,e))}r.hasPendingChanges&&(t.set(n,r.toTargetChange()),r.clearPendingChanges())}});let r=li();this.pendingDocumentTargetMapping.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{let t=this.targetDataForActiveTarget(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)}),n&&(r=r.add(e))}),this.pendingDocumentUpdates.forEach((t,r)=>r.setReadTime(e));let n=new ce(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=o3(),this.pendingDocumentUpdatesByTarget=cl(),this.pendingDocumentTargetMapping=cl(),this.pendingTargetResets=new sS(nu),n}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let r=2*!!this.targetContainsDocument(e,t.key);this.ensureTargetState(e).addDocumentChange(t.key,r),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(t.key,this.ensureDocumentUpdateByTarget(t.key).add(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,r){if(!this.isActiveTarget(e))return;let n=this.ensureTargetState(e);this.targetContainsDocument(e,t)?n.addDocumentChange(t,1):n.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).add(e)),r&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,r))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new cs,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new sC(nu),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}ensureDocumentUpdateByTarget(e){let t=this.pendingDocumentUpdatesByTarget.get(e);return t||(t=new sC(nu),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(e,t)),t}isActiveTarget(e){let t=null!==this.targetDataForActiveTarget(e);return t||rY(ca,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new cs),this.metadataProvider.getRemoteKeysForTarget(e).forEach(t=>{this.removeDocumentFromTarget(e,t,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}}function cl(){return new sS(n_.comparator)}function cc(){return new sS(n_.comparator)}function cu(e,t,r,n,i){var s,a,o,l,c,u;let d={localCacheCount:e,existenceFilterCount:t.count,databaseId:r.database,projectId:r.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!=(s=null==h?void 0:h.hashCount)?s:0,bitmapLength:null!=(l=null==(o=null==(a=null==h?void 0:h.bits)?void 0:a.bitmap)?void 0:o.length)?l:0,padding:null!=(u=null==(c=null==h?void 0:h.bits)?void 0:c.padding)?u:0,mightContain:e=>{var t;return null!=(t=null==n?void 0:n.mightContain(e))&&t}}),d}let cd=(()=>{let e={};return e.asc="ASCENDING",e.desc="DESCENDING",e})(),ch=(()=>{let e={};return e["<"]="LESS_THAN",e["<="]="LESS_THAN_OR_EQUAL",e[">"]="GREATER_THAN",e[">="]="GREATER_THAN_OR_EQUAL",e["=="]="EQUAL",e["!="]="NOT_EQUAL",e["array-contains"]="ARRAY_CONTAINS",e.in="IN",e["not-in"]="NOT_IN",e["array-contains-any"]="ARRAY_CONTAINS_ANY",e})(),cf=(()=>{let e={};return e.and="AND",e.or="OR",e})();class cp{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function cm(e){return new r4(void 0===e.code?r6.UNKNOWN:l1(e.code),e.message||"")}function cg(e,t){return e.useProto3Json||sJ(t)?t:{value:t}}function cy(e){let t;return sJ(t="object"==typeof e?e.value:e)?null:t}function cv(e,t){if(!e.useProto3Json)return{seconds:""+t.seconds,nanos:t.nanoseconds};{let e=new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+t.nanoseconds).slice(-9);return`${e}.${r}Z`}}function cb(e){let t=sM(e);return new nv(t.seconds,t.nanos)}function cS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function cw(e,t){return e.useProto3Json?(r2(void 0===t||"string"==typeof t,58123),sN.fromBase64String(t||"")):(r2(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),sN.fromUint8Array(t||new Uint8Array))}function cT(e,t){return cv(e,t.toTimestamp())}function cE(e){return r2(!!e,49232),nb.fromTimestamp(cb(e))}function cC(e,t){return c_(e,t).canonicalString()}function c_(e,t){let r=cD(e).child("documents");return void 0===t?r:r.child(t)}function cI(e){let t=nT.fromString(e);return r2(uE(t),10190,{key:t.toString()}),t}function cx(e,t){return cC(e.databaseId,t.path)}function cR(e,t){let r=cI(t);if(r.get(1)!==e.databaseId.projectId)throw new r4(r6.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new r4(r6.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new n_(cO(r))}function ck(e,t){return cC(e.databaseId,t)}function cA(e){let t=cI(e);return 4===t.length?nT.emptyPath():cO(t)}function cN(e){return new nT(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function cD(e){return new nT(["projects",e.projectId,"databases",e.database])}function cO(e){return r2(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function cP(e,t,r){return{name:cx(e,t),fields:r.value.mapValue.fields}}function cM(e,t){return{name:cx(e,t.key),fields:t.data.value.mapValue.fields,updateTime:cv(e,t.version.toTimestamp()),createTime:cv(e,t.createTime.toTimestamp())}}function cL(e,t,r){let n=cR(e,t.name),i=cE(t.updateTime),s=t.createTime?cE(t.createTime):nb.min(),a=new aU({mapValue:{fields:t.fields}}),o=az.newFoundDocument(n,i,s,a);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function cF(e,t){r2(!!t.found,43571),t.found.name,t.found.updateTime;let r=cR(e,t.found.name),n=cE(t.found.updateTime),i=t.found.createTime?cE(t.found.createTime):nb.min(),s=new aU({mapValue:{fields:t.found.fields}});return az.newFoundDocument(r,n,i,s)}function cj(e,t){r2(!!t.missing,3894),r2(!!t.readTime,22933);let r=cR(e,t.missing),n=cE(t.readTime);return az.newNoDocument(r,n)}function cB(e,t){return"found"in t?cF(e,t):"missing"in t?cj(e,t):r0(7234,{result:t})}function cU(e,t){let r;if("targetChange"in t){t.targetChange;let n=cV(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=cw(e,t.targetChange.resumeToken),a=t.targetChange.cause;r=new ci(n,i,s,a&&cm(a)||null)}else if("documentChange"in t){t.documentChange;let n=t.documentChange;n.document,n.document.name,n.document.updateTime;let i=cR(e,n.document.name),s=cE(n.document.updateTime),a=n.document.createTime?cE(n.document.createTime):nb.min(),o=new aU({mapValue:{fields:n.document.fields}}),l=az.newFoundDocument(i,s,a,o);r=new cr(n.targetIds||[],n.removedTargetIds||[],l.key,l)}else if("documentDelete"in t){t.documentDelete;let n=t.documentDelete;n.document;let i=cR(e,n.document),s=n.readTime?cE(n.readTime):nb.min(),a=az.newNoDocument(i,s);r=new cr([],n.removedTargetIds||[],a.key,a)}else if("documentRemove"in t){t.documentRemove;let n=t.documentRemove;n.document;let i=cR(e,n.document);r=new cr([],n.removedTargetIds||[],i,null)}else{if(!("filter"in t))return r0(11601,{change:t});t.filter;let e=t.filter;e.targetId;let{count:n=0,unchangedNames:i}=e,s=new lX(n,i);r=new cn(e.targetId,s)}return r}function cV(e){if("NO_CHANGE"===e)return 0;if("ADD"===e)return 1;if("REMOVE"===e)return 2;if("CURRENT"===e)return 3;if("RESET"===e)return 4;else return r0(39313,{state:e})}function cz(e){if(!("targetChange"in e))return nb.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length||!t.readTime?nb.min():cE(t.readTime)}function cq(e,t){let r;if(t instanceof lL)r={update:cP(e,t.key,t.value)};else if(t instanceof lG)r={delete:cx(e,t.key)};else if(t instanceof lB)r={update:cP(e,t.key,t.data),updateMask:uw(t.fieldMask)};else{if(!(t instanceof lK))return r0(16599,{mutationType:t.type});r={verify:cx(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(t=>cQ(e,t))),t.precondition.isNone||(r.currentDocument=cG(e,t.precondition)),r}function c$(e,t){let r=t.currentDocument?cH(t.currentDocument):lR.none(),n=t.updateTransforms?t.updateTransforms.map(t=>cY(e,t)):[];if(t.update){t.update.name;let i=cR(e,t.update.name),s=new aU({mapValue:{fields:t.update.fields}});return t.updateMask?new lB(i,s,uT(t.updateMask),r,n):new lL(i,s,r,n)}return t.delete?new lG(cR(e,t.delete),r):t.verify?new lK(cR(e,t.verify),r):r0(1463,{proto:t})}function cG(e,t){return void 0!==t.updateTime?{updateTime:cT(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:r0(27497)}function cH(e){return void 0!==e.updateTime?lR.updateTime(cE(e.updateTime)):void 0!==e.exists?lR.exists(e.exists):lR.none()}function cW(e,t){let r=e.updateTime?cE(e.updateTime):cE(t);return r.isEqual(nb.min())&&(r=cE(t)),new lx(r,e.transformResults||[])}function cK(e,t){return e&&e.length>0?(r2(void 0!==t,14353),e.map(e=>cW(e,t))):[]}function cQ(e,t){let r=t.transform;if(r instanceof lm)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof lg)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof lv)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof lS)return{fieldPath:t.field.canonicalString(),increment:r.operand};throw r0(20930,{transform:t.transform})}function cY(e,t){let r=null;return"setToServerValue"in t?(r2("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),r=new lm):"appendMissingElements"in t?r=new lg(t.appendMissingElements.values||[]):"removeAllFromArray"in t?r=new lv(t.removeAllFromArray.values||[]):"increment"in t?r=new lS(e,t.increment):r0(16584,{proto:t}),new lC(nC.fromServerFormat(t.fieldPath),r)}function cJ(e,t){return{documents:[ck(e,t.path)]}}function cX(e){let t=e.documents.length;return r2(1===t,1966,{count:t}),oL(ok(cA(e.documents[0])))}function cZ(e,t){let r,n={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=ck(e,r);let s=c5(t.filters);s&&(n.structuredQuery.where=s);let a=c9(t.orderBy);a&&(n.structuredQuery.orderBy=a);let o=cg(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=ut(t.startAt)),t.endAt&&(n.structuredQuery.endAt=ur(t.endAt)),{queryTarget:n,parent:r}}function c0(e,t,r,n){let{queryTarget:i,parent:s}=cZ(e,t),a={},o=[],l=0;return r.forEach(e=>{let t=n?e.alias:`aggregate_${l++}`;a[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:ud(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:ud(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:i.structuredQuery},parent:i.parent},aliasMap:a,parent:s}}function c1(e){let t=cA(e.parent),r=e.structuredQuery,n=r.from?r.from.length:0,i=null;if(n>0){r2(1===n,65062);let e=r.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];r.where&&(s=c8(r.where));let a=[];r.orderBy&&(a=ue(r.orderBy));let o=null;r.limit&&(o=cy(r.limit));let l=null;r.startAt&&(l=un(r.startAt));let c=null;return r.endAt&&(c=ui(r.endAt)),oR(t,i,a,s,o,"F",l,c)}function c2(e){return oL(c1(e))}function c3(e,t){let r=c6(t.purpose);return null==r?null:{"goog-listen-tags":r}}function c6(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return r0(28987,{purpose:e})}}function c4(e,t){let r,n=t.target;if((r=oy(n)?{documents:cJ(e,n)}:{query:cZ(e,n).queryTarget}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=cS(e,t.resumeToken);let n=cg(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo(nb.min())>0){r.readTime=cv(e,t.snapshotVersion.toTimestamp());let n=cg(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}function c5(e){if(0!==e.length)return um(a1.create(e,"and"))}function c8(e){let t=c7(e);return t instanceof a1&&a6(t)?t.getFilters():[t]}function c7(e){return void 0!==e.unaryFilter?uv(e):void 0!==e.fieldFilter?ub(e):void 0!==e.compositeFilter?uS(e):r0(30097,{filter:e})}function c9(e){if(0!==e.length)return e.map(e=>uf(e))}function ue(e){return e.map(e=>up(e))}function ut(e){return{before:e.inclusive,values:e.position}}function ur(e){return{before:!e.inclusive,values:e.position}}function un(e){let t=!!e.before;return new a$(e.values||[],t)}function ui(e){let t=!e.before;return new a$(e.values||[],t)}function us(e){return cd[e]}function ua(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function uo(e){return ch[e]}function ul(e){return cf[e]}function uc(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return r0(58110);default:return r0(50506)}}function uu(e){switch(e){case"AND":return"and";case"OR":return"or";default:return r0(1026)}}function ud(e){return{fieldPath:e.canonicalString()}}function uh(e){return nC.fromServerFormat(e.fieldPath)}function uf(e){return{field:ud(e.field),direction:us(e.dir)}}function up(e){return new aQ(uh(e.field),ua(e.direction))}function um(e){return e instanceof a0?uy(e):e instanceof a1?ug(e):r0(54877,{filter:e})}function ug(e){let t=e.getFilters().map(e=>um(e));return 1===t.length?t[0]:{compositeFilter:{op:ul(e.op),filters:t}}}function uy(e){if("=="===e.op){if(aA(e.value))return{unaryFilter:{field:ud(e.field),op:"IS_NAN"}};else if(ak(e.value))return{unaryFilter:{field:ud(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(aA(e.value))return{unaryFilter:{field:ud(e.field),op:"IS_NOT_NAN"}};else if(ak(e.value))return{unaryFilter:{field:ud(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ud(e.field),op:uo(e.op),value:e.value}}}function uv(e){switch(e.unaryFilter.op){case"IS_NAN":let t=uh(e.unaryFilter.field);return a0.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=uh(e.unaryFilter.field);return a0.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=uh(e.unaryFilter.field);return a0.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=uh(e.unaryFilter.field);return a0.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return r0(61313);default:return r0(60726)}}function ub(e){return a0.create(uh(e.fieldFilter.field),uc(e.fieldFilter.op),e.fieldFilter.value)}function uS(e){return a1.create(e.compositeFilter.filters.map(e=>c7(e)),uu(e.compositeFilter.op))}function uw(e){let t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function uT(e){return new sR((e.fieldPaths||[]).map(e=>nC.fromServerFormat(e)))}function uE(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class uC{constructor(e,t,r,n,i=nb.min(),s=nb.min(),a=sN.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new uC(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new uC(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new uC(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new uC(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class u_{constructor(e){this.remoteSerializer=e}}function uI(e,t){let r;if(t.document)r=cL(e.remoteSerializer,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let e=n_.fromSegments(t.noDocument.path),n=uN(t.noDocument.readTime);r=az.newNoDocument(e,n),t.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!t.unknownDocument)return r0(56709);let e=n_.fromSegments(t.unknownDocument.path),n=uN(t.unknownDocument.version);r=az.newUnknownDocument(e,n)}return t.readTime&&r.setReadTime(uk(t.readTime)),r}function ux(e,t){let r=t.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:uR(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())n.document=cM(e.remoteSerializer,t);else if(t.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:uA(t.version)};else{if(!t.isUnknownDocument())return r0(57904,{document:t});n.unknownDocument={path:r.path.toArray(),version:uA(t.version)}}return n}function uR(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function uk(e){let t=new nv(e[0],e[1]);return nb.fromTimestamp(t)}function uA(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function uN(e){let t=new nv(e.seconds,e.nanoseconds);return nb.fromTimestamp(t)}function uD(e,t,r){let n=r.baseMutations.map(t=>cq(e.remoteSerializer,t)),i=r.mutations.map(t=>cq(e.remoteSerializer,t));return{userId:t,batchId:r.batchId,localWriteTimeMs:r.localWriteTime.toMillis(),baseMutations:n,mutations:i}}function uO(e,t){let r=(t.baseMutations||[]).map(t=>c$(e.remoteSerializer,t));for(let e=0;e<t.mutations.length-1;++e){let r=t.mutations[e];e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform&&(r.updateTransforms=t.mutations[e+1].transform.fieldTransforms,t.mutations.splice(e+1,1),++e)}let n=t.mutations.map(t=>c$(e.remoteSerializer,t)),i=nv.fromMillis(t.localWriteTimeMs);return new lQ(t.batchId,i,r,n)}function uP(e){let t,r=uN(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?uN(e.lastLimboFreeSnapshotVersion):nb.min();return new uC(t=uL(e.query)?cX(e.query):c2(e.query),e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,n,sN.fromBase64String(e.resumeToken))}function uM(e,t){let r,n=uA(t.snapshotVersion),i=uA(t.lastLimboFreeSnapshotVersion);r=oy(t.target)?cJ(e.remoteSerializer,t.target):cZ(e.remoteSerializer,t.target).queryTarget;let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:op(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function uL(e){return void 0!==e.documents}function uF(e){return{id:e.bundleId,createTime:uN(e.createTime),version:e.version}}function uj(e){return{bundleId:e.id,createTime:uA(cE(e.createTime)),version:e.version}}function uB(e){return{name:e.name,query:uV(e.bundledQuery),readTime:uN(e.readTime)}}function uU(e){return{name:e.name,readTime:uA(cE(e.readTime)),bundledQuery:e.bundledQuery}}function uV(e){let t=c1({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?oV(t,t.limit,"L"):t}function uz(e){return{name:e.name,query:uV(e.bundledQuery),readTime:cE(e.readTime)}}function uq(e){return{id:e.id,version:e.version,createTime:cE(e.createTime)}}function u$(e,t){return new lJ(t.largestBatchId,c$(e.remoteSerializer,t.overlayMutation))}function uG(e,t,r){let[n,i,s]=uH(t,r.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:cq(e.remoteSerializer,r.mutation)}}function uH(e,t){let r=t.path.lastSegment();return[e,is(t.path.popLast()),r]}function uW(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}function uK(e,t){let r=t?new nL(t.sequenceNumber,new nB(uN(t.readTime),new n_(il(t.documentKey)),t.largestBatchId)):nL.empty(),n=e.fields.map(([e,t])=>new nP(nC.fromServerFormat(e),t));return new nR(e.indexId,e.collectionGroup,n,r)}function uQ(e,t,r,n){return{indexId:e,uid:t,sequenceNumber:r,readTime:uA(n.readTime),documentKey:is(n.documentKey.path),largestBatchId:n.largestBatchId}}class uY{getBundleMetadata(e,t){return uJ(e).get(t).next(e=>{if(e)return uF(e)})}saveBundleMetadata(e,t){return uJ(e).put(uj(t))}getNamedQuery(e,t){return uX(e).get(t).next(e=>{if(e)return uB(e)})}saveNamedQuery(e,t){return uX(e).put(uU(t))}}function uJ(e){return sm(e,iH)}function uX(e){return sm(e,iK)}class uZ{constructor(e,t){this.serializer=e,this.userId=t}static forUser(e,t){return new uZ(e,t.uid||"")}getOverlay(e,t){return u0(e).get(uH(this.userId,t)).next(e=>e?u$(this.serializer,e):null)}getOverlays(e,t){let r=o7();return n$.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){let n=[];return r.forEach((r,i)=>{let s=new lJ(t,i);n.push(this.saveOverlay(e,s))}),n$.waitFor(n)}removeOverlaysForBatchId(e,t,r){let n=new Set;t.forEach(e=>n.add(is(e.getCollectionPath())));let i=[];return n.forEach(t=>{let n=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,r+1],!1,!0);i.push(u0(e).deleteAll(se,n))}),n$.waitFor(i)}getOverlaysForCollection(e,t,r){let n=o7(),i=is(t),s=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return u0(e).loadAll(se,s).next(e=>{for(let t of e){let e=u$(this.serializer,t);n.set(e.getKey(),e)}return n})}getOverlaysForCollectionGroup(e,t,r,n){let i,s=o7(),a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return u0(e).iterate({index:sr,range:a},(e,t,r)=>{let a=u$(this.serializer,t);s.size()<n||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):r.done()}).next(()=>s)}saveOverlay(e,t){return u0(e).put(uG(this.serializer,this.userId,t))}}function u0(e){return sm(e,i7)}class u1{globalsStore(e){return sm(e,si)}getSessionToken(e){return this.globalsStore(e).get("sessionToken").next(e=>{let t=null==e?void 0:e.value;return t?sN.fromUint8Array(t):sN.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.globalsStore(e).put({name:"sessionToken",value:t.toUint8Array()})}}let u2=5,u3=10,u6=13,u4=15,u5=20,u8=25,u7=30,u9=37,de=45,dt=50,dr=53,dn=55,di=60,ds=2;class da{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,u2);else if("booleanValue"in e)this.writeValueTypeLabel(t,u3),t.writeNumber(+!!e.booleanValue);else if("integerValue"in e)this.writeValueTypeLabel(t,u4),t.writeNumber(sL(e.integerValue));else if("doubleValue"in e){let r=sL(e.doubleValue);isNaN(r)?this.writeValueTypeLabel(t,u6):(this.writeValueTypeLabel(t,u4),sX(r)?t.writeNumber(0):t.writeNumber(r))}else if("timestampValue"in e){let r=e.timestampValue;this.writeValueTypeLabel(t,u5),"string"==typeof r&&(r=sM(r)),t.writeString(`${r.seconds||""}`),t.writeNumber(r.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,u7),t.writeBytes(sF(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.writeValueTypeLabel(t,de),t.writeNumber(r.latitude||0),t.writeNumber(r.longitude||0)}else"mapValue"in e?aP(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):aD(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):r0(19022,{indexValue:e})}writeIndexString(e,t){this.writeValueTypeLabel(t,u8),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let r=e.fields||{};for(let e of(this.writeValueTypeLabel(t,dn),Object.keys(r)))this.writeIndexString(e,t),this.writeIndexValueAux(r[e],t)}writeIndexVector(e,t){var r,n;let i=e.fields||{};this.writeValueTypeLabel(t,dr);let s=s6,a=(null==(n=null==(r=i[s].arrayValue)?void 0:r.values)?void 0:n.length)||0;this.writeValueTypeLabel(t,u4),t.writeNumber(sL(a)),this.writeIndexString(s,t),this.writeIndexValueAux(i[s],t)}writeIndexArray(e,t){let r=e.values||[];for(let e of(this.writeValueTypeLabel(t,dt),r))this.writeIndexValueAux(e,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,u9),n_.fromName(e).path.forEach(e=>{this.writeValueTypeLabel(t,di),this.writeUnlabeledIndexString(e,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(ds)}}da.INSTANCE=new da;let dl="\uD800",dc="\uDBFF",du=0,dd=255,dh=1,df=255,dp=255,dm=0,dg=64,dy=8,dv=1024;function db(e){let t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}function dS(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function dw(e){let t=0;for(let r=0;r<8;++r){let n=dS(255&e[r]);if(t+=n,8!==n)break}return t}function dT(e){return Math.ceil((dg-dw(e))/dy)}class dE{constructor(){this.buffer=new Uint8Array(dv),this.position=0}writeBytesAscending(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.writeByteAscending(r.value),r=t.next();this.writeSeparatorAscending()}writeBytesDescending(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.writeByteDescending(r.value),r=t.next();this.writeSeparatorDescending()}writeUtf8Ascending(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.writeByteAscending(e);else if(e<2048)this.writeByteAscending(960|e>>>6),this.writeByteAscending(128|63&e);else if(t<dl||dc<t)this.writeByteAscending(480|e>>>12),this.writeByteAscending(128|63&e>>>6),this.writeByteAscending(128|63&e);else{let e=t.codePointAt(0);this.writeByteAscending(240|e>>>18),this.writeByteAscending(128|63&e>>>12),this.writeByteAscending(128|63&e>>>6),this.writeByteAscending(128|63&e)}}this.writeSeparatorAscending()}writeUtf8Descending(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.writeByteDescending(e);else if(e<2048)this.writeByteDescending(960|e>>>6),this.writeByteDescending(128|63&e);else if(t<dl||dc<t)this.writeByteDescending(480|e>>>12),this.writeByteDescending(128|63&e>>>6),this.writeByteDescending(128|63&e);else{let e=t.codePointAt(0);this.writeByteDescending(240|e>>>18),this.writeByteDescending(128|63&e>>>12),this.writeByteDescending(128|63&e>>>6),this.writeByteDescending(128|63&e)}}this.writeSeparatorDescending()}writeNumberAscending(e){let t=this.toOrderedBits(e),r=dT(t);this.ensureAvailable(1+r),this.buffer[this.position++]=255&r;for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=255&t[e]}writeNumberDescending(e){let t=this.toOrderedBits(e),r=dT(t);this.ensureAvailable(1+r),this.buffer[this.position++]=~(255&r);for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}writeInfinityAscending(){this.writeEscapedByteAscending(df),this.writeEscapedByteAscending(dp)}writeInfinityDescending(){this.writeEscapedByteDescending(df),this.writeEscapedByteDescending(dp)}reset(){this.position=0}seed(e){this.ensureAvailable(e.length),this.buffer.set(e,this.position),this.position+=e.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(e){let t=db(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let e=1;e<t.length;++e)t[e]^=255*!!r;return t}writeByteAscending(e){let t=255&e;t===du?(this.writeEscapedByteAscending(du),this.writeEscapedByteAscending(dd)):t===df?(this.writeEscapedByteAscending(df),this.writeEscapedByteAscending(dm)):this.writeEscapedByteAscending(t)}writeByteDescending(e){let t=255&e;t===du?(this.writeEscapedByteDescending(du),this.writeEscapedByteDescending(dd)):t===df?(this.writeEscapedByteDescending(df),this.writeEscapedByteDescending(dm)):this.writeEscapedByteDescending(e)}writeSeparatorAscending(){this.writeEscapedByteAscending(du),this.writeEscapedByteAscending(dh)}writeSeparatorDescending(){this.writeEscapedByteDescending(du),this.writeEscapedByteDescending(dh)}writeEscapedByteAscending(e){this.ensureAvailable(1),this.buffer[this.position++]=e}writeEscapedByteDescending(e){this.ensureAvailable(1),this.buffer[this.position++]=~e}ensureAvailable(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let n=new Uint8Array(r);n.set(this.buffer),this.buffer=n}}class dC{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesAscending(e)}writeString(e){this.orderedCode.writeUtf8Ascending(e)}writeNumber(e){this.orderedCode.writeNumberAscending(e)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class d_{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesDescending(e)}writeString(e){this.orderedCode.writeUtf8Descending(e)}writeNumber(e){this.orderedCode.writeNumberDescending(e)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class dI{constructor(){this.orderedCode=new dE,this.ascending=new dC(this.orderedCode),this.descending=new d_(this.orderedCode)}seed(e){this.orderedCode.seed(e)}forKind(e){return 0===e?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}class dx{constructor(e,t,r,n){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=n}successor(){let e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new dx(this.indexId,this.documentKey,this.arrayValue,r)}}function dR(e,t){let r=e.indexId-t.indexId;return 0!==r||0!==(r=dk(e.arrayValue,t.arrayValue))||0!==(r=dk(e.directionalValue,t.directionalValue))?r:n_.comparator(e.documentKey,t.documentKey)}function dk(e,t){for(let r=0;r<e.length&&r<t.length;++r){let n=e[r]-t[r];if(0!==n)return n}return e.length-t.length}class dA{constructor(e){for(let t of(this.inequalityFilters=new sC((e,t)=>nC.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.orderBys=e.orderBy,this.equalityFilters=[],e.filters)){let e=t;e.isInequality()?this.inequalityFilters=this.inequalityFilters.add(e):this.equalityFilters.push(e)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(e){if(r2(e.collectionGroup===this.collectionId,49279),this.hasMultipleInequality)return!1;let t=nk(e);if(void 0!==t&&!this.hasMatchingEqualityFilter(t))return!1;let r=nA(e),n=new Set,i=0,s=0;for(;i<r.length;++i)if(this.hasMatchingEqualityFilter(r[i]))n=n.add(r[i].fieldPath.canonicalString());else break;if(i===r.length)return!0;if(this.inequalityFilters.size>0){let e=this.inequalityFilters.getIterator().getNext();if(!n.has(e.field.canonicalString())){let t=r[i];if(!this.matchesFilter(e,t)||!this.matchesOrderBy(this.orderBys[s++],t))return!1}++i}for(;i<r.length;++i){let e=r[i];if(s>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[s++],e))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let e=new sC(nC.comparator),t=[];for(let r of this.equalityFilters)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new nP(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new nP(r.field,0))}for(let r of this.orderBys)!r.field.isKeyField()&&(e.has(r.field)||(e=e.add(r.field),t.push(new nP(r.field,+("asc"!==r.dir)))));return new nR(nR.UNKNOWN_ID,this.collectionId,t,nL.empty())}hasMatchingEqualityFilter(e){for(let t of this.equalityFilters)if(this.matchesFilter(t,e))return!0;return!1}matchesFilter(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let r="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===r}matchesOrderBy(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function dN(e){var t,r;if(r2(e instanceof a0||e instanceof a1,20012),e instanceof a0)if(!(e instanceof oc))return e;else{let n=(null==(r=null==(t=e.value.arrayValue)?void 0:t.values)?void 0:r.map(t=>a0.create(e.field,"==",t)))||[];return a1.create(n,"or")}let n=e.filters.map(e=>dN(e));return a1.create(n,e.op)}function dD(e){if(0===e.getFilters().length)return[];let t=dF(dN(e));return(r2(dM(t),7391),dO(t)||dP(t))?[t]:t.getFilters()}function dO(e){return e instanceof a0}function dP(e){return e instanceof a1&&a6(e)}function dM(e){return dO(e)||dP(e)||dL(e)}function dL(e){if(e instanceof a1&&a3(e)){for(let t of e.getFilters())if(!dO(t)&&!dP(t))return!1;return!0}return!1}function dF(e){if(r2(e instanceof a0||e instanceof a1,34018),e instanceof a0)return e;if(1===e.filters.length)return dF(e.filters[0]);let t=e.filters.map(e=>dF(e)),r=a1.create(t,e.op);return dM(r=dz(r))?r:(r2(r instanceof a1,64498),r2(a2(r),40251),r2(r.filters.length>1,57927),r.filters.reduce((e,t)=>dj(e,t)))}function dj(e,t){let r;return r2(e instanceof a0||e instanceof a1,38388),r2(t instanceof a0||t instanceof a1,25473),dz(r=e instanceof a0?t instanceof a0?dB(e,t):dV(e,t):t instanceof a0?dV(t,e):dU(e,t))}function dB(e,t){return a1.create([e,t],"and")}function dU(e,t){if(r2(e.filters.length>0&&t.filters.length>0,48005),a2(e)&&a2(t))return oe(e,t.getFilters());let r=a3(e)?e:t,n=a3(e)?t:e,i=r.filters.map(e=>dj(e,n));return a1.create(i,"or")}function dV(e,t){if(a2(t))return oe(t,e.getFilters());{let r=t.filters.map(t=>dj(e,t));return a1.create(r,"or")}}function dz(e){if(r2(e instanceof a0||e instanceof a1,11850),e instanceof a0)return e;let t=e.getFilters();if(1===t.length)return dz(t[0]);if(a4(e))return e;let r=t.map(e=>dz(e)),n=[];return(r.forEach(t=>{t instanceof a0?n.push(t):t instanceof a1&&(t.op===e.op?n.push(...t.filters):n.push(t))}),1===n.length)?n[0]:a1.create(n,e.op)}class dq{constructor(){this.collectionParentIndex=new d$}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),n$.resolve()}getCollectionParents(e,t){return n$.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return n$.resolve()}deleteFieldIndex(e,t){return n$.resolve()}deleteAllFieldIndexes(e){return n$.resolve()}createTargetIndexes(e,t){return n$.resolve()}getDocumentsMatchingTarget(e,t){return n$.resolve(null)}getIndexType(e,t){return n$.resolve(0)}getFieldIndexes(e,t){return n$.resolve([])}getNextCollectionGroupToUpdate(e){return n$.resolve(null)}getMinOffset(e,t){return n$.resolve(nB.min())}getMinOffsetFromCollectionGroup(e,t){return n$.resolve(nB.min())}updateCollectionGroup(e,t,r){return n$.resolve()}updateIndexEntries(e,t){return n$.resolve()}}class d${constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new sC(nT.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new sC(nT.comparator)).toArray()}}let dG="IndexedDbIndexManager",dH=new Uint8Array(0);class dW{constructor(e,t){this.databaseId=t,this.collectionParentsCache=new d$,this.targetToDnfSubTargets=new o1(e=>op(e),(e,t)=>og(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.collectionParentsCache.has(t)){let r=t.lastSegment(),n=t.popLast();e.addOnCommittedListener(()=>{this.collectionParentsCache.add(t)});let i={collectionId:r,parent:is(n)};return dK(e).put(i)}return n$.resolve()}getCollectionParents(e,t){let r=[],n=IDBKeyRange.bound([t,""],[nm(t),""],!1,!0);return dK(e).loadAll(n).next(e=>{for(let n of e){if(n.collectionId!==t)break;r.push(il(n.parent))}return r})}addFieldIndex(e,t){let r=dY(e),n=uW(t);delete n.indexId;let i=r.add(n);if(!t.indexState)return i.next();{let r=dJ(e);return i.next(e=>{r.put(uQ(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}}deleteFieldIndex(e,t){let r=dY(e),n=dJ(e),i=dQ(e);return r.delete(t.indexId).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=dY(e),r=dQ(e),n=dJ(e);return t.deleteAll().next(()=>r.deleteAll()).next(()=>n.deleteAll())}createTargetIndexes(e,t){return n$.forEach(this.getSubTargets(t),t=>this.getIndexType(e,t).next(r=>{if(0===r||1===r){let r=new dA(t).buildTargetIndex();if(null!=r)return this.addFieldIndex(e,r)}}))}getDocumentsMatchingTarget(e,t){let r=dQ(e),n=!0,i=new Map;return n$.forEach(this.getSubTargets(t),t=>this.getFieldIndex(e,t).next(e=>{n&&(n=!!e),i.set(t,e)})).next(()=>{if(!n)return n$.resolve(null);{let e=li(),n=[];return n$.forEach(i,(i,s)=>{rY(dG,`Using index ${nO(i)} to execute ${op(t)}`);let a=ob(s,i),o=oS(s,i),l=ow(s,i),c=oT(s,i),u=this.encodeBound(i,s,l),d=this.encodeBound(i,s,c),h=this.encodeValues(i,s,o),f=this.generateIndexRanges(i.indexId,a,u,l.inclusive,d,c.inclusive,h);return n$.forEach(f,i=>r.loadFirst(i,t.limit).next(t=>{t.forEach(t=>{let r=n_.fromSegments(t.documentKey);e.has(r)||(e=e.add(r),n.push(r))})}))}).next(()=>n)}})}getSubTargets(e){let t=this.targetToDnfSubTargets.get(e);return t||(t=0===e.filters.length?[e]:dD(a1.create(e.filters,"and")).map(t=>of(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.targetToDnfSubTargets.set(e,t)),t}generateIndexRanges(e,t,r,n,i,s,a){let o=(null!=t?t.length:1)*Math.max(r.length,i.length),l=o/(null!=t?t.length:1),c=[];for(let u=0;u<o;++u){let o=t?this.encodeSingleElement(t[u/l]):dH,d=this.generateLowerBound(e,o,r[u%l],n),h=this.generateUpperBound(e,o,i[u%l],s),f=a.map(t=>this.generateLowerBound(e,o,t,!0));c.push(...this.createRange(d,h,f))}return c}generateLowerBound(e,t,r,n){let i=new dx(e,n_.empty(),t,r);return n?i:i.successor()}generateUpperBound(e,t,r,n){let i=new dx(e,n_.empty(),t,r);return n?i.successor():i}getFieldIndex(e,t){let r=new dA(t),n=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,n).next(e=>{let t=null;for(let n of e)r.servedByIndex(n)&&(!t||n.fields.length>t.fields.length)&&(t=n);return t})}getIndexType(e,t){let r=2,n=this.getSubTargets(t);return n$.forEach(n,t=>this.getFieldIndex(e,t).next(e=>{e?0!==r&&e.fields.length<o_(t)&&(r=1):r=0})).next(()=>oI(t)&&n.length>1&&2===r?1:r)}encodeDirectionalElements(e,t){let r=new dI;for(let n of nA(e)){let e=t.data.field(n.fieldPath);if(null==e)return null;let i=r.forKind(n.kind);da.INSTANCE.writeIndexValue(e,i)}return r.encodedBytes()}encodeSingleElement(e){let t=new dI;return da.INSTANCE.writeIndexValue(e,t.forKind(0)),t.encodedBytes()}encodeDirectionalKey(e,t){let r=new dI;return da.INSTANCE.writeIndexValue(aC(this.databaseId,t),r.forKind(nN(e))),r.encodedBytes()}encodeValues(e,t,r){if(null===r)return[];let n=[];n.push(new dI);let i=0;for(let s of nA(e)){let e=r[i++];for(let r of n)if(this.isInFilter(t,s.fieldPath)&&aR(e))n=this.expandIndexValues(n,s,e);else{let t=r.forKind(s.kind);da.INSTANCE.writeIndexValue(e,t)}}return this.getEncodedBytes(n)}encodeBound(e,t,r){return this.encodeValues(e,t,r.position)}getEncodedBytes(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].encodedBytes();return t}expandIndexValues(e,t,r){let n=[...e],i=[];for(let e of r.arrayValue.values||[])for(let r of n){let n=new dI;n.seed(r.encodedBytes()),da.INSTANCE.writeIndexValue(e,n.forKind(t.kind)),i.push(n)}return i}isInFilter(e,t){return!!e.filters.find(e=>e instanceof a0&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let r=dY(e),n=dJ(e);return(t?r.loadAll(iX,IDBKeyRange.bound(t,t)):r.loadAll()).next(e=>{let t=[];return n$.forEach(e,e=>n.get([e.indexId,this.uid]).next(r=>{t.push(uK(e,r))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==r?r:nu(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,r){let n=dY(e),i=dJ(e);return this.getNextSequenceNumber(e).next(e=>n.loadAll(iX,IDBKeyRange.bound(t,t)).next(t=>n$.forEach(t,t=>i.put(uQ(t.indexId,this.uid,e,r)))))}updateIndexEntries(e,t){let r=new Map;return n$.forEach(t,(t,n)=>{let i=r.get(t.collectionGroup);return(i?n$.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(r.set(t.collectionGroup,i),n$.forEach(i,r=>this.getExistingIndexEntries(e,t,r).next(t=>{let i=this.computeIndexEntries(n,r);return t.isEqual(i)?n$.resolve():this.updateEntries(e,n,r,t,i)}))))})}addIndexEntry(e,t,r,n){return dQ(e).put({indexId:n.indexId,uid:this.uid,arrayValue:n.arrayValue,directionalValue:n.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(r,t.key),documentKey:t.key.path.toArray()})}deleteIndexEntry(e,t,r,n){return dQ(e).delete([n.indexId,this.uid,n.arrayValue,n.directionalValue,this.encodeDirectionalKey(r,t.key),t.key.path.toArray()])}getExistingIndexEntries(e,t,r){let n=dQ(e),i=new sC(dR);return n.iterate({index:i5,range:IDBKeyRange.only([r.indexId,this.uid,this.encodeDirectionalKey(r,t)])},(e,n)=>{i=i.add(new dx(r.indexId,t,n.arrayValue,n.directionalValue))}).next(()=>i)}computeIndexEntries(e,t){let r=new sC(dR),n=this.encodeDirectionalElements(t,e);if(null==n)return r;let i=nk(t);if(null!=i){let s=e.data.field(i.fieldPath);if(aR(s))for(let i of s.arrayValue.values||[])r=r.add(new dx(t.indexId,e.key,this.encodeSingleElement(i),n))}else r=r.add(new dx(t.indexId,e.key,dH,n));return r}updateEntries(e,t,r,n,i){rY(dG,"Updating index entries for document '%s'",t.key);let s=[];return sI(n,i,dR,n=>{s.push(this.addIndexEntry(e,t,r,n))},n=>{s.push(this.deleteIndexEntry(e,t,r,n))}),n$.waitFor(s)}getNextSequenceNumber(e){let t=1;return dJ(e).iterate({index:i2,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,r,n)=>{n.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((e,t)=>dR(e,t)).filter((e,t,r)=>!t||0!==dR(e,r[t-1]));let n=[];for(let i of(n.push(e),r)){let r=dR(i,e),s=dR(i,t);if(0===r)n[0]=e.successor();else if(r>0&&s<0)n.push(i),n.push(i.successor());else if(s>0)break}n.push(t);let i=[];for(let e=0;e<n.length;e+=2){if(this.isRangeMatchable(n[e],n[e+1]))return[];let t=[n[e].indexId,this.uid,n[e].arrayValue,n[e].directionalValue,dH,[]],r=[n[e+1].indexId,this.uid,n[e+1].arrayValue,n[e+1].directionalValue,dH,[]];i.push(IDBKeyRange.bound(t,r))}return i}isRangeMatchable(e,t){return dR(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(dX)}getMinOffset(e,t){return n$.mapArray(this.getSubTargets(t),t=>this.getFieldIndex(e,t).next(e=>e||r0(44426))).next(dX)}}function dK(e){return sm(e,iz)}function dQ(e){return sm(e,i6)}function dY(e){return sm(e,iY)}function dJ(e){return sm(e,i0)}function dX(e){r2(0!==e.length,28825);let t=e[0].indexState.offset,r=t.largestBatchId;for(let n=1;n<e.length;n++){let i=e[n].indexState.offset;0>nU(i,t)&&(t=i),r<i.largestBatchId&&(r=i.largestBatchId)}return new nB(t.readTime,t.documentKey,r)}function dZ(e,t,r){let n=e.store(im),i=e.store(iE),s=[],a=IDBKeyRange.only(r.batchId),o=0,l=n.iterate({range:a},(e,t,r)=>(o++,r.delete()));s.push(l.next(()=>{r2(1===o,47070,{batchId:r.batchId})}));let c=[];for(let e of r.mutations){let n=iw(t,e.key.path,r.batchId);s.push(i.delete(n)),c.push(e.key)}return n$.waitFor(s).next(()=>c)}function d0(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else if(e.noDocument)t=e.noDocument;else throw r0(14731);return JSON.stringify(t).length}class d1{constructor(e,t,r,n){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=n,this.documentKeysByBatchId={}}static forUser(e,t,r,n){return r2(""!==e.uid,64387),new d1(e.isAuthenticated()?e.uid:"",t,r,n)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return d6(e).iterate({index:iy,range:r},(e,r,n)=>{t=!1,n.done()}).next(()=>t)}addMutationBatch(e,t,r,n){let i=d4(e),s=d6(e);return s.add({}).next(a=>{r2("number"==typeof a,49019);let o=new lQ(a,t,r,n),l=uD(this.serializer,this.userId,o),c=[],u=new sC((e,t)=>nu(e.canonicalString(),t.canonicalString()));for(let e of n){let t=iw(this.userId,e.key.path,a);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(i.put(t,iT))}return u.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.documentKeysByBatchId[a]=o.keys()}),n$.waitFor(c).next(()=>o)})}lookupMutationBatch(e,t){return d6(e).get(t).next(e=>e?(r2(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),uO(this.serializer,e)):null)}lookupMutationKeys(e,t){return this.documentKeysByBatchId[t]?n$.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(e=>{if(!e)return null;{let r=e.keys();return this.documentKeysByBatchId[t]=r,r}})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,n=IDBKeyRange.lowerBound([this.userId,r]),i=null;return d6(e).iterate({index:iy,range:n},(e,t,n)=>{t.userId===this.userId&&(r2(t.batchId>=r,47524,{nextBatchId:r}),i=uO(this.serializer,t)),n.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=sY;return d6(e).iterate({index:iy,range:t,reverse:!0},(e,t,n)=>{r=t.batchId,n.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,sY],[this.userId,Number.POSITIVE_INFINITY]);return d6(e).loadAll(iy,t).next(e=>e.map(e=>uO(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=iS(this.userId,t.path),n=IDBKeyRange.lowerBound(r),i=[];return d4(e).iterate({range:n},(r,n,s)=>{let[a,o,l]=r,c=il(o);return a===this.userId&&t.path.isEqual(c)?d6(e).get(l).next(e=>{if(!e)throw r0(61480,{indexKey:r,batchId:l});r2(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),i.push(uO(this.serializer,e))}):void s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new sC(nu),n=[];return t.forEach(t=>{let i=iS(this.userId,t.path),s=IDBKeyRange.lowerBound(i),a=d4(e).iterate({range:s},(e,n,i)=>{let[s,a,o]=e,l=il(a);if(s!==this.userId||!t.path.isEqual(l))return void i.done();r=r.add(o)});n.push(a)}),n$.waitFor(n).next(()=>this.lookupMutationBatches(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=iS(this.userId,r),s=IDBKeyRange.lowerBound(i),a=new sC(nu);return d4(e).iterate({range:s},(e,t,i)=>{let[s,o,l]=e,c=il(o);if(s!==this.userId||!r.isPrefixOf(c))return void i.done();c.length===n&&(a=a.add(l))}).next(()=>this.lookupMutationBatches(e,a))}lookupMutationBatches(e,t){let r=[],n=[];return t.forEach(t=>{n.push(d6(e).get(t).next(e=>{if(null===e)throw r0(35274,{batchId:t});r2(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),r.push(uO(this.serializer,e))}))}),n$.waitFor(n).next(()=>r)}removeMutationBatch(e,t){return dZ(e.simpleDbTransaction,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.removeCachedMutationKeys(t.batchId)}),n$.forEach(r,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}removeCachedMutationKeys(e){delete this.documentKeysByBatchId[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return n$.resolve();let r=IDBKeyRange.lowerBound(ib(this.userId)),n=[];return d4(e).iterate({range:r},(e,t,r)=>{if(e[0]!==this.userId)return void r.done();{let t=il(e[1]);n.push(t)}}).next(()=>{r2(0===n.length,56720,{danglingKeys:n.map(e=>e.canonicalString())})})})}containsKey(e,t){return d2(e,this.userId,t)}getMutationQueueMetadata(e){return d5(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:sY,lastStreamToken:""})}}function d2(e,t,r){let n=iS(t,r.path),i=n[1],s=IDBKeyRange.lowerBound(n),a=!1;return d4(e).iterate({range:s,keysOnly:!0},(e,r,n)=>{let[s,o,l]=e;s===t&&o===i&&(a=!0),n.done()}).next(()=>a)}function d3(e,t){let r=!1;return d5(e).iterateSerial(n=>d2(e,n,t).next(e=>(e&&(r=!0),n$.resolve(!e)))).next(()=>r)}function d6(e){return sm(e,im)}function d4(e){return sm(e,iE)}function d5(e){return sm(e,ih)}let d8=2;class d7{constructor(e){this.lastId=e}next(){return this.lastId+=d8,this.lastId}static forTargetCache(){return new d7(2-d8)}static forSyncEngine(){return new d7(1-d8)}}class d9{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.retrieveMetadata(e).next(t=>{let r=new d7(t.highestTargetId);return t.highestTargetId=r.next(),this.saveMetadata(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.retrieveMetadata(e).next(e=>nb.fromTimestamp(new nv(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.retrieveMetadata(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.retrieveMetadata(e).next(n=>(n.highestListenSequenceNumber=t,r&&(n.lastRemoteSnapshotVersion=r.toTimestamp()),t>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t),this.saveMetadata(e,n)))}addTargetData(e,t){return this.saveTargetData(e,t).next(()=>this.retrieveMetadata(e).next(r=>(r.targetCount+=1,this.updateMetadataFromTargetData(t,r),this.saveMetadata(e,r))))}updateTargetData(e,t){return this.saveTargetData(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>he(e).delete(t.targetId)).next(()=>this.retrieveMetadata(e)).next(t=>(r2(t.targetCount>0,8065),t.targetCount-=1,this.saveMetadata(e,t)))}removeTargets(e,t,r){let n=0,i=[];return he(e).iterate((s,a)=>{let o=uP(a);o.sequenceNumber<=t&&null===r.get(o.targetId)&&(n++,i.push(this.removeTargetData(e,o)))}).next(()=>n$.waitFor(i)).next(()=>n)}forEachTarget(e,t){return he(e).iterate((e,r)=>{t(uP(r))})}retrieveMetadata(e){return ht(e).get(iU).next(e=>(r2(null!==e,2888),e))}saveMetadata(e,t){return ht(e).put(iU,t)}saveTargetData(e,t){return he(e).put(uM(this.serializer,t))}updateMetadataFromTargetData(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.retrieveMetadata(e).next(e=>e.targetCount)}getTargetData(e,t){let r=op(t),n=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),i=null;return he(e).iterate({range:n,index:iP},(e,r,n)=>{let s=uP(r);og(t,s.target)&&(i=s,n.done())}).next(()=>i)}addMatchingKeys(e,t,r){let n=[],i=hr(e);return t.forEach(t=>{let s=is(t.path);n.push(i.put({targetId:r,path:s})),n.push(this.referenceDelegate.addReference(e,r,t))}),n$.waitFor(n)}removeMatchingKeys(e,t,r){let n=hr(e);return n$.forEach(t,t=>{let i=is(t.path);return n$.waitFor([n.delete([r,i]),this.referenceDelegate.removeReference(e,r,t)])})}removeMatchingKeysForTargetId(e,t){let r=hr(e),n=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(n)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),n=hr(e),i=li();return n.iterate({range:r,keysOnly:!0},(e,t,r)=>{let n=new n_(il(e[1]));i=i.add(n)}).next(()=>i)}containsKey(e,t){let r=is(t.path),n=IDBKeyRange.bound([r],[nm(r)],!1,!0),i=0;return hr(e).iterate({index:ij,keysOnly:!0,range:n},([e,t],r,n)=>{0!==e&&(i++,n.done())}).next(()=>i>0)}getTargetDataForTarget(e,t){return he(e).get(t).next(e=>e?uP(e):null)}}function he(e){return sm(e,iD)}function ht(e){return sm(e,iV)}function hr(e){return sm(e,iL)}let hn={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hi=-1,hs=0x2800000;class ha{static withCacheSize(e){return new ha(e,ha.DEFAULT_COLLECTION_PERCENTILE,ha.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}ha.DEFAULT_COLLECTION_PERCENTILE=10,ha.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ha.DEFAULT=new ha(hs,ha.DEFAULT_COLLECTION_PERCENTILE,ha.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ha.DISABLED=new ha(hi,0,0);let ho="LruGarbageCollector",hl=1048576,hc=6e4,hu=3e5;function hd([e,t],[r,n]){let i=nu(e,r);return 0===i?nu(t,n):i}class hh{constructor(e){this.maxElements=e,this.buffer=new sC(hd),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>hd(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class hf{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==hi&&this.scheduleGC(hc)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(e){rY(ho,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){nX(e)?rY(ho,"Ignoring IndexedDB error during garbage collection: ",e):await nq(e)}await this.scheduleGC(hu)})}}class hp{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return n$.resolve(n9.INVALID);let r=new hh(t);return this.delegate.forEachTarget(e,e=>r.addElement(e.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,e=>r.addElement(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.delegate.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===hi?(rY("LruGarbageCollector","Garbage collection skipped; disabled"),n$.resolve(hn)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(rY("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hn):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let r,n,i,a,o,l,c,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(rY("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,a=Date.now(),this.nthSequenceNumber(e,n))).next(n=>(r=n,o=Date.now(),this.removeTargets(e,r,t))).next(t=>(i=t,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(c=Date.now(),rQ()<=s.DEBUG&&rY("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${n} in ${o-a}ms
	Removed ${i} targets in ${l-o}ms
	Removed ${e} documents in ${c-l}ms
Total Duration: ${c-u}ms`),n$.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e})))}}function hm(e,t){return new hp(e,t)}class hg{constructor(e,t){this.db=e,this.garbageCollector=hm(this,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}forEachOrphanedDocumentSequenceNumber(e,t){return this.forEachOrphanedDocument(e,(e,r)=>t(r))}addReference(e,t,r){return hb(e,r)}removeReference(e,t,r){return hb(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return hb(e,t)}isPinned(e,t){return d3(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),n=[],i=0;return this.forEachOrphanedDocument(e,(s,a)=>{if(a<=t){let t=this.isPinned(e,s).next(t=>{if(!t)return i++,r.getEntry(e,s).next(()=>(r.removeEntry(s,nb.min()),hr(e).delete(hy(s))))});n.push(t)}}).next(()=>n$.waitFor(n)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return hb(e,t)}forEachOrphanedDocument(e,t){let r,n=hr(e),i=n9.INVALID;return n.iterate({index:ij},([e,n],{path:s,sequenceNumber:a})=>{0===e?(i!==n9.INVALID&&t(new n_(il(r)),i),i=a,r=s):i=n9.INVALID}).next(()=>{i!==n9.INVALID&&t(new n_(il(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function hy(e){return[0,is(e.path)]}function hv(e,t){return{targetId:0,path:is(e.path),sequenceNumber:t}}function hb(e,t){return hr(e).put(hv(t,e.currentSequenceNumber))}class hS{constructor(){this.changes=new o1(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,az.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?n$.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class hw{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return h_(e).put(r)}removeEntry(e,t,r){return h_(e).delete(hx(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.setMetadata(e,r)))}getEntry(e,t){let r=az.newInvalidDocument(t);return h_(e).iterate({index:iI,range:IDBKeyRange.only(hI(t))},(e,n)=>{r=this.maybeDecodeDocument(t,n)}).next(()=>r)}getSizedEntry(e,t){let r={size:0,document:az.newInvalidDocument(t)};return h_(e).iterate({index:iI,range:IDBKeyRange.only(hI(t))},(e,n)=>{r={document:this.maybeDecodeDocument(t,n),size:d0(n)}}).next(()=>r)}getEntries(e,t){let r=o3();return this.forEachDbEntry(e,t,(e,t)=>{let n=this.maybeDecodeDocument(e,t);r=r.insert(e,n)}).next(()=>r)}getSizedEntries(e,t){let r=o3(),n=new sS(n_.comparator);return this.forEachDbEntry(e,t,(e,t)=>{let i=this.maybeDecodeDocument(e,t);r=r.insert(e,i),n=n.insert(e,d0(t))}).next(()=>({documents:r,sizeMap:n}))}forEachDbEntry(e,t,r){if(t.isEmpty())return n$.resolve();let n=new sC(hk);t.forEach(e=>n=n.add(e));let i=IDBKeyRange.bound(hI(n.first()),hI(n.last())),s=n.getIterator(),a=s.getNext();return h_(e).iterate({index:iI,range:i},(e,t,n)=>{let i=n_.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&0>hk(a,i);)r(a,null),a=s.getNext();a&&a.isEqual(i)&&(r(a,t),a=s.hasNext()?s.getNext():null),a?n.skip(hI(a)):n.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,n,i){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),uR(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return h_(e).loadAll(IDBKeyRange.bound(a,o,!0)).next(e=>{null==i||i.incrementDocumentReadCount(e.length);let r=o3();for(let i of e){let e=this.maybeDecodeDocument(n_.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(oW(t,e)||n.has(e.key))&&(r=r.insert(e.key,e))}return r})}getAllFromCollectionGroup(e,t,r,n){let i=o3(),s=hR(t,r),a=hR(t,nB.max());return h_(e).iterate({index:iR,range:IDBKeyRange.bound(s,a,!0)},(e,t,r)=>{let s=this.maybeDecodeDocument(n_.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===n&&r.done()}).next(()=>i)}newChangeBuffer(e){return new hE(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return hC(e).get(iN).next(e=>(r2(!!e,20021),e))}setMetadata(e,t){return hC(e).put(iN,t)}maybeDecodeDocument(e,t){if(t){let e=uI(this.serializer,t);if(!(e.isNoDocument()&&e.version.isEqual(nb.min())))return e}return az.newInvalidDocument(e)}}function hT(e){return new hw(e)}class hE extends hS{constructor(e,t){super(),this.documentCache=e,this.trackRemovals=t,this.documentStates=new o1(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],r=0,n=new sC((e,t)=>nu(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let a=this.documentStates.get(i);if(t.push(this.documentCache.removeEntry(e,i,a.readTime)),s.isValidDocument()){let o=ux(this.documentCache.serializer,s);n=n.add(i.path.popLast());let l=d0(o);r+=l-a.size,t.push(this.documentCache.addEntry(e,i,o))}else if(r-=a.size,this.trackRemovals){let r=ux(this.documentCache.serializer,s.convertToNoDocument(nb.min()));t.push(this.documentCache.addEntry(e,i,r))}}),n.forEach(r=>{t.push(this.documentCache.indexManager.addToCollectionParentIndex(e,r))}),t.push(this.documentCache.updateMetadata(e,r)),n$.waitFor(t)}getFromCache(e,t){return this.documentCache.getSizedEntry(e,t).next(e=>(this.documentStates.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.documentCache.getSizedEntries(e,t).next(({documents:e,sizeMap:t})=>(t.forEach((t,r)=>{this.documentStates.set(t,{size:r,readTime:e.get(t).readTime})}),e))}}function hC(e){return sm(e,iA)}function h_(e){return sm(e,iC)}function hI(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function hx(e,t){let r=e.path.toArray();return[r.slice(0,r.length-2),r[r.length-2],uR(t),r[r.length-1]]}function hR(e,t){let r=t.documentKey.path.toArray();return[e,uR(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function hk(e,t){let r=e.path.toArray(),n=t.path.toArray(),i=0;for(let e=0;e<r.length-2&&e<n.length-2;++e)if(i=nu(r[e],n[e]))return i;return(i=nu(r.length,n.length))||(i=nu(r[r.length-2],n[n.length-2]))?i:nu(r[r.length-1],n[n.length-1])}let hA=17;class hN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class hD{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(r=n,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&lO(r.mutation,e,sR.empty(),nv.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,li()).next(()=>t))}getLocalViewOfDocuments(e,t,r=li()){let n=o7();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let t=o4();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=o7();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,li()))}populateOverlays(e,t,r){let n=[];return r.forEach(e=>{t.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,n){let i=o3(),s=le(),a=o5();return t.forEach((e,t)=>{let a=r.get(t.key);n.has(t.key)&&(void 0===a||a.mutation instanceof lB)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),lO(a.mutation,t,a.mutation.getFieldMask(),nv.now())):s.set(t.key,sR.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var r;return a.set(e,new hN(t,null!=(r=s.get(e))?r:null))}),a))}recalculateAndSaveOverlays(e,t){let r=le(),n=new sS((e,t)=>e-t),i=li();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=r.get(e)||sR.empty();a=i.applyToLocalView(s,a),r.set(e,a);let o=(n.get(i.batchId)||li()).add(e);n=n.insert(i.batchId,o)})}).next(()=>{let s=[],a=n.getReverseIterator();for(;a.hasNext();){let n=a.getNext(),o=n.key,l=n.value,c=o9();l.forEach(e=>{if(!i.has(e)){let n=lN(t.get(e),r.get(e));null!==n&&c.set(e,n),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return n$.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,n){return oO(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):oP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next(i=>{let s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-i.size):n$.resolve(o7()),a=nI,o=i;return s.next(t=>n$.forEach(t,(t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),i.get(t))?n$.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)})).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,li())).next(e=>({batchId:a,changes:o8(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new n_(t)).next(e=>{let t=o4();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){let i=t.collectionGroup,s=o4();return this.indexManager.getCollectionParents(e,i).next(a=>n$.forEach(a,a=>{let o=oA(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,n))).next(e=>{i.forEach((t,r)=>{let n=r.getKey();null===e.get(n)&&(e=e.insert(n,az.newInvalidDocument(n)))});let r=o4();return e.forEach((e,n)=>{let s=i.get(e);void 0!==s&&lO(s.mutation,n,sR.empty(),nv.now()),oW(t,n)&&(r=r.insert(e,n))}),r})}}class hO{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return n$.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,uq(t)),n$.resolve()}getNamedQuery(e,t){return n$.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,uz(t)),n$.resolve()}}class hP{constructor(){this.overlays=new sS(n_.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return n$.resolve(this.overlays.get(t))}getOverlays(e,t){let r=o7();return n$.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,n)=>{this.saveOverlay(e,t,n)}),n$.resolve()}removeOverlaysForBatchId(e,t,r){let n=this.overlayByBatchId.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.overlayByBatchId.delete(r)),n$.resolve()}getOverlaysForCollection(e,t,r){let n=o7(),i=t.length+1,s=new n_(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>r&&n.set(e.getKey(),e)}return n$.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let i=new sS((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=i.get(e.largestBatchId);null===t&&(t=o7(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=o7(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=n)););return n$.resolve(a)}saveOverlay(e,t,r){let n=this.overlays.get(r.key);if(null!==n){let e=this.overlayByBatchId.get(n.largestBatchId).delete(r.key);this.overlayByBatchId.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new lJ(t,r));let i=this.overlayByBatchId.get(t);void 0===i&&(i=li(),this.overlayByBatchId.set(t,i)),this.overlayByBatchId.set(t,i.add(r.key))}}class hM{constructor(){this.sessionToken=sN.EMPTY_BYTE_STRING}getSessionToken(e){return n$.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,n$.resolve()}}class hL{constructor(){this.refsByKey=new sC(hF.compareByKey),this.refsByTarget=new sC(hF.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let r=new hF(e,t);this.refsByKey=this.refsByKey.add(r),this.refsByTarget=this.refsByTarget.add(r)}addReferences(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.removeRef(new hF(e,t))}removeReferences(e,t){e.forEach(e=>this.removeReference(e,t))}removeReferencesForId(e){let t=new n_(new nT([])),r=new hF(t,e),n=new hF(t,e+1),i=[];return this.refsByTarget.forEachInRange([r,n],e=>{this.removeRef(e),i.push(e.key)}),i}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new n_(new nT([])),r=new hF(t,e),n=new hF(t,e+1),i=li();return this.refsByTarget.forEachInRange([r,n],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new hF(e,0),r=this.refsByKey.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class hF{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return n_.comparator(e.key,t.key)||nu(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return nu(e.targetOrBatchId,t.targetOrBatchId)||n_.comparator(e.key,t.key)}}class hj{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new sC(hF.compareByKey)}checkEmpty(e){return n$.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){let i=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new lQ(i,t,r,n);for(let t of(this.mutationQueue.push(s),n))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new hF(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return n$.resolve(s)}lookupMutationBatch(e,t){return n$.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,n=this.indexOfBatchId(r),i=n<0?0:n;return n$.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return n$.resolve(0===this.mutationQueue.length?sY:this.nextBatchId-1)}getAllMutationBatches(e){return n$.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new hF(t,0),n=new hF(t,Number.POSITIVE_INFINITY),i=[];return this.batchesByDocumentKey.forEachInRange([r,n],e=>{let t=this.findMutationBatch(e.targetOrBatchId);i.push(t)}),n$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new sC(nu);return t.forEach(e=>{let t=new hF(e,0),n=new hF(e,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([t,n],e=>{r=r.add(e.targetOrBatchId)})}),n$.resolve(this.findMutationBatches(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=r;n_.isDocumentKey(i)||(i=i.child(""));let s=new hF(new n_(i),0),a=new sC(nu);return this.batchesByDocumentKey.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.targetOrBatchId)),!0)},s),n$.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(e=>{let r=this.findMutationBatch(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){r2(0===this.indexOfExistingBatchId(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.batchesByDocumentKey;return n$.forEach(t.mutations,n=>{let i=new hF(n.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.batchesByDocumentKey=r})}removeCachedMutationKeys(e){}containsKey(e,t){let r=new hF(t,0),n=this.batchesByDocumentKey.firstAfterOrEqual(r);return n$.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,n$.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}let hB="-9223372036854775808";function hU(){return new sS(n_.comparator)}class hV{constructor(e){this.sizer=e,this.docs=hU(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,n=this.docs.get(r),i=n?n.size:0,s=this.sizer(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return n$.resolve(r?r.document.mutableCopy():az.newInvalidDocument(t))}getEntries(e,t){let r=o3();return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():az.newInvalidDocument(e))}),n$.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let i=o3(),s=t.path,a=new n_(s.child("__id"+hB+"__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;!(e.path.length>s.length+1||0>=nU(nj(a),r))&&(n.has(a.key)||oW(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return n$.resolve(i)}getAllFromCollectionGroup(e,t,r,n){r0(9500)}forEachDocumentKey(e,t){return n$.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new hq(this)}getSize(e){return n$.resolve(this.size)}}function hz(e){return new hV(e)}class hq extends hS{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((r,n)=>{n.isValidDocument()?t.push(this.documentCache.addEntry(e,n)):this.documentCache.removeEntry(r)}),n$.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}}class h${constructor(e){this.persistence=e,this.targets=new o1(e=>op(e),og),this.lastRemoteSnapshotVersion=nb.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new hL,this.targetCount=0,this.targetIdGenerator=d7.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((e,r)=>t(r)),n$.resolve()}getLastRemoteSnapshotVersion(e){return n$.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return n$.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),n$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),n$.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new d7(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,n$.resolve()}updateTargetData(e,t){return this.saveTargetData(t),n$.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,n$.resolve()}removeTargets(e,t,r){let n=0,i=[];return this.targets.forEach((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.targets.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),n++)}),n$.waitFor(i).next(()=>n)}getTargetCount(e){return n$.resolve(this.targetCount)}getTargetData(e,t){let r=this.targets.get(t)||null;return n$.resolve(r)}addMatchingKeys(e,t,r){return this.references.addReferences(t,r),n$.resolve()}removeMatchingKeys(e,t,r){this.references.removeReferences(t,r);let n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(t=>{i.push(n.markPotentiallyOrphaned(e,t))}),n$.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),n$.resolve()}getMatchingKeysForTargetId(e,t){let r=this.references.referencesForId(t);return n$.resolve(r)}containsKey(e,t){return n$.resolve(this.references.containsKey(t))}}let hG="MemoryPersistence";class hH{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new n9(0),this._started=!1,this._started=!0,this.globalsCache=new hM,this.referenceDelegate=e(this),this.targetCache=new h$(this);let r=e=>this.referenceDelegate.documentSize(e);this.indexManager=new dq,this.remoteDocumentCache=hz(r),this.serializer=new u_(t),this.bundleCache=new hO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.mutationQueues[e.toKey()];return r||(r=new hj(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=r),r}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,r){rY(hG,"Starting transaction:",e);let n=new hW(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),r(n).next(e=>this.referenceDelegate.onTransactionCommitted(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}mutationQueuesContainKey(e,t){return n$.or(Object.values(this.mutationQueues).map(r=>()=>r.containsKey(e,t)))}}class hW extends nz{constructor(e){super(),this.currentSequenceNumber=e}}class hK{constructor(e){this.persistence=e,this.localViewReferences=new hL,this._orphanedDocuments=null}static factory(e){return new hK(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw r0(60996)}addReference(e,t,r){return this.localViewReferences.addReference(r,t),this.orphanedDocuments.delete(r.toString()),n$.resolve()}removeReference(e,t,r){return this.localViewReferences.removeReference(r,t),this.orphanedDocuments.add(r.toString()),n$.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),n$.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(e=>this.orphanedDocuments.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.orphanedDocuments.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return n$.forEach(this.orphanedDocuments,r=>{let n=n_.fromPath(r);return this.isReferenced(e,n).next(e=>{e||t.removeEntry(n,nb.min())})}).next(()=>(this._orphanedDocuments=null,t.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(e=>{e?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return n$.or([()=>n$.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}}class hQ{constructor(e,t){this.persistence=e,this.orphanedSequenceNumbers=new o1(e=>is(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=hm(this,t)}static factory(e,t){return new hQ(e,t)}onTransactionStarted(){}onTransactionCommitted(e){return n$.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,e=>{t++}).next(()=>t)}forEachOrphanedDocumentSequenceNumber(e,t){return n$.forEach(this.orphanedSequenceNumbers,(r,n)=>this.isPinned(e,r,n).next(e=>e?n$.resolve():t(n)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,n=this.persistence.getRemoteDocumentCache(),i=n.newChangeBuffer();return n.forEachDocumentKey(e,n=>this.isPinned(e,n,t).next(e=>{e||(r++,i.removeEntry(n,nb.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),n$.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),n$.resolve()}removeReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),n$.resolve()}updateLimboDocument(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),n$.resolve()}documentSize(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=aw(e.data.value)),t}isPinned(e,t,r){return n$.or([()=>this.persistence.mutationQueuesContainKey(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.orphanedSequenceNumbers.get(t);return n$.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class hY{constructor(e){this.serializer=e}createOrUpgrade(e,t,r,n){let i=new nW("createOrUpgrade",t);r<1&&n>=1&&(hX(e),hZ(e),h6(e),h1(e));let s=n$.resolve();return r<3&&n>=3&&(0!==r&&(h4(e),h6(e)),s=s.next(()=>h8(i))),r<4&&n>=4&&(0!==r&&(s=s.next(()=>h0(e,i))),s=s.next(()=>{h7(e)})),r<5&&n>=5&&(s=s.next(()=>this.removeAcknowledgedMutations(i))),r<6&&n>=6&&(s=s.next(()=>(h3(e),this.addDocumentGlobal(i)))),r<7&&n>=7&&(s=s.next(()=>this.ensureSequenceNumbers(i))),r<8&&n>=8&&(s=s.next(()=>this.createCollectionParentIndex(e,i))),r<9&&n>=9&&(s=s.next(()=>{h5(e)})),r<10&&n>=10&&(s=s.next(()=>this.rewriteCanonicalIds(i))),r<11&&n>=11&&(s=s.next(()=>{h9(e),fe(e)})),r<12&&n>=12&&(s=s.next(()=>{fr(e)})),r<13&&n>=13&&(s=s.next(()=>h2(e)).next(()=>this.rewriteRemoteDocumentCache(e,i)).next(()=>e.deleteObjectStore(ic))),r<14&&n>=14&&(s=s.next(()=>this.runOverlayMigration(e,i))),r<15&&n>=15&&(s=s.next(()=>ft(e))),r<16&&n>=16&&(s=s.next(()=>{t.objectStore(i0).clear()}).next(()=>{t.objectStore(i6).clear()})),r<17&&n>=17&&(s=s.next(()=>{fn(e)})),s}addDocumentGlobal(e){let t=0;return e.store(ic).iterate((e,r)=>{t+=d0(r)}).next(()=>{let r={byteSize:t};return e.store(iA).put(iN,r)})}removeAcknowledgedMutations(e){let t=e.store(ih),r=e.store(im);return t.loadAll().next(t=>n$.forEach(t,t=>{let n=IDBKeyRange.bound([t.userId,sY],[t.userId,t.lastAcknowledgedBatchId]);return r.loadAll(iy,n).next(r=>n$.forEach(r,r=>{r2(r.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:r.batchId});let n=uO(this.serializer,r);return dZ(e,t.userId,n).next(()=>{})}))}))}ensureSequenceNumbers(e){let t=e.store(iL),r=e.store(ic);return e.store(iV).get(iU).next(e=>{let n=r=>t.put({targetId:0,path:is(r),sequenceNumber:e.highestListenSequenceNumber}),i=[];return r.iterate((e,r)=>{let s=new nT(e),a=hJ(s);i.push(t.get(a).next(e=>e?n$.resolve():n(s)))}).next(()=>n$.waitFor(i))})}createCollectionParentIndex(e,t){e.createObjectStore(iz,{keyPath:iq});let r=t.store(iz),n=new d$,i=e=>{if(n.add(e)){let t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:is(n)})}};return t.store(ic).iterate({keysOnly:!0},(e,t)=>i(new nT(e).popLast())).next(()=>t.store(iE).iterate({keysOnly:!0},([e,t,r],n)=>i(il(t).popLast())))}rewriteCanonicalIds(e){let t=e.store(iD);return t.iterate((e,r)=>{let n=uP(r),i=uM(this.serializer,n);return t.put(i)})}rewriteRemoteDocumentCache(e,t){let r=t.store(ic),n=[];return r.iterate((e,r)=>{let i=t.store(iC),s=fi(r).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:r.readTime||[0,0],unknownDocument:r.unknownDocument,noDocument:r.noDocument,document:r.document,hasCommittedMutations:!!r.hasCommittedMutations};n.push(i.put(a))}).next(()=>n$.waitFor(n))}runOverlayMigration(e,t){let r=t.store(im),n=hT(this.serializer),i=new hH(hK.factory,this.serializer.remoteSerializer);return r.loadAll().next(e=>{let r=new Map;return e.forEach(e=>{var t;let n=null!=(t=r.get(e.userId))?t:li();uO(this.serializer,e).keys().forEach(e=>n=n.add(e)),r.set(e.userId,n)}),n$.forEach(r,(e,r)=>{let s=new r$(r),a=uZ.forUser(this.serializer,s),o=i.getIndexManager(s);return new hD(n,d1.forUser(s,this.serializer,o,i.referenceDelegate),a,o).recalculateAndSaveOverlaysForDocumentKeys(new sp(t,n9.INVALID),e).next()})})}}function hJ(e){return[0,is(e)]}function hX(e){e.createObjectStore(iu)}function hZ(e){e.createObjectStore(ih,{keyPath:ip}),e.createObjectStore(im,{keyPath:ig,autoIncrement:!0}).createIndex(iy,iv,{unique:!0}),e.createObjectStore(iE)}function h0(e,t){return t.store(im).loadAll().next(r=>{e.deleteObjectStore(im),e.createObjectStore(im,{keyPath:ig,autoIncrement:!0}).createIndex(iy,iv,{unique:!0});let n=t.store(im),i=r.map(e=>n.put(e));return n$.waitFor(i)})}function h1(e){e.createObjectStore(ic)}function h2(e){let t=e.createObjectStore(iC,{keyPath:i_});t.createIndex(iI,ix),t.createIndex(iR,ik)}function h3(e){e.createObjectStore(iA)}function h6(e){e.createObjectStore(iL,{keyPath:iF}).createIndex(ij,iB,{unique:!0}),e.createObjectStore(iD,{keyPath:iO}).createIndex(iP,iM,{unique:!0}),e.createObjectStore(iV)}function h4(e){e.deleteObjectStore(iL),e.deleteObjectStore(iD),e.deleteObjectStore(iV)}function h5(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}function h8(e){let t=e.store(iV),r={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:nb.min().toTimestamp(),targetCount:0};return t.put(iU,r)}function h7(e){e.createObjectStore(i$,{keyPath:iG})}function h9(e){e.createObjectStore(iH,{keyPath:iW})}function fe(e){e.createObjectStore(iK,{keyPath:iQ})}function ft(e){e.createObjectStore(iY,{keyPath:iJ,autoIncrement:!0}).createIndex(iX,iZ,{unique:!1}),e.createObjectStore(i0,{keyPath:i1}).createIndex(i2,i3,{unique:!1}),e.createObjectStore(i6,{keyPath:i4}).createIndex(i5,i8,{unique:!1})}function fr(e){let t=e.createObjectStore(i7,{keyPath:i9});t.createIndex(se,st,{unique:!1}),t.createIndex(sr,sn,{unique:!1})}function fn(e){e.createObjectStore(si,{keyPath:ss})}function fi(e){return e.document?new n_(nT.fromString(e.document.name).popFirst(5)):e.noDocument?n_.fromSegments(e.noDocument.path):e.unknownDocument?n_.fromSegments(e.unknownDocument.path):r0(36783)}let fs="IndexedDbPersistence",fa=18e5,fo=5e3,fl=4e3,fc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",fu="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",fd="firestore_zombie",fh="main";class ff{constructor(e,t,r,n,i,s,a,o,l,c,u=hA){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.queue=i,this.window=s,this.document=a,this.sequenceNumberSyncer=l,this.forceOwningTab=c,this.schemaVersion=u,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=e=>Promise.resolve(),!ff.isAvailable())throw new r4(r6.UNIMPLEMENTED,fu);this.referenceDelegate=new hg(this,n),this.dbName=t+fh,this.serializer=new u_(o),this.simpleDb=new nK(this.dbName,this.schemaVersion,new hY(this.serializer)),this.globalsCache=new u1,this.targetCache=new d9(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hT(this.serializer),this.bundleCache=new uY,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===c&&rJ(fs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new r4(r6.FAILED_PRECONDITION,fc);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.targetCache.getHighestSequenceNumber(e))}).then(e=>{this.listenSequence=new n9(e,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(e=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(e)))}setPrimaryStateListener(e){return this.primaryStateListener=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.simpleDb.setVersionChangeListener(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(e).next(e=>{e||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(e)).next(t=>this.isPrimary&&!t?this.releasePrimaryLeaseIfHeld(e).next(()=>!1):!!t&&this.acquireOrExtendPrimaryLease(e).next(()=>!0))).catch(e=>{if(nX(e))return rY(fs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return rY(fs,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.queue.enqueueRetryable(()=>this.primaryStateListener(e)),this.isPrimary=e})}verifyPrimaryLease(e){return fp(e).get(id).next(e=>n$.resolve(this.isLocalClient(e)))}removeClientMetadata(e){return fm(e).delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,fa)){this.lastGarbageCollectionTime=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=sm(e,i$);return t.loadAll().next(e=>{let r=this.filterActiveClients(e,fa),n=e.filter(e=>-1===r.indexOf(e));return n$.forEach(n,e=>t.delete(e.clientId)).next(()=>n)})}).catch(()=>[]);if(this.webStorage)for(let t of e)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(t.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",fl,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(e){return!!e&&e.ownerId===this.clientId}canActAsPrimary(e){return this.forceOwningTab?n$.resolve(!0):fp(e).get(id).next(t=>{if(null!==t&&this.isWithinAge(t.leaseTimestampMs,fo)&&!this.isClientZombied(t.ownerId)){if(this.isLocalClient(t)&&this.networkEnabled)return!0;if(!this.isLocalClient(t)){if(!t.allowTabSynchronization)throw new r4(r6.FAILED_PRECONDITION,fc);return!1}}return!!this.networkEnabled&&!!this.inForeground||fm(e).loadAll().next(e=>void 0===this.filterActiveClients(e,fo).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,n=this.networkEnabled===e.networkEnabled;if(t||r&&n)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&rY(fs,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[iu,i$],e=>{let t=new sp(e,n9.INVALID);return this.releasePrimaryLeaseIfHeld(t).next(()=>this.removeClientMetadata(t))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(e,t){return e.filter(e=>this.isWithinAge(e.updateTimeMs,t)&&!this.isClientZombied(e.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",e=>fm(e).loadAll().next(e=>this.filterActiveClients(e,fa).map(e=>e.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(e,t){return d1.forUser(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new dW(e,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(e){return uZ.forUser(this.serializer,e)}getBundleCache(){return this.bundleCache}runTransaction(e,t,r){let n;rY(fs,"Starting transaction:",e);let i="readonly"===t?"readonly":"readwrite",s=sf(this.schemaVersion);return this.simpleDb.runTransaction(e,i,s,i=>(n=new sp(i,this.listenSequence?this.listenSequence.next():n9.INVALID),"readwrite-primary"===t)?this.verifyPrimaryLease(n).next(e=>!!e||this.canActAsPrimary(n)).next(t=>{if(!t)throw rJ(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new r4(r6.FAILED_PRECONDITION,nV);return r(n)}).next(e=>this.acquireOrExtendPrimaryLease(n).next(()=>e)):this.verifyAllowTabSynchronization(n).next(()=>r(n))).then(e=>(n.raiseOnCommittedEvent(),e))}verifyAllowTabSynchronization(e){return fp(e).get(id).next(e=>{if(null!==e&&this.isWithinAge(e.leaseTimestampMs,fo)&&!this.isClientZombied(e.ownerId)&&!this.isLocalClient(e)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!e.allowTabSynchronization))throw new r4(r6.FAILED_PRECONDITION,fc)})}acquireOrExtendPrimaryLease(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fp(e).put(id,t)}static isAvailable(){return nK.isAvailable()}releasePrimaryLeaseIfHeld(e){let t=fp(e);return t.get(id).next(e=>this.isLocalClient(e)?(rY(fs,"Releasing primary lease."),t.delete(id)):n$.resolve())}isWithinAge(e,t){let r=Date.now(),n=r-t,i=r;return!(e<n)&&(!(e>i)||(rJ(`Detected an update time that is in the future: ${e} > ${i}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var e;"function"==typeof(null==(e=this.window)?void 0:e.addEventListener)&&(this.windowUnloadHandler=()=>{this.markClientZombied();let e=/(?:Version|Mobile)\/1[456]/;tl()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(e){var t;try{let r=(null==(t=this.webStorage)?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)))!==null;return rY(fs,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(e){return rJ(fs,"Failed to get zombied client id.",e),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){rJ("Failed to set zombie client id.",e)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}}zombiedClientLocalStorageKey(e){return`${fd}_${this.persistenceKey}_${e}`}}function fp(e){return sm(e,iu)}function fm(e){return sm(e,i$)}function fg(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}function fy(e,t,r,n,i){t=[...t],(e=[...e]).sort(r),t.sort(r);let s=e.length,a=t.length,o=0,l=0;for(;o<a&&l<s;){let s=r(e[l],t[o]);s<0?i(e[l++]):s>0?n(t[o++]):(o++,l++)}for(;o<a;)n(t[o++]);for(;l<s;)i(e[l++])}function fv(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}let fb="LocalStore",fS=3e8;class fw{constructor(e,t,r,n){this.persistence=e,this.queryEngine=t,this.serializer=n,this.targetDataByTarget=new sS(nu),this.targetIdByTarget=new o1(e=>op(e),og),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(r)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hD(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}}function fT(e,t,r,n){return new fw(e,t,r,n)}async function fE(e,t){let r=r3(e);return await r.persistence.runTransaction("Handle user change","readonly",e=>{let n;return r.mutationQueue.getAllMutationBatches(e).next(i=>(n=i,r.initializeUserComponents(t),r.mutationQueue.getAllMutationBatches(e))).next(t=>{let i=[],s=[],a=li();for(let e of n)for(let t of(i.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return r.localDocuments.getDocuments(e,a).next(e=>({affectedDocuments:e,removedBatchIds:i,addedBatchIds:s}))})})}function fC(e,t){let r,n,i=r3(e),s=nv.now(),a=t.reduce((e,t)=>e.add(t.key),li());return i.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=o3(),l=li();return i.remoteDocuments.getEntries(e,a).next(e=>{(o=e).forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>i.localDocuments.getOverlayedDocuments(e,o)).next(n=>{r=n;let a=[];for(let e of t){let t=lP(e,r.get(e.key).overlayedDocument);null!=t&&a.push(new lB(e.key,t,aV(t.value.mapValue),lR.exists(!0)))}return i.mutationQueue.addMutationBatch(e,s,a,t)}).next(t=>{n=t;let s=t.applyToLocalDocumentSet(r,l);return i.documentOverlayCache.saveOverlays(e,t.batchId,s)})}).then(()=>({batchId:n.batchId,changes:o8(r)}))}function f_(e,t){let r=r3(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let n=t.batch.keys(),i=r.remoteDocuments.newChangeBuffer({trackRemovals:!0});return fU(r,e,t,i).next(()=>i.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,fI(t))).next(()=>r.localDocuments.getDocuments(e,n))})}function fI(e){let t=li();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}function fx(e,t){let r=r3(e);return r.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let n;return r.mutationQueue.lookupMutationBatch(e,t).next(t=>(r2(null!==t,37113),n=t.keys(),r.mutationQueue.removeMutationBatch(e,t))).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,n)).next(()=>r.localDocuments.getDocuments(e,n))})}function fR(e){let t=r3(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}function fk(e){let t=r3(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.targetCache.getLastRemoteSnapshotVersion(e))}function fA(e,t){let r=r3(e),n=t.snapshotVersion,i=r.targetDataByTarget;return r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{let s=r.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=r.targetDataByTarget;let a=[];t.targetChanges.forEach((s,o)=>{let l=i.get(o);if(!l)return;a.push(r.targetCache.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.targetCache.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(sN.EMPTY_BYTE_STRING,nb.min()).withLastLimboFreeSnapshotVersion(nb.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,n)),i=i.insert(o,c),fD(l,c,s)&&a.push(r.targetCache.updateTargetData(e,c))});let o=o3(),l=li();if(t.documentUpdates.forEach(n=>{t.resolvedLimboDocuments.has(n)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))}),a.push(fN(e,s,t.documentUpdates).next(e=>{o=e.changedDocuments,l=e.existenceChangedKeys})),!n.isEqual(nb.min())){let t=r.targetCache.getLastRemoteSnapshotVersion(e).next(t=>r.targetCache.setTargetsMetadata(e,e.currentSequenceNumber,n));a.push(t)}return n$.waitFor(a).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(r.targetDataByTarget=i,e))}function fN(e,t,r){let n=li(),i=li();return r.forEach(e=>n=n.add(e)),t.getEntries(e,n).next(e=>{let n=o3();return r.forEach((r,s)=>{let a=e.get(r);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(r)),s.isNoDocument()&&s.version.isEqual(nb.min())?(t.removeEntry(r,s.readTime),n=n.insert(r,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),n=n.insert(r,s)):rY(fb,"Ignoring outdated watch update for ",r,". Current version:",a.version," Watch version:",s.version)}),{changedDocuments:n,existenceChangedKeys:i}})}function fD(e,t,r){return!!(0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=fS)||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0}async function fO(e,t){let r=r3(e);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>n$.forEach(t,t=>n$.forEach(t.addedKeys,n=>r.persistence.referenceDelegate.addReference(e,t.targetId,n)).next(()=>n$.forEach(t.removedKeys,n=>r.persistence.referenceDelegate.removeReference(e,t.targetId,n)))))}catch(e){if(nX(e))rY(fb,"Failed to update sequence numbers: "+e);else throw e}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=r.targetDataByTarget.get(t),n=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(n);r.targetDataByTarget=r.targetDataByTarget.insert(t,i)}}}function fP(e,t){let r=r3(e);return r.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=sY),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function fM(e,t){let r=r3(e);return r.persistence.runTransaction("read document","readonly",e=>r.localDocuments.getDocument(e,t))}function fL(e,t){let r=r3(e);return r.persistence.runTransaction("Allocate target","readwrite",e=>{let n;return r.targetCache.getTargetData(e,t).next(i=>i?(n=i,n$.resolve(n)):r.targetCache.allocateTargetId(e).next(i=>(n=new uC(t,i,"TargetPurposeListen",e.currentSequenceNumber),r.targetCache.addTargetData(e,n).next(()=>n))))}).then(e=>{let n=r.targetDataByTarget.get(e.targetId);return(null===n||e.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.targetDataByTarget=r.targetDataByTarget.insert(e.targetId,e),r.targetIdByTarget.set(t,e.targetId)),e})}function fF(e,t,r){let n=r3(e),i=n.targetIdByTarget.get(r);return void 0!==i?n$.resolve(n.targetDataByTarget.get(i)):n.targetCache.getTargetData(t,r)}async function fj(e,t,r){let n=r3(e),i=n.targetDataByTarget.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,e=>n.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(nX(e))rY(fb,`Failed to update sequence numbers for target ${t}: ${e}`);else throw e}n.targetDataByTarget=n.targetDataByTarget.remove(t),n.targetIdByTarget.delete(i.target)}function fB(e,t,r){let n=r3(e),i=nb.min(),s=li();return n.persistence.runTransaction("Execute query","readwrite",e=>fF(n,e,oL(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>n.queryEngine.getDocumentsMatchingQuery(e,t,r?i:nb.min(),r?s:li())).next(e=>(fH(n,oX(t),e),{documents:e,remoteKeys:s})))}function fU(e,t,r,n){let i=r.batch,s=i.keys(),a=n$.resolve();return s.forEach(e=>{a=a.next(()=>n.getEntry(t,e)).next(t=>{let s=r.docVersions.get(e);r2(null!==s,48541),0>t.version.compareTo(s)&&(i.applyToRemoteDocument(t,r),t.isValidDocument()&&(t.setReadTime(r.commitVersion),n.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}function fV(e,t){let r=r3(e),n=r3(r.mutationQueue);return r.persistence.runTransaction("Lookup mutation documents","readonly",e=>n.lookupMutationKeys(e,t).next(t=>t?r.localDocuments.getDocuments(e,t):n$.resolve(null)))}function fz(e,t){r3(r3(e,fw).mutationQueue).removeCachedMutationKeys(t)}function fq(e){return r3(r3(e,fw).persistence).getActiveClients()}function f$(e,t){let r=r3(e),n=r3(r.targetCache),i=r.targetDataByTarget.get(t);return i?Promise.resolve(i.target):r.persistence.runTransaction("Get target data","readonly",e=>n.getTargetDataForTarget(e,t).next(e=>e?e.target:null))}function fG(e,t){let r=r3(e),n=r.collectionGroupReadTime.get(t)||nb.min();return r.persistence.runTransaction("Get new document changes","readonly",e=>r.remoteDocuments.getAllFromCollectionGroup(e,t,nF(n,nI),Number.MAX_SAFE_INTEGER)).then(e=>(fH(r,t,e),e))}function fH(e,t,r){let n=e.collectionGroupReadTime.get(t)||nb.min();r.forEach((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)}),e.collectionGroupReadTime.set(t,n)}function fW(e){return oL(ok(nT.fromString(`__bundle__/docs/${e}`)))}async function fK(e,t,r,n){let i=r3(e),s=li(),a=o3();for(let e of r){let r=t.toDocumentKey(e.metadata.name);e.document&&(s=s.add(r));let n=t.toMutableDocument(e);n.setReadTime(t.toSnapshotVersion(e.metadata.readTime)),a=a.insert(r,n)}let o=i.remoteDocuments.newChangeBuffer({trackRemovals:!0}),l=await fL(i,fW(n));return i.persistence.runTransaction("Apply bundle documents","readwrite",e=>fN(e,o,a).next(t=>(o.apply(e),t)).next(t=>i.targetCache.removeMatchingKeysForTargetId(e,l.targetId).next(()=>i.targetCache.addMatchingKeys(e,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(e,t.changedDocuments,t.existenceChangedKeys)).next(()=>t.changedDocuments)))}function fQ(e,t){let r=r3(e),n=cE(t.createTime);return r.persistence.runTransaction("hasNewerBundle","readonly",e=>r.bundleCache.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(n)>=0)}function fY(e,t){let r=r3(e);return r.persistence.runTransaction("Save bundle","readwrite",e=>r.bundleCache.saveBundleMetadata(e,t))}function fJ(e,t){let r=r3(e);return r.persistence.runTransaction("Get named query","readonly",e=>r.bundleCache.getNamedQuery(e,t))}async function fX(e,t,r=li()){let n=await fL(e,oL(uV(t.bundledQuery))),i=r3(e);return i.persistence.runTransaction("Save named query","readwrite",e=>{let s=cE(t.readTime);if(n.snapshotVersion.compareTo(s)>=0)return i.bundleCache.saveNamedQuery(e,t);let a=n.withResumeToken(sN.EMPTY_BYTE_STRING,s);return i.targetDataByTarget=i.targetDataByTarget.insert(a.targetId,a),i.targetCache.updateTargetData(e,a).next(()=>i.targetCache.removeMatchingKeysForTargetId(e,n.targetId)).next(()=>i.targetCache.addMatchingKeys(e,r,n.targetId)).next(()=>i.bundleCache.saveNamedQuery(e,t))})}async function fZ(e,t){let r=r3(e),n=r.indexManager,i=[];return r.persistence.runTransaction("Configure indexes","readwrite",e=>n.getFieldIndexes(e).next(r=>fy(r,t,nD,t=>{i.push(n.addFieldIndex(e,t))},t=>{i.push(n.deleteFieldIndex(e,t))})).next(()=>n$.waitFor(i)))}function f0(e,t){r3(e).queryEngine.indexAutoCreationEnabled=t}function f1(e){let t=r3(e),r=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",e=>r.deleteAllFieldIndexes(e))}class f2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}let f3=100;function f6(){return tl()?8:nQ(tr())>0?6:4}class f4{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=f3,this.relativeIndexReadCostPerDocument=f6()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,r,n){let i={result:null};return this.performQueryUsingIndex(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.performQueryUsingRemoteKeys(e,t,n,r).next(e=>{i.result=e})}).next(()=>{if(i.result)return;let r=new f2;return this.executeFullCollectionScan(e,t,r).next(n=>{if(i.result=n,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,r,n.size)})}).next(()=>i.result)}createCacheIndexes(e,t,r,n){return r.documentReadCount<this.indexAutoCreationMinCollectionSize?(rQ()<=s.DEBUG&&rY("QueryEngine","SDK will not create cache indexes for query:",oH(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),n$.resolve()):(rQ()<=s.DEBUG&&rY("QueryEngine","Query:",oH(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.relativeIndexReadCostPerDocument*n)?(rQ()<=s.DEBUG&&rY("QueryEngine","The SDK decides to create cache indexes for query:",oH(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,oL(t))):n$.resolve()}performQueryUsingIndex(e,t){if(oN(t))return n$.resolve(null);let r=oL(t);return this.indexManager.getIndexType(e,r).next(n=>0===n?null:(null!==t.limit&&1===n&&(r=oL(t=oV(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(n=>{let i=li(...n);return this.localDocumentsView.getDocuments(e,i).next(n=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.applyQuery(t,n);return this.needsRefill(t,s,i,r.readTime)?this.performQueryUsingIndex(e,oV(t,null,"F")):this.appendRemainingResults(e,s,t,r)}))})))}performQueryUsingRemoteKeys(e,t,r,n){return oN(t)||n.isEqual(nb.min())?n$.resolve(null):this.localDocumentsView.getDocuments(e,r).next(i=>{let a=this.applyQuery(t,i);return this.needsRefill(t,a,r,n)?n$.resolve(null):(rQ()<=s.DEBUG&&rY("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),oH(t)),this.appendRemainingResults(e,a,t,nF(n,nI)).next(e=>e))})}applyQuery(e,t){let r=new sC(oZ(e));return t.forEach((t,n)=>{oW(e,n)&&(r=r.add(n))}),r}needsRefill(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}executeFullCollectionScan(e,t,r){return rQ()<=s.DEBUG&&rY("QueryEngine","Using full collection scan to execute query:",oH(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,nB.min(),r)}appendRemainingResults(e,t,r,n){return this.localDocumentsView.getDocumentsMatchingQuery(e,r,n).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}let f5="firestore_clients";function f8(e,t){return`${f5}_${e}_${t}`}let f7="firestore_mutations";function f9(e,t,r){let n=`${f7}_${e}_${r}`;return t.isAuthenticated()&&(n+=`_${t.uid}`),n}let pe="firestore_targets";function pt(e,t){return`${pe}_${e}_${t}`}let pr="firestore_online_state";function pn(e){return`${pr}_${e}`}let pi="firestore_bundle_loaded_v2";function ps(e){return`${pi}_${e}`}let pa="firestore_sequence_number";function po(e){return`${pa}_${e}`}let pl="SharedClientState";class pc{constructor(e,t,r,n){this.user=e,this.batchId=t,this.state=r,this.error=n}static fromWebStorageEntry(e,t,r){let n,i=JSON.parse(r),s="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return(s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(n=new r4(i.error.code,i.error.message)),s)?new pc(e,t,i.state,n):(rJ(pl,`Failed to parse mutation state for ID '${t}': ${r}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static fromWebStorageEntry(e,t){let r,n=JSON.parse(t),i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return(i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(r=new r4(n.error.code,n.error.message)),i)?new pu(e,n.state,r):(rJ(pl,`Failed to parse target state for ID '${e}': ${t}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pd{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fromWebStorageEntry(e,t){let r=JSON.parse(t),n="object"==typeof r&&r.activeTargetIds instanceof Array,i=la();for(let e=0;n&&e<r.activeTargetIds.length;++e)n=sZ(r.activeTargetIds[e]),i=i.add(r.activeTargetIds[e]);return n?new pd(e,i):(rJ(pl,`Failed to parse client data for instance '${e}': ${t}`),null)}}class ph{constructor(e,t){this.clientId=e,this.onlineState=t}static fromWebStorageEntry(e){let t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new ph(t.clientId,t.onlineState):(rJ(pl,`Failed to parse online state: ${e}`),null)}}class pf{constructor(){this.activeTargetIds=la()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class pp{constructor(e,t,r,n,i){this.window=e,this.queue=t,this.persistenceKey=r,this.localClientId=n,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new sS(nu),this.started=!1,this.earlyEvents=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.localClientStorageKey=f8(this.persistenceKey,this.localClientId),this.sequenceNumberKey=po(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new pf),this.clientStateKeyRe=RegExp(`^${f5}_${s}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${f7}_${s}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${pe}_${s}_(\\d+)$`),this.onlineStateKey=pn(this.persistenceKey),this.bundleLoadedKey=ps(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(e){return!!(e&&e.localStorage)}async start(){for(let e of(await this.syncEngine.getActiveClients())){if(e===this.localClientId)continue;let t=this.getItem(f8(this.persistenceKey,e));if(t){let r=pd.fromWebStorageEntry(e,t);r&&(this.activeClients=this.activeClients.insert(r.clientId,r))}}this.persistClientState();let e=this.storage.getItem(this.onlineStateKey);if(e){let t=this.fromWebStorageOnlineState(e);t&&this.handleOnlineStateEvent(t)}for(let e of this.earlyEvents)this.handleWebStorageEvent(e);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(e){let t=!1;return this.activeClients.forEach((r,n)=>{n.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.persistMutationState(e,"pending")}updateMutationState(e,t,r){this.persistMutationState(e,t,r),this.removeMutationState(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let t=this.storage.getItem(pt(this.persistenceKey,e));if(t){let n=pu.fromWebStorageEntry(e,t);n&&(r=n.state)}}return t&&this.localClientState.addQueryTarget(e),this.persistClientState(),r}removeLocalQueryTarget(e){this.localClientState.removeQueryTarget(e),this.persistClientState()}isLocalQueryTarget(e){return this.localClientState.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(pt(this.persistenceKey,e))}updateQueryState(e,t,r){this.persistQueryTargetState(e,t,r)}handleUserChange(e,t,r){t.forEach(e=>{this.removeMutationState(e)}),this.currentUser=e,r.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.persistOnlineState(e)}notifyBundleLoaded(e){this.persistBundleLoadedState(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return rY(pl,"READ",e,t),t}setItem(e,t){rY(pl,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){rY(pl,"REMOVE",e),this.storage.removeItem(e)}handleWebStorageEvent(e){let t=e;if(t.storageArea===this.storage){if(rY(pl,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void rJ("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueRetryable(async()=>{if(!this.started)return void this.earlyEvents.push(t);if(null!==t.key){if(this.clientStateKeyRe.test(t.key))if(null!=t.newValue){let e=this.fromWebStorageClientState(t.key,t.newValue);if(e)return this.handleClientStateEvent(e.clientId,e)}else{let e=this.fromWebStorageClientStateKey(t.key);return this.handleClientStateEvent(e,null)}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue){let e=this.fromWebStorageMutationMetadata(t.key,t.newValue);if(e)return this.handleMutationBatchEvent(e)}}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue){let e=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue);if(e)return this.handleQueryTargetEvent(e)}}else if(t.key===this.onlineStateKey){if(null!==t.newValue){let e=this.fromWebStorageOnlineState(t.newValue);if(e)return this.handleOnlineStateEvent(e)}}else if(t.key===this.sequenceNumberKey){let e=pm(t.newValue);e!==n9.INVALID&&this.sequenceNumberHandler(e)}else if(t.key===this.bundleLoadedKey){let e=this.fromWebStoreBundleLoadedState(t.newValue);await Promise.all(e.map(e=>this.syncEngine.synchronizeWithChangedDocuments(e)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(e,t,r){let n=new pc(this.currentUser,e,t,r),i=f9(this.persistenceKey,this.currentUser,e);this.setItem(i,n.toWebStorageJSON())}removeMutationState(e){let t=f9(this.persistenceKey,this.currentUser,e);this.removeItem(t)}persistOnlineState(e){let t={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))}persistQueryTargetState(e,t,r){let n=pt(this.persistenceKey,e),i=new pu(e,t,r);this.setItem(n,i.toWebStorageJSON())}persistBundleLoadedState(e){let t=JSON.stringify(Array.from(e));this.setItem(this.bundleLoadedKey,t)}fromWebStorageClientStateKey(e){let t=this.clientStateKeyRe.exec(e);return t?t[1]:null}fromWebStorageClientState(e,t){let r=this.fromWebStorageClientStateKey(e);return pd.fromWebStorageEntry(r,t)}fromWebStorageMutationMetadata(e,t){let r=this.mutationBatchKeyRe.exec(e),n=Number(r[1]),i=void 0!==r[2]?r[2]:null;return pc.fromWebStorageEntry(new r$(i),n,t)}fromWebStorageQueryTargetMetadata(e,t){let r=Number(this.queryTargetKeyRe.exec(e)[1]);return pu.fromWebStorageEntry(r,t)}fromWebStorageOnlineState(e){return ph.fromWebStorageEntry(e)}fromWebStoreBundleLoadedState(e){return JSON.parse(e)}async handleMutationBatchEvent(e){return e.user.uid!==this.currentUser.uid?void rY(pl,`Ignoring mutation for non-active user ${e.user.uid}`):this.syncEngine.applyBatchState(e.batchId,e.state,e.error)}handleQueryTargetEvent(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)}handleClientStateEvent(e,t){let r=t?this.activeClients.insert(e,t):this.activeClients.remove(e),n=this.extractActiveQueryTargets(this.activeClients),i=this.extractActiveQueryTargets(r),s=[],a=[];return i.forEach(e=>{n.has(e)||s.push(e)}),n.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.applyActiveTargetsChange(s,a).then(()=>{this.activeClients=r})}handleOnlineStateEvent(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}extractActiveQueryTargets(e){let t=la();return e.forEach((e,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}function pm(e){let t=n9.INVALID;if(null!=e)try{let r=JSON.parse(e);r2("number"==typeof r,30636,{seqString:e}),t=r}catch(e){rJ(pl,"Failed to read sequence number from WebStorage",e)}return t}class pg{constructor(){this.localState=new pf,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,r){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new pf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class py{addCallback(e){}shutdown(){}}class pv{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}}let pb=null;function pS(){return 0x10000000+Math.round(0x80000000*Math.random())}function pw(){return null===pb?pb=pS():pb++,"0x"+pb.toString(16)}function pT(e){return new Promise((t,r)=>{e((e,n)=>{e?r(e):t(n)})})}let pE="1.9.15",pC="GrpcConnection",p_=`gl-node/${process.versions.node} fire/${rG} grpc/${pE}`;function pI(e,t,r,n){r2(null===t||"OAuth"===t.type,36936);let i=new rU.OS;return t&&t.headers.forEach((e,t)=>i.set(t,e)),r&&r.headers.forEach((e,t)=>i.set(t,e)),n&&i.set("X-Firebase-GMPID",n),i.set("X-Goog-Api-Client",p_),i.set("Google-Cloud-Resource-Prefix",e),i.set("x-goog-request-params",e),i}class px{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){rY(pC,"Creating Firestore stub.");let e=this.databaseInfo.ssl?rU.z3.createSsl():rU.z3.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,r,n,i){let s=pw(),a=this.ensureActiveStub(),o=pI(this.databasePath,n,i,this.databaseInfo.appId),l=Object.assign({database:this.databasePath},r);return pT(t=>(rY(pC,`RPC '${e}' ${s} invoked with request:`,r),a[e](l,o,(r,n)=>{r?(rY(pC,`RPC '${e}' ${s} failed with error:`,r),t(new r4(l1(r.code),r.message))):(rY(pC,`RPC '${e}' ${s} completed with response:`,n),t(void 0,n))})))}invokeStreamingRPC(e,t,r,n,i,s){let a=pw(),o=[],l=new r5;rY(pC,`RPC '${e}' ${a} invoked (streaming) with request:`,r);let c=this.ensureActiveStub(),u=pI(this.databasePath,n,i,this.databaseInfo.appId),d=Object.assign(Object.assign({},r),{database:this.databasePath}),h=c[e](d,u),f=!1;return h.on("data",t=>{rY(pC,`RPC ${e} ${a} received result:`,t),o.push(t),void 0!==s&&o.length===s&&(f=!0,l.resolve(o))}),h.on("end",()=>{rY(pC,`RPC '${e}' ${a} completed.`),f||(f=!0,l.resolve(o))}),h.on("error",t=>{rY(pC,`RPC '${e}' ${a} failed with error:`,t);let r=l1(t.code);l.reject(new r4(r,t.message))}),l.promise}openStream(e,t,r){let n=pw(),i=this.ensureActiveStub(),s=pI(this.databasePath,t,r,this.databaseInfo.appId),a=i[e](s),o=!1,l=e=>{o||(o=!0,c.callOnClose(e),a.end())},c=new pv({sendFn:t=>{if(o)rY(pC,`RPC '${e}' stream ${n} not sending because gRPC stream is closed:`,t);else{rY(pC,`RPC '${e}' stream ${n} sending:`,t);try{a.write(t)}catch(e){throw rJ("Failure sending:",t),rJ("Error:",e),e}}},closeFn:()=>{rY(pC,`RPC '${e}' stream ${n} closed locally via close().`),l()}}),u=!1;return a.on("data",t=>{o||(rY(pC,`RPC '${e}' stream ${n} received:`,t),u||(c.callOnConnected(),u=!0),c.callOnMessage(t))}),a.on("end",()=>{rY(pC,`RPC '${e}' stream ${n} ended.`),l()}),a.on("error",t=>{o||(rX(pC,`RPC '${e}' stream ${n} error. Code:`,t.code,"Message:",t.message),l(new r4(l1(t.code),t.message)))}),rY(pC,`Opening RPC '${e}' stream ${n} to ${this.databaseInfo.host}`),setTimeout(()=>{c.callOnOpen()},0),c}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let pR={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:0x44f2530,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var pk={nested:pR},pA=Object.freeze({__proto__:null,nested:pR,default:pk});let pN={longs:String,enums:String,defaults:!0,oneofs:!1};function pD(){let e=rV.rS(pA,pN);return rU.ex(e)}function pO(e){return new px(pD(),e)}function pP(){return new py}function pM(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function pL(){return null}function pF(e){return new cp(e,!1)}let pj="ExponentialBackoff",pB=1e3,pU=1.5,pV=6e4;class pz{constructor(e,t,r=pB,n=pU,i=pV){this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=n,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),n=Math.max(0,t-r);n>0&&rY(pj,`Backing off for ${n} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,n,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}let pq="PersistentStream",p$=6e4,pG=1e4;class pH{constructor(e,t,r,n,i,s,a,o){this.queue=e,this.idleTimerId=r,this.healthTimerId=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new pz(e,t)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state)return void this.performBackoff();this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,p$,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(e,t){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==e?this.backoff.reset():t&&t.code===r6.RESOURCE_EXHAUSTED?(rJ(t.toString()),rJ("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===r6.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,await this.listener.onClose(t)}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,r])=>{this.closeCount===t&&this.startStream(e,r)},t=>{e(()=>{let e=new r4(r6.UNKNOWN,"Fetching auth token failed: "+t.message);return this.handleStreamClose(e)})})}startStream(e,t){let r=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{r(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{r(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,pG,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(e=>{r(()=>this.handleStreamClose(e))}),this.stream.onMessage(e=>{r(()=>1==++this.responseCount?this.onFirst(e):this.onNext(e))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(e){return rY(pq,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(rY(pq,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class pW extends pH{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=cU(this.serializer,e),r=cz(e);return this.listener.onWatchChange(t,r)}watch(e){let t={};t.database=cN(this.serializer),t.addTarget=c4(this.serializer,e);let r=c3(this.serializer,e);r&&(t.labels=r),this.sendRequest(t)}unwatch(e){let t={};t.database=cN(this.serializer),t.removeTarget=e,this.sendRequest(t)}}class pK extends pH{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return r2(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,r2(!e.writeResults||0===e.writeResults.length,55816),this.listener.onHandshakeComplete()}onNext(e){r2(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=cK(e.writeResults,e.commitTime),r=cE(e.commitTime);return this.listener.onMutationResult(r,t)}writeHandshake(){let e={};e.database=cN(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>cq(this.serializer,e))};this.sendRequest(t)}}class pQ{}class pY extends pQ{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new r4(r6.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,r,n){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.invokeRPC(e,c_(t,r),n,i,s)).catch(e=>{if("FirebaseError"===e.name)throw e.code===r6.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new r4(r6.UNKNOWN,e.toString())})}invokeStreamingRPC(e,t,r,n,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.invokeStreamingRPC(e,c_(t,r),n,s,a,i)).catch(e=>{if("FirebaseError"===e.name)throw e.code===r6.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new r4(r6.UNKNOWN,e.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function pJ(e,t,r,n){return new pY(e,t,r,n)}async function pX(e,t){let r=r3(e),n={writes:t.map(e=>cq(r.serializer,e))};await r.invokeRPC("Commit",r.serializer.databaseId,nT.emptyPath(),n)}async function pZ(e,t){let r=r3(e),n={documents:t.map(e=>cx(r.serializer,e))},i=await r.invokeStreamingRPC("BatchGetDocuments",r.serializer.databaseId,nT.emptyPath(),n,t.length),s=new Map;i.forEach(e=>{let t=cB(r.serializer,e);s.set(t.key.toString(),t)});let a=[];return t.forEach(e=>{let t=s.get(e.toString());r2(!!t,55234,{key:e}),a.push(t)}),a}async function p0(e,t,r){var n;let i=r3(e),{request:s,aliasMap:a,parent:o}=c0(i.serializer,oF(t),r);i.connection.shouldResourcePathBeIncludedInRequest||delete s.parent;let l=(await i.invokeStreamingRPC("RunAggregationQuery",i.serializer.databaseId,o,s,1)).filter(e=>!!e.result);r2(1===l.length,64727);let c=null==(n=l[0].result)?void 0:n.aggregateFields;return Object.keys(c).reduce((e,t)=>(e[a[t]]=c[t],e),{})}function p1(e,t,r){let n=r3(e);return n.verifyInitialized(),new pK(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}function p2(e,t,r){let n=r3(e);return n.verifyInitialized(),new pW(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}let p3="OnlineStateTracker",p6=1,p4=1e4;class p5{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",p4,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${p4/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=p6&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${p6} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===e&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(rJ(t),this.shouldWarnClientIsOffline=!1):rY(p3,t)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}let p8="RemoteStore",p7=10;class p9{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=i,this.connectivityMonitor.addCallback(e=>{r.enqueueAndForget(async()=>{mh(this)&&(rY(p8,"Restarting streams for network reachability change."),await mD(this))})}),this.onlineStateTracker=new p5(r,n)}}function me(e,t,r,n,i){return new p9(e,t,r,n,i)}function mt(e){let t=r3(e);return t.offlineCauses.delete(0),mr(t)}async function mr(e){if(mh(e))for(let t of e.onNetworkStatusChange)await t(!0)}async function mn(e){let t=r3(e);t.offlineCauses.add(0),await mi(t),t.onlineStateTracker.set("Offline")}async function mi(e){for(let t of e.onNetworkStatusChange)await t(!1)}async function ms(e){let t=r3(e);rY(p8,"RemoteStore shutting down."),t.offlineCauses.add(5),await mi(t),t.connectivityMonitor.shutdown(),t.onlineStateTracker.set("Unknown")}function ma(e,t){let r=r3(e);!r.listenTargets.has(t.targetId)&&(r.listenTargets.set(t.targetId,t),md(r)?mu(r):mM(r).isOpen()&&ml(r,t))}function mo(e,t){let r=r3(e),n=mM(r);r.listenTargets.delete(t),n.isOpen()&&mc(r,t),0===r.listenTargets.size&&(n.isOpen()?n.markIdle():mh(r)&&r.onlineStateTracker.set("Unknown"))}function ml(e,t){if(e.watchChangeAggregator.recordPendingTargetRequest(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(nb.min())>0){let r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}mM(e).watch(t)}function mc(e,t){e.watchChangeAggregator.recordPendingTargetRequest(t),mM(e).unwatch(t)}function mu(e){e.watchChangeAggregator=new co({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),getTargetDataForTarget:t=>e.listenTargets.get(t)||null,getDatabaseId:()=>e.datastore.serializer.databaseId}),mM(e).start(),e.onlineStateTracker.handleWatchStreamStart()}function md(e){return mh(e)&&!mM(e).isStarted()&&e.listenTargets.size>0}function mh(e){return 0===r3(e).offlineCauses.size}function mf(e){e.watchChangeAggregator=void 0}async function mp(e){e.onlineStateTracker.set("Online")}async function mm(e){e.listenTargets.forEach((t,r)=>{ml(e,t)})}async function mg(e,t){mf(e),md(e)?(e.onlineStateTracker.handleWatchStreamFailure(t),mu(e)):e.onlineStateTracker.set("Unknown")}async function my(e,t,r){if(e.onlineStateTracker.set("Online"),t instanceof ci&&2===t.state&&t.cause){try{await mw(e,t)}catch(r){rY(p8,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await mv(e,r)}return}if(t instanceof cr?e.watchChangeAggregator.handleDocumentChange(t):t instanceof cn?e.watchChangeAggregator.handleExistenceFilter(t):e.watchChangeAggregator.handleTargetChange(t),!r.isEqual(nb.min()))try{let t=await fk(e.localStore);r.compareTo(t)>=0&&await mS(e,r)}catch(t){rY(p8,"Failed to raise snapshot:",t),await mv(e,t)}}async function mv(e,t,r){if(nX(t))e.offlineCauses.add(1),await mi(e),e.onlineStateTracker.set("Offline"),r||(r=()=>fk(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{rY(p8,"Retrying IndexedDB access"),await r(),e.offlineCauses.delete(1),await mr(e)});else throw t}function mb(e,t){return t().catch(r=>mv(e,r,t))}function mS(e,t){let r=e.watchChangeAggregator.createRemoteEvent(t);return r.targetChanges.forEach((r,n)=>{if(r.resumeToken.approximateByteSize()>0){let i=e.listenTargets.get(n);i&&e.listenTargets.set(n,i.withResumeToken(r.resumeToken,t))}}),r.targetMismatches.forEach((t,r)=>{let n=e.listenTargets.get(t);n&&(e.listenTargets.set(t,n.withResumeToken(sN.EMPTY_BYTE_STRING,n.snapshotVersion)),mc(e,t),ml(e,new uC(n.target,t,r,n.sequenceNumber)))}),e.remoteSyncer.applyRemoteEvent(r)}async function mw(e,t){let r=t.cause;for(let n of t.targetIds)e.listenTargets.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.listenTargets.delete(n),e.watchChangeAggregator.removeTarget(n))}async function mT(e){let t=r3(e),r=mL(t),n=t.writePipeline.length>0?t.writePipeline[t.writePipeline.length-1].batchId:sY;for(;mE(t);)try{let e=await fP(t.localStore,n);if(null===e){0===t.writePipeline.length&&r.markIdle();break}n=e.batchId,mC(t,e)}catch(e){await mv(t,e)}m_(t)&&mI(t)}function mE(e){return mh(e)&&e.writePipeline.length<p7}function mC(e,t){e.writePipeline.push(t);let r=mL(e);r.isOpen()&&r.handshakeComplete&&r.writeMutations(t.mutations)}function m_(e){return mh(e)&&!mL(e).isStarted()&&e.writePipeline.length>0}function mI(e){mL(e).start()}async function mx(e){mL(e).writeHandshake()}async function mR(e){let t=mL(e);for(let r of e.writePipeline)t.writeMutations(r.mutations)}async function mk(e,t,r){let n=e.writePipeline.shift(),i=lY.from(n,t,r);await mb(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await mT(e)}async function mA(e,t){t&&mL(e).handshakeComplete&&await mN(e,t),m_(e)&&mI(e)}async function mN(e,t){if(l0(t.code)){let r=e.writePipeline.shift();mL(e).inhibitBackoff(),await mb(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await mT(e)}}async function mD(e){let t=r3(e);t.offlineCauses.add(4),await mi(t),t.onlineStateTracker.set("Unknown"),t.offlineCauses.delete(4),await mr(t)}async function mO(e,t){let r=r3(e);r.asyncQueue.verifyOperationInProgress(),rY(p8,"RemoteStore received new credentials");let n=mh(r);r.offlineCauses.add(3),await mi(r),n&&r.onlineStateTracker.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.offlineCauses.delete(3),await mr(r)}async function mP(e,t){let r=r3(e);t?(r.offlineCauses.delete(2),await mr(r)):t||(r.offlineCauses.add(2),await mi(r),r.onlineStateTracker.set("Unknown"))}function mM(e){return e.watchStream||(e.watchStream=p2(e.datastore,e.asyncQueue,{onConnected:mp.bind(null,e),onOpen:mm.bind(null,e),onClose:mg.bind(null,e),onWatchChange:my.bind(null,e)}),e.onNetworkStatusChange.push(async t=>{t?(e.watchStream.inhibitBackoff(),md(e)?mu(e):e.onlineStateTracker.set("Unknown")):(await e.watchStream.stop(),mf(e))})),e.watchStream}function mL(e){return e.writeStream||(e.writeStream=p1(e.datastore,e.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:mx.bind(null,e),onClose:mA.bind(null,e),onHandshakeComplete:mR.bind(null,e),onMutationResult:mk.bind(null,e)}),e.onNetworkStatusChange.push(async t=>{t?(e.writeStream.inhibitBackoff(),await mT(e)):(await e.writeStream.stop(),e.writePipeline.length>0&&(rY(p8,`Stopping write stream with ${e.writePipeline.length} pending writes`),e.writePipeline=[]))})),e.writeStream}let mF="AsyncQueue";class mj{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new r5,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){let s=new mj(e,t,Date.now()+r,n,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new r4(r6.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mB(e,t){if(rJ(mF,`${t}: ${e}`),nX(e))return new r4(r6.UNAVAILABLE,`${t}: ${e}`);throw e}class mU{static emptySet(e){return new mU(e.comparator)}constructor(e){e?this.comparator=(t,r)=>e(t,r)||n_.comparator(t.key,r.key):this.comparator=(e,t)=>n_.comparator(e.key,t.key),this.keyedMap=o4(),this.sortedSet=new sS(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof mU)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){let e=[];return(this.forEach(t=>{e.push(t.toString())}),0===e.length)?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let r=new mU;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class mV{constructor(){this.changeMap=new sS(n_.comparator)}track(e){let t=e.doc.key,r=this.changeMap.get(t);if(!r){this.changeMap=this.changeMap.insert(t,e);return}0!==e.type&&3===r.type?this.changeMap=this.changeMap.insert(t,e):3===e.type&&1!==r.type?this.changeMap=this.changeMap.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.changeMap=this.changeMap.remove(t):1===e.type&&2===r.type?this.changeMap=this.changeMap.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):r0(63341,{change:e,oldChange:r})}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,r)=>{e.push(r)}),e}}class mz{constructor(e,t,r,n,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new mz(e,t,mU.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!o$(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==r[e].type||!t[e].doc.isEqual(r[e].doc))return!1;return!0}}class mq{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}}function m$(){return new mG}class mG{constructor(){this.queries=mH(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){m0(this,new r4(r6.ABORTED,"Firestore shutting down"))}}function mH(){return new o1(e=>oG(e),o$)}async function mW(e,t){let r=r3(e),n=3,i=t.query,s=r.queries.get(i);s?!s.hasRemoteListeners()&&t.listensToRemoteStore()&&(n=2):(s=new mq,n=+!t.listensToRemoteStore());try{switch(n){case 0:s.viewSnap=await r.onListen(i,!0);break;case 1:s.viewSnap=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(r){let e=mB(r,`Initialization of query '${oH(t.query)}' failed`);t.onError(e);return}r.queries.set(i,s),s.listeners.push(t),t.applyOnlineStateChange(r.onlineState),s.viewSnap&&t.onViewSnapshot(s.viewSnap)&&m1(r)}async function mK(e,t){let r=r3(e),n=t.query,i=3,s=r.queries.get(n);if(s){let e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),0===s.listeners.length?i=+!t.listensToRemoteStore():!s.hasRemoteListeners()&&t.listensToRemoteStore()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function mQ(e,t){let r=r3(e),n=!1;for(let e of t){let t=e.query,i=r.queries.get(t);if(i){for(let t of i.listeners)t.onViewSnapshot(e)&&(n=!0);i.viewSnap=e}}n&&m1(r)}function mY(e,t,r){let n=r3(e),i=n.queries.get(t);if(i)for(let e of i.listeners)e.onError(r);n.queries.delete(t)}function mJ(e,t){let r=r3(e);r.onlineState=t;let n=!1;r.queries.forEach((e,r)=>{for(let e of r.listeners)e.applyOnlineStateChange(t)&&(n=!0)}),n&&m1(r)}function mX(e,t){r3(e).snapshotsInSyncListeners.add(t),t.next()}function mZ(e,t){r3(e).snapshotsInSyncListeners.delete(t)}function m0(e,t){let r=r3(e),n=r.queries;r.queries=mH(),n.forEach((e,r)=>{for(let e of r.listeners)e.onError(t)})}function m1(e){e.snapshotsInSyncListeners.forEach(e=>{e.next()})}!function(e){e.Default="default",e.Cache="cache"}(c||(c={}));class m2{constructor(e,t,r){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=r||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let t=[];for(let r of e.docChanges)3!==r.type&&t.push(r);e=new mz(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let r="Offline"!==t;return(!this.options.waitForSyncWhenOnline||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return(!!e.syncStateChanged||!!t)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(e){e=mz.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==c.Cache}}class m3{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.addedKeys=r,this.removedKeys=n}static fromSnapshot(e,t){let r=li(),n=li();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new m3(e,t.fromCache,r,n)}}class m6{constructor(e){this.serializer=e}toDocumentKey(e){return cR(this.serializer,e)}toMutableDocument(e){return e.metadata.exists?cL(this.serializer,e.document,!1):az.newNoDocument(this.toDocumentKey(e.metadata.name),this.toSnapshotVersion(e.metadata.readTime))}toSnapshotVersion(e){return cE(e)}}class m4{constructor(e,t,r){this.bundleMetadata=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=m5(e)}addSizedElement(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),!e.payload.documentMetadata.exists&&++t;let r=nT.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}getQueryDocumentMapping(e){let t=new Map,r=new m6(this.serializer);for(let n of e)if(n.metadata.queries){let e=r.toDocumentKey(n.metadata.name);for(let r of n.metadata.queries){let n=(t.get(r)||li()).add(e);t.set(r,n)}}return t}async complete(){let e=await fK(this.localStore,new m6(this.serializer),this.documents,this.bundleMetadata.id),t=this.getQueryDocumentMapping(this.documents);for(let e of this.queries)await fX(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:e}}}function m5(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}function m8(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class m7{constructor(e){this.key=e}}class m9{constructor(e){this.key=e}}class ge{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=li(),this.mutatedKeys=li(),this.docComparator=oZ(e),this.documentSet=new mU(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let r=t?t.changeSet:new mV,n=t?t.documentSet:this.documentSet,i=t?t.mutatedKeys:this.mutatedKeys,s=n,a=!1,o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((e,t)=>{let c=n.get(e),u=oW(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations),f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(r.track({type:3,doc:u}),f=!0):!this.shouldWaitForSyncedDocument(c,u)&&(r.track({type:2,doc:u}),f=!0,(o&&this.docComparator(u,o)>0||l&&0>this.docComparator(u,l))&&(a=!0)):!c&&u?(r.track({type:0,doc:u}),f=!0):c&&!u&&(r.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),r.track({type:1,doc:e})}return{documentSet:s,changeSet:r,needsRefill:a,mutatedKeys:i}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){let i=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let s=e.changeSet.getChanges();s.sort((e,t)=>gt(e.type,t.type)||this.docComparator(e.doc,t.doc)),this.applyTargetChange(r),n=null!=n&&n;let a=t&&!n?this.updateLimboDocuments():[],o=+!!(0===this.limboDocuments.size&&this.current&&!n),l=o!==this.syncState;return(this.syncState=o,0!==s.length||l)?{snapshot:new mz(this.query,e.documentSet,i,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),limboChanges:a}:{limboChanges:a}}applyOnlineStateChange(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new mV,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations}applyTargetChange(e){e&&(e.addedDocuments.forEach(e=>this._syncedDocuments=this._syncedDocuments.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this._syncedDocuments=this._syncedDocuments.delete(e)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=li(),this.documentSet.forEach(e=>{this.shouldBeInLimbo(e.key)&&(this.limboDocuments=this.limboDocuments.add(e.key))});let t=[];return e.forEach(e=>{this.limboDocuments.has(e)||t.push(new m9(e))}),this.limboDocuments.forEach(r=>{e.has(r)||t.push(new m7(r))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=li();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return mz.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function gt(e,t){let r=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return r0(20277,{change:e})}};return r(e)-r(t)}let gr="SyncEngine";class gn{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class gi{constructor(e){this.key=e,this.receivedDocument=!1}}class gs{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.syncEngineListener={},this.queryViewsByQuery=new o1(e=>oG(e),o$),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new sS(n_.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new hL,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=d7.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function ga(e,t,r,n,i,s,a){let o=new gs(e,t,r,n,i,s);return a&&(o._isPrimaryClient=!0),o}async function go(e,t,r=!0){let n,i=gq(e),s=i.queryViewsByQuery.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.computeInitialSnapshot()):n=await gc(i,t,r,!0),n}async function gl(e,t){let r=gq(e);await gc(r,t,!0,!1)}async function gc(e,t,r,n){let i,s=await fL(e.localStore,oL(t)),a=s.targetId,o=e.sharedClientState.addLocalQueryTarget(a,r);return n&&(i=await gu(e,t,a,"current"===o,s.resumeToken)),e.isPrimaryClient&&r&&ma(e.remoteStore,s),i}async function gu(e,t,r,n,i){e.applyDocChanges=(t,r,n)=>gA(e,t,r,n);let s=await fB(e.localStore,t,!0),a=new ge(t,s.remoteKeys),o=a.computeDocChanges(s.documents),l=ct.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,i),c=a.applyChanges(o,e.isPrimaryClient,l);gI(e,r,c.limboChanges);let u=new gn(t,r,a);return e.queryViewsByQuery.set(t,u),e.queriesByTarget.has(r)?e.queriesByTarget.get(r).push(t):e.queriesByTarget.set(r,[t]),c.snapshot}async function gd(e,t,r){let n=r3(e),i=n.queryViewsByQuery.get(t),s=n.queriesByTarget.get(i.targetId);if(s.length>1){n.queriesByTarget.set(i.targetId,s.filter(e=>!o$(e,t))),n.queryViewsByQuery.delete(t);return}n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await fj(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&mo(n.remoteStore,i.targetId),gC(n,i.targetId)}).catch(nq)):(gC(n,i.targetId),await fj(n.localStore,i.targetId,!0))}async function gh(e,t){let r=r3(e),n=r.queryViewsByQuery.get(t),i=r.queriesByTarget.get(n.targetId);r.isPrimaryClient&&1===i.length&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),mo(r.remoteStore,n.targetId))}async function gf(e,t,r){let n=g$(e);try{let e=await fC(n.localStore,t);n.sharedClientState.addPendingMutation(e.batchId),gT(n,e.batchId,r),await gk(n,e.changes),await mT(n.remoteStore)}catch(t){let e=mB(t,"Failed to persist write");r.reject(e)}}async function gp(e,t){let r=r3(e);try{let e=await fA(r.localStore,t);t.targetChanges.forEach((e,t)=>{let n=r.activeLimboResolutionsByTarget.get(t);n&&(r2(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?n.receivedDocument=!0:e.modifiedDocuments.size>0?r2(n.receivedDocument,14607):e.removedDocuments.size>0&&(r2(n.receivedDocument,42227),n.receivedDocument=!1))}),await gk(r,e,t)}catch(e){await nq(e)}}function gm(e,t,r){let n=r3(e);if(n.isPrimaryClient&&0===r||!n.isPrimaryClient&&1===r){let e=[];n.queryViewsByQuery.forEach((r,n)=>{let i=n.view.applyOnlineStateChange(t);i.snapshot&&e.push(i.snapshot)}),mJ(n.eventManager,t),e.length&&n.syncEngineListener.onWatchChange(e),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function gg(e,t,r){let n=r3(e);n.sharedClientState.updateQueryState(t,"rejected",r);let i=n.activeLimboResolutionsByTarget.get(t),s=i&&i.key;if(s){let e=new sS(n_.comparator);e=e.insert(s,az.newNoDocument(s,nb.min()));let r=li().add(s),i=new ce(nb.min(),new Map,new sS(nu),e,r);await gp(n,i),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(s),n.activeLimboResolutionsByTarget.delete(t),gR(n)}else await fj(n.localStore,t,!1).then(()=>gC(n,t,r)).catch(nq)}async function gy(e,t){let r=r3(e),n=t.batch.batchId;try{let e=await f_(r.localStore,t);gE(r,n,null),gS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await gk(r,e)}catch(e){await nq(e)}}async function gv(e,t,r){let n=r3(e);try{let e=await fx(n.localStore,t);gE(n,t,r),gS(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await gk(n,e)}catch(e){await nq(e)}}async function gb(e,t){let r=r3(e);mh(r.remoteStore)||rY(gr,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let e=await fR(r.localStore);if(e===sY)return void t.resolve();let n=r.pendingWritesCallbacks.get(e)||[];n.push(t),r.pendingWritesCallbacks.set(e,n)}catch(r){let e=mB(r,"Initialization of waitForPendingWrites() operation failed");t.reject(e)}}function gS(e,t){(e.pendingWritesCallbacks.get(t)||[]).forEach(e=>{e.resolve()}),e.pendingWritesCallbacks.delete(t)}function gw(e,t){e.pendingWritesCallbacks.forEach(e=>{e.forEach(e=>{e.reject(new r4(r6.CANCELLED,t))})}),e.pendingWritesCallbacks.clear()}function gT(e,t,r){let n=e.mutationUserCallbacks[e.currentUser.toKey()];n||(n=new sS(nu)),n=n.insert(t,r),e.mutationUserCallbacks[e.currentUser.toKey()]=n}function gE(e,t,r){let n=r3(e),i=n.mutationUserCallbacks[n.currentUser.toKey()];if(i){let e=i.get(t);e&&(r?e.reject(r):e.resolve(),i=i.remove(t)),n.mutationUserCallbacks[n.currentUser.toKey()]=i}}function gC(e,t,r=null){for(let n of(e.sharedClientState.removeLocalQueryTarget(t),e.queriesByTarget.get(t)))e.queryViewsByQuery.delete(n),r&&e.syncEngineListener.onWatchError(n,r);e.queriesByTarget.delete(t),e.isPrimaryClient&&e.limboDocumentRefs.removeReferencesForId(t).forEach(t=>{e.limboDocumentRefs.containsKey(t)||g_(e,t)})}function g_(e,t){e.enqueuedLimboResolutions.delete(t.path.canonicalString());let r=e.activeLimboTargetsByKey.get(t);null!==r&&(mo(e.remoteStore,r),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.remove(t),e.activeLimboResolutionsByTarget.delete(r),gR(e))}function gI(e,t,r){for(let n of r)n instanceof m7?(e.limboDocumentRefs.addReference(n.key,t),gx(e,n)):n instanceof m9?(rY(gr,"Document no longer in limbo: "+n.key),e.limboDocumentRefs.removeReference(n.key,t),e.limboDocumentRefs.containsKey(n.key)||g_(e,n.key)):r0(19791,{limboChange:n})}function gx(e,t){let r=t.key,n=r.path.canonicalString();e.activeLimboTargetsByKey.get(r)||e.enqueuedLimboResolutions.has(n)||(rY(gr,"New document in limbo: "+r),e.enqueuedLimboResolutions.add(n),gR(e))}function gR(e){for(;e.enqueuedLimboResolutions.size>0&&e.activeLimboTargetsByKey.size<e.maxConcurrentLimboResolutions;){let t=e.enqueuedLimboResolutions.values().next().value;e.enqueuedLimboResolutions.delete(t);let r=new n_(nT.fromString(t)),n=e.limboTargetIdGenerator.next();e.activeLimboResolutionsByTarget.set(n,new gi(r)),e.activeLimboTargetsByKey=e.activeLimboTargetsByKey.insert(r,n),ma(e.remoteStore,new uC(oL(ok(r.path)),n,"TargetPurposeLimboResolution",n9.INVALID))}}async function gk(e,t,r){let n=r3(e),i=[],s=[],a=[];n.queryViewsByQuery.isEmpty()||(n.queryViewsByQuery.forEach((e,o)=>{a.push(n.applyDocChanges(o,t,r).then(e=>{var t;if((e||r)&&n.isPrimaryClient){let i=e?!e.fromCache:null==(t=null==r?void 0:r.targetChanges.get(o.targetId))?void 0:t.current;n.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);let t=m3.fromSnapshot(o.targetId,e);s.push(t)}}))}),await Promise.all(a),n.syncEngineListener.onWatchChange(i),await fO(n.localStore,s))}async function gA(e,t,r,n){let i=t.view.computeDocChanges(r);i.needsRefill&&(i=await fB(e.localStore,t.query,!1).then(({documents:e})=>t.view.computeDocChanges(e,i)));let s=n&&n.targetChanges.get(t.targetId),a=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return gI(e,t.targetId,o.limboChanges),o.snapshot}async function gN(e,t){let r=r3(e);if(!r.currentUser.isEqual(t)){rY(gr,"User change. New user:",t.toKey());let e=await fE(r.localStore,t);r.currentUser=t,gw(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await gk(r,e.affectedDocuments)}}function gD(e,t){let r=r3(e),n=r.activeLimboResolutionsByTarget.get(t);if(n&&n.receivedDocument)return li().add(n.key);{let e=li(),n=r.queriesByTarget.get(t);if(!n)return e;for(let t of n){let n=r.queryViewsByQuery.get(t);e=e.unionWith(n.view.syncedDocuments)}return e}}async function gO(e,t){let r=r3(e),n=await fB(r.localStore,t.query,!0),i=t.view.synchronizeWithPersistedState(n);return r.isPrimaryClient&&gI(r,t.targetId,i.limboChanges),i}async function gP(e,t){let r=r3(e);return fG(r.localStore,t).then(e=>gk(r,e))}async function gM(e,t,r,n){let i=r3(e),s=await fV(i.localStore,t);if(null===s)return void rY(gr,"Cannot apply mutation batch with id: "+t);"pending"===r?await mT(i.remoteStore):"acknowledged"===r||"rejected"===r?(gE(i,t,n||null),gS(i,t),fz(i.localStore,t)):r0(6720,"Unknown batchState",{batchState:r}),await gk(i,s)}async function gL(e,t){let r=r3(e);if(gq(r),g$(r),!0===t&&!0!==r._isPrimaryClient){let e=r.sharedClientState.getAllActiveQueryTargets(),t=await gj(r,e.toArray());for(let e of(r._isPrimaryClient=!0,await mP(r.remoteStore,!0),t))ma(r.remoteStore,e)}else if(!1===t&&!1!==r._isPrimaryClient){let e=[],t=Promise.resolve();r.queriesByTarget.forEach((n,i)=>{r.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(gC(r,i),fj(r.localStore,i,!0))),mo(r.remoteStore,i)}),await t,await gj(r,e),gF(r),r._isPrimaryClient=!1,await mP(r.remoteStore,!1)}}function gF(e){let t=r3(e);t.activeLimboResolutionsByTarget.forEach((e,r)=>{mo(t.remoteStore,r)}),t.limboDocumentRefs.removeAllReferences(),t.activeLimboResolutionsByTarget=new Map,t.activeLimboTargetsByKey=new sS(n_.comparator)}async function gj(e,t,r){let n=r3(e),i=[],s=[];for(let e of t){let t,r=n.queriesByTarget.get(e);if(r&&0!==r.length)for(let e of(t=await fL(n.localStore,oL(r[0])),r)){let t=n.queryViewsByQuery.get(e),r=await gO(n,t);r.snapshot&&s.push(r.snapshot)}else{let r=await f$(n.localStore,e);t=await fL(n.localStore,r),await gu(n,gB(r),e,!1,t.resumeToken)}i.push(t)}return n.syncEngineListener.onWatchChange(s),i}function gB(e){return oR(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function gU(e){return fq(r3(e).localStore)}async function gV(e,t,r,n){let i=r3(e);if(i._isPrimaryClient)return void rY(gr,"Ignoring unexpected query state notification.");let s=i.queriesByTarget.get(t);if(s&&s.length>0)switch(r){case"current":case"not-current":{let e=await fG(i.localStore,oX(s[0])),n=ce.createSynthesizedRemoteEventForCurrentChange(t,"current"===r,sN.EMPTY_BYTE_STRING);await gk(i,e,n);break}case"rejected":await fj(i.localStore,t,!0),gC(i,t,n);break;default:r0(64155,r)}}async function gz(e,t,r){let n=gq(e);if(n._isPrimaryClient){for(let e of t){if(n.queriesByTarget.has(e)&&n.sharedClientState.isActiveQueryTarget(e)){rY(gr,"Adding an already active target "+e);continue}let t=await f$(n.localStore,e),r=await fL(n.localStore,t);await gu(n,gB(t),r.targetId,!1,r.resumeToken),ma(n.remoteStore,r)}for(let e of r)n.queriesByTarget.has(e)&&await fj(n.localStore,e,!1).then(()=>{mo(n.remoteStore,e),gC(n,e)}).catch(nq)}}function gq(e){let t=r3(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=gp.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=gD.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=gg.bind(null,t),t.syncEngineListener.onWatchChange=mQ.bind(null,t.eventManager),t.syncEngineListener.onWatchError=mY.bind(null,t.eventManager),t}function g$(e){let t=r3(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gy.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=gv.bind(null,t),t}function gG(e,t,r){let n=r3(e);gH(n,t,r).then(e=>{n.sharedClientState.notifyBundleLoaded(e)})}async function gH(e,t,r){try{let n=await t.getMetadata();if(await fQ(e.localStore,n))return await t.close(),r._completeWith(m8(n)),Promise.resolve(new Set);r._updateProgress(m5(n));let i=new m4(n,e.localStore,t.serializer),s=await t.nextElement();for(;s;){let e=await i.addSizedElement(s);e&&r._updateProgress(e),s=await t.nextElement()}let a=await i.complete();return await gk(e,a.changedDocs,void 0),await fY(e.localStore,n),r._completeWith(a.progress),Promise.resolve(a.changedCollectionGroups)}catch(e){return rX(gr,`Loading bundle failed with ${e}`),r._failWith(e),Promise.resolve(new Set)}}class gW{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pF(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return fT(this.persistence,new f4,e.initialUser,this.serializer)}createPersistence(e){return new hH(hK.factory,this.serializer)}createSharedClientState(e){return new pg}async terminate(){var e,t;null==(e=this.gcScheduler)||e.stop(),null==(t=this.indexBackfillerScheduler)||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gW.provider={build:()=>new gW};class gK extends gW{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){return r2(this.persistence.referenceDelegate instanceof hQ,46915),new hf(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createPersistence(e){let t=void 0!==this.cacheSizeBytes?ha.withCacheSize(this.cacheSizeBytes):ha.DEFAULT;return new hH(e=>hQ.factory(e,t),this.serializer)}}class gQ extends gW{constructor(e,t,r){super(),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.onlineComponentProvider.initialize(this,e),await g$(this.onlineComponentProvider.syncEngine),await mT(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return fT(this.persistence,new f4,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new hf(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new n7(t,this.persistence);return new n8(e.asyncQueue,r)}createPersistence(e){let t=fg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ha.withCacheSize(this.cacheSizeBytes):ha.DEFAULT;return new ff(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,pM(),pL(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new pg}}class gY extends gQ{constructor(e,t){super(e,t,!1),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof pp&&(this.sharedClientState.syncEngine={applyBatchState:gM.bind(null,t),applyTargetState:gV.bind(null,t),applyActiveTargetsChange:gz.bind(null,t),getActiveClients:gU.bind(null,t),synchronizeWithChangedDocuments:gP.bind(null,t)},await this.sharedClientState.start()),await this.persistence.setPrimaryStateListener(async e=>{await gL(this.onlineComponentProvider.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){let t=pM();if(!pp.isAvailable(t))throw new r4(r6.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=fg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pp(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class gJ{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>gm(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=gN.bind(null,this.syncEngine),await mP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return m$()}createDatastore(e){let t=pF(e.databaseInfo.databaseId),r=pO(e.databaseInfo);return pJ(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return me(this.localStore,this.datastore,e.asyncQueue,e=>gm(this.syncEngine,e,0),pP())}createSyncEngine(e,t){return ga(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await ms(this.remoteStore),null==(e=this.datastore)||e.terminate(),null==(t=this.eventManager)||t.terminate()}}gJ.provider={build:()=>new gJ};let gX=10240;function gZ(e,t=gX){let r=0;return{async read(){if(r<e.byteLength){let n={value:e.slice(r,r+t),done:!1};return r+=t,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}function g0(e,t,r){if(!r)throw new r4(r6.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function g1(e,t,r,n){if(!0===t&&!0===n)throw new r4(r6.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function g2(e){if(!n_.isDocumentKey(e))throw new r4(r6.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function g3(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function g6(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e)if(e instanceof Array)return"an array";else{let t=g4(e);return t?`a custom ${t} object`:"an object"}else if("function"==typeof e)return"a function";else return r0(12329,{type:typeof e})}function g4(e){return e.constructor?e.constructor.name:null}function g5(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t))if(t.name===e.constructor.name)throw new r4(r6.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");else{let r=g6(e);throw new r4(r6.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}return e}function g8(e,t){if(!(e instanceof Uint8Array))throw new r4(r6.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${g6(e)}`);return gZ(e,t)}class g7{constructor(e){this.observer=e,this.muted=!1}next(e){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):rJ("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class g9{constructor(e,t){this.payload=e,this.byteLength=t}isBundleMetadata(){return"metadata"in this.payload}}class ye{constructor(e,t){this.reader=e,this.serializer=t,this.metadata=new r5,this.buffer=new Uint8Array,this.textDecoder=nl(),this.nextElementImpl().then(e=>{e&&e.isBundleMetadata()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==e?void 0:e.payload)}`))},e=>this.metadata.reject(e))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let e=await this.readLength();if(null===e)return null;let t=this.textDecoder.decode(e),r=Number(t);return isNaN(r)&&this.raiseError(`length string (${t}) is not valid number`),new g9(JSON.parse(await this.readJsonString(r)),e.length+r)}indexOfOpenBracket(){return this.buffer.findIndex(e=>123===e)}async readLength(){for(;0>this.indexOfOpenBracket()&&!await this.pullMoreDataToBuffer(););if(0===this.buffer.length)return null;let e=this.indexOfOpenBracket();e<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async readJsonString(e){for(;this.buffer.length<e;)await this.pullMoreDataToBuffer()&&this.raiseError("Reached the end of bundle when more is expected.");let t=this.textDecoder.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}raiseError(e){throw this.reader.cancel(),Error(`Invalid bundle format: ${e}`)}async pullMoreDataToBuffer(){let e=await this.reader.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}function yt(e,t){return new ye(e,t)}class yr{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new r4(r6.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await pZ(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new lG(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let r=n_.fromPath(t);this.mutations.push(new lK(r,this.precondition(r)))}),await pX(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else if(e.isNoDocument())t=nb.min();else throw r0(50498,{documentName:e.constructor.name});let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new r4(r6.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return this.writtenDocs.has(e.toString())||!t?lR.none():t.isEqual(nb.min())?lR.exists(!1):lR.updateTime(t)}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(this.writtenDocs.has(e.toString())||!t)return lR.exists(!0);if(t.isEqual(nb.min()))throw new r4(r6.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return lR.updateTime(t)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class yn{constructor(e,t,r,n,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=n,this.deferred=i,this.attemptsRemaining=r.maxAttempts,this.backoff=new pz(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(async()=>{let e=new yr(this.datastore),t=this.tryRunUpdateFunction(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.handleTransactionError(e)}))}).catch(e=>{this.handleTransactionError(e)})})}tryRunUpdateFunction(e){try{let t=this.updateFunction(e);if(sJ(t)||!t.catch||!t.then)return this.deferred.reject(Error("Transaction callback must return a Promise")),null;return t}catch(e){return this.deferred.reject(e),null}}handleTransactionError(e){this.attemptsRemaining>0&&this.isRetryableTransactionError(e)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(e)}isRetryableTransactionError(e){if("FirebaseError"===e.name){let t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!lZ(t)}return!1}}let yi="FirestoreClient",ys=100,ya=11,yo=20,yl=22;class yc{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=n,this.user=r$.UNAUTHENTICATED,this.clientId=nc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async e=>{rY(yi,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(rY(yi,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:ys}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new r5;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let t=mB(r,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function yu(e,t){e.asyncQueue.verifyOperationInProgress(),rY(yi,"Initializing OfflineComponentProvider");let r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await fE(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function yd(e,t){e.asyncQueue.verifyOperationInProgress();let r=await yf(e);rY(yi,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>mO(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>mO(t.remoteStore,r)),e._onlineComponents=t}function yh(e){return"FirebaseError"===e.name?e.code===r6.FAILED_PRECONDITION||e.code===r6.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||e.code===yl||e.code===yo||e.code===ya}async function yf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){rY(yi,"Using user provided OfflineComponentProvider");try{await yu(e,e._uninitializedComponentsProvider._offline)}catch(r){let t=r;if(!yh(t))throw t;rX("Error using user provided cache. Falling back to memory cache: "+t),await yu(e,new gW)}}else rY(yi,"Using default OfflineComponentProvider"),await yu(e,new gK(void 0));return e._offlineComponents}async function yp(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(rY(yi,"Using user provided OnlineComponentProvider"),await yd(e,e._uninitializedComponentsProvider._online)):(rY(yi,"Using default OnlineComponentProvider"),await yd(e,new gJ))),e._onlineComponents}function ym(e){return yf(e).then(e=>e.persistence)}function yg(e){return yf(e).then(e=>e.localStore)}function yy(e){return yp(e).then(e=>e.remoteStore)}function yv(e){return yp(e).then(e=>e.syncEngine)}function yb(e){return yp(e).then(e=>e.datastore)}async function yS(e){let t=await yp(e),r=t.eventManager;return r.onListen=go.bind(null,t.syncEngine),r.onUnlisten=gd.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=gl.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=gh.bind(null,t.syncEngine),r}function yw(e,t,r={}){let n=new r5;return e.asyncQueue.enqueueAndForget(async()=>y_(await yS(e),e.asyncQueue,t,r,n)),n.promise}function yT(e,t,r){let n=new r5;return e.asyncQueue.enqueueAndForget(async()=>{try{let i=await yb(e);n.resolve(p0(i,t,r))}catch(e){n.reject(e)}}),n.promise}function yE(e,t){let r=new r5;return e.asyncQueue.enqueueAndForget(async()=>gf(await yv(e),t,r)),r.promise}async function yC(e,t,r){try{let n=await fM(e,t);n.isFoundDocument()?r.resolve(n):n.isNoDocument()?r.resolve(null):r.reject(new r4(r6.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(n){let e=mB(n,`Failed to get document '${t} from cache`);r.reject(e)}}function y_(e,t,r,n,i){let s=new g7({next:o=>{s.mute(),t.enqueueAndForget(()=>mK(e,a));let l=o.docs.has(r);!l&&o.fromCache?i.reject(new r4(r6.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&n&&"server"===n.source?i.reject(new r4(r6.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),a=new m2(ok(r.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return mW(e,a)}async function yI(e,t,r){try{let n=await fB(e,t,!0),i=new ge(t,n.remoteKeys),s=i.computeDocChanges(n.documents),a=i.applyChanges(s,!1);r.resolve(a.snapshot)}catch(n){let e=mB(n,`Failed to execute query '${t} against cache`);r.reject(e)}}function yx(e,t,r,n,i){let s=new g7({next:r=>{s.mute(),t.enqueueAndForget(()=>mK(e,a)),r.fromCache&&"server"===n.source?i.reject(new r4(r6.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(r)},error:e=>i.reject(e)}),a=new m2(r,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return mW(e,a)}function yR(e,t){let r;return yt(g8(r="string"==typeof e?no().encode(e):e),t)}function yk(e,t){return e.asyncQueue.enqueue(async()=>f0(await yg(e),t))}function yA(e,t){return e.timeoutSeconds===t.timeoutSeconds}function yN(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let yD="ComponentProvider",yO=new Map;function yP(e){let t=yO.get(e);t&&(rY(yD,"Removing Datastore"),yO.delete(e),t.terminate())}function yM(e,t,r,n){return new sH(e,t,r,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,yN(n.experimentalLongPollingOptions),n.useFetchStreams,n.isUsingEmulator)}let yL="firestore.googleapis.com",yF=!0,yj=5,yB=30,yU=!0;class yV{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new r4(r6.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yL,this.ssl=yF}else this.host=e.host,this.ssl=null!=(t=e.ssl)?t:yF;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=hs;else if(e.cacheSizeBytes!==hi&&e.cacheSizeBytes<hl)throw new r4(r6.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${hl}`);else this.cacheSizeBytes=e.cacheSizeBytes;g1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=yU:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yN(null!=(r=e.experimentalLongPollingOptions)?r:{}),yz(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&yA(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}function yz(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new r4(r6.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<yj)throw new r4(r6.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is ${yj})`);if(e.timeoutSeconds>yB)throw new r4(r6.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is ${yB})`)}}class yq{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yV({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new r4(r6.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new r4(r6.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yV(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=ns(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,tt("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return yP(this),Promise.resolve()}}function y$(e,t,r,n={}){var i;e=g5(e,yq);let s=e6(t),a=e._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${r}`;a.host!==yL&&a.host!==l&&rX("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let c=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:n});if(!ty(c,o)&&(e._setSettings(c),s&&(e4(`https://${l}`),tt("Firestore",!0)),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=r$.MOCK_USER;else{t=e5(n.mockUserToken,null==(i=e._app)?void 0:i.options.projectId);let s=n.mockUserToken.sub||n.mockUserToken.user_id;if(!s)throw new r4(r6.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new r$(s)}e._authCredentials=new r9(new r8(t,r))}}class yG{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new yG(this.firestore,e,this._query)}}class yH{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yW(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yH(this.firestore,e,this._key)}}class yW extends yG{constructor(e,t,r){super(e,t,ok(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new yH(this.firestore,null,new n_(e))}withConverter(e){return new yW(this.firestore,e,this._path)}}function yK(e,t,...r){if(e=tI(e),1==arguments.length&&(t=nc.newId()),g0("doc","path",t),e instanceof yq){let n=nT.fromString(t,...r);return g2(n),new yH(e,null,new n_(n))}{if(!(e instanceof yH)&&!(e instanceof yW))throw new r4(r6.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(nT.fromString(t,...r));return g2(n),new yH(e.firestore,e instanceof yW?e.converter:null,new n_(n))}}let yQ="AsyncQueue";class yY{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new pz(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new r5;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(nX(e))rY(yQ,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(e=>{throw this.failure=e,this.operationInProgress=!1,rJ("INTERNAL UNHANDLED ERROR: ",yJ(e)),e}).then(e=>(this.operationInProgress=!1,e))));return this.tail=t,t}enqueueAfterDelay(e,t,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let n=mj.createAndSchedule(this,e,t,r,e=>this.removeDelayedOperation(e));return this.delayedOperations.push(n),n}verifyNotFailed(){this.failure&&r0(47125,{messageOrStack:yJ(this.failure)})}verifyOperationInProgress(){}async drain(){let e;do e=this.tail,await e;while(e!==this.tail)}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{for(let t of(this.delayedOperations.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.delayedOperations))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}}function yJ(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class yX extends yq{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new yY,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new yY(e),this._firestoreClient=void 0,await e}}}function yZ(e,t){let r="object"==typeof e?e:rg(),n="string"==typeof e?e:t||sW,i=rc(r,"firestore").getImmediate({identifier:n});if(!i._initialized){let e=e1("firestore");e&&y$(i,...e)}return i}function y0(e){if(e._terminated)throw new r4(r6.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||y1(e),e._firestoreClient}function y1(e){var t,r,n;let i=e._freezeSettings(),s=yM(e._databaseId,(null==(t=e._app)?void 0:t.options.appId)||"",e._persistenceKey,i);!e._componentsProvider&&(null==(r=i.localCache)?void 0:r._offlineComponentProvider)&&(null==(n=i.localCache)?void 0:n._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new yc(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&y2(e._componentsProvider))}function y2(e){let t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}function y3(e,t=!0){rH(rp),rl(new tx("firestore",(e,{instanceIdentifier:r,options:n})=>{let i=e.getProvider("app").getImmediate(),s=new yX(new ne(e.getProvider("auth-internal")),new ni(i,e.getProvider("app-check-internal")),sQ(i,r),i);return n=Object.assign({useFetchStreams:t},n),s._setSettings(n),s},"PUBLIC").setMultipleInstances(!0)),rb(rz,rq,e),rb(rz,rq,"esm2017")}class y6{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class y4{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class y5{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class y8{constructor(e){this._byteString=e}static fromBase64String(e){try{return new y8(sN.fromBase64String(e))}catch(e){throw new r4(r6.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new y8(sN.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class y7{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new r4(r6.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nC(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class y9{constructor(e){this._methodName=e}}class ve{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new r4(r6.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new r4(r6.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return nu(this._lat,e._lat)||nu(this._long,e._long)}}class vt{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return fv(this._values,e._values)}}let vr=/^__.*__$/;class vn{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new lB(e,this.data,this.fieldMask,t,this.fieldTransforms):new lL(e,this.data,t,this.fieldTransforms)}}class vi{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new lB(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function vs(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw r0(40011,{dataSource:e})}}class va{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new va(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let r=null==(t=this.path)?void 0:t.child(e),n=this.contextWith({path:r,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var t;let r=null==(t=this.path)?void 0:t.child(e),n=this.contextWith({path:r,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return vA(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(vs(this.dataSource)&&vr.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class vo{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||pF(e)}createContext(e,t,r,n=!1){return new va({dataSource:e,methodName:t,targetDoc:r,path:nC.emptyPath(),arrayElement:!1,hasConverter:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vl(e){let t=e._freezeSettings(),r=pF(e._databaseId);return new vo(e._databaseId,!!t.ignoreUndefinedProperties,r)}function vc(e,t,r,n,i,s={}){let a,o,l=e.createContext(s.merge||s.mergeFields?2:0,t,r,i);vI("Data must be an object, but it was:",l,n);let c=vS(n,l);if(s.merge)a=new sR(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let n of s.mergeFields){let i=vx(t,n,r);if(!l.contains(i))throw new r4(r6.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);vN(e,i)||e.push(i)}a=new sR(e),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new vn(new aU(c),a,o)}class vu extends y9{_toFieldTransform(e){if(2===e.dataSource)e.fieldMask.push(e.path);else if(1===e.dataSource)throw e.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof vu}}function vd(e,t,r){return new va({dataSource:3,targetDoc:t.settings.targetDoc,methodName:e._methodName,arrayElement:r},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class vh extends null{_toFieldTransform(e){return new lC(e.path,new lm)}isEqual(e){return e instanceof vh}}class vf extends y9{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=vd(this,e,!0),r=new lg(this._elements.map(e=>vb(e,t)));return new lC(e.path,r)}isEqual(e){return e instanceof vf&&ty(this._elements,e._elements)}}class vp extends y9{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=vd(this,e,!0),r=new lv(this._elements.map(e=>vb(e,t)));return new lC(e.path,r)}isEqual(e){return e instanceof vp&&ty(this._elements,e._elements)}}class vm extends y9{constructor(e,t){super(e),this._operand=t}_toFieldTransform(e){let t=new lS(e.serializer,lc(e.serializer,this._operand));return new lC(e.path,t)}isEqual(e){return e instanceof vm&&this._operand===e._operand}}function vg(e,t,r,n){let i=e.createContext(1,t,r);vI("Data must be an object, but it was:",i,n);let s=[],a=aU.empty();return sy(n,(e,n)=>{let o=vk(t,e,r);n=tI(n);let l=i.childContextForFieldPath(o);if(n instanceof vu)s.push(o);else{let e=vb(n,l);null!=e&&(s.push(o),a.set(o,e))}}),new vi(a,new sR(s),i.fieldTransforms)}function vy(e,t,r,n,i,s){let a=e.createContext(1,t,r),o=[vx(t,n,r)],l=[i];if(s.length%2!=0)throw new r4(r6.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)o.push(vx(t,s[e])),l.push(s[e+1]);let c=[],u=aU.empty();for(let e=o.length-1;e>=0;--e)if(!vN(c,o[e])){let t=o[e],r=l[e];r=tI(r);let n=a.childContextForFieldPath(t);if(r instanceof vu)c.push(t);else{let e=vb(r,n);null!=e&&(c.push(t),u.set(t,e))}}return new vi(u,new sR(c),a.fieldTransforms)}function vv(e,t,r,n=!1){return vb(r,e.createContext(n?4:3,t))}function vb(e,t){if(v_(e=tI(e)))return vI("Unsupported field value:",t,e),vS(e,t);if(e instanceof y9)return vT(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),!(e instanceof Array))return vE(e,t);if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");return vw(e,t)}function vS(e,t){let r={};return sb(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):sy(e,(e,n)=>{let i=vb(n,t.childContextForField(e));null!=i&&(r[e]=i)}),{mapValue:{fields:r}}}function vw(e,t){let r=[],n=0;for(let i of e){let e=vb(i,t.childContextForArray(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}function vT(e,t){if(!vs(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}function vE(e,t){if(null===(e=tI(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return lc(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=nv.fromDate(e);return{timestampValue:cv(t.serializer,r)}}else if(e instanceof nv){let r=new nv(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:cv(t.serializer,r)}}else if(e instanceof ve)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};else if(e instanceof y8)return{bytesValue:cS(t.serializer,e._byteString)};else if(e instanceof yH){let r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.createError(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:cC(e.firestore._databaseId||t.databaseId,e._key.path)}}else if(e instanceof vt)return vC(e,t);else throw t.createError(`Unsupported field value: ${g6(e)}`)}function vC(e,t){return{mapValue:{fields:{[s0]:{stringValue:s3},[s6]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.createError("VectorValues must only contain numeric values.");return lo(t.serializer,e)})}}}}}}function v_(e){return"object"==typeof e&&null!==e&&!(e instanceof Array)&&!(e instanceof Date)&&!(e instanceof nv)&&!(e instanceof ve)&&!(e instanceof y8)&&!(e instanceof yH)&&!(e instanceof y9)&&!(e instanceof vt)}function vI(e,t,r){if(!v_(r)||!g3(r)){let n=g6(r);if("an object"===n)throw t.createError(e+" a custom object");throw t.createError(e+" "+n)}}function vx(e,t,r){if((t=tI(t))instanceof y7)return t._internalPath;if("string"==typeof t)return vk(e,t);throw vA("Field path arguments must be of type string or ",e,!1,void 0,r)}let vR=RegExp("[~\\*/\\[\\]]");function vk(e,t,r){if(t.search(vR)>=0)throw vA(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new y7(...t.split("."))._internalPath}catch(n){throw vA(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function vA(e,t,r,n,i){let s=n&&!n.isEmpty(),a=void 0!==i,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new r4(r6.INVALID_ARGUMENT,o+e+l)}function vN(e,t){return e.some(e=>e.isEqual(t))}class vD{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new yH(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let e=new vO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}}}get(e){if(this._document){let t=this._document.data.field(vP("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class vO extends vD{data(){return super.data()}}function vP(e,t){return"string"==typeof t?vk(e,t):t instanceof y7?t._internalPath:t._delegate._internalPath}class vM{}class vL extends vM{}class vF extends vL{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new vF(e,t,r)}_apply(e){let t=this._parse(e);return vJ(e._query,t),new yG(e.firestore,e.converter,oB(e._query,t))}_parse(e){let t=vl(e.firestore);return v$(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class vj extends vM{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vj(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:a1.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(vX(e._query,t),new yG(e.firestore,e.converter,oB(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class vB extends vL{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new vB(e,t)}_apply(e){let t=vG(e._query,this._field,this._direction);return new yG(e.firestore,e.converter,oU(e._query,t))}}class vU extends vL{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new vU(e,t,r)}_apply(e){return new yG(e.firestore,e.converter,oV(e._query,this._limit,this._limitType))}}class vV extends vL{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new vV(e,t,r)}_apply(e){let t=vq(e,this.type,this._docOrFields,this._inclusive);return new yG(e.firestore,e.converter,oz(e._query,t))}}class vz extends vL{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new vz(e,t,r)}_apply(e){let t=vq(e,this.type,this._docOrFields,this._inclusive);return new yG(e.firestore,e.converter,oq(e._query,t))}}function vq(e,t,r,n){if(r[0]=tI(r[0]),r[0]instanceof vD)return vH(e._query,e.firestore._databaseId,t,r[0]._document,n);{let i=vl(e.firestore);return vW(e._query,e.firestore._databaseId,i,t,r,n)}}function v$(e,t,r,n,i,s,a){let o;if(i.isKeyField())if("array-contains"===s||"array-contains-any"===s)throw new r4(r6.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);else if("in"===s||"not-in"===s){vQ(a,s);let t=[];for(let r of a)t.push(vK(n,e,r));o={arrayValue:{values:t}}}else o=vK(n,e,a);else("in"===s||"not-in"===s||"array-contains-any"===s)&&vQ(a,s),o=vv(r,t,a,"in"===s||"not-in"===s);return a0.create(i,s,o)}function vG(e,t,r){if(null!==e.startAt)throw new r4(r6.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new r4(r6.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new aQ(t,r)}function vH(e,t,r,n,i){if(!n)throw new r4(r6.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${r}().`);let s=[];for(let r of oM(e))if(r.field.isKeyField())s.push(aC(t,n.key));else{let e=n.data.field(r.field);if(sz(e))throw new r4(r6.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+r.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==e)s.push(e);else{let e=r.field.canonicalString();throw new r4(r6.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}}return new a$(s,i)}function vW(e,t,r,n,i,s){let a=e.explicitOrderBy;if(i.length>a.length)throw new r4(r6.INVALID_ARGUMENT,`Too many arguments provided to ${n}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let o=[];for(let s=0;s<i.length;s++){let l=i[s];if(a[s].field.isKeyField()){if("string"!=typeof l)throw new r4(r6.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${n}(), but got a ${typeof l}`);if(!oP(e)&&-1!==l.indexOf("/"))throw new r4(r6.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${n}() must be a plain document ID, but '${l}' contains a slash.`);let r=e.path.child(nT.fromString(l));if(!n_.isDocumentKey(r))throw new r4(r6.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${n}() must result in a valid document path, but '${r}' is not because it contains an odd number of segments.`);let i=new n_(r);o.push(aC(t,i))}else{let e=vv(r,n,l);o.push(e)}}return new a$(o,s)}function vK(e,t,r){if("string"==typeof(r=tI(r))){if(""===r)throw new r4(r6.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!oP(t)&&-1!==r.indexOf("/"))throw new r4(r6.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);let n=t.path.child(nT.fromString(r));if(!n_.isDocumentKey(n))throw new r4(r6.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return aC(e,new n_(n))}if(r instanceof yH)return aC(e,r._key);throw new r4(r6.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${g6(r)}.`)}function vQ(e,t){if(!Array.isArray(e)||0===e.length)throw new r4(r6.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function vY(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function vJ(e,t){let r=vZ(e.filters,vY(t.op));if(null!==r)if(r===t.op)throw new r4(r6.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`);else throw new r4(r6.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}function vX(e,t){let r=e;for(let e of t.getFlattenedFilters())vJ(r,e),r=oB(r,e)}function vZ(e,t){for(let r of e)for(let e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}class v0{convertValue(e,t="none"){switch(s5(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sL(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(sF(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw r0(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return sy(e,(e,n)=>{r[e]=this.convertValue(n,t)}),r}convertVectorValue(e){var t,r,n;return new vt(null==(n=null==(r=null==(t=e.fields)?void 0:t[s6].arrayValue)?void 0:r.values)?void 0:n.map(e=>sL(e.doubleValue)))}convertGeoPoint(e){return new ve(sL(e.latitude),sL(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=s$(e);if(null==r)return null;return this.convertValue(r,t);case"estimate":return this.convertTimestamp(sG(e));default:return null}}convertTimestamp(e){let t=sM(e);return new nv(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=nT.fromString(e);r2(uE(r),9688,{name:e});let n=new sK(r.get(1),r.get(3)),i=new n_(r.popFirst(5));return n.isEqual(t)||rJ(`Document ${i} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function v1(e,t,r){let n;return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class v2 extends v0{constructor(e){super(),this.firestore=e}convertBytes(e){return new y8(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new yH(this.firestore,null,t)}}function v3(e,t){if("object"!=typeof e||null===e)return!1;let r=e;for(let e of t)if(e in r&&"function"==typeof r[e])return!0;return!1}class v6{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class v4 extends vD{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);{let t=new v5(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}}}get(e,t={}){if(this._document){let r=this._document.data.field(vP("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class v5 extends v4{data(e={}){return super.data(e)}}function v8(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let n=new v5(e._firestore,e._userDataWriter,r.doc.key,r.doc,new v6(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let n=new v5(e._firestore,e._userDataWriter,t.doc.key,t.doc,new v6(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,s=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:v7(t.type),doc:n,oldIndex:i,newIndex:s}})}}function v7(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return r0(61501,{type:e})}}function v9(e){e=g5(e,yH);let t=g5(e.firestore,yX);return yw(y0(t),e._key).then(r=>bn(t,e,r))}class be extends v0{constructor(e){super(),this.firestore=e}convertBytes(e){return new y8(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new yH(this.firestore,null,t)}}function bt(e,t,r){e=g5(e,yH);let n=g5(e.firestore,yX),i=v1(e.converter,t,r),s=vc(vl(n),"setDoc",e._key,i,null!==e.converter,r).toMutation(e._key,lR.none());return br(n,[s])}function br(e,t){return yE(y0(e),t)}function bn(e,t,r){let n=r.docs.get(t._key),i=new be(e);return new v4(e,i,t._key,n,new v6(r.hasPendingWrites,r.fromCache),t.converter)}function bi(e,t,r){return new y5(t,new be(e),r)}class bs{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=gJ.provider,this._offlineComponentProvider={build:t=>new gQ(t,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}}function ba(e){return new bs(null==e?void 0:e.forceOwnership)}function bo(e,t){if((e=tI(e)).firestore===t)return e;throw new r4(r6.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.")}class bl{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=vl(e)}get(e){let t=bo(e,this._firestore),r=new v2(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return r0(24041);let n=e[0];if(n.isFoundDocument())return new vD(this._firestore,r,n.key,n,t.converter);if(n.isNoDocument())return new vD(this._firestore,r,t._key,null,t.converter);throw r0(18433,{doc:n})})}set(e,t,r){let n=bo(e,this._firestore),i=v1(n.converter,t,r),s=vc(this._dataReader,"Transaction.set",n._key,i,null!==n.converter,r);return this._transaction.set(n._key,s),this}update(e,t,r,...n){let i,s=bo(e,this._firestore);return i="string"==typeof(t=tI(t))||t instanceof y7?vy(this._dataReader,"Transaction.update",s._key,t,r,n):vg(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,i),this}delete(e){let t=bo(e,this._firestore);return this._transaction.delete(t._key),this}}function bc(e){try{return JSON.parse(e)}catch(e){throw new r4(r6.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}function bu(e,t){if("string"!=typeof e[t])throw new r4(r6.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}new WeakMap;class bd{constructor(){this.existenceFilterMismatchCallbacksById=new Map}static get instance(){return bh||l6(bh=new bd),bh}notifyOnExistenceFilterMismatch(e){this.existenceFilterMismatchCallbacksById.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.existenceFilterMismatchCallbacksById;return r.set(t,e),()=>r.delete(t)}}let bh=null;y3("node"),rb("firebase","11.7.3","app");var bf=function(e,t){return(bf=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},bp=function(){return(bp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function bm(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}var bg=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function by(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function bv(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function bb(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function bS(e){return this instanceof bS?(this.v=e,this):new bS(e)}var bw=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},bT=function(e){return(bT=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)},bE="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function bC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let b_=bC,bI=new tf("auth","Firebase",bC()),bx=new tj("@firebase/auth");function bR(e,...t){bx.logLevel<=s.WARN&&bx.warn(`Auth (${rp}): ${e}`,...t)}function bk(e,...t){bx.logLevel<=s.ERROR&&bx.error(`Auth (${rp}): ${e}`,...t)}function bA(e,...t){throw bP(e,...t)}function bN(e,...t){return bP(e,...t)}function bD(e,t,r){return new tf("auth","Firebase",Object.assign(Object.assign({},b_()),{[t]:r})).create(t,{appName:e.name})}function bO(e){return bD(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bP(e,...t){if("string"!=typeof e){let r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return bI.create(e,...t)}function bM(e,t,...r){if(!e)throw bP(t,...r)}function bL(e){let t="INTERNAL ASSERTION FAILED: "+e;throw bk(t),Error(t)}function bF(e,t){e||bL(t)}function bj(){return"http:"===bB()||"https:"===bB()}function bB(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.protocol)||null}function bU(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(bj()||ta()||"connection"in navigator))||navigator.onLine}function bV(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}class bz{constructor(e,t){this.shortDelay=e,this.longDelay=t,bF(t>e,"Short delay should be less than long delay!"),this.isMobile=tn()||to()}get(){return bU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function bq(e,t){bF(e.emulator,"Emulator should always be set here");let{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}class b${static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void bL("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void bL("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void bL("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let bG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},bH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bW=new bz(3e4,6e4);function bK(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function bQ(e,t,r,n,i={}){return bY(e,i,async()=>{let i={},s={};n&&("GET"===t?s=n:i={body:JSON.stringify(n)});let a=tb(Object.assign({key:e.config.apiKey},s)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);let l=Object.assign({method:t,headers:o},i);return ts()||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&e6(e.emulatorConfig.host)&&(l.credentials="include"),b$.fetch()(await bX(e,e.config.apiHost,r,a),l)})}async function bY(e,t,r){e._canInitEmulator=!1;let n=Object.assign(Object.assign({},bG),t);try{let t=new b0(e),i=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();let s=await i.json();if("needConfirmation"in s)throw b1(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{let[t,r]=(i.ok?s.errorMessage:s.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw b1(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw b1(e,"email-already-in-use",s);if("USER_DISABLED"===t)throw b1(e,"user-disabled",s);let a=n[t]||t.toLowerCase().replace(/[_\s]+/g,"-");if(r)throw bD(e,a,r);bA(e,a)}}catch(t){if(t instanceof th)throw t;bA(e,"network-request-failed",{message:String(t)})}}async function bJ(e,t,r,n,i={}){let s=await bQ(e,t,r,n,i);return"mfaPendingCredential"in s&&bA(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function bX(e,t,r,n){let i=`${t}${r}?${n}`,s=e,a=s.config.emulator?bq(e.config,i):`${e.config.apiScheme}://${i}`;return bH.includes(r)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())?s._getPersistence()._getFinalTarget(a).toString():a}function bZ(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class b0{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(bN(this.auth,"network-request-failed")),bW.get())})}}function b1(e,t,r){let n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=bN(e,t,n);return i.customData._tokenResponse=r,i}function b2(e){return void 0!==e&&void 0!==e.enterprise}class b3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return bZ(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function b6(e,t){return bQ(e,"GET","/v2/recaptchaConfig",bK(e,t))}async function b4(e,t){return bQ(e,"POST","/v1/accounts:delete",t)}async function b5(e,t){return bQ(e,"POST","/v1/accounts:lookup",t)}function b8(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function b7(e,t=!1){let r=tI(e),n=await r.getIdToken(t),i=Se(n);bM(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let s="object"==typeof i.firebase?i.firebase:void 0,a=null==s?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:b8(b9(i.auth_time)),issuedAtTime:b8(b9(i.iat)),expirationTime:b8(b9(i.exp)),signInProvider:a||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}function b9(e){return 1e3*Number(e)}function Se(e){let[t,r,n]=e.split(".");if(void 0===t||void 0===r||void 0===n)return bk("JWT malformed, contained fewer than 3 sections"),null;try{let e=eW(r);if(!e)return bk("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return bk("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function St(e){let t=Se(e);return bM(t,"internal-error"),bM(void 0!==t.exp,"internal-error"),bM(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Sr(e,t,r=!1){if(r)return t;try{return await t}catch(t){throw t instanceof th&&Sn(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}function Sn({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class Si{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(!e)return this.errorBackoff=3e4,Math.max(0,(null!=(t=this.user.stsTokenManager.expirationTime)?t:0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(null==e?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ss{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=b8(this.lastLoginAt),this.creationTime=b8(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Sa(e){var t;let r=e.auth,n=await e.getIdToken(),i=await Sr(e,b5(r,{idToken:n}));bM(null==i?void 0:i.users.length,r,"internal-error");let s=i.users[0];e._notifyReloadListener(s);let a=(null==(t=s.providerUserInfo)?void 0:t.length)?Sc(s.providerUserInfo):[],o=Sl(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(null==o?void 0:o.length),u=!!l&&c;Object.assign(e,{uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ss(s.createdAt,s.lastLoginAt),isAnonymous:u})}async function So(e){let t=tI(e);await Sa(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function Sl(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function Sc(e){return e.map(e=>{var{providerId:t}=e,r=bm(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function Su(e,t){let r=await bY(e,{},async()=>{let r=tb({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:i}=e.config,s=await bX(e,n,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",b$.fetch()(s,{method:"POST",headers:a,body:r})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Sd(e,t){return bQ(e,"POST","/v2/accounts:revokeToken",bK(e,t))}class Sh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){bM(e.idToken,"internal-error"),bM(void 0!==e.idToken,"internal-error"),bM(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):St(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){bM(0!==e.length,"internal-error");let t=St(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(bM(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:n,expiresIn:i}=await Su(e,t);this.updateTokensAndExpiration(r,n,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){let{refreshToken:r,accessToken:n,expirationTime:i}=t,s=new Sh;return r&&(bM("string"==typeof r,"internal-error",{appName:e}),s.refreshToken=r),n&&(bM("string"==typeof n,"internal-error",{appName:e}),s.accessToken=n),i&&(bM("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sh,this.toJSON())}_performRefresh(){return bL("not implemented")}}function Sf(e,t){bM("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Sp{constructor(e){var{uid:t,auth:r,stsTokenManager:n}=e,i=bm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Si(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ss(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Sr(this,this.stsTokenManager.getToken(this.auth,e));return bM(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return b7(this,e)}reload(){return So(this)}_assign(e){this!==e&&(bM(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new Sp(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){bM(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Sa(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ru(this.auth.app))return Promise.reject(bO(this.auth));let e=await this.getIdToken();return await Sr(this,b4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,n,i,s,a,o,l,c;let u=null!=(r=t.displayName)?r:void 0,d=null!=(n=t.email)?n:void 0,h=null!=(i=t.phoneNumber)?i:void 0,f=null!=(s=t.photoURL)?s:void 0,p=null!=(a=t.tenantId)?a:void 0,m=null!=(o=t._redirectEventId)?o:void 0,g=null!=(l=t.createdAt)?l:void 0,y=null!=(c=t.lastLoginAt)?c:void 0,{uid:v,emailVerified:b,isAnonymous:S,providerData:w,stsTokenManager:T}=t;bM(v&&T,e,"internal-error");let E=Sh.fromJSON(this.name,T);bM("string"==typeof v,e,"internal-error"),Sf(u,e.name),Sf(d,e.name),bM("boolean"==typeof b,e,"internal-error"),bM("boolean"==typeof S,e,"internal-error"),Sf(h,e.name),Sf(f,e.name),Sf(p,e.name),Sf(m,e.name),Sf(g,e.name),Sf(y,e.name);let C=new Sp({uid:v,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:S,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return w&&Array.isArray(w)&&(C.providerData=w.map(e=>Object.assign({},e))),m&&(C._redirectEventId=m),C}static async _fromIdTokenResponse(e,t,r=!1){let n=new Sh;n.updateFromServerResponse(t);let i=new Sp({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await Sa(i),i}static async _fromGetAccountInfoResponse(e,t,r){let n=t.users[0];bM(void 0!==n.localId,"internal-error");let i=void 0!==n.providerUserInfo?Sc(n.providerUserInfo):[],s=!(n.email&&n.passwordHash)&&!(null==i?void 0:i.length),a=new Sh;a.updateFromIdToken(r);let o=new Sp({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:s});return Object.assign(o,{uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:i,metadata:new Ss(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(null==i?void 0:i.length)}),o}}let Sm=new Map;function Sg(e){bF(e instanceof Function,"Expected a class definition");let t=Sm.get(e);return t?bF(t instanceof e,"Instance stored in cache mismatched with class"):(t=new e,Sm.set(e,t)),t}class Sy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Sy.type="NONE";let Sv=Sy;function Sb(e,t,r){return`firebase:${e}:${t}:${r}`}class SS{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:n,name:i}=this.auth;this.fullUserKey=Sb(this.userKey,n.apiKey,i),this.fullPersistenceKey=Sb("persistence",n.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let t=await b5(this.auth,{idToken:e}).catch(()=>void 0);return t?Sp._fromGetAccountInfoResponse(this.auth,t,e):null}return Sp._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new SS(Sg(Sv),e,r);let n=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),i=n[0]||Sg(Sv),s=Sb(r,e.config.apiKey,e.name),a=null;for(let r of t)try{let t=await r._get(s);if(t){let n;if("string"==typeof t){let r=await b5(e,{idToken:t}).catch(()=>void 0);if(!r)break;n=await Sp._fromGetAccountInfoResponse(e,r,t)}else n=Sp._fromJSON(e,t);r!==i&&(a=n),i=r;break}}catch(e){}let o=n.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length&&(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new SS(i,e,r)}}function Sw(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";{if(S_(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ST(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Sx(t))return"Blackberry";if(SR(t))return"Webos";if(SE(t))return"Safari";if((t.includes("chrome/")||SC(t))&&!t.includes("edge/"))return"Chrome";if(SI(t))return"Android";let r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((null==n?void 0:n.length)===2)return n[1]}return"Other"}function ST(e=tr()){return/firefox\//i.test(e)}function SE(e=tr()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function SC(e=tr()){return/crios\//i.test(e)}function S_(e=tr()){return/iemobile/i.test(e)}function SI(e=tr()){return/android/i.test(e)}function Sx(e=tr()){return/blackberry/i.test(e)}function SR(e=tr()){return/webos/i.test(e)}function Sk(e,t=[]){let r;switch(e){case"Browser":r=Sw(tr());break;case"Worker":r=`${Sw(tr())}-${e}`;break;default:r=e}let n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${rp}/${n}`}class SA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=t=>new Promise((r,n)=>{try{let n=e(t);r(n)}catch(e){n(e)}});r.onAbort=t,this.queue.push(r);let n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}async function SN(e,t={}){return bQ(e,"GET","/v2/passwordPolicy",bK(e,t))}let SD=6;class SO{constructor(e){var t,r,n,i;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(t=s.minPasswordLength)?t:SD,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(n=null==(r=e.allowedNonAlphanumericCharacters)?void 0:r.join(""))?n:"",this.forceUpgradeOnSignin=null!=(i=e.forceUpgradeOnSignin)&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,n,i,s,a;let o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null==(t=o.meetsMinPasswordLength)||t),o.isValid&&(o.isValid=null==(r=o.meetsMaxPasswordLength)||r),o.isValid&&(o.isValid=null==(n=o.containsLowercaseLetter)||n),o.isValid&&(o.isValid=null==(i=o.containsUppercaseLetter)||i),o.isValid&&(o.isValid=null==(s=o.containsNumericCharacter)||s),o.isValid&&(o.isValid=null==(a=o.containsNonAlphanumericCharacter)||a),o}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class SP{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new SL(this),this.idTokenSubscription=new SL(this),this.beforeStateQueue=new SA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sg(t)),this._initializationPromise=this.queue(async()=>{var r,n,i;if(!this._deleted){if(this.persistenceManager=await SS.create(this,e),null==(r=this._resolvePersistenceManagerAvailable)||r.call(this),!this._deleted){if(null==(n=this._popupRedirectResolver)?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null==(i=this.currentUser)?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await b5(this,{idToken:e}),r=await Sp._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ru(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let r=null==(t=this.redirectUser)?void 0:t._redirectEventId,s=null==n?void 0:n._redirectEventId,a=await this.tryRedirectSignIn(e);(!r||r===s)&&(null==a?void 0:a.user)&&(n=a.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(e){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return(bM(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId)?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Sa(e)}catch(e){if((null==e?void 0:e.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ru(this.app))return Promise.reject(bO(this));let t=e?tI(e):null;return t&&bM(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&bM(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ru(this.app)?Promise.reject(bO(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ru(this.app)?Promise.reject(bO(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sg(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new SO(await SN(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new tf("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await Sd(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(e=this._currentUser)?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Sg(e)||this._popupRedirectResolver;bM(t,this,"argument-error"),this.redirectPersistenceManager=await SS.create(this,[Sg(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return(this._isInitialized&&await this.queue(async()=>{}),(null==(t=this._currentUser)?void 0:t._redirectEventId)===e)?this._currentUser:(null==(r=this.redirectUser)?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=null!=(t=null==(e=this.currentUser)?void 0:e.uid)?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};let i="function"==typeof t?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(bM(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"==typeof t){let i=e.addObserver(t,r,n);return()=>{s=!0,i()}}{let r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return bM(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Sk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await (null==(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){var e;if(ru(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await (null==(e=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:e.getToken());return(null==t?void 0:t.error)&&bR(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function SM(e){return tI(e)}class SL{constructor(e){this.auth=e,this.observer=null,this.addObserver=tT(e=>this.observer=e)}get next(){return bM(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let SF={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Sj(e){return SF.loadJS(e)}function SB(){return SF.recaptchaEnterpriseScript}class SU{constructor(){this.enterprise=new SV}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class SV{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}let Sz="recaptcha-enterprise",Sq="NO_RECAPTCHA";class S${constructor(e){this.type=Sz,this.auth=SM(e)}async verify(e="verify",t=!1){async function r(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{b6(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(n=>{if(void 0===n.recaptchaKey)r(Error("recaptcha Enterprise site key undefined"));else{let r=new b3(n);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}}).catch(e=>{r(e)})})}function n(t,r,n){let i=window.grecaptcha;b2(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r(Sq)})}):n(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new SU().execute("siteKey",{action:"verify"}):new Promise((e,i)=>{r(this.auth).then(r=>{if(!t&&b2(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(Error("RecaptchaVerifier is only supported in browser"));let t=SB();0!==t.length&&(t+=r),Sj(t).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function SG(e,t,r,n=!1,i=!1){let s,a=new S$(e);if(i)s=Sq;else try{s=await a.verify(r)}catch(e){s=await a.verify(r,!0)}let o=Object.assign({},t);if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in o){let e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){let e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function SH(e,t,r,n,i){var s,a;if("EMAIL_PASSWORD_PROVIDER"===i)if(null==(s=e._getRecaptchaConfig())||!s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return n(e,t).catch(async i=>{if("auth/missing-recaptcha-token"!==i.code)return Promise.reject(i);{console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let i=await SG(e,t,r,"getOobCode"===r);return n(e,i)}});else{let i=await SG(e,t,r,"getOobCode"===r);return n(e,i)}if("PHONE_PROVIDER"!==i)return Promise.reject(i+" provider is not supported.");if(null==(a=e._getRecaptchaConfig())?void 0:a.isProviderEnabled("PHONE_PROVIDER")){let i=await SG(e,t,r);return n(e,i).catch(async i=>{var s;if((null==(s=e._getRecaptchaConfig())?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);let i=await SG(e,t,r,!1,!0);return n(e,i)}return Promise.reject(i)})}{let i=await SG(e,t,r,!1,!0);return n(e,i)}}function SW(e,t){let r=rc(e,"auth");if(r.isInitialized()){let e=r.getImmediate();if(ty(r.getOptions(),null!=t?t:{}))return e;bA(e,"already-initialized")}return r.initialize({options:t})}function SK(e,t){let r=(null==t?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Sg);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,null==t?void 0:t.popupRedirectResolver)}function SQ(e,t,r){let n=SM(e);bM(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");let i=!!(null==r?void 0:r.disableWarnings),s=SY(t),{host:a,port:o}=SJ(t),l=null===o?"":`:${o}`,c={url:`${s}//${a}${l}/`},u=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){bM(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),bM(ty(c,n.config.emulator)&&ty(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,e6(a)?(tt("Auth",!0),e4(`${s}//${a}${l}`)):i||SZ()}function SY(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function SJ(e){let t=SY(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};let n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){let e=i[1];return{host:e,port:SX(n.substr(e.length+1))}}{let[e,t]=n.split(":");return{host:e,port:SX(t)}}}function SX(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}function SZ(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}class S0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return bL("not implemented")}_getIdTokenResponse(e){return bL("not implemented")}_linkToIdToken(e,t){return bL("not implemented")}_getReauthenticationResolver(e){return bL("not implemented")}}async function S1(e,t){return bQ(e,"POST","/v1/accounts:resetPassword",bK(e,t))}async function S2(e,t){return bQ(e,"POST","/v1/accounts:update",t)}async function S3(e,t){return bQ(e,"POST","/v1/accounts:signUp",t)}async function S6(e,t){return bJ(e,"POST","/v1/accounts:signInWithPassword",bK(e,t))}async function S4(e,t){return bQ(e,"POST","/v1/accounts:sendOobCode",bK(e,t))}async function S5(e,t){return bJ(e,"POST","/v1/accounts:signInWithEmailLink",bK(e,t))}async function S8(e,t){return bJ(e,"POST","/v1/accounts:signInWithEmailLink",bK(e,t))}class S7 extends S0{constructor(e,t,r,n=null){super("password",r),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new S7(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new S7(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);else if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return SH(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",S6,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return S5(e,{email:this._email,oobCode:this._password});default:bA(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return SH(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",S3,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return S8(e,{idToken:t,email:this._email,oobCode:this._password});default:bA(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function S9(e,t){return bJ(e,"POST","/v1/accounts:signInWithIdp",bK(e,t))}let we="http://localhost";class wt extends S0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new wt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):bA("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e,{providerId:r,signInMethod:n}=t,i=bm(t,["providerId","signInMethod"]);if(!r||!n)return null;let s=new wt(r,n);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return S9(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,S9(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,S9(e,t)}buildRequest(){let e={requestUri:we,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=tb(t)}return e}}async function wr(e,t){return bJ(e,"POST","/v1/accounts:signInWithPhoneNumber",bK(e,t))}async function wn(e,t){let r=await bJ(e,"POST","/v1/accounts:signInWithPhoneNumber",bK(e,t));if(r.temporaryProof)throw b1(e,"account-exists-with-different-credential",r);return r}let wi={USER_NOT_FOUND:"user-not-found"};async function ws(e,t){return bJ(e,"POST","/v1/accounts:signInWithPhoneNumber",bK(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),wi)}class wa extends S0{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new wa({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new wa({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return wr(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return wn(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return ws(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:n}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:n}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}=e;return r||t||n||i?new wa({verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}):null}}function wo(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function wl(e){let t=tS(tw(e)).link,r=t?tS(tw(t)).deep_link_id:null,n=tS(tw(e)).deep_link_id;return(n?tS(tw(n)).link:null)||n||r||t||e}class wc{constructor(e){var t,r,n,i,s,a;let o=tS(tw(e)),l=null!=(t=o.apiKey)?t:null,c=null!=(r=o.oobCode)?r:null,u=wo(null!=(n=o.mode)?n:null);bM(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!=(i=o.continueUrl)?i:null,this.languageCode=null!=(s=o.lang)?s:null,this.tenantId=null!=(a=o.tenantId)?a:null}static parseLink(e){let t=wl(e);try{return new wc(t)}catch(e){return null}}}class wu{constructor(){this.providerId=wu.PROVIDER_ID}static credential(e,t){return S7._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=wc.parseLink(t);return bM(r,"argument-error"),S7._fromEmailAndCode(e,r.code,r.tenantId)}}wu.PROVIDER_ID="password",wu.EMAIL_PASSWORD_SIGN_IN_METHOD="password",wu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class wd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class wh extends wd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class wf extends null{static credentialFromJSON(e){let t="string"==typeof e?JSON.parse(e):e;return bM("providerId"in t&&"signInMethod"in t,"argument-error"),wt._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return bM(e.idToken||e.accessToken,"argument-error"),wt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return wf.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return wf.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:n,pendingToken:i,nonce:s,providerId:a}=e;if(!r&&!n&&!t&&!i||!a)return null;try{return new wf(a)._credential({idToken:t,accessToken:r,nonce:s,pendingToken:i})}catch(e){return null}}}class wp extends wh{constructor(){super("facebook.com")}static credential(e){return wt._fromParams({providerId:wp.PROVIDER_ID,signInMethod:wp.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wp.credentialFromTaggedObject(e)}static credentialFromError(e){return wp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wp.credential(e.oauthAccessToken)}catch(e){return null}}}wp.FACEBOOK_SIGN_IN_METHOD="facebook.com",wp.PROVIDER_ID="facebook.com";class wm extends wh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return wt._fromParams({providerId:wm.PROVIDER_ID,signInMethod:wm.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wm.credentialFromTaggedObject(e)}static credentialFromError(e){return wm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return wm.credential(t,r)}catch(e){return null}}}wm.GOOGLE_SIGN_IN_METHOD="google.com",wm.PROVIDER_ID="google.com";class wg extends wh{constructor(){super("github.com")}static credential(e){return wt._fromParams({providerId:wg.PROVIDER_ID,signInMethod:wg.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wg.credentialFromTaggedObject(e)}static credentialFromError(e){return wg.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wg.credential(e.oauthAccessToken)}catch(e){return null}}}wg.GITHUB_SIGN_IN_METHOD="github.com",wg.PROVIDER_ID="github.com";let wy="http://localhost";class wv extends S0{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return S9(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,S9(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,S9(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let{providerId:t,signInMethod:r,pendingToken:n}="string"==typeof e?JSON.parse(e):e;return t&&r&&n&&t===r?new wv(t,n):null}static _create(e,t){return new wv(e,t)}buildRequest(){return{requestUri:wy,returnSecureToken:!0,pendingToken:this.pendingToken}}}let wb="saml.";class wS extends wd{constructor(e){bM(e.startsWith(wb),"argument-error"),super(e)}static credentialFromResult(e){return wS.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return wS.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=wv.fromJSON(e);return bM(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return wv._create(r,t)}catch(e){return null}}}class ww extends wh{constructor(){super("twitter.com")}static credential(e,t){return wt._fromParams({providerId:ww.PROVIDER_ID,signInMethod:ww.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ww.credentialFromTaggedObject(e)}static credentialFromError(e){return ww.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ww.credential(t,r)}catch(e){return null}}}ww.TWITTER_SIGN_IN_METHOD="twitter.com",ww.PROVIDER_ID="twitter.com";class wT{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,n=!1){return new wT({user:await Sp._fromIdTokenResponse(e,r,n),providerId:wE(r),_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){return await e._updateTokensIfNecessary(r,!0),new wT({user:e,providerId:wE(r),_tokenResponse:r,operationType:t})}}function wE(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class wC extends th{constructor(e,t,r,n){var i;super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,wC.prototype),this.customData={appName:e.name,tenantId:null!=(i=e.tenantId)?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new wC(e,t,r,n)}}function w_(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if("auth/multi-factor-auth-required"===r.code)throw wC._fromErrorAndOperation(e,r,t,n);throw r})}function wI(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function wx(e,t,r=!1){if(ru(e.app))return Promise.reject(bO(e));let n="signIn",i=await w_(e,n,t),s=await wT._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function wR(e,t){return wx(SM(e),t)}class wk{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?wA._fromServerResponse(e,t):"totpInfo"in t?wN._fromServerResponse(e,t):bA(e,"internal-error")}}class wA extends wk{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new wA(t)}}class wN extends wk{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new wN(t)}}async function wD(e){let t=SM(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function wO(e,t,r){return ru(e.app)?Promise.reject(bO(e)):wR(tI(e),wu.credential(t,r)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&wD(e),t})}class wP{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class wM extends wP{constructor(e,t,r,n){super(e,t,r),this.username=n}}class wL extends wP{constructor(e,t){super(e,"facebook.com",t)}}class wF extends wM{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class wj extends wP{constructor(e,t){super(e,"google.com",t)}}class wB extends wM{constructor(e,t,r){super(e,"twitter.com",t,r)}}function wU(e){return tI(e).signOut()}class wV{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new wV("enroll",e,t)}static _fromMfaPendingCredential(e){return new wV("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(null==e?void 0:e.multiFactorSession){if(null==(t=e.multiFactorSession)?void 0:t.pendingCredential)return wV._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);else if(null==(r=e.multiFactorSession)?void 0:r.idToken)return wV._fromIdtoken(e.multiFactorSession.idToken)}return null}}class wz{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=SM(e),n=t.customData._serverResponse,i=(n.mfaInfo||[]).map(e=>wk._fromServerResponse(r,e));bM(n.mfaPendingCredential,r,"internal-error");let s=wV._fromMfaPendingCredential(n.mfaPendingCredential);return new wz(s,i,async e=>{let i=await e._process(r,s);delete n.mfaInfo,delete n.mfaPendingCredential;let a=Object.assign(Object.assign({},n),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":let o=await wT._fromIdTokenResponse(r,t.operationType,a);return await r._updateCurrentUser(o.user),o;case"reauthenticate":return bM(t.user,r,"internal-error"),wT._forOperation(t.user,t.operationType,a);default:bA(r,"internal-error")}})}async resolveSignIn(e){let t=e;return this.signInResolver(t)}}function wq(e,t){return bQ(e,"POST","/v2/accounts/mfaEnrollment:start",bK(e,t))}function w$(e,t){return bQ(e,"POST","/v2/accounts/mfaEnrollment:finalize",bK(e,t))}function wG(e,t){return bQ(e,"POST","/v2/accounts/mfaEnrollment:withdraw",bK(e,t))}class wH{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>wk._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new wH(e)}async getSession(){return wV._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){let r=e,n=await this.getSession(),i=await Sr(this.user,r._process(this.user.auth,n,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){let t="string"==typeof e?e:e.uid,r=await this.user.getIdToken();try{let e=await Sr(this.user,wG(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}}}new WeakMap;var wW="@firebase/auth",wK="1.10.4";class wQ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null==(e=this.auth.currentUser)?void 0:e.uid)||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){bM(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function wY(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wJ(e){rl(new tx("auth",(t,{options:r})=>{let n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;bM(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});let l=new SP(n,i,s,{apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Sk(e)});return SK(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),rl(new tx("auth-internal",e=>new wQ(SM(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),rb(wW,wK,wY(e)),rb(wW,wK,"esm2017")}function wX(e=rg()){let t=rc(e,"auth");if(t.isInitialized())return t.getImmediate();let r=SW(e),n=e0("auth");return n&&SQ(r,`http://${n}`),r}function wZ(e,t){return bQ(e,"POST","/v2/accounts/mfaSignIn:finalize",bK(e,t))}b$.initialize(fetch,Headers,Response),wJ("Node"),bN("operation-not-supported-in-this-environment"),SP.prototype.setPersistence=async()=>{};class w0{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return bL("unexpected MultiFactorSessionType")}}}class w1{static assertionForEnrollment(e,t){return w2._fromSecret(e,t)}static assertionForSignIn(e,t){return w2._fromEnrollmentId(e,t)}static async generateSecret(e){var t;let r=e;bM(void 0!==(null==(t=r.user)?void 0:t.auth),"internal-error");let n=await wq(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return w3._fromStartTotpMfaEnrollmentResponse(n,r.user.auth)}}w1.FACTOR_ID="totp";class w2 extends w0{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new w2(t,void 0,e)}static _fromEnrollmentId(e,t){return new w2(t,e)}async _finalizeEnroll(e,t,r){return bM(void 0!==this.secret,e,"argument-error"),w$(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){bM(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let r={verificationCode:this.otp};return wZ(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class w3{constructor(e,t,r,n,i,s,a){this.sessionInfo=s,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=n,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new w3(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let n=!1;return(w6(e)||w6(t))&&(n=!0),n&&(w6(e)&&(e=(null==(r=this.auth.currentUser)?void 0:r.email)||"unknownuser"),w6(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function w6(e){return void 0===e||(null==e?void 0:e.length)===0}let w4=(0,ek.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function w5({className:e,variant:t,...r}){return(0,d.jsx)("div",{className:(0,p.cn)(w4({variant:t}),e),...r})}let w8=h.forwardRef(({className:e,type:t,...r},n)=>(0,d.jsx)("input",{type:t,className:(0,p.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));w8.displayName="Input";var w7="Label",w9=h.forwardRef((e,t)=>(0,d.jsx)(b.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));w9.displayName=w7;var Te=w9;let Tt=(0,ek.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Tr=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)(Te,{ref:r,className:(0,p.cn)(Tt(),e),...t}));Tr.displayName=Te.displayName;var Tn=f["useId".toString()]||(()=>void 0),Ti=0;function Ts(e){let[t,r]=h.useState(Tn());return(0,I.N)(()=>{e||r(e=>e??String(Ti++))},[e]),e||(t?`radix-${t}`:"")}var Ta=r(5551),To=r(1355),Tl="focusScope.autoFocusOnMount",Tc="focusScope.autoFocusOnUnmount",Tu={bubbles:!1,cancelable:!0},Td="FocusScope",Th=h.forwardRef((e,t)=>{let{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=e,[o,l]=h.useState(null),c=(0,E.c)(i),u=(0,E.c)(s),f=h.useRef(null),p=(0,T.s)(t,e=>l(e)),m=h.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;h.useEffect(()=>{if(n){let e=function(e){if(m.paused||!o)return;let t=e.target;o.contains(t)?f.current=t:Tb(f.current,{select:!0})},t=function(e){if(m.paused||!o)return;let t=e.relatedTarget;null!==t&&(o.contains(t)||Tb(f.current,{select:!0}))},r=function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&Tb(o)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let n=new MutationObserver(r);return o&&n.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}},[n,o,m.paused]),h.useEffect(()=>{if(o){TS.add(m);let e=document.activeElement;if(!o.contains(e)){let t=new CustomEvent(Tl,Tu);o.addEventListener(Tl,c),o.dispatchEvent(t),t.defaultPrevented||(Tf(TE(Tm(o)),{select:!0}),document.activeElement===e&&Tb(o))}return()=>{o.removeEventListener(Tl,c),setTimeout(()=>{let t=new CustomEvent(Tc,Tu);o.addEventListener(Tc,u),o.dispatchEvent(t),t.defaultPrevented||Tb(e??document.body,{select:!0}),o.removeEventListener(Tc,u),TS.remove(m)},0)}}},[o,c,u,m]);let g=h.useCallback(e=>{if(!r&&!n||m.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,i=document.activeElement;if(t&&i){let t=e.currentTarget,[n,s]=Tp(t);n&&s?e.shiftKey||i!==s?e.shiftKey&&i===n&&(e.preventDefault(),r&&Tb(s,{select:!0})):(e.preventDefault(),r&&Tb(n,{select:!0})):i===t&&e.preventDefault()}},[r,n,m.paused]);return(0,d.jsx)(b.sG.div,{tabIndex:-1,...a,ref:p,onKeyDown:g})});function Tf(e,{select:t=!1}={}){let r=document.activeElement;for(let n of e)if(Tb(n,{select:t}),document.activeElement!==r)return}function Tp(e){let t=Tm(e);return[Tg(t,e),Tg(t.reverse(),e)]}function Tm(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Tg(e,t){for(let r of e)if(!Ty(r,{upTo:t}))return r}function Ty(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function Tv(e){return e instanceof HTMLInputElement&&"select"in e}function Tb(e,{select:t=!1}={}){if(e&&e.focus){let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Tv(e)&&t&&e.select()}}Th.displayName=Td;var TS=Tw();function Tw(){let e=[];return{add(t){let r=e[0];t!==r&&r?.pause(),(e=TT(e,t)).unshift(t)},remove(t){e=TT(e,t),e[0]?.resume()}}}function TT(e,t){let r=[...e],n=r.indexOf(t);return -1!==n&&r.splice(n,1),r}function TE(e){return e.filter(e=>"A"!==e.tagName)}var TC=r(5028),T_=0;function TI(){h.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Tx()),document.body.insertAdjacentElement("beforeend",e[1]??Tx()),T_++,()=>{1===T_&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),T_--}},[])}function Tx(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var TR="right-scroll-bar-position",Tk="width-before-scroll-bar",TA="with-scroll-bars-hidden",TN="--removed-body-scroll-bar-size";function TD(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}function TO(e,t){var r=(0,h.useState)(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(value){var n=r.value;n!==value&&(r.value=value,r.callback(value,n))}}}})[0];return r.callback=t,r.facade}var TP="undefined"!=typeof window?h.useLayoutEffect:h.useEffect,TM=new WeakMap;function TL(e,t){var r=TO(t||null,function(t){return e.forEach(function(e){return TD(e,t)})});return TP(function(){var t=TM.get(r);if(t){var n=new Set(t),i=new Set(e),s=r.current;n.forEach(function(e){i.has(e)||TD(e,null)}),i.forEach(function(e){n.has(e)||TD(e,s)})}TM.set(r,e)},[e]),r}function TF(e){return e}function Tj(e,t){void 0===t&&(t=TF);var r=[],n=!1;return{read:function(){if(n)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(e){var i=t(e,n);return r.push(i),function(){r=r.filter(function(e){return e!==i})}},assignSyncMedium:function(e){for(n=!0;r.length;){var t=r;r=[],t.forEach(e)}r={push:function(t){return e(t)},filter:function(){return r}}},assignMedium:function(e){n=!0;var t=[];if(r.length){var i=r;r=[],i.forEach(e),t=r}var s=function(){var r=t;t=[],r.forEach(e)},a=function(){return Promise.resolve().then(s)};a(),r={push:function(e){t.push(e),a()},filter:function(e){return t=t.filter(e),r}}}}}var TB=function(e){void 0===e&&(e={});var t=Tj(null);return t.options=bp({async:!0,ssr:!1},e),t}(),TU=function(){},TV=h.forwardRef(function(e,t){var r=h.useRef(null),n=h.useState({onScrollCapture:TU,onWheelCapture:TU,onTouchMoveCapture:TU}),i=n[0],s=n[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,m=e.inert,g=e.allowPinchZoom,y=e.as,v=void 0===y?"div":y,b=e.gapMode,S=bm(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=f,T=TL([r,t]),E=bp(bp({},S),i);return h.createElement(h.Fragment,null,u&&h.createElement(w,{sideCar:TB,removeScrollBar:c,shards:d,noIsolation:p,inert:m,setCallbacks:s,allowPinchZoom:!!g,lockRef:r,gapMode:b}),a?h.cloneElement(h.Children.only(o),bp(bp({},E),{ref:T})):h.createElement(v,bp({},E,{className:l,ref:T}),o))});TV.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},TV.classNames={fullWidth:Tk,zeroRight:TR};var Tz=function(e){var t=e.sideCar,r=bm(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw Error("Sidecar medium not found");return h.createElement(n,bp({},r))};function Tq(e,t){return e.useMedium(t),Tz}Tz.isSideCarExport=!0;var T$=function(){return u||r.nc};function TG(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=T$();return t&&e.setAttribute("nonce",t),e}function TH(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function TW(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}var TK=function(){var e=0,t=null;return{add:function(r){0==e&&(t=TG())&&(TH(t,r),TW(t)),e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},TQ=function(){var e=TK();return function(t,r){h.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},TY=function(){var e=TQ();return function(t){return e(t.styles,t.dynamic),null}},TJ={left:0,top:0,right:0,gap:0},TX=function(e){return parseInt(e||"",10)||0},TZ=function(e){var t=window.getComputedStyle(document.body),r=t["padding"===e?"paddingLeft":"marginLeft"],n=t["padding"===e?"paddingTop":"marginTop"],i=t["padding"===e?"paddingRight":"marginRight"];return[TX(r),TX(n),TX(i)]},T0=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return TJ;var t=TZ(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},T1=TY(),T2="data-scroll-locked",T3=function(e,t,r,n){var i=e.left,s=e.top,a=e.right,o=e.gap;return void 0===r&&(r="margin"),"\n  .".concat(TA," {\n   overflow: hidden ").concat(n,";\n   padding-right: ").concat(o,"px ").concat(n,";\n  }\n  body[").concat(T2,"] {\n    overflow: hidden ").concat(n,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(n,";"),"margin"===r&&"\n    padding-left: ".concat(i,"px;\n    padding-top: ").concat(s,"px;\n    padding-right: ").concat(a,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(n,";\n    "),"padding"===r&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(TR," {\n    right: ").concat(o,"px ").concat(n,";\n  }\n  \n  .").concat(Tk," {\n    margin-right: ").concat(o,"px ").concat(n,";\n  }\n  \n  .").concat(TR," .").concat(TR," {\n    right: 0 ").concat(n,";\n  }\n  \n  .").concat(Tk," .").concat(Tk," {\n    margin-right: 0 ").concat(n,";\n  }\n  \n  body[").concat(T2,"] {\n    ").concat(TN,": ").concat(o,"px;\n  }\n")},T6=function(){var e=parseInt(document.body.getAttribute(T2)||"0",10);return isFinite(e)?e:0},T4=function(){h.useEffect(function(){return document.body.setAttribute(T2,(T6()+1).toString()),function(){var e=T6()-1;e<=0?document.body.removeAttribute(T2):document.body.setAttribute(T2,e.toString())}},[])},T5=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=void 0===n?"margin":n;T4();var s=h.useMemo(function(){return T0(i)},[i]);return h.createElement(T1,{styles:T3(s,!t,i,r?"":"!important")})},T8=!1;if("undefined"!=typeof window)try{var T7=Object.defineProperty({},"passive",{get:function(){return T8=!0,!0}});window.addEventListener("test",T7,T7),window.removeEventListener("test",T7,T7)}catch(e){T8=!1}var T9=!!T8&&{passive:!1},Ee=function(e){return"TEXTAREA"===e.tagName},Et=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return"hidden"!==r[t]&&!(r.overflowY===r.overflowX&&!Ee(e)&&"visible"===r[t])},Er=function(e){return Et(e,"overflowY")},En=function(e){return Et(e,"overflowX")},Ei=function(e,t){var r=t.ownerDocument,n=t;do{if("undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot&&(n=n.host),Eo(e,n)){var i=El(e,n);if(i[1]>i[2])return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Es=function(e){return[e.scrollTop,e.scrollHeight,e.clientHeight]},Ea=function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]},Eo=function(e,t){return"v"===e?Er(t):En(t)},El=function(e,t){return"v"===e?Es(t):Ea(t)},Ec=function(e,t){return"h"===e&&"rtl"===t?-1:1},Eu=function(e,t,r,n,i){var s=Ec(e,window.getComputedStyle(t).direction),a=s*n,o=r.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var f=El(e,o),p=f[0],m=f[1]-f[2]-s*p;(p||m)&&Eo(e,o)&&(d+=m,h+=p),o=o instanceof ShadowRoot?o.host:o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return u&&(i&&1>Math.abs(d)||!i&&a>d)?c=!0:!u&&(i&&1>Math.abs(h)||!i&&-a>h)&&(c=!0),c},Ed=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Eh=function(e){return[e.deltaX,e.deltaY]},Ef=function(e){return e&&"current"in e?e.current:e},Ep=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Em=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},Eg=0,Ey=[];function Ev(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}let Eb=Tq(TB,function(e){var t=h.useRef([]),r=h.useRef([0,0]),n=h.useRef(),i=h.useState(Eg++)[0],s=h.useState(TY)[0],a=h.useRef(e);h.useEffect(function(){a.current=e},[e]),h.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var t=bb([e.lockRef.current],(e.shards||[]).map(Ef),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=h.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!a.current.allowPinchZoom;var i,s=Ed(e),o=r.current,l="deltaX"in e?e.deltaX:o[0]-s[0],c="deltaY"in e?e.deltaY:o[1]-s[1],u=e.target,d=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===d&&"range"===u.type)return!1;var h=Ei(d,u);if(!h)return!0;if(h?i=d:(i="v"===d?"h":"v",h=Ei(d,u)),!h)return!1;if(!n.current&&"changedTouches"in e&&(l||c)&&(n.current=i),!i)return!0;var f=n.current||i;return Eu(f,t,e,"h"===f?l:c,!0)},[]),l=h.useCallback(function(e){var r=e;if(Ey.length&&Ey[Ey.length-1]===s){var n="deltaY"in r?Eh(r):Ed(r),i=t.current.filter(function(e){return e.name===r.type&&(e.target===r.target||r.target===e.shadowParent)&&Ep(e.delta,n)})[0];if(i&&i.should){r.cancelable&&r.preventDefault();return}if(!i){var l=(a.current.shards||[]).map(Ef).filter(Boolean).filter(function(e){return e.contains(r.target)});(l.length>0?o(r,l[0]):!a.current.noIsolation)&&r.cancelable&&r.preventDefault()}}},[]),c=h.useCallback(function(e,r,n,i){var s={name:e,delta:r,target:n,should:i,shadowParent:Ev(n)};t.current.push(s),setTimeout(function(){t.current=t.current.filter(function(e){return e!==s})},1)},[]),u=h.useCallback(function(e){r.current=Ed(e),n.current=void 0},[]),d=h.useCallback(function(t){c(t.type,Eh(t),t.target,o(t,e.lockRef.current))},[]),f=h.useCallback(function(t){c(t.type,Ed(t),t.target,o(t,e.lockRef.current))},[]);h.useEffect(function(){return Ey.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,T9),document.addEventListener("touchmove",l,T9),document.addEventListener("touchstart",u,T9),function(){Ey=Ey.filter(function(e){return e!==s}),document.removeEventListener("wheel",l,T9),document.removeEventListener("touchmove",l,T9),document.removeEventListener("touchstart",u,T9)}},[]);var p=e.removeScrollBar,m=e.inert;return h.createElement(h.Fragment,null,m?h.createElement(s,{styles:Em(i)}):null,p?h.createElement(T5,{gapMode:e.gapMode}):null)});var ES=h.forwardRef(function(e,t){return h.createElement(TV,bp({},e,{ref:t,sideCar:Eb}))});ES.classNames=TV.classNames;let Ew=ES;var ET=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},EE=new WeakMap,EC=new WeakMap,E_={},EI=0,Ex=function(e){return e&&(e.host||Ex(e.parentNode))},ER=function(e,t){return t.map(function(t){if(e.contains(t))return t;var r=Ex(t);return r&&e.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(e){return!!e})},Ek=function(e,t,r,n){var i=ER(t,Array.isArray(e)?e:[e]);E_[r]||(E_[r]=new WeakMap);var s=E_[r],a=[],o=new Set,l=new Set(i),c=function(e){!e||o.has(e)||(o.add(e),c(e.parentNode))};i.forEach(c);var u=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(o.has(e))u(e);else try{var t=e.getAttribute(n),i=null!==t&&"false"!==t,l=(EE.get(e)||0)+1,c=(s.get(e)||0)+1;EE.set(e,l),s.set(e,c),a.push(e),1===l&&i&&EC.set(e,!0),1===c&&e.setAttribute(r,"true"),i||e.setAttribute(n,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return u(t),o.clear(),EI++,function(){a.forEach(function(e){var t=EE.get(e)-1,i=s.get(e)-1;EE.set(e,t),s.set(e,i),t||(EC.has(e)||e.removeAttribute(n),EC.delete(e)),i||e.removeAttribute(r)}),--EI||(EE=new WeakMap,EE=new WeakMap,EC=new WeakMap,E_={})}},EA=function(e,t,r){void 0===r&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=t||ET(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),Ek(n,i,r,"aria-hidden")):function(){return null}},EN="Dialog",[ED,EO]=(0,w.A)(EN),[EP,EM]=ED(EN),EL=e=>{let{__scopeDialog:t,children:r,open:n,defaultOpen:i,onOpenChange:s,modal:a=!0}=e,o=h.useRef(null),l=h.useRef(null),[c=!1,u]=(0,Ta.i)({prop:n,defaultProp:i,onChange:s});return(0,d.jsx)(EP,{scope:t,triggerRef:o,contentRef:l,contentId:Ts(),titleId:Ts(),descriptionId:Ts(),open:c,onOpenChange:u,onOpenToggle:h.useCallback(()=>u(e=>!e),[u]),modal:a,children:r})};EL.displayName=EN;var EF="DialogTrigger",Ej=h.forwardRef((e,t)=>{let{__scopeDialog:r,...n}=e,i=EM(EF,r),s=(0,T.s)(t,i.triggerRef);return(0,d.jsx)(b.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":E3(i.open),...n,ref:s,onClick:(0,R.m)(e.onClick,i.onOpenToggle)})});Ej.displayName=EF;var EB="DialogPortal",[EU,EV]=ED(EB,{forceMount:void 0}),Ez=e=>{let{__scopeDialog:t,forceMount:r,children:n,container:i}=e,s=EM(EB,t);return(0,d.jsx)(EU,{scope:t,forceMount:r,children:h.Children.map(n,e=>(0,d.jsx)(S.C,{present:r||s.open,children:(0,d.jsx)(TC.Z,{asChild:!0,container:i,children:e})}))})};Ez.displayName=EB;var Eq="DialogOverlay",E$=h.forwardRef((e,t)=>{let r=EV(Eq,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,s=EM(Eq,e.__scopeDialog);return s.modal?(0,d.jsx)(S.C,{present:n||s.open,children:(0,d.jsx)(EG,{...i,ref:t})}):null});E$.displayName=Eq;var EG=h.forwardRef((e,t)=>{let{__scopeDialog:r,...n}=e,i=EM(Eq,r);return(0,d.jsx)(Ew,{as:eM.DX,allowPinchZoom:!0,shards:[i.contentRef],children:(0,d.jsx)(b.sG.div,{"data-state":E3(i.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),EH="DialogContent",EW=h.forwardRef((e,t)=>{let r=EV(EH,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,s=EM(EH,e.__scopeDialog);return(0,d.jsx)(S.C,{present:n||s.open,children:s.modal?(0,d.jsx)(EK,{...i,ref:t}):(0,d.jsx)(EQ,{...i,ref:t})})});EW.displayName=EH;var EK=h.forwardRef((e,t)=>{let r=EM(EH,e.__scopeDialog),n=h.useRef(null),i=(0,T.s)(t,r.contentRef,n);return h.useEffect(()=>{let e=n.current;if(e)return EA(e)},[]),(0,d.jsx)(EY,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,R.m)(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:(0,R.m)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:(0,R.m)(e.onFocusOutside,e=>e.preventDefault())})}),EQ=h.forwardRef((e,t)=>{let r=EM(EH,e.__scopeDialog),n=h.useRef(!1),i=h.useRef(!1);return(0,d.jsx)(EY,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(n.current||r.triggerRef.current?.focus(),t.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(n.current=!0,"pointerdown"===t.detail.originalEvent.type&&(i.current=!0));let s=t.target;r.triggerRef.current?.contains(s)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}})}),EY=h.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:s,...a}=e,o=EM(EH,r),l=h.useRef(null),c=(0,T.s)(t,l);return TI(),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(Th,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:s,children:(0,d.jsx)(To.qW,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":E3(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(E8,{titleId:o.titleId}),(0,d.jsx)(E9,{contentRef:l,descriptionId:o.descriptionId})]})]})}),EJ="DialogTitle",EX=h.forwardRef((e,t)=>{let{__scopeDialog:r,...n}=e,i=EM(EJ,r);return(0,d.jsx)(b.sG.h2,{id:i.titleId,...n,ref:t})});EX.displayName=EJ;var EZ="DialogDescription",E0=h.forwardRef((e,t)=>{let{__scopeDialog:r,...n}=e,i=EM(EZ,r);return(0,d.jsx)(b.sG.p,{id:i.descriptionId,...n,ref:t})});E0.displayName=EZ;var E1="DialogClose",E2=h.forwardRef((e,t)=>{let{__scopeDialog:r,...n}=e,i=EM(E1,r);return(0,d.jsx)(b.sG.button,{type:"button",...n,ref:t,onClick:(0,R.m)(e.onClick,()=>i.onOpenChange(!1))})});function E3(e){return e?"open":"closed"}E2.displayName=E1;var E6="DialogTitleWarning",[E4,E5]=(0,w.q)(E6,{contentName:EH,titleName:EJ,docsSlug:"dialog"}),E8=({titleId:e})=>{let t=E5(E6),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return h.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},E7="DialogDescriptionWarning",E9=({contentRef:e,descriptionId:t})=>{let r=E5(E7),n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r.contentName}}.`;return h.useEffect(()=>{let r=e.current?.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Ce=EL,Ct=Ej,Cr=Ez,Cn=E$,Ci=EW,Cs=EX,Ca=E0,Co=E2,Cl=r(8726);let Cc=Ce,Cu=Ct,Cd=Cr,Ch=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)(Cn,{ref:r,className:(0,p.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Ch.displayName=Cn.displayName;let Cf=h.forwardRef(({className:e,children:t,...r},n)=>(0,d.jsxs)(Cd,{children:[(0,d.jsx)(Ch,{}),(0,d.jsxs)(Ci,{ref:n,className:(0,p.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,(0,d.jsxs)(Co,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,d.jsx)(Cl.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));Cf.displayName=Ci.displayName;let Cp=({className:e,...t})=>(0,d.jsx)("div",{className:(0,p.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Cp.displayName="DialogHeader";let Cm=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)(Cs,{ref:r,className:(0,p.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));Cm.displayName=Cs.displayName;let Cg=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)(Ca,{ref:r,className:(0,p.cn)("text-sm text-muted-foreground",e),...t}));Cg.displayName=Ca.displayName;let Cy=h.forwardRef(({className:e,...t},r)=>(0,d.jsx)("textarea",{className:(0,p.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));Cy.displayName="Textarea";var Cv=r(9867);let Cb="type.googleapis.com/google.protobuf.Int64Value",CS="type.googleapis.com/google.protobuf.UInt64Value";function Cw(e,t){let r={};for(let n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n]));return r}function CT(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>CT(e));if("function"==typeof e||"object"==typeof e)return Cw(e,e=>CT(e));throw Error("Data cannot be encoded in JSON: "+e)}function CE(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case Cb:case CS:{let t=Number(e.value);if(isNaN(t))throw Error("Data cannot be decoded from JSON: "+e);return t}default:throw Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>CE(e)):"function"==typeof e||"object"==typeof e?Cw(e,e=>CE(e)):e}let CC="functions",C_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class CI extends th{constructor(e,t,r){super(`${CC}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,CI.prototype)}}function Cx(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function CR(e,t){let r,n=Cx(e),i=n;try{let e=t&&t.error;if(e){let t=e.status;if("string"==typeof t){if(!C_[t])return new CI("internal","internal");n=C_[t],i=t}let s=e.message;"string"==typeof s&&(i=s),r=e.details,void 0!==r&&(r=CE(r))}}catch(e){}return"ok"===n?null:new CI(n,i,r)}class Ck{constructor(e,t,r,n){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ru(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(e=>this.auth=e,()=>{}),this.messaging||r.get().then(e=>this.messaging=e,()=>{}),this.appCheck||null==n||n.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{let e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){let t=await this.getAuthToken();return{authToken:t,messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}let CA="us-central1",CN=/^data: (.*?)(?:\n|$)/;function CD(e){let t=null;return{promise:new Promise((r,n)=>{t=setTimeout(()=>{n(new CI("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}class CO{constructor(e,t,r,n,i=CA,s=(...e)=>fetch(...e)){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Ck(e,t,r,n),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{let e=new URL(i);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=CA}catch(e){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;if(null!==this.emulatorOrigin){let r=this.emulatorOrigin;return`${r}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function CP(e,t,r){let n=e6(t);e.emulatorOrigin=`http${n?"s":""}://${t}:${r}`,n&&(e4(e.emulatorOrigin),tt("Functions",!0))}function CM(e,t,r){let n=n=>Cj(e,t,n,r||{});return n.stream=(r,n)=>CU(e,t,r,n),n}async function CL(e,t,r,n){let i;r["Content-Type"]="application/json";try{i=await n(e,{method:"POST",body:JSON.stringify(t),headers:r})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}async function CF(e,t){let r={},n=await e.contextProvider.getContext(t.limitedUseAppCheckTokens);return n.authToken&&(r.Authorization="Bearer "+n.authToken),n.messagingToken&&(r["Firebase-Instance-ID-Token"]=n.messagingToken),null!==n.appCheckToken&&(r["X-Firebase-AppCheck"]=n.appCheckToken),r}function Cj(e,t,r,n){let i=e._url(t);return CB(e,i,r,n)}async function CB(e,t,r,n){let i={data:r=CT(r)},s=await CF(e,n),a=CD(n.timeout||7e4),o=await Promise.race([CL(t,i,s,e.fetchImpl),a.promise,e.cancelAllRequests]);if(a.cancel(),!o)throw new CI("cancelled","Firebase Functions instance was deleted.");let l=CR(o.status,o.json);if(l)throw l;if(!o.json)throw new CI("internal","Response is not valid JSON object.");let c=o.json.data;if(void 0===c&&(c=o.json.result),void 0===c)throw new CI("internal","Response is missing data field.");return{data:CE(c)}}function CU(e,t,r,n){let i=e._url(t);return CV(e,i,r,n||{})}async function CV(e,t,r,n){var i;let s,a,o,l={data:r=CT(r)},c=await CF(e,n);c["Content-Type"]="application/json",c.Accept="text/event-stream";try{s=await e.fetchImpl(t,{method:"POST",body:JSON.stringify(l),headers:c,signal:null==n?void 0:n.signal})}catch(t){if(t instanceof Error&&"AbortError"===t.name){let e=new CI("cancelled","Request was cancelled.");return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let e=CR(0,null);return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let u=new Promise((e,t)=>{a=e,o=t});null==(i=null==n?void 0:n.signal)||i.addEventListener("abort",()=>{let e=new CI("cancelled","Request was cancelled.");o(e)});let d=Cz(s.body.getReader(),a,o,null==n?void 0:n.signal);return{stream:{[Symbol.asyncIterator](){let e=d.getReader();return{async next(){let{value:t,done:r}=await e.read();return{value:t,done:r}},return:async()=>(await e.cancel(),{done:!0,value:void 0})}}},data:u}}function Cz(e,t,r,n){let i=(e,n)=>{let i=e.match(CN);if(!i)return;let s=i[1];try{let e=JSON.parse(s);if("result"in e)return void t(CE(e.result));if("message"in e)return void n.enqueue(CE(e.message));if("error"in e){let t=CR(0,e);n.error(t),r(t);return}}catch(e){if(e instanceof CI){n.error(e),r(e);return}}},s=new TextDecoder;return new ReadableStream({start(t){let a="";return o();async function o(){if(null==n?void 0:n.aborted){let e=new CI("cancelled","Request was cancelled");return t.error(e),r(e),Promise.resolve()}try{let{value:l,done:c}=await e.read();if(c){a.trim()&&i(a.trim(),t),t.close();return}if(null==n?void 0:n.aborted){let n=new CI("cancelled","Request was cancelled");t.error(n),r(n),await e.cancel();return}let u=(a+=s.decode(l,{stream:!0})).split("\n");for(let e of(a=u.pop()||"",u))e.trim()&&i(e.trim(),t);return o()}catch(n){let e=n instanceof CI?n:CR(0,null);t.error(e),r(e)}}},cancel:()=>e.cancel()})}let Cq="@firebase/functions",C$="0.12.6",CG="auth-internal",CH="app-check-internal",CW="messaging-internal";function CK(e=rg(),t=CA){tt("Functions",!1);let r=rc(tI(e),CC).getImmediate({identifier:t}),n=e1("functions");return n&&CQ(r,...n),r}function CQ(e,t,r){CP(tI(e),t,r)}function CY(e,t,r){return CM(tI(e),t,r)}(function e(e){rl(new tx(CC,(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),n=e.getProvider(CG);return new CO(r,n,e.getProvider(CW),e.getProvider(CH),t)},"PUBLIC").setMultipleInstances(!0)),rb(Cq,C$,e),rb(Cq,C$,"esm2017")})();let CJ=["top","right","bottom","left"],CX=Math.min,CZ=Math.max,C0=Math.round,C1=Math.floor,C2=e=>({x:e,y:e}),C3={left:"right",right:"left",bottom:"top",top:"bottom"},C6={start:"end",end:"start"};function C4(e,t,r){return CZ(e,CX(t,r))}function C5(e,t){return"function"==typeof e?e(t):e}function C8(e){return e.split("-")[0]}function C7(e){return e.split("-")[1]}function C9(e){return"x"===e?"y":"x"}function _e(e){return"y"===e?"height":"width"}function _t(e){return["top","bottom"].includes(C8(e))?"y":"x"}function _r(e){return C9(_t(e))}function _n(e,t,r){void 0===r&&(r=!1);let n=C7(e),i=_r(e),s=_e(i),a="x"===i?n===(r?"end":"start")?"right":"left":"start"===n?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=_l(a)),[a,_l(a)]}function _i(e){let t=_l(e);return[_s(e),t,_s(t)]}function _s(e){return e.replace(/start|end/g,e=>C6[e])}function _a(e,t,r){let n=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":if(r)return t?i:n;return t?n:i;case"left":case"right":return t?s:a;default:return[]}}function _o(e,t,r,n){let i=C7(e),s=_a(C8(e),"start"===r,n);return i&&(s=s.map(e=>e+"-"+i),t&&(s=s.concat(s.map(_s)))),s}function _l(e){return e.replace(/left|right|bottom|top/g,e=>C3[e])}function _c(e){return{top:0,right:0,bottom:0,left:0,...e}}function _u(e){return"number"!=typeof e?_c(e):{top:e,right:e,bottom:e,left:e}}function _d(e){let{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function _h(e,t,r){let n,{reference:i,floating:s}=e,a=_t(t),o=_r(t),l=_e(o),c=C8(t),u="y"===a,d=i.x+i.width/2-s.width/2,h=i.y+i.height/2-s.height/2,f=i[l]/2-s[l]/2;switch(c){case"top":n={x:d,y:i.y-s.height};break;case"bottom":n={x:d,y:i.y+i.height};break;case"right":n={x:i.x+i.width,y:h};break;case"left":n={x:i.x-s.width,y:h};break;default:n={x:i.x,y:i.y}}switch(C7(t)){case"start":n[o]-=f*(r&&u?-1:1);break;case"end":n[o]+=f*(r&&u?-1:1)}return n}let _f=async(e,t,r)=>{let{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await (null==a.isRTL?void 0:a.isRTL(t)),c=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=_h(c,n,l),h=n,f={},p=0;for(let r=0;r<o.length;r++){let{name:s,fn:m}=o[r],{x:g,y:y,data:v,reset:b}=await m({x:u,y:d,initialPlacement:n,placement:h,strategy:i,middlewareData:f,rects:c,platform:a,elements:{reference:e,floating:t}});u=null!=g?g:u,d=null!=y?y:d,f={...f,[s]:{...f[s],...v}},b&&p<=50&&(p++,"object"==typeof b&&(b.placement&&(h=b.placement),b.rects&&(c=!0===b.rects?await a.getElementRects({reference:e,floating:t,strategy:i}):b.rects),{x:u,y:d}=_h(c,h,l)),r=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:f}};async function _p(e,t){var r;void 0===t&&(t={});let{x:n,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=C5(t,e),p=_u(f),m="floating"===d?"reference":"floating",g=o[h?m:d],y=_d(await s.getClippingRect({element:null==(r=await (null==s.isElement?void 0:s.isElement(g)))||r?g:g.contextElement||await (null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===d?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,b=await (null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),S=await (null==s.isElement?void 0:s.isElement(b))&&await (null==s.getScale?void 0:s.getScale(b))||{x:1,y:1},w=_d(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:b,strategy:l}):v);return{top:(y.top-w.top+p.top)/S.y,bottom:(w.bottom-y.bottom+p.bottom)/S.y,left:(y.left-w.left+p.left)/S.x,right:(w.right-y.right+p.right)/S.x}}let _m=e=>({name:"arrow",options:e,async fn(t){let{x:r,y:n,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=C5(e,t)||{};if(null==c)return{};let d=_u(u),h={x:r,y:n},f=_r(i),p=_e(f),m=await a.getDimensions(c),g="y"===f,y=g?"top":"left",v=g?"bottom":"right",b=g?"clientHeight":"clientWidth",S=s.reference[p]+s.reference[f]-h[f]-s.floating[p],w=h[f]-s.reference[f],T=await (null==a.getOffsetParent?void 0:a.getOffsetParent(c)),E=T?T[b]:0;E&&await (null==a.isElement?void 0:a.isElement(T))||(E=o.floating[b]||s.floating[p]);let C=S/2-w/2,_=E/2-m[p]/2-1,I=CX(d[y],_),x=CX(d[v],_),R=I,k=E-m[p]-x,A=E/2-m[p]/2+C,N=C4(R,A,k),D=!l.arrow&&null!=C7(i)&&A!==N&&s.reference[p]/2-(A<R?I:x)-m[p]/2<0,O=D?A<R?A-R:A-k:0;return{[f]:h[f]+O,data:{[f]:N,centerOffset:A-N-O,...D&&{alignmentOffset:O}},reset:D}}}),_g=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var r,n,i,s,a;let{placement:o,middlewareData:l,rects:c,initialPlacement:u,platform:d,elements:h}=t,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:v=!0,...b}=C5(e,t);if(null!=(r=l.arrow)&&r.alignmentOffset)return{};let S=C8(o),w=_t(u),T=C8(u)===u,E=await (null==d.isRTL?void 0:d.isRTL(h.floating)),C=m||(T||!v?[_l(u)]:_i(u)),_="none"!==y;!m&&_&&C.push(..._o(u,v,y,E));let I=[u,...C],x=await _p(t,b),R=[],k=(null==(n=l.flip)?void 0:n.overflows)||[];if(f&&R.push(x[S]),p){let e=_n(o,c,E);R.push(x[e[0]],x[e[1]])}if(k=[...k,{placement:o,overflows:R}],!R.every(e=>e<=0)){let e=((null==(i=l.flip)?void 0:i.index)||0)+1,t=I[e];if(t)return{data:{index:e,overflows:k},reset:{placement:t}};let r=null==(s=k.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:s.placement;if(!r)switch(g){case"bestFit":{let e=null==(a=k.filter(e=>{if(_){let t=_t(e.placement);return t===w||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:a[0];e&&(r=e);break}case"initialPlacement":r=u}if(o!==r)return{reset:{placement:r}}}return{}}}};function _y(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function _v(e){return CJ.some(t=>e[t]>=0)}let _b=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){let{rects:r}=t,{strategy:n="referenceHidden",...i}=C5(e,t);switch(n){case"referenceHidden":{let e=_y(await _p(t,{...i,elementContext:"reference"}),r.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:_v(e)}}}case"escaped":{let e=_y(await _p(t,{...i,altBoundary:!0}),r.floating);return{data:{escapedOffsets:e,escaped:_v(e)}}}default:return{}}}}};function _S(e){let t=min(...e.map(e=>e.left)),r=min(...e.map(e=>e.top));return{x:t,y:r,width:max(...e.map(e=>e.right))-t,height:max(...e.map(e=>e.bottom))-r}}async function _w(e,t){let{placement:r,platform:n,elements:i}=e,s=await (null==n.isRTL?void 0:n.isRTL(i.floating)),a=C8(r),o=C7(r),l="y"===_t(r),c=["left","top"].includes(a)?-1:1,u=s&&l?-1:1,d=C5(t,e),{mainAxis:h,crossAxis:f,alignmentAxis:p}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&"number"==typeof p&&(f="end"===o?-1*p:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}let _T=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var r,n;let{x:i,y:s,placement:a,middlewareData:o}=t,l=await _w(t,e);return a===(null==(r=o.offset)?void 0:r.placement)&&null!=(n=o.arrow)&&n.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},_E=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){let{x:r,y:n,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...l}=C5(e,t),c={x:r,y:n},u=await _p(t,l),d=_t(C8(i)),h=C9(d),f=c[h],p=c[d];if(s){let e="y"===h?"top":"left",t="y"===h?"bottom":"right",r=f+u[e],n=f-u[t];f=C4(r,f,n)}if(a){let e="y"===d?"top":"left",t="y"===d?"bottom":"right",r=p+u[e],n=p-u[t];p=C4(r,p,n)}let m=o.fn({...t,[h]:f,[d]:p});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[h]:s,[d]:a}}}}}},_C=function(e){return void 0===e&&(e={}),{options:e,fn(t){let{x:r,y:n,placement:i,rects:s,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=C5(e,t),u={x:r,y:n},d=_t(i),h=C9(d),f=u[h],p=u[d],m=C5(o,t),g="number"==typeof m?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){let e="y"===h?"height":"width",t=s.reference[h]-s.floating[e]+g.mainAxis,r=s.reference[h]+s.reference[e]-g.mainAxis;f<t?f=t:f>r&&(f=r)}if(c){var y,v;let e="y"===h?"width":"height",t=["top","left"].includes(C8(i)),r=s.reference[d]-s.floating[e]+(t&&(null==(y=a.offset)?void 0:y[d])||0)+(t?0:g.crossAxis),n=s.reference[d]+s.reference[e]+(t?0:(null==(v=a.offset)?void 0:v[d])||0)-(t?g.crossAxis:0);p<r?p=r:p>n&&(p=n)}return{[h]:f,[d]:p}}}},__=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var r,n;let i,s,{placement:a,rects:o,platform:l,elements:c}=t,{apply:u=()=>{},...d}=C5(e,t),h=await _p(t,d),f=C8(a),p=C7(a),m="y"===_t(a),{width:g,height:y}=o.floating;"top"===f||"bottom"===f?(i=f,s=p===(await (null==l.isRTL?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(s=f,i="end"===p?"top":"bottom");let v=y-h.top-h.bottom,b=g-h.left-h.right,S=CX(y-h[i],v),w=CX(g-h[s],b),T=!t.middlewareData.shift,E=S,C=w;if(null!=(r=t.middlewareData.shift)&&r.enabled.x&&(C=b),null!=(n=t.middlewareData.shift)&&n.enabled.y&&(E=v),T&&!p){let e=CZ(h.left,0),t=CZ(h.right,0),r=CZ(h.top,0),n=CZ(h.bottom,0);m?C=g-2*(0!==e||0!==t?e+t:CZ(h.left,h.right)):E=y-2*(0!==r||0!==n?r+n:CZ(h.top,h.bottom))}await u({...t,availableWidth:C,availableHeight:E});let _=await l.getDimensions(c.floating);return g!==_.width||y!==_.height?{reset:{rects:!0}}:{}}}};function _I(){return"undefined"!=typeof window}function _x(e){return _A(e)?(e.nodeName||"").toLowerCase():"#document"}function _R(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function _k(e){var t;return null==(t=(_A(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function _A(e){return!!_I()&&(e instanceof Node||e instanceof _R(e).Node)}function _N(e){return!!_I()&&(e instanceof Element||e instanceof _R(e).Element)}function _D(e){return!!_I()&&(e instanceof HTMLElement||e instanceof _R(e).HTMLElement)}function _O(e){return!!_I()&&"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof _R(e).ShadowRoot)}function _P(e){let{overflow:t,overflowX:r,overflowY:n,display:i}=_V(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function _M(e){return["table","td","th"].includes(_x(e))}function _L(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch(e){return!1}})}function _F(e){let t=_B(),r=_N(e)?_V(e):e;return["transform","translate","scale","rotate","perspective"].some(e=>!!r[e]&&"none"!==r[e])||!!r.containerType&&"normal"!==r.containerType||!t&&!!r.backdropFilter&&"none"!==r.backdropFilter||!t&&!!r.filter&&"none"!==r.filter||["transform","translate","scale","rotate","perspective","filter"].some(e=>(r.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(r.contain||"").includes(e))}function _j(e){let t=_q(e);for(;_D(t)&&!_U(t);){if(_F(t))return t;if(_L(t))break;t=_q(t)}return null}function _B(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function _U(e){return["html","body","#document"].includes(_x(e))}function _V(e){return _R(e).getComputedStyle(e)}function _z(e){return _N(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function _q(e){if("html"===_x(e))return e;let t=e.assignedSlot||e.parentNode||_O(e)&&e.host||_k(e);return _O(t)?t.host:t}function _$(e){let t=_q(e);return _U(t)?e.ownerDocument?e.ownerDocument.body:e.body:_D(t)&&_P(t)?t:_$(t)}function _G(e,t,r){var n;void 0===t&&(t=[]),void 0===r&&(r=!0);let i=_$(e),s=i===(null==(n=e.ownerDocument)?void 0:n.body),a=_R(i);if(s){let e=_H(a);return t.concat(a,a.visualViewport||[],_P(i)?i:[],e&&r?_G(e):[])}return t.concat(i,_G(i,[],r))}function _H(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function _W(e){let t=_V(e),r=parseFloat(t.width)||0,n=parseFloat(t.height)||0,i=_D(e),s=i?e.offsetWidth:r,a=i?e.offsetHeight:n,o=C0(r)!==s||C0(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function _K(e){return _N(e)?e:e.contextElement}function _Q(e){let t=_K(e);if(!_D(t))return C2(1);let r=t.getBoundingClientRect(),{width:n,height:i,$:s}=_W(t),a=(s?C0(r.width):r.width)/n,o=(s?C0(r.height):r.height)/i;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}let _Y=C2(0);function _J(e){let t=_R(e);return _B()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:_Y}function _X(e,t,r){return void 0===t&&(t=!1),!!r&&(!t||r===_R(e))&&t}function _Z(e,t,r,n){void 0===t&&(t=!1),void 0===r&&(r=!1);let i=e.getBoundingClientRect(),s=_K(e),a=C2(1);t&&(n?_N(n)&&(a=_Q(n)):a=_Q(e));let o=_X(s,r,n)?_J(s):C2(0),l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,u=i.width/a.x,d=i.height/a.y;if(s){let e=_R(s),t=n&&_N(n)?_R(n):n,r=e,i=_H(r);for(;i&&n&&t!==r;){let e=_Q(i),t=i.getBoundingClientRect(),n=_V(i),s=t.left+(i.clientLeft+parseFloat(n.paddingLeft))*e.x,a=t.top+(i.clientTop+parseFloat(n.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=s,c+=a,i=_H(r=_R(i))}}return _d({width:u,height:d,x:l,y:c})}function _0(e,t){let r=_z(e).scrollLeft;return t?t.left+r:_Z(_k(e)).left+r}function _1(e,t,r){void 0===r&&(r=!1);let n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-(r?0:_0(e,n)),y:n.top+t.scrollTop}}function _2(e){let t=_k(e),r=_z(e),n=e.ownerDocument.body,i=CZ(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=CZ(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight),a=-r.scrollLeft+_0(e),o=-r.scrollTop;return"rtl"===_V(n).direction&&(a+=CZ(t.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function _3(e,t){let r=_R(e),n=_k(e),i=r.visualViewport,s=n.clientWidth,a=n.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;let e=_B();(!e||e&&"fixed"===t)&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function _6(e,t){let r=_Z(e,!0,"fixed"===t),n=r.top+e.clientTop,i=r.left+e.clientLeft,s=_D(e)?_Q(e):C2(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y;return{width:a,height:o,x:i*s.x,y:n*s.y}}function _4(e,t,r){let n;if("viewport"===t)n=_3(e,r);else if("document"===t)n=_2(_k(e));else if(_N(t))n=_6(t,r);else{let r=_J(e);n={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return _d(n)}function _5(e,t){let r=_q(e);return!(r===t||!_N(r)||_U(r))&&("fixed"===_V(r).position||_5(r,t))}function _8(e,t){let r=t.get(e);if(r)return r;let n=_G(e,[],!1).filter(e=>_N(e)&&"body"!==_x(e)),i=null,s="fixed"===_V(e).position,a=s?_q(e):e;for(;_N(a)&&!_U(a);){let t=_V(a),r=_F(a);r||"fixed"!==t.position||(i=null),(s?!r&&!i:!r&&"static"===t.position&&!!i&&["absolute","fixed"].includes(i.position)||_P(a)&&!r&&_5(e,a))?n=n.filter(e=>e!==a):i=t,a=_q(a)}return t.set(e,n),n}function _7(e,t,r){let n=_D(t),i=_k(t),s="fixed"===r,a=_Z(e,!0,s,t),o={scrollLeft:0,scrollTop:0},l=C2(0);if(n||!n&&!s)if(("body"!==_x(t)||_P(i))&&(o=_z(t)),n){let e=_Z(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else i&&(l.x=_0(i));let c=!i||n||s?C2(0):_1(i,o);return{x:a.left+o.scrollLeft-l.x-c.x,y:a.top+o.scrollTop-l.y-c.y,width:a.width,height:a.height}}function _9(e){return"static"===_V(e).position}function Ie(e,t){if(!_D(e)||"fixed"===_V(e).position)return null;if(t)return t(e);let r=e.offsetParent;return _k(e)===r&&(r=r.ownerDocument.body),r}function It(e,t){let r=_R(e);if(_L(e))return r;if(!_D(e)){let t=_q(e);for(;t&&!_U(t);){if(_N(t)&&!_9(t))return t;t=_q(t)}return r}let n=Ie(e,t);for(;n&&_M(n)&&_9(n);)n=Ie(n,t);return n&&_U(n)&&_9(n)&&!_F(n)?r:n||_j(e)||r}let Ir=async function(e){let t=this.getOffsetParent||It,r=this.getDimensions,n=await r(e.floating);return{reference:_7(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}},In={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e,s="fixed"===i,a=_k(n),o=!!t&&_L(t.floating);if(n===a||o&&s)return r;let l={scrollLeft:0,scrollTop:0},c=C2(1),u=C2(0),d=_D(n);if((d||!d&&!s)&&(("body"!==_x(n)||_P(a))&&(l=_z(n)),_D(n))){let e=_Z(n);c=_Q(n),u.x=e.x+n.clientLeft,u.y=e.y+n.clientTop}let h=!a||d||s?C2(0):_1(a,l,!0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:r.y*c.y-l.scrollTop*c.y+u.y+h.y}},getDocumentElement:_k,getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e,s=[..."clippingAncestors"===r?_L(t)?[]:_8(t,this._c):[].concat(r),n],a=s[0],o=s.reduce((e,r)=>{let n=_4(t,r,i);return e.top=CZ(n.top,e.top),e.right=CX(n.right,e.right),e.bottom=CX(n.bottom,e.bottom),e.left=CZ(n.left,e.left),e},_4(t,a,i));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:It,getElementRects:Ir,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:r}=_W(e);return{width:t,height:r}},getScale:_Q,isElement:_N,isRTL:function(e){return"rtl"===_V(e).direction}};function Ii(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Is(e,t){let r,n=null,i=_k(e);function s(){var e;clearTimeout(r),null==(e=n)||e.disconnect(),n=null}function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();let c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(o||t(),!h||!f)return;let p=C1(d),m=C1(i.clientWidth-(u+h)),g={rootMargin:-p+"px "+-m+"px "+-C1(i.clientHeight-(d+f))+"px "+-C1(u)+"px",threshold:CZ(0,CX(1,l))||1},y=!0;function v(t){let n=t[0].intersectionRatio;if(n!==l){if(!y)return a();n?a(!1,n):r=setTimeout(()=>{a(!1,1e-7)},1e3)}1!==n||Ii(c,e.getBoundingClientRect())||a(),y=!1}try{n=new IntersectionObserver(v,{...g,root:i.ownerDocument})}catch(e){n=new IntersectionObserver(v,g)}n.observe(e)}return a(!0),s}function Ia(e,t,r,n){let i;void 0===n&&(n={});let{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:c=!1}=n,u=_K(e),d=s||a?[...u?_G(u):[],..._G(t)]:[];d.forEach(e=>{s&&e.addEventListener("scroll",r,{passive:!0}),a&&e.addEventListener("resize",r)});let h=u&&l?Is(u,r):null,f=-1,p=null;o&&(p=new ResizeObserver(e=>{let[n]=e;n&&n.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),r()}),u&&!c&&p.observe(u),p.observe(t));let m=c?_Z(e):null;function g(){let t=_Z(e);m&&!Ii(m,t)&&r(),m=t,i=requestAnimationFrame(g)}return c&&g(),r(),()=>{var e;d.forEach(e=>{s&&e.removeEventListener("scroll",r),a&&e.removeEventListener("resize",r)}),null==h||h(),null==(e=p)||e.disconnect(),p=null,c&&cancelAnimationFrame(i)}}let Io=_T,Il=_E,Ic=_g,Iu=__,Id=_b,Ih=_m,If=_C,Ip=(e,t,r)=>{let n=new Map,i={platform:In,...r},s={...i.platform,_c:n};return _f(e,t,{...i,platform:s})};var Im=r(1215),Ig="undefined"!=typeof document?h.useLayoutEffect:h.useEffect;function Iy(e,t){let r,n,i;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(n=r;0!=n--;)if(!Iy(e[n],t[n]))return!1;return!0}if((r=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!({}).hasOwnProperty.call(t,i[n]))return!1;for(n=r;0!=n--;){let r=i[n];if(("_owner"!==r||!e.$$typeof)&&!Iy(e[r],t[r]))return!1}return!0}return e!=e&&t!=t}function Iv(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Ib(e,t){let r=Iv(e);return Math.round(t*r)/r}function IS(e){let t=h.useRef(e);return Ig(()=>{t.current=e}),t}function Iw(e){void 0===e&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=h.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=h.useState(n);Iy(f,n)||p(n);let[m,g]=h.useState(null),[y,v]=h.useState(null),b=h.useCallback(e=>{e!==E.current&&(E.current=e,g(e))},[]),S=h.useCallback(e=>{e!==C.current&&(C.current=e,v(e))},[]),w=s||m,T=a||y,E=h.useRef(null),C=h.useRef(null),_=h.useRef(u),I=null!=l,x=IS(l),R=IS(i),k=IS(c),A=h.useCallback(()=>{if(!E.current||!C.current)return;let e={placement:t,strategy:r,middleware:f};R.current&&(e.platform=R.current),Ip(E.current,C.current,e).then(e=>{let t={...e,isPositioned:!1!==k.current};N.current&&!Iy(_.current,t)&&(_.current=t,Im.flushSync(()=>{d(t)}))})},[f,t,r,R,k]);Ig(()=>{!1===c&&_.current.isPositioned&&(_.current.isPositioned=!1,d(e=>({...e,isPositioned:!1})))},[c]);let N=h.useRef(!1);Ig(()=>(N.current=!0,()=>{N.current=!1}),[]),Ig(()=>{if(w&&(E.current=w),T&&(C.current=T),w&&T){if(x.current)return x.current(w,T,A);A()}},[w,T,A,x,I]);let D=h.useMemo(()=>({reference:E,floating:C,setReference:b,setFloating:S}),[b,S]),O=h.useMemo(()=>({reference:w,floating:T}),[w,T]),P=h.useMemo(()=>{let e={position:r,left:0,top:0};if(!O.floating)return e;let t=Ib(O.floating,u.x),n=Ib(O.floating,u.y);return o?{...e,transform:"translate("+t+"px, "+n+"px)",...Iv(O.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:n}},[r,o,O.floating,u.x,u.y]);return h.useMemo(()=>({...u,update:A,refs:D,elements:O,floatingStyles:P}),[u,A,D,O,P])}let IT=e=>{function t(e){return({}).hasOwnProperty.call(e,"current")}return{name:"arrow",options:e,fn(r){let{element:n,padding:i}="function"==typeof e?e(r):e;return n&&t(n)?null!=n.current?Ih({element:n.current,padding:i}).fn(r):{}:n?Ih({element:n,padding:i}).fn(r):{}}}},IE=(e,t)=>({...Io(e),options:[e,t]}),IC=(e,t)=>({...Il(e),options:[e,t]}),I_=(e,t)=>({...If(e),options:[e,t]}),II=(e,t)=>({...Ic(e),options:[e,t]}),Ix=(e,t)=>({...Iu(e),options:[e,t]}),IR=(e,t)=>({...Id(e),options:[e,t]}),Ik=(e,t)=>({...IT(e),options:[e,t]});var IA="Arrow",IN=h.forwardRef((e,t)=>{let{children:r,width:n=10,height:i=5,...s}=e;return(0,d.jsx)(b.sG.svg,{...s,ref:t,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:(0,d.jsx)("polygon",{points:"0,0 30,0 15,10"})})});IN.displayName=IA;var ID=IN;function IO(e){let[t,r]=h.useState(void 0);return(0,I.N)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let n,i;if(!Array.isArray(t)||!t.length)return;let s=t[0];if("borderBoxSize"in s){let e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;n=t.inlineSize,i=t.blockSize}else n=e.offsetWidth,i=e.offsetHeight;r({width:n,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}var IP="Popper",[IM,IL]=(0,w.A)(IP),[IF,Ij]=IM(IP),IB=e=>{let{__scopePopper:t,children:r}=e,[n,i]=h.useState(null);return(0,d.jsx)(IF,{scope:t,anchor:n,onAnchorChange:i,children:r})};IB.displayName=IP;var IU="PopperAnchor",IV=h.forwardRef((e,t)=>{let{__scopePopper:r,virtualRef:n,...i}=e,s=Ij(IU,r),a=h.useRef(null),o=(0,T.s)(t,a);return h.useEffect(()=>{s.onAnchorChange(n?.current||a.current)}),n?null:(0,d.jsx)(b.sG.div,{...i,ref:o})});IV.displayName=IU;var Iz="PopperContent",[Iq,I$]=IM(Iz),IG=h.forwardRef((e,t)=>{let{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:m="optimized",onPlaced:g,...y}=e,v=Ij(Iz,r),[S,w]=h.useState(null),C=(0,T.s)(t,e=>w(e)),[_,x]=h.useState(null),R=IO(_),k=R?.width??0,A=R?.height??0,N=n+("center"!==s?"-"+s:""),D="number"==typeof u?u:{top:0,right:0,bottom:0,left:0,...u},O=Array.isArray(c)?c:[c],P=O.length>0,M={padding:D,boundary:O.filter(IQ),altBoundary:P},{refs:L,floatingStyles:F,placement:j,isPositioned:B,middlewareData:U}=Iw({strategy:"fixed",placement:N,whileElementsMounted:(...e)=>Ia(...e,{animationFrame:"always"===m}),elements:{reference:v.anchor},middleware:[IE({mainAxis:i+A,alignmentAxis:a}),l&&IC({mainAxis:!0,crossAxis:!1,limiter:"partial"===f?I_():void 0,...M}),l&&II({...M}),Ix({...M,apply:({elements:e,rects:t,availableWidth:r,availableHeight:n})=>{let{width:i,height:s}=t.reference,a=e.floating.style;a.setProperty("--radix-popper-available-width",`${r}px`),a.setProperty("--radix-popper-available-height",`${n}px`),a.setProperty("--radix-popper-anchor-width",`${i}px`),a.setProperty("--radix-popper-anchor-height",`${s}px`)}}),_&&Ik({element:_,padding:o}),IY({arrowWidth:k,arrowHeight:A}),p&&IR({strategy:"referenceHidden",...M})]}),[V,z]=IJ(j),q=(0,E.c)(g);(0,I.N)(()=>{B&&q?.()},[B,q]);let $=U.arrow?.x,G=U.arrow?.y,H=U.arrow?.centerOffset!==0,[W,K]=h.useState();return(0,I.N)(()=>{S&&K(window.getComputedStyle(S).zIndex)},[S]),(0,d.jsx)("div",{ref:L.setFloating,"data-radix-popper-content-wrapper":"",style:{...F,transform:B?F.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:W,"--radix-popper-transform-origin":[U.transformOrigin?.x,U.transformOrigin?.y].join(" "),...U.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:(0,d.jsx)(Iq,{scope:r,placedSide:V,onArrowChange:x,arrowX:$,arrowY:G,shouldHideArrow:H,children:(0,d.jsx)(b.sG.div,{"data-side":V,"data-align":z,...y,ref:C,style:{...y.style,animation:B?void 0:"none"}})})})});IG.displayName=Iz;var IH="PopperArrow",IW={top:"bottom",right:"left",bottom:"top",left:"right"},IK=h.forwardRef(function(e,t){let{__scopePopper:r,...n}=e,i=I$(IH,r),s=IW[i.placedSide];return(0,d.jsx)("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:(0,d.jsx)(ID,{...n,ref:t,style:{...n.style,display:"block"}})})});function IQ(e){return null!==e}IK.displayName=IH;var IY=e=>({name:"transformOrigin",options:e,fn(t){let{placement:r,rects:n,middlewareData:i}=t,s=i.arrow?.centerOffset!==0,a=s?0:e.arrowWidth,o=s?0:e.arrowHeight,[l,c]=IJ(r),u={start:"0%",center:"50%",end:"100%"}[c],d=(i.arrow?.x??0)+a/2,h=(i.arrow?.y??0)+o/2,f="",p="";return"bottom"===l?(f=s?u:`${d}px`,p=`${-o}px`):"top"===l?(f=s?u:`${d}px`,p=`${n.floating.height+o}px`):"right"===l?(f=`${-o}px`,p=s?u:`${h}px`):"left"===l&&(f=`${n.floating.width+o}px`,p=s?u:`${h}px`),{data:{x:f,y:p}}}});function IJ(e){let[t,r="center"]=e.split("-");return[t,r]}var IX=IB,IZ=IV,I0=IG,I1=IK,I2=r(9024),[I3,I6]=(0,w.A)("Tooltip",[IL]),I4=IL(),I5="TooltipProvider",I8=700,I7="tooltip.open",[I9,xe]=I3(I5),xt=e=>{let{__scopeTooltip:t,delayDuration:r=I8,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:s}=e,[a,o]=h.useState(!0),l=h.useRef(!1),c=h.useRef(0);return h.useEffect(()=>{let e=c.current;return()=>window.clearTimeout(e)},[]),(0,d.jsx)(I9,{scope:t,isOpenDelayed:a,delayDuration:r,onOpen:h.useCallback(()=>{window.clearTimeout(c.current),o(!1)},[]),onClose:h.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o(!0),n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:h.useCallback(e=>{l.current=e},[]),disableHoverableContent:i,children:s})};xt.displayName=I5;var xr="Tooltip",[xn,xi]=I3(xr),xs=e=>{let{__scopeTooltip:t,children:r,open:n,defaultOpen:i=!1,onOpenChange:s,disableHoverableContent:a,delayDuration:o}=e,l=xe(xr,e.__scopeTooltip),c=I4(t),[u,f]=h.useState(null),p=Ts(),m=h.useRef(0),g=a??l.disableHoverableContent,y=o??l.delayDuration,v=h.useRef(!1),[b=!1,S]=(0,Ta.i)({prop:n,defaultProp:i,onChange:e=>{e?(l.onOpen(),document.dispatchEvent(new CustomEvent(I7))):l.onClose(),s?.(e)}}),w=h.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),T=h.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,S(!0)},[S]),E=h.useCallback(()=>{window.clearTimeout(m.current),m.current=0,S(!1)},[S]),C=h.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,S(!0),m.current=0},y)},[y,S]);return h.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),(0,d.jsx)(IX,{...c,children:(0,d.jsx)(xn,{scope:t,contentId:p,open:b,stateAttribute:w,trigger:u,onTriggerChange:f,onTriggerEnter:h.useCallback(()=>{l.isOpenDelayed?C():T()},[l.isOpenDelayed,C,T]),onTriggerLeave:h.useCallback(()=>{g?E():(window.clearTimeout(m.current),m.current=0)},[E,g]),onOpen:T,onClose:E,disableHoverableContent:g,children:r})})};xs.displayName=xr;var xa="TooltipTrigger",xo=h.forwardRef((e,t)=>{let{__scopeTooltip:r,...n}=e,i=xi(xa,r),s=xe(xa,r),a=I4(r),o=h.useRef(null),l=(0,T.s)(t,o,i.onTriggerChange),c=h.useRef(!1),u=h.useRef(!1),f=h.useCallback(()=>c.current=!1,[]);return h.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),(0,d.jsx)(IZ,{asChild:!0,...a,children:(0,d.jsx)(b.sG.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...n,ref:l,onPointerMove:(0,R.m)(e.onPointerMove,e=>{"touch"!==e.pointerType&&(u.current||s.isPointerInTransitRef.current||(i.onTriggerEnter(),u.current=!0))}),onPointerLeave:(0,R.m)(e.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:(0,R.m)(e.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:(0,R.m)(e.onFocus,()=>{c.current||i.onOpen()}),onBlur:(0,R.m)(e.onBlur,i.onClose),onClick:(0,R.m)(e.onClick,i.onClose)})})});xo.displayName=xa;var xl="TooltipPortal",[xc,xu]=I3(xl,{forceMount:void 0}),xd="TooltipContent",xh=h.forwardRef((e,t)=>{let r=xu(xd,e.__scopeTooltip),{forceMount:n=r.forceMount,side:i="top",...s}=e,a=xi(xd,e.__scopeTooltip);return(0,d.jsx)(S.C,{present:n||a.open,children:a.disableHoverableContent?(0,d.jsx)(xg,{side:i,...s,ref:t}):(0,d.jsx)(xf,{side:i,...s,ref:t})})}),xf=h.forwardRef((e,t)=>{let r=xi(xd,e.__scopeTooltip),n=xe(xd,e.__scopeTooltip),i=h.useRef(null),s=(0,T.s)(t,i),[a,o]=h.useState(null),{trigger:l,onClose:c}=r,u=i.current,{onPointerInTransitChange:f}=n,p=h.useCallback(()=>{o(null),f(!1)},[f]),m=h.useCallback((e,t)=>{let r=e.currentTarget,n={x:e.clientX,y:e.clientY},i=xv(n,r.getBoundingClientRect());o(xT([...xb(n,i),...xS(t.getBoundingClientRect())])),f(!0)},[f]);return h.useEffect(()=>()=>p(),[p]),h.useEffect(()=>{if(l&&u){let e=e=>m(e,u),t=e=>m(e,l);return l.addEventListener("pointerleave",e),u.addEventListener("pointerleave",t),()=>{l.removeEventListener("pointerleave",e),u.removeEventListener("pointerleave",t)}}},[l,u,m,p]),h.useEffect(()=>{if(a){let e=e=>{let t=e.target,r={x:e.clientX,y:e.clientY},n=l?.contains(t)||u?.contains(t),i=!xw(r,a);n?p():i&&(p(),c())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[l,u,a,c,p]),(0,d.jsx)(xg,{...e,ref:s})}),[xp,xm]=I3(xr,{isInside:!1}),xg=h.forwardRef((e,t)=>{let{__scopeTooltip:r,children:n,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:a,...o}=e,l=xi(xd,r),c=I4(r),{onClose:u}=l;return h.useEffect(()=>(document.addEventListener(I7,u),()=>document.removeEventListener(I7,u)),[u]),h.useEffect(()=>{if(l.trigger){let e=e=>{let t=e.target;t?.contains(l.trigger)&&u()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[l.trigger,u]),(0,d.jsx)(To.qW,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:e=>e.preventDefault(),onDismiss:u,children:(0,d.jsxs)(I0,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[(0,d.jsx)(eM.xV,{children:n}),(0,d.jsx)(xp,{scope:r,isInside:!0,children:(0,d.jsx)(I2.b,{id:l.contentId,role:"tooltip",children:i||n})})]})})});xh.displayName=xd;var xy="TooltipArrow";function xv(e,t){let r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),i=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,n,i,s)){case s:return"left";case i:return"right";case r:return"top";case n:return"bottom";default:throw Error("unreachable")}}function xb(e,t,r=5){let n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r})}return n}function xS(e){let{top:t,right:r,bottom:n,left:i}=e;return[{x:i,y:t},{x:r,y:t},{x:r,y:n},{x:i,y:n}]}function xw(e,t){let{x:r,y:n}=e,i=!1;for(let e=0,s=t.length-1;e<t.length;s=e++){let a=t[e].x,o=t[e].y,l=t[s].x,c=t[s].y;o>n!=c>n&&r<(l-a)*(n-o)/(c-o)+a&&(i=!i)}return i}function xT(e){let t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:1*!!(e.y>t.y)),xE(t)}function xE(e){if(e.length<=1)return e.slice();let t=[];for(let r=0;r<e.length;r++){let n=e[r];for(;t.length>=2;){let e=t[t.length-1],r=t[t.length-2];if((e.x-r.x)*(n.y-r.y)>=(e.y-r.y)*(n.x-r.x))t.pop();else break}t.push(n)}t.pop();let r=[];for(let t=e.length-1;t>=0;t--){let n=e[t];for(;r.length>=2;){let e=r[r.length-1],t=r[r.length-2];if((e.x-t.x)*(n.y-t.y)>=(e.y-t.y)*(n.x-t.x))r.pop();else break}r.push(n)}return(r.pop(),1===t.length&&1===r.length&&t[0].x===r[0].x&&t[0].y===r[0].y)?t:t.concat(r)}h.forwardRef((e,t)=>{let{__scopeTooltip:r,...n}=e,i=I4(r);return xm(xy,r).isInside?null:(0,d.jsx)(I1,{...i,...n,ref:t})}).displayName=xy;var xC=xh;let x_=xt,xI=xs,xx=xo,xR=h.forwardRef(({className:e,sideOffset:t=4,...r},n)=>(0,d.jsx)(xC,{ref:n,sideOffset:t,className:(0,p.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));xR.displayName=xC.displayName;let xk={apiKey:"AIzaSyAglV5rgoSjtpf0W5EY5qeVWO_T1-Z_FI0",authDomain:"accountviewer.firebaseapp.com",projectId:"accountviewer",storageBucket:"accountviewer.firebasestorage.app",messagingSenderId:"693621188843",appId:"1:693621188843:web:9d332a2bb0973d98bcb6ae"},xA={functions:5001},xN="accountviewer_market_prices";function xD(){let[e,t]=(0,h.useState)([]),[r,n]=(0,h.useState)([]),[i,s]=(0,h.useState)(!0),[a,o]=(0,h.useState)(null),[l,c]=(0,h.useState)("firestore"),[u,f]=(0,h.useState)(null),[p,m]=(0,h.useState)(!0),[g,y]=(0,h.useState)(""),[v,b]=(0,h.useState)(""),[S,w]=(0,h.useState)(null),[T,E]=(0,h.useState)(!1),[C,_]=(0,h.useState)(!1),[I,x]=(0,h.useState)(!1),[R,k]=(0,h.useState)(""),[A,N]=(0,h.useState)(null),[D,O]=(0,h.useState)({}),[P,M]=(0,h.useState)(!1),[L,F]=(0,h.useState)(null),[j,B]=(0,h.useState)(!1),[U,V]=(0,h.useState)(!1),{toast:z}=(0,Cv.dj)(),q=(0,h.useCallback)(async()=>{s(!0),o(null),n([]),t([]);try{if("mock"===l){let e=[{description:"Alphabet Inc.",quantity:15,symbol:"GOOGL",unitcost:2500,stock:!0},{description:"Amazon.com Inc.",quantity:3,symbol:"AMZN",unitcost:3200.75,stock:!0}],r=[{id:"mock-page-1",name:"Mock Brokerage Account",securities:e},{id:"mock-page-2",name:"Mock Savings Account"},{id:"mock-page-3",name:"Mock Investment Portfolio",securities:[{description:"Netflix Inc.",quantity:7,symbol:"NFLX",unitcost:550.2,stock:!0}]},{id:"mock-page-4",name:"Mock College Fund"}];t(r)}else{if(!u){t([]),o("Please sign in to view your accounts");return}let e=0===ry().length?rm(xk):ry()[0],r=yZ(e),n=yK(r,"users",u.uid),i=await v9(n);if(!i.exists())return void t([]);let s=i.data(),a=[];s.accounts&&Array.isArray(s.accounts)&&s.accounts.forEach(e=>{a.push({id:e.id||`${u.uid}-${a.length}`,name:e.name||"N/A",securities:(e.securities||[]).map(e=>({...e,unitcost:e.unitcost||0,quantity:e.quantity||0}))})}),t(a)}}catch(e){console.error("Failed to fetch accounts:",e),o(e.message||"Could not load accounts. Please try again later.")}finally{s(!1)}},[l,u]),$=()=>{c(e=>"firestore"===e?"mock":"firestore")},G=async()=>{w(null);try{let e=0===ry().length?rm(xk):ry()[0],t=wX(e);await wO(t,g,v),E(!1)}catch(e){console.error("Login error:",e),w(e.message||"Failed to login")}},H=async()=>{try{let e=ry()[0],t=wX(e);await wU(t)}catch(e){console.error("Logout error:",e)}},W=async()=>{N(null);try{let e=JSON.parse(R);if(!u)throw Error("You must be signed in to update user data");let t=ry()[0],r=yZ(t),n=yK(r,"users",u.uid);await bt(n,e,{merge:!0}),x(!1),z({title:"Success",description:"User data updated successfully"}),q()}catch(e){console.error("JSON update error:",e),N(e.message||"Invalid JSON or update failed")}},K=(0,h.useCallback)(()=>{if(!e.length)return[];let t=new Map;return e.forEach(e=>{e.securities&&e.securities.forEach(e=>{if(!e.stock)return;let r=t.get(e.symbol);if(r){let n=r.quantity+e.quantity,i=r.quantity*r.unitcost+e.quantity*e.unitcost;t.set(e.symbol,{symbol:e.symbol,description:e.description,quantity:n,unitcost:i/n,stock:e.stock})}else t.set(e.symbol,{...e})})}),Array.from(t.values())},[e]),Q=async()=>{let e=K();if(e.length){M(!0),F(null);try{let t=e.map(e=>e.symbol),r=ry()[0],n=CK(r),i=CY(n,"getMarketValues"),s=(await i({symbols:t})).data,a={};if(s&&s.length>0&&s[0].values){let e=s[0].values;Object.entries(e).forEach(([e,t])=>{a[e]=t})}O(a),localStorage.setItem(xN,JSON.stringify(a)),z({title:"Prices Updated",description:"Market prices have been refreshed"})}catch(e){console.error("Failed to fetch market prices:",e),F(e.message||"Could not load market prices")}finally{M(!1)}}},Y=()=>{try{let e=ry()[0],t=CK(e);CQ(t,"localhost",xA.functions),V(!0),z({title:"Emulator Connected",description:`Now using Firebase Functions emulator on localhost:${xA.functions}`})}catch(e){console.error("Failed to connect to emulator:",e),z({title:"Connection Failed",description:e.message||"Could not connect to Functions emulator",variant:"destructive"})}};return(0,d.jsxs)("main",{className:"min-h-screen container mx-auto px-2 py-1",children:[(0,d.jsx)(x_,{children:C&&(0,d.jsx)("div",{className:"mt-1 mb-1",children:p?(0,d.jsx)(w5,{variant:"outline",className:"animate-pulse",children:"Checking auth..."}):u?(0,d.jsx)("div",{className:"flex flex-col items-center gap-1",children:(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsxs)(xI,{children:[(0,d.jsx)(xx,{asChild:!0,children:(0,d.jsx)(eF,{variant:"outline",onClick:H,className:"h-auto py-[2px] px-3 text-xs",children:"Sign Out"})}),(0,d.jsx)(xR,{children:(0,d.jsx)("p",{children:u.email||u.displayName||"User"})})]}),(0,d.jsx)(eF,{variant:"outline",onClick:()=>x(!0),className:"h-auto py-[2px] px-3 text-xs",children:"User JSON"}),(0,d.jsx)(eF,{onClick:Q,disabled:P||!K().length,variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:P?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(eI,{size:16,className:"mr-2"}),"Updating..."]}):"Update Prices"}),(0,d.jsxs)(eF,{onClick:$,variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:["firestore"===l?"Mock":"Live (Firestore)"," Data"]}),j&&(U?(0,d.jsxs)(w5,{variant:"outline",className:"h-auto py-[2px] px-3 text-xs bg-red-100 text-red-800 border-red-300",children:["Functions emulated port ",xA.functions]}):(0,d.jsx)(eF,{onClick:Y,variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:"Emulate Functions"}))]})}):(0,d.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,d.jsx)(w5,{variant:"secondary",children:"Not signed in"}),(0,d.jsxs)(Cc,{open:T,onOpenChange:E,children:[(0,d.jsx)(Cu,{asChild:!0,children:(0,d.jsx)(eF,{variant:"default",className:"h-auto py-[2px] px-3 text-xs",children:"Sign In"})}),(0,d.jsxs)(Cf,{className:"sm:max-w-[425px]",children:[(0,d.jsxs)(Cp,{children:[(0,d.jsx)(Cm,{children:"Sign in to AccountViewer"}),(0,d.jsx)(Cg,{children:"Enter your credentials to access your account information."})]}),(0,d.jsx)("form",{onSubmit:e=>{e.preventDefault(),G()},children:(0,d.jsxs)("div",{className:"grid gap-2 py-2",children:[S&&(0,d.jsx)("div",{className:"text-sm text-destructive",children:S}),(0,d.jsxs)("div",{className:"grid gap-1",children:[(0,d.jsx)(Tr,{htmlFor:"email",children:"Email"}),(0,d.jsx)(w8,{id:"email",type:"email",value:g,onChange:e=>y(e.target.value),placeholder:"your@email.com",autoComplete:"username"})]}),(0,d.jsxs)("div",{className:"grid gap-1",children:[(0,d.jsx)(Tr,{htmlFor:"password",children:"Password"}),(0,d.jsx)(w8,{id:"password",type:"password",value:v,onChange:e=>b(e.target.value),autoComplete:"current-password"})]}),(0,d.jsx)(eF,{type:"submit",className:"mt-2 h-auto py-[2px] px-3 text-xs",children:"Sign In"})]})})]})]})]})})}),!i&&!a&&e.length>0&&r.length>0&&(0,d.jsxs)("div",{className:"mb-1",children:[L&&(0,d.jsx)("div",{className:"mb-1",children:(0,d.jsx)(eP,{message:L})}),(0,d.jsx)(eT,{account:{id:"combined-holdings",name:"Combined",securities:K()},marketPrices:D,className:"animate-in fade-in slide-in-from-bottom-5 duration-500"},"combined-holdings")]}),i&&(0,d.jsx)(eI,{className:"my-4"}),a&&!i&&(0,d.jsxs)("div",{className:"my-4 flex flex-col items-center gap-2",children:[(0,d.jsx)(eP,{message:a}),(0,d.jsx)(eF,{onClick:q,variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:"Retry"})]}),!i&&!a&&0===e.length&&(0,d.jsxs)("div",{className:"text-center text-muted-foreground py-3",children:[(0,d.jsxs)("p",{className:"text-lg",children:["No accounts found for ","firestore"===l?"live":"mock"," source."]}),(0,d.jsx)("p",{className:"text-sm",children:"Try adding some accounts or check back later."})]}),!i&&!a&&r.length>0&&(0,d.jsx)("div",{className:"grid grid-cols-1 gap-2",children:r.map((e,t)=>(0,d.jsx)(eT,{account:e,marketPrices:D,className:"animate-in fade-in slide-in-from-bottom-5 duration-500 ease-out",style:{animationDelay:`${50*t}ms`}},e.id))}),!i&&!a&&e.length>0&&r.length<e.length&&(0,d.jsxs)("div",{className:"mt-2 flex justify-center items-center",children:[(0,d.jsx)(eI,{size:20}),(0,d.jsx)("p",{className:"ml-2 text-sm text-muted-foreground",children:"Loading more accounts..."})]}),(0,d.jsx)(Cc,{open:I,onOpenChange:x,children:(0,d.jsxs)(Cf,{className:"sm:max-w-[600px]",children:[(0,d.jsxs)(Cp,{children:[(0,d.jsx)(Cm,{children:"User Data"}),(0,d.jsx)(Cg,{children:"Enter JSON for your user document. This will update or create the document in Firestore."})]}),(0,d.jsxs)("div",{className:"grid gap-2 py-2",children:[A&&(0,d.jsx)("div",{className:"text-sm text-destructive",children:A}),(0,d.jsxs)("div",{className:"grid gap-1",children:[(0,d.jsx)(Tr,{htmlFor:"userJson",children:"User data"}),(0,d.jsx)(Cy,{id:"userJson",value:R,onChange:e=>k(e.target.value),placeholder:'{"accounts": [{"id": "account1", "name": "My Account", "securities": [{"description": "Apple Inc.", "quantity": 10, "symbol": "AAPL", "unitcost": 150.00, "stock": true}]}]}',className:"min-h-[150px] font-mono text-xs"})]}),(0,d.jsx)(eF,{onClick:W,className:"h-auto py-[2px] px-3 text-xs",children:"Update User Data"})]})]})})]})}},7386:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.PickFirstLoadBalancer=t.shuffled=t.PickFirstLoadBalancingConfig=void 0;let n=r(6239),i=r(8155),s=r(2910),a=r(1359),o=r(1271),l="pick_first";function c(e){a.trace(o.LogVerbosity.DEBUG,l,e)}let u="pick_first",d=250;class h{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return u}toJsonObject(){return{[u]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&"boolean"!=typeof e.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new h(!0===e.shuffleAddressList)}}t.PickFirstLoadBalancingConfig=h;class f{constructor(e){this.subchannel=e}pick(e){return{pickResultType:s.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function p(e){let t=e.slice();for(let e=t.length-1;e>1;e--){let r=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[r],t[r]=n}return t}t.shuffled=p;class m{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=i.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(e,t,r,n,i)=>{this.onSubchannelStateUpdate(e,t,r,i)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(i.ConnectivityState.READY,new f(this.currentPick)):0===this.children.length?this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:e}of(this.stickyTransientFailureMode=!0,this.children))e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,r,n){var s;if(null==(s=this.currentPick)?void 0:s.realSubchannelEquals(e)){r!==i.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[t,s]of this.children.entries())if(e.realSubchannelEquals(s.subchannel)){r===i.ConnectivityState.READY&&this.pickSubchannel(s.subchannel),r===i.ConnectivityState.TRANSIENT_FAILURE&&(s.hasReportedTransientFailure=!0,n&&(this.lastError=n),this.maybeEnterStickyTransientFailureMode(),t===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(t+1)),s.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,r]of this.children.entries())if(t>=e){let e=r.subchannel.getConnectivityState();if(e===i.ConnectivityState.IDLE||e===i.ConnectivityState.CONNECTING)return void this.startConnecting(t)}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,r;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===i.ConnectivityState.IDLE&&(c("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var t;null==(t=this.children[e])||t.subchannel.startConnecting()})),this.connectionDelayTimeout=null==(r=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},d)).unref)?void 0:r.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(c("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){c(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(e=>({subchannel:this.channelControlHelper.createSubchannel(e,{}),hasReportedTransientFailure:!1}));for(let{subchannel:e}of t)e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef());for(let{subchannel:e}of(this.resetSubchannelList(),this.children=t,this.children))if(e.addConnectivityStateListener(this.subchannelStateListener),e.getConnectivityState()===i.ConnectivityState.READY)return void this.pickSubchannel(e);for(let e of this.children)e.subchannel.getConnectivityState()===i.ConnectivityState.TRANSIENT_FAILURE&&(e.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof h&&(t.getShuffleAddressList()&&(e=p(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===i.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return u}}t.PickFirstLoadBalancer=m,t.setup=function(){(0,n.registerLoadBalancerType)(u,m,h),(0,n.registerDefaultLoadBalancerType)(u)}},7408:(e,t,r)=>{"use strict";e.exports=C,C.filename=null,C.defaults={keepCase:!1};var n=r(158),i=r(2703),s=r(4351),a=r(3267),o=r(5585),l=r(2630),c=r(2110),u=r(3076),d=r(1202),h=r(1810),f=r(3107),p=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,v=/^0[0-7]+$/,b=/^-?0[0-7]+$/,S=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,w=/^[a-zA-Z_][a-zA-Z_0-9]*$/,T=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,E=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function C(e,t,r){t instanceof i||(r=t,t=new i),r||(r=C.defaults);var _,I,x,R,k,A=r.preferTrailingComment||!1,N=n(e,r.alternateCommentMode||!1),D=N.next,O=N.push,P=N.peek,M=N.skip,L=N.cmnt,F=!0,j=!1,B=t,U=r.keepCase?function(e){return e}:f.camelCase;function V(e,t,r){var n=C.filename;return r||(C.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(n?n+", ":"")+"line "+N.line+")")}function z(){var e,t=[];do{if('"'!==(e=D())&&"'"!==e)throw V(e);t.push(D()),M(e),e=P()}while('"'===e||"'"===e);return t.join("")}function q(e){var t=D();switch(t){case"'":case'"':return O(t),z();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return G(t,!0)}catch(r){if(e&&T.test(t))return t;throw V(t,"value")}}function $(e,t){do t&&('"'===(r=P())||"'"===r)?e.push(z()):e.push([n=H(D()),M("to",!0)?H(D()):n]);while(M(",",!0));var r,n,i={options:void 0};i.setOption=function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t},J(i,function(e){if("option"===e)es(i,e),M(";");else throw V(e)},function(){ec(i)})}function G(e,t){var r=1;switch("-"===e.charAt(0)&&(r=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return 1/0*r;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return r*parseInt(e,10);if(g.test(e))return r*parseInt(e,16);if(v.test(e))return r*parseInt(e,8);if(S.test(e))return r*parseFloat(e);throw V(e,"number",t)}function H(e,t){switch(e){case"max":case"MAX":case"Max":return 0x1fffffff;case"0":return 0}if(!t&&"-"===e.charAt(0))throw V(e,"id");if(m.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw V(e,"id")}function W(){if(void 0!==I)throw V("package");if(I=D(),!T.test(I))throw V(I,"name");B=B.define(I),M(";")}function K(){var e,t=P();switch(t){case"weak":e=R||(R=[]),D();break;case"public":D();default:e=x||(x=[])}t=z(),M(";"),e.push(t)}function Q(){if(M("="),!(j="proto3"===(k=z()))&&"proto2"!==k)throw V(k,"syntax");t.setOption("syntax",k),M(";")}function Y(e,t){switch(t){case"option":return es(e,t),M(";"),!0;case"message":return X(e,t),!0;case"enum":return en(e,t),!0;case"service":return eu(e,t),!0;case"extend":return eh(e,t),!0}return!1}function J(e,t,r){var n,i=N.line;if(e&&("string"!=typeof e.comment&&(e.comment=L()),e.filename=C.filename),M("{",!0)){for(;"}"!==(n=D());)t(n);M(";",!0)}else r&&r(),M(";"),e&&("string"!=typeof e.comment||A)&&(e.comment=L(i)||e.comment)}function X(e,t){if(!w.test(t=D()))throw V(t,"type name");var r=new s(t);J(r,function(e){if(!Y(r,e))switch(e){case"map":et(r,e);break;case"required":case"repeated":Z(r,e);break;case"optional":j?Z(r,"proto3_optional"):Z(r,"optional");break;case"oneof":er(r,e);break;case"extensions":$(r.extensions||(r.extensions=[]));break;case"reserved":$(r.reserved||(r.reserved=[]),!0);break;default:if(!j||!T.test(e))throw V(e);O(e),Z(r,"optional")}}),e.add(r)}function Z(e,t,r){var n=D();if("group"===n)return void ee(e,t);for(;n.endsWith(".")||P().startsWith(".");)n+=D();if(!T.test(n))throw V(n,"type");var i=D();if(!w.test(i))throw V(i,"name");i=U(i),M("=");var s=new a(i,H(D()),n,t,r);if(J(s,function(e){if("option"===e)es(s,e),M(";");else throw V(e)},function(){ec(s)}),"proto3_optional"===t){var o=new l("_"+i);s.setOption("proto3_optional",!0),o.add(s),e.add(o)}else e.add(s);!j&&s.repeated&&(void 0!==h.packed[n]||void 0===h.basic[n])&&s.setOption("packed",!1,!0)}function ee(e,t){var r=D();if(!w.test(r))throw V(r,"name");var n=f.lcFirst(r);r===n&&(r=f.ucFirst(r)),M("=");var i=H(D()),o=new s(r);o.group=!0;var l=new a(n,i,r,t);l.filename=C.filename,J(o,function(e){switch(e){case"option":es(o,e),M(";");break;case"required":case"repeated":Z(o,e);break;case"optional":j?Z(o,"proto3_optional"):Z(o,"optional");break;case"message":X(o,e);break;case"enum":en(o,e);break;default:throw V(e)}}),e.add(o).add(l)}function et(e){M("<");var t=D();if(void 0===h.mapKey[t])throw V(t,"type");M(",");var r=D();if(!T.test(r))throw V(r,"type");M(">");var n=D();if(!w.test(n))throw V(n,"name");M("=");var i=new o(U(n),H(D()),t,r);J(i,function(e){if("option"===e)es(i,e),M(";");else throw V(e)},function(){ec(i)}),e.add(i)}function er(e,t){if(!w.test(t=D()))throw V(t,"name");var r=new l(U(t));J(r,function(e){"option"===e?(es(r,e),M(";")):(O(e),Z(r,"optional"))}),e.add(r)}function en(e,t){if(!w.test(t=D()))throw V(t,"name");var r=new c(t);J(r,function(e){switch(e){case"option":es(r,e),M(";");break;case"reserved":$(r.reserved||(r.reserved=[]),!0);break;default:ei(r,e)}}),e.add(r)}function ei(e,t){if(!w.test(t))throw V(t,"name");M("=");var r=H(D(),!0),n={options:void 0};n.setOption=function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t},J(n,function(e){if("option"===e)es(n,e),M(";");else throw V(e)},function(){ec(n)}),e.add(t,r,n.comment,n.options)}function es(e,t){var r,n=M("(",!0);if(!T.test(t=D()))throw V(t,"name");var i=t,s=i;n&&(M(")"),s=i="("+i+")",t=P(),E.test(t)&&(r=t.slice(1),i+=t,D())),M("=");var a=ea(e,i);el(e,s,a,r)}function ea(e,t){if(M("{",!0)){for(var r={};!M("}",!0);){if(!w.test(_=D()))throw V(_,"name");if(null===_)throw V(_,"end of input");var n,i,s=_;if(M(":",!0),"{"===P())n=ea(e,t+"."+_);else if("["===P()){if(n=[],M("[",!0)){do i=q(!0),n.push(i);while(M(",",!0));M("]"),void 0!==i&&eo(e,t+"."+_,i)}}else n=q(!0),eo(e,t+"."+_,n);var a=r[s];a&&(n=[].concat(a).concat(n)),r[s]=n,M(",",!0),M(";",!0)}return r}var o=q(!0);return eo(e,t,o),o}function eo(e,t,r){e.setOption&&e.setOption(t,r)}function el(e,t,r,n){e.setParsedOption&&e.setParsedOption(t,r,n)}function ec(e){if(M("[",!0)){do es(e,"option");while(M(",",!0));M("]")}return e}function eu(e,t){if(!w.test(t=D()))throw V(t,"service name");var r=new u(t);J(r,function(e){if(!Y(r,e))if("rpc"===e)ed(r,e);else throw V(e)}),e.add(r)}function ed(e,t){var r=L(),n=t;if(!w.test(t=D()))throw V(t,"name");var i,s,a,o,l=t;if(M("("),M("stream",!0)&&(s=!0),!T.test(t=D())||(i=t,M(")"),M("returns"),M("("),M("stream",!0)&&(o=!0),!T.test(t=D())))throw V(t);a=t,M(")");var c=new d(l,n,i,a,s,o);c.comment=r,J(c,function(e){if("option"===e)es(c,e),M(";");else throw V(e)}),e.add(c)}function eh(e,t){if(!T.test(t=D()))throw V(t,"reference");var r=t;J(null,function(t){switch(t){case"required":case"repeated":Z(e,t,r);break;case"optional":j?Z(e,"proto3_optional",r):Z(e,"optional",r);break;default:if(!j||!T.test(t))throw V(t);O(t),Z(e,"optional",r)}})}for(;null!==(_=D());)switch(_){case"package":if(!F)throw V(_);W();break;case"import":if(!F)throw V(_);K();break;case"syntax":if(!F)throw V(_);Q();break;case"option":es(B,_),M(";");break;default:if(Y(B,_)){F=!1;continue}throw V(_)}return C.filename=null,{package:I,imports:x,weakImports:R,syntax:k,root:t}}},7492:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2ServerCallStream=t.ServerDuplexStreamImpl=t.ServerWritableStreamImpl=t.ServerReadableStreamImpl=t.ServerUnaryCallImpl=void 0;let n=r(4735),i=r(3496),s=r(7910),a=r(4075),o=r(1271),l=r(6777),c=r(1037),u=r(1359),d=r(776),h="server_call";function f(e){u.trace(o.LogVerbosity.DEBUG,h,e)}let p="grpc-message",m="grpc-status",g="grpc-timeout",y=/(\d{1,8})\s*([HMSmun])/,v={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},b={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},S={[i.constants.HTTP2_HEADER_STATUS]:i.constants.HTTP_STATUS_OK,[i.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},w={waitForTrailers:!0};class T extends n.EventEmitter{constructor(e,t,r){super(),this.call=e,this.metadata=t,this.request=r,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}t.ServerUnaryCallImpl=T;class E extends s.Readable{constructor(e,t,r,n){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=r,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,n)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}t.ServerReadableStreamImpl=E;class C extends s.Writable{constructor(e,t,r,n){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.request=n,this.cancelled=!1,this.trailingMetadata=new l.Metadata,this.call.setupSurfaceCall(this),this.on("error",e=>{this.call.sendError(e),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,r){try{let t=this.call.serializeMessage(e);if(!this.call.write(t))return void this.call.once("drain",r)}catch(e){this.emit("error",{details:(0,d.getErrorMessage)(e),code:o.Status.INTERNAL})}r()}_final(e){this.call.sendStatus({code:o.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}}t.ServerWritableStreamImpl=C;class _ extends s.Duplex{constructor(e,t,r,n,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.deserialize=n,this.cancelled=!1,this.trailingMetadata=new l.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i),this.on("error",e=>{this.call.sendError(e),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}}t.ServerDuplexStreamImpl=_,_.prototype._read=E.prototype._read,_.prototype._write=C.prototype._write,_.prototype._final=C.prototype._final;class I extends n.EventEmitter{constructor(e,t,r){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=o.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=o.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",e=>{}),this.stream.once("close",()=>{var e;f("Request to method "+(null==(e=this.handler)?void 0:e.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:o.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in r&&(this.maxSendMessageSize=r["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in r&&(this.maxReceiveMessageSize=r["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let r=e.subarray(5);if("identity"===t)return r;if("deflate"!==t&&"gzip"!==t)return Promise.reject({code:o.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`});{let e;return e="deflate"===t?a.createInflate():a.createGunzip(),new Promise((t,n)=>{let i=0,s=[];e.on("data",t=>{s.push(t),i+=t.byteLength,-1!==this.maxReceiveMessageSize&&i>this.maxReceiveMessageSize&&(e.destroy(),n({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),e.on("end",()=>{t(Buffer.concat(s))}),e.write(r),e.end()})}}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,r=Object.assign(Object.assign(Object.assign({},S),b),t);this.stream.respond(r,w)}receiveMetadata(e){let t=l.Metadata.fromHttp2Headers(e);u.isTracerEnabled(h)&&f("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let r=t.get(g);if(r.length>0){let e=r[0].toString().match(y);if(null===e){let e=Error("Invalid deadline");return e.code=o.Status.OUT_OF_RANGE,this.sendError(e),t}let n=e[1]*v[e[2]]|0,i=new Date;this.deadline=i.setMilliseconds(i.getMilliseconds()+n),this.deadlineTimer=setTimeout(x,n,this),t.remove(g)}return t.remove(i.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(i.constants.HTTP2_HEADER_TE),t.remove(i.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,r)=>{let{stream:n}=this,i=0,s=this,a=[],l=this.maxReceiveMessageSize;function c(e){if(i+=e.byteLength,-1!==l&&i>l){n.removeListener("data",c),n.removeListener("end",u),n.removeListener("error",u),r({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${i} vs. ${l})`});return}a.push(e)}function u(l){if(n.removeListener("data",c),n.removeListener("end",u),n.removeListener("error",u),void 0!==l)return void r({code:o.Status.INTERNAL,details:l.message});if(0===i)return void r({code:o.Status.INTERNAL,details:"received empty unary message"});s.emit("receiveMessage");let d=Buffer.concat(a,i),h=1===d.readUInt8(0)?e:"identity",f=s.getDecompressedMessage(d,h);if(Buffer.isBuffer(f))return void t(s.deserializeMessageWithInternalError(f));f.then(e=>t(s.deserializeMessageWithInternalError(e)),t=>r(t.code?t:{code:o.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}this.stream.on("data",c),this.stream.on("end",u),this.stream.on("error",u)})}async deserializeMessageWithInternalError(e){try{return this.deserializeMessage(e)}catch(e){throw{details:(0,d.getErrorMessage)(e),code:o.Status.INTERNAL}}}serializeMessage(e){let t=this.handler.serialize(e),r=t.byteLength,n=Buffer.allocUnsafe(r+5);return n.writeUInt8(0,0),n.writeUInt32BE(r,1),t.copy(n,5),n}deserializeMessage(e){return this.handler.deserialize(e)}async sendUnaryMessage(e,t,r,n){if(!this.checkCancelled()){if(void 0===r&&(r=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&r&&(e.metadata=r),this.sendError(e);return}try{let e=this.serializeMessage(t);this.write(e),this.sendStatus({code:o.Status.OK,details:"OK",metadata:r})}catch(e){this.sendError({details:(0,d.getErrorMessage)(e),code:o.Status.INTERNAL})}}}sendStatus(e){var t,r;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===o.Status.OK),!this.checkCancelled())if(f("Request to method "+(null==(t=this.handler)?void 0:t.path)+" ended with status code: "+o.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var t;let r=Object.assign({[m]:e.code,[p]:encodeURI(e.details)},null==(t=e.metadata)?void 0:t.toHttp2Headers());this.stream.sendTrailers(r),this.statusSent=!0}),this.stream.end());else{let t=Object.assign(Object.assign({[m]:e.code,[p]:encodeURI(e.details)},S),null==(r=e.metadata)?void 0:r.toHttp2Headers());this.stream.respond(t,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:o.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&void 0!==e.metadata?e.metadata:null};"code"in e&&"number"==typeof e.code&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&"string"==typeof e.details&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled())return -1!==this.maxSendMessageSize&&e.length>this.maxSendMessageSize?void this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`}):(this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e))}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let r=new c.StreamDecoder(this.maxReceiveMessageSize),n=!1,i=!1,s=!1,a=async()=>{s||!n||i||(s=!0,await this.pushOrBufferMessage(e,null))};this.stream.on("data",async n=>{let s;try{s=r.write(n)}catch(e){this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:e.message});return}for(let r of(i=!0,this.stream.pause(),s)){let n;this.emit("receiveMessage");let i=1===r.readUInt8(0)?t:"identity";try{n=await this.getDecompressedMessage(r,i)}catch(e){this.sendError(e);return}if(!n)return;await this.pushOrBufferMessage(e,n)}i=!1,this.stream.resume(),await a()}),this.stream.once("end",async()=>{n=!0,await a()})}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),r=e.push(t);if(null===t||!1===r){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(e,t){this.isPushPending?this.bufferedMessages.push(t):await this.pushMessage(e,t)}async pushMessage(e,t){if(null===t){f("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}f("Received message of length "+t.length),this.isPushPending=!0;try{let r=await this.deserializeMessage(t);this.canPush?e.push(r)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(r)}catch(r){this.bufferedMessages.length=0;let t=(0,d.getErrorCode)(r);(null===t||t<o.Status.OK||t>o.Status.UNAUTHENTICATED)&&(t=o.Status.INTERNAL),e.emit("error",{details:(0,d.getErrorMessage)(r),code:t})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(e,this.bufferedMessages.shift())}getPeer(){var e;let t=null==(e=this.stream.session)?void 0:e.socket;return null!=t&&t.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function x(e){let t=Error("Deadline exceeded");t.code=o.Status.DEADLINE_EXCEEDED,e.sendError(t),e.cancelled=!0,e.emit("cancelled","deadline")}t.Http2ServerCallStream=I},7587:(e,t,r)=>{"use strict";var n,i;n={value:!0},n=n=t.rS=t.Yi=n=t.Ib=n=n=void 0;let s=r(7099),a=r(8474),o=r(1614),l=r(7603);n=r(6061),n=function(e){return"@type"in e&&"string"==typeof e["@type"]},function(e){e.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",e.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",e.IDEMPOTENT="IDEMPOTENT"}(i=t.Ib||(t.Ib={}));let c={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function u(e,t){return""===e?t:e+"."+t}function d(e){return e instanceof a.Service||e instanceof a.Type||e instanceof a.Enum}function h(e){return e instanceof a.Namespace||e instanceof a.Root}function f(e,t){let r=u(t,e.name);return d(e)?[[r,e]]:h(e)&&void 0!==e.nested?Object.keys(e.nested).map(t=>f(e.nested[t],r)).reduce((e,t)=>e.concat(t),[]):[]}function p(e,t){return function(r){return e.toObject(e.decode(r),t)}}function m(e){return function(t){if(Array.isArray(t))throw Error(`Failed to serialize message: expected object with ${e.name} structure, got array instead`);let r=e.fromObject(t);return e.encode(r).finish()}}function g(e){return(e||[]).reduce((e,t)=>{for(let[r,n]of Object.entries(t))"uninterpreted_option"===r?e.uninterpreted_option.push(t.uninterpreted_option):e[r]=n;return e},{deprecated:!1,idempotency_level:i.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function y(e,t,r,n){let i=e.resolvedRequestType,a=e.resolvedResponseType;return{path:"/"+t+"/"+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestSerialize:m(i),requestDeserialize:p(i,r),responseSerialize:m(a),responseDeserialize:p(a,r),originalName:s(e.name),requestType:b(i,n),responseType:b(a,n),options:g(e.parsedOptions)}}function v(e,t,r,n){let i={};for(let s of e.methodsArray)i[s.name]=y(s,t,r,n);return i}function b(e,t){let r=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:r.$type.toObject(r,c),fileDescriptorProtos:t}}function S(e,t){let r=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:r.$type.toObject(r,c),fileDescriptorProtos:t}}function w(e,t,r,n){if(e instanceof a.Service)return v(e,t,r,n);if(e instanceof a.Type)return b(e,n);if(e instanceof a.Enum)return S(e,n);throw Error("Type mismatch in reflection object handling")}function T(e,t){let r={};e.resolveAll();let n=e.toDescriptor("proto3").file.map(e=>Buffer.from(o.FileDescriptorProto.encode(e).finish()));for(let[i,s]of f(e,""))r[i]=w(s,i,t,n);return r}function E(e,t){t=t||{};let r=a.Root.fromDescriptor(e);return r.resolveAll(),T(r,t)}n=function(e,t){return(0,l.loadProtosWithOptions)(e,t).then(e=>T(e,t))},t.Yi=function(e,t){return T((0,l.loadProtosWithOptionsSync)(e,t),t)},t.rS=function(e,t){t=t||{};let r=a.Root.fromJSON(e);return r.resolveAll(),T(r,t)},n=function(e,t){return E(o.FileDescriptorSet.decode(e),t)},n=function(e,t){return E(o.FileDescriptorSet.fromObject(e),t)},(0,l.addCommonProtos)()},7603:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addCommonProtos=t.loadProtosWithOptionsSync=t.loadProtosWithOptions=void 0;let n=r(9021),i=r(3873),s=r(8474);function a(e,t){let r=e.resolvePath;e.resolvePath=(e,s)=>{if(i.isAbsolute(s))return s;for(let e of t){let t=i.join(e,s);try{return n.accessSync(t,n.constants.R_OK),t}catch(e){continue}}return process.emitWarning(`${s} not found in any of the include paths ${t}`),r(e,s)}}t.loadProtosWithOptions=async function(e,t){let r=new s.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));a(r,t.includeDirs)}let n=await r.load(e,t);return n.resolveAll(),n},t.loadProtosWithOptionsSync=function(e,t){let r=new s.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))throw Error("The includeDirs option must be an array");a(r,t.includeDirs)}let n=r.loadSync(e,t);return n.resolveAll(),n},t.addCommonProtos=function(){let e=r(2566),t=r(40),n=r(6271),i=r(6138);s.common("api",e.nested.google.nested.protobuf.nested),s.common("descriptor",t.nested.google.nested.protobuf.nested),s.common("source_context",n.nested.google.nested.protobuf.nested),s.common("type",i.nested.google.nested.protobuf.nested)}},7659:(e,t,r)=>{"use strict";var n=t,i=r(2110),s=r(3107);function a(e,t,r,n){var s=!1;if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(d%s){",n);for(var a=t.resolvedType.values,o=Object.keys(a),l=0;l<o.length;++l)a[o[l]]!==t.typeDefault||s||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),t.repeated||e("break"),s=!0),e("case%j:",o[l])("case %i:",a[o[l]])("m%s=%j",n,a[o[l]])("break");e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,c)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n)}}return e}function o(e,t,r,n){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,r,n,n,r,n,n):e("d%s=types[%i].toObject(m%s,o)",n,r,n);else{var s=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":s=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,s?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n)}}return e}n.fromObject=function(e){var t=e.fieldsArray,r=s.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var n=0;n<t.length;++n){var o=t[n].resolve(),l=s.safeProp(o.name);o.map?(r("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",o.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),a(r,o,n,l+"[ks[i]]")("}")("}")):o.repeated?(r("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",o.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),a(r,o,n,l+"[i]")("}")("}")):(o.resolvedType instanceof i||r("if(d%s!=null){",l),a(r,o,n,l),o.resolvedType instanceof i||r("}"))}return r("return m")},n.toObject=function(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()("return {}");for(var r=s.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],a=[],l=[],c=0;c<t.length;++c)t[c].partOf||(t[c].resolve().repeated?n:t[c].map?a:l).push(t[c]);if(n.length){for(r("if(o.arrays||o.defaults){"),c=0;c<n.length;++c)r("d%s=[]",s.safeProp(n[c].name));r("}")}if(a.length){for(r("if(o.objects||o.defaults){"),c=0;c<a.length;++c)r("d%s={}",s.safeProp(a[c].name));r("}")}if(l.length){for(r("if(o.defaults){"),c=0;c<l.length;++c){var u=l[c],d=s.safeProp(u.name);if(u.resolvedType instanceof i)r("d%s=o.enums===String?%j:%j",d,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var h="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else r("d%s=%j",d,u.typeDefault)}r("}")}var f=!1;for(c=0;c<t.length;++c){var u=t[c],p=e._fieldsArray.indexOf(u),d=s.safeProp(u.name);u.map?(f||(f=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),o(r,u,p,d+"[ks2[j]]")("}")):u.repeated?(r("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),o(r,u,p,d+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",d,u.name),o(r,u,p,d),u.partOf&&r("if(o.oneofs)")("d%s=%j",s.safeProp(u.partOf.name),u.name)),r("}")}return r("return d")}},7757:(e,t,r)=>{"use strict";e.exports=s;var n=r(5108),i=r(9644)("fs");function s(e,t,r){return("function"==typeof t?(r=t,t={}):t||(t={}),r)?!t.xhr&&i&&i.readFile?i.readFile(e,function(n,i){return n&&"undefined"!=typeof XMLHttpRequest?s.xhr(e,t,r):n?r(n):r(null,t.binary?i:i.toString("utf8"))}):s.xhr(e,t,r):n(s,this,e,t)}s.xhr=function(e,t,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){if(0!==n.status&&200!==n.status)return r(Error("status "+n.status));if(t.binary){var e=n.response;if(!e){e=[];for(var i=0;i<n.responseText.length;++i)e.push(255&n.responseText.charCodeAt(i))}return r(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return r(null,n.responseText)}},t.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}},7775:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;let n=r(4168),i=r(8453),s=r(8155),a=r(1271),o=r(6777),l=r(3712),c=Symbol(),u=Symbol(),d=Symbol(),h=Symbol();function f(e){return"function"==typeof e}function p(e){return e.stack.split("\n").slice(1).join("\n")}class m{constructor(e,t,r={}){var n,s;if(r=Object.assign({},r),this[u]=null!=(n=r.interceptors)?n:[],delete r.interceptors,this[d]=null!=(s=r.interceptor_providers)?s:[],delete r.interceptor_providers,this[u].length>0&&this[d].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[h]=r.callInvocationTransformer,delete r.callInvocationTransformer,r.channelOverride)this[c]=r.channelOverride;else if(r.channelFactoryOverride){let n=r.channelFactoryOverride;delete r.channelFactoryOverride,this[c]=n(e,t,r)}else this[c]=new i.ChannelImplementation(e,t,r)}close(){this[c].close()}getChannel(){return this[c]}waitForReady(e,t){let r=n=>{let i;if(n)return void t(Error("Failed to connect before the deadline"));try{i=this[c].getConnectivityState(!0)}catch(e){t(Error("The channel has been closed"));return}if(i===s.ConnectivityState.READY)t();else try{this[c].watchConnectivityState(i,e,r)}catch(e){t(Error("The channel has been closed"))}};setImmediate(r)}checkOptionalUnaryResponseArguments(e,t,r){if(f(e))return{metadata:new o.Metadata,options:{},callback:e};if(f(t))if(e instanceof o.Metadata)return{metadata:e,options:{},callback:t};else return{metadata:new o.Metadata,options:e,callback:t};if(!(e instanceof o.Metadata&&t instanceof Object&&f(r)))throw Error("Incorrect arguments passed");return{metadata:e,options:t,callback:r}}makeUnaryRequest(e,t,r,i,s,o,f){var m,g;let y=this.checkOptionalUnaryResponseArguments(s,o,f),v={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:r},b={argument:i,metadata:y.metadata,call:new n.ClientUnaryCallImpl,channel:this[c],methodDefinition:v,callOptions:y.options,callback:y.callback};this[h]&&(b=this[h](b));let S=b.call,w={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:null!=(m=b.callOptions.interceptors)?m:[],callInterceptorProviders:null!=(g=b.callOptions.interceptor_providers)?g:[]},T=(0,l.getInterceptingCall)(w,b.methodDefinition,b.callOptions,b.channel);S.call=T;let E=null,C=!1,_=Error();return T.start(b.metadata,{onReceiveMetadata:e=>{S.emit("metadata",e)},onReceiveMessage(e){null!==E&&T.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),E=e},onReceiveStatus(e){if(!C){if(C=!0,e.code===a.Status.OK)if(null===E){let t=p(_);b.callback((0,n.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else b.callback(null,E);else{let t=p(_);b.callback((0,n.callErrorFromStatus)(e,t))}_=null,S.emit("status",e)}}}),T.sendMessage(i),T.halfClose(),S}makeClientStreamRequest(e,t,r,i,s,o){var f,m;let g=this.checkOptionalUnaryResponseArguments(i,s,o),y={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:r},v={metadata:g.metadata,call:new n.ClientWritableStreamImpl(t),channel:this[c],methodDefinition:y,callOptions:g.options,callback:g.callback};this[h]&&(v=this[h](v));let b=v.call,S={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:null!=(f=v.callOptions.interceptors)?f:[],callInterceptorProviders:null!=(m=v.callOptions.interceptor_providers)?m:[]},w=(0,l.getInterceptingCall)(S,v.methodDefinition,v.callOptions,v.channel);b.call=w;let T=null,E=!1,C=Error();return w.start(v.metadata,{onReceiveMetadata:e=>{b.emit("metadata",e)},onReceiveMessage(e){null!==T&&w.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),T=e},onReceiveStatus(e){if(!E){if(E=!0,e.code===a.Status.OK)if(null===T){let t=p(C);v.callback((0,n.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else v.callback(null,T);else{let t=p(C);v.callback((0,n.callErrorFromStatus)(e,t))}C=null,b.emit("status",e)}}}),b}checkMetadataAndOptions(e,t){let r,n;return e instanceof o.Metadata?(r=e,n=t||{}):(n=e||{},r=new o.Metadata),{metadata:r,options:n}}makeServerStreamRequest(e,t,r,i,s,o){var f,m;let g=this.checkMetadataAndOptions(s,o),y={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:r},v={argument:i,metadata:g.metadata,call:new n.ClientReadableStreamImpl(r),channel:this[c],methodDefinition:y,callOptions:g.options};this[h]&&(v=this[h](v));let b=v.call,S={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:null!=(f=v.callOptions.interceptors)?f:[],callInterceptorProviders:null!=(m=v.callOptions.interceptor_providers)?m:[]},w=(0,l.getInterceptingCall)(S,v.methodDefinition,v.callOptions,v.channel);b.call=w;let T=!1,E=Error();return w.start(v.metadata,{onReceiveMetadata(e){b.emit("metadata",e)},onReceiveMessage(e){b.push(e)},onReceiveStatus(e){if(!T){if(T=!0,b.push(null),e.code!==a.Status.OK){let t=p(E);b.emit("error",(0,n.callErrorFromStatus)(e,t))}E=null,b.emit("status",e)}}}),w.sendMessage(i),w.halfClose(),b}makeBidiStreamRequest(e,t,r,i,s){var o,f;let m=this.checkMetadataAndOptions(i,s),g={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:r},y={metadata:m.metadata,call:new n.ClientDuplexStreamImpl(t,r),channel:this[c],methodDefinition:g,callOptions:m.options};this[h]&&(y=this[h](y));let v=y.call,b={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:null!=(o=y.callOptions.interceptors)?o:[],callInterceptorProviders:null!=(f=y.callOptions.interceptor_providers)?f:[]},S=(0,l.getInterceptingCall)(b,y.methodDefinition,y.callOptions,y.channel);v.call=S;let w=!1,T=Error();return S.start(y.metadata,{onReceiveMetadata(e){v.emit("metadata",e)},onReceiveMessage(e){v.push(e)},onReceiveStatus(e){if(!w){if(w=!0,v.push(null),e.code!==a.Status.OK){let t=p(T);v.emit("error",(0,n.callErrorFromStatus)(e,t))}T=null,v.emit("status",e)}}}),v}}t.Client=m},7910:e=>{"use strict";e.exports=require("stream")},7968:(e,t,r)=>{"use strict";e.exports=d;var n,i,s,a=r(4824);((d.prototype=Object.create(a.prototype)).constructor=d).className="Namespace";var o=r(3267),l=r(3107),c=r(2630);function u(e,t){if(e&&e.length){for(var r={},n=0;n<e.length;++n)r[e[n].name]=e[n].toJSON(t);return r}}function d(e,t){a.call(this,e,t),this.nested=void 0,this._nestedArray=null}function h(e){return e._nestedArray=null,e}d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=u,d.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if("string"!=typeof e[r]&&e[r][0]<=t&&e[r][1]>t)return!0}return!1},d.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),d.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},d.prototype.addJSON=function(e){var t=this;if(e)for(var r,a=Object.keys(e),l=0;l<a.length;++l)r=e[a[l]],t.add((void 0!==r.fields?n.fromJSON:void 0!==r.values?s.fromJSON:void 0!==r.methods?i.fromJSON:void 0!==r.id?o.fromJSON:d.fromJSON)(a[l],r));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof s)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof o&&void 0!==e.extend||e instanceof n||e instanceof c||e instanceof s||e instanceof i||e instanceof d))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t)if(t instanceof d&&e instanceof d&&!(t instanceof n||t instanceof i)){for(var r=t.nestedArray,a=0;a<r.length;++a)e.add(r[a]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),h(this)},d.prototype.remove=function(e){if(!(e instanceof a))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),h(this)},d.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var r=this;e.length>0;){var n=e.shift();if(r.nested&&r.nested[n]){if(!((r=r.nested[n])instanceof d))throw Error("path conflicts with non-namespace objects")}else r.add(r=new d(n))}return t&&r.addJSON(t),r},d.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this.resolve()},d.prototype.lookup=function(e,t,r){if("boolean"==typeof t?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(1===e.length){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof d&&(n=n.lookup(e.slice(1),t,!0)))return n}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof d&&(n=this._nestedArray[i].lookup(e,t,!0)))return n;return null===this.parent||r?null:this.parent.lookup(e,t)},d.prototype.lookupType=function(e){var t=this.lookup(e,[n]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[n,s]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(e,t,r){n=e,i=t,s=r}},8034:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getRouteMatcher",{enumerable:!0,get:function(){return i}});let n=r(4827);function i(e){let{re:t,groups:r}=e;return e=>{let i=t.exec(e);if(!i)return!1;let s=e=>{try{return decodeURIComponent(e)}catch(e){throw Object.defineProperty(new n.DecodeError("failed to decode param"),"__NEXT_ERROR_CODE",{value:"E528",enumerable:!1,configurable:!0})}},a={};for(let[e,t]of Object.entries(r)){let r=i[t.pos];void 0!==r&&(t.repeat?a[e]=r.split("/").map(e=>s(e)):a[e]=s(r))}return a}}},8155:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectivityState=void 0,function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.READY=2]="READY",e[e.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",e[e.SHUTDOWN=4]="SHUTDOWN"}(r||(t.ConnectivityState=r={}))},8212:(e,t,r)=>{"use strict";function n(e){return function(){let{cookie:t}=e;if(!t)return{};let{parse:n}=r(6415);return n(Array.isArray(t)?t.join("; "):t)}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getCookieParser",{enumerable:!0,get:function(){return n}})},8295:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalChannel=void 0;let n=r(3689),i=r(1309),s=r(8316),a=r(2910),o=r(1271),l=r(4003),c=r(3516),u=r(5674),d=r(1359),h=r(8620),f=r(6786),p=r(8155),m=r(6827),g=r(9012),y=r(6412),v=r(8546),b=r(1260),S=r(3911),w=r(6683),T=r(4719),E=0x7fffffff,C=1e3,_=18e5,I=new Map,x=0x1000000,R=1048576;class k extends T.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(e,r,n,i)=>{t.throttleKeepalive(i)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class A{constructor(e,t,r){var g,y,v,b,T,A,N,D;if(this.credentials=t,this.options=r,this.connectivityState=p.ConnectivityState.IDLE,this.currentPicker=new a.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new m.ChannelzCallTracker,this.childrenTracker=new m.ChannelzChildrenTracker,"string"!=typeof e)throw TypeError("Channel target must be a string");if(!(t instanceof n.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(r&&"object"!=typeof r)throw TypeError("Channel options must be an object");this.originalTarget=e;let O=(0,f.parseUri)(e);if(null===O)throw Error(`Could not parse target name "${e}"`);let P=(0,u.mapUriDefaultScheme)(O);if(null===P)throw Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},E),null==(y=(g=this.callRefTimer).unref)||y.call(g),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new m.ChannelzTrace,this.channelzRef=(0,m.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,u.getDefaultAuthority)(P);let M=(0,h.mapProxyName)(P,r);this.target=M.target,this.options=Object.assign({},this.options,M.extraOptions),this.subchannelPool=(0,s.getSubchannelPool)((null!=(v=r["grpc.use_local_subchannel_pool"])?v:0)===0),this.retryBufferTracker=new w.MessageBufferTracker(null!=(b=r["grpc.retry_buffer_size"])?b:x,null!=(T=r["grpc.per_rpc_retry_buffer_size"])?T:R),this.keepaliveTime=null!=(A=r["grpc.keepalive_time_ms"])?A:-1,this.idleTimeoutMs=Math.max(null!=(N=r["grpc.client_idle_timeout_ms"])?N:_,C);let L={createSubchannel:(e,t)=>{let r=this.subchannelPool.getOrCreateSubchannel(this.target,e,Object.assign({},this.options,t),this.credentials);r.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",r.getChannelzRef());let n=new k(r,this);return this.wrappedSubchannels.add(n),n},updateState:(e,t)=>{this.currentPicker=t;let r=this.pickQueue.slice();for(let e of(this.pickQueue=[],r.length>0&&this.callRefTimerUnref(),r))e.doPick();this.updateState(e)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.refChild(e)},removeChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.unrefChild(e)}};this.resolvingLoadBalancer=new i.ResolvingLoadBalancer(this.target,L,r,(e,t)=>{e.retryThrottling?I.set(this.getTarget(),new w.RetryThrottler(e.retryThrottling.maxTokens,e.retryThrottling.tokenRatio,I.get(this.getTarget()))):I.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=t,this.currentResolutionError=null,process.nextTick(()=>{let e=this.configSelectionQueue;for(let t of(this.configSelectionQueue=[],e.length>0&&this.callRefTimerUnref(),e))t.getConfig()})},e=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+e.code+' and details "'+e.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,S.restrictControlPlaneStatusCode)(e.code,e.details)),{metadata:e.metadata}));let t=this.configSelectionQueue;for(let r of(this.configSelectionQueue=[],t.length>0&&this.callRefTimerUnref(),t))r.reportResolverError(e)}),this.filterStackFactory=new l.FilterStackFactory([new c.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(r,void 0,2));let F=Error();(0,d.trace)(o.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null==(D=F.stack)?void 0:D.substring(F.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,d.trace)(null!=t?t:o.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,f.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,r,n;(null==(t=(e=this.callRefTimer).hasRef)?void 0:t.call(e))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(n=(r=this.callRefTimer).ref)||n.call(r))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(t=(e=this.callRefTimer).unref)||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(t=>t===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){for(let t of((0,d.trace)(o.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,f.uriToString)(this.target)+" "+p.ConnectivityState[this.connectivityState]+" -> "+p.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+p.ConnectivityState[e]),this.connectivityState=e,this.connectivityStateWatchers.slice()))e!==t.currentState&&(t.timer&&clearTimeout(t.timer),this.removeConnectivityStateWatcher(t),t.callback());e!==p.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime)for(let t of(this.keepaliveTime=e,this.wrappedSubchannels))t.throttleKeepalive(e)}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(p.ConnectivityState.IDLE),this.currentPicker=new a.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,r;this.idleTimer=setTimeout(()=>{if(this.callCount>0)return void this.startIdleTimeout(this.idleTimeoutMs);let e=new Date().valueOf()-this.lastActivityTimestamp.valueOf();e>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-e)},e),null==(r=(t=this.idleTimer).unref)||r.call(t)}maybeStartIdleTimer(){this.connectivityState===p.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===o.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,r,n,i){let s=(0,b.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+s+'] method="'+t+'"'),new g.LoadBalancingCall(this,e,t,r,n,i,s)}createRetryingCall(e,t,r,n,i){let s=(0,b.getNextCallNumber)();return this.trace("createRetryingCall ["+s+'] method="'+t+'"'),new w.RetryingCall(this,e,t,r,n,i,s,this.retryBufferTracker,I.get(this.getTarget()))}createInnerCall(e,t,r,n,i){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(e,t,r,n,i):this.createRetryingCall(e,t,r,n,i)}createResolvingCall(e,t,r,n,i){let s=(0,b.getNextCallNumber)();this.trace("createResolvingCall ["+s+'] method="'+e+'", deadline='+(0,y.deadlineToString)(t));let a={deadline:t,flags:null!=i?i:o.Propagate.DEFAULTS,host:null!=r?r:this.defaultAuthority,parentCall:n},l=new v.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),s);return this.onCallStart(),l.addStatusWatcher(e=>{this.onCallEnd(e)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(p.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,m.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,f.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,r){if(this.connectivityState===p.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let n=null;if(t!==1/0){let e=t instanceof Date?t:new Date(t),s=new Date;if(t===-1/0||e<=s)return void process.nextTick(r,Error("Deadline passed without connectivity state change"));n=setTimeout(()=>{this.removeConnectivityStateWatcher(i),r(Error("Deadline passed without connectivity state change"))},e.getTime()-s.getTime())}let i={currentState:e,callback:r,timer:n};this.connectivityStateWatchers.push(i)}getChannelzRef(){return this.channelzRef}createCall(e,t,r,n,i){if("string"!=typeof e)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===p.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(e,t,r,n,i)}}t.InternalChannel=A},8304:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DEFAULT_METADATA_ROUTE_EXTENSIONS:function(){return o},STATIC_METADATA_IMAGES:function(){return a},getExtensionRegexString:function(){return l},isMetadataPage:function(){return d},isMetadataRoute:function(){return h},isMetadataRouteFile:function(){return c},isStaticMetadataRoute:function(){return u}});let n=r(2958),i=r(4722),s=r(554),a={icon:{filename:"icon",extensions:["ico","jpg","jpeg","png","svg"]},apple:{filename:"apple-icon",extensions:["jpg","jpeg","png"]},favicon:{filename:"favicon",extensions:["ico"]},openGraph:{filename:"opengraph-image",extensions:["jpg","jpeg","png","gif"]},twitter:{filename:"twitter-image",extensions:["jpg","jpeg","png","gif"]}},o=["js","jsx","ts","tsx"],l=(e,t)=>t&&0!==t.length?`(?:\\.(${e.join("|")})|(\\.(${t.join("|")})))`:`(\\.(?:${e.join("|")}))`;function c(e,t,r){let i=(r?"":"?")+"$",s="\\d?",o=r?"":"(-\\w{6})?",c=`${s}${o}`,u=[RegExp(`^[\\\\/]robots${l(t.concat("txt"),null)}${i}`),RegExp(`^[\\\\/]manifest${l(t.concat("webmanifest","json"),null)}${i}`),RegExp("^[\\\\/]favicon\\.ico$"),RegExp(`[\\\\/]sitemap${l(["xml"],t)}${i}`),RegExp(`[\\\\/]${a.icon.filename}${c}${l(a.icon.extensions,t)}${i}`),RegExp(`[\\\\/]${a.apple.filename}${c}${l(a.apple.extensions,t)}${i}`),RegExp(`[\\\\/]${a.openGraph.filename}${c}${l(a.openGraph.extensions,t)}${i}`),RegExp(`[\\\\/]${a.twitter.filename}${c}${l(a.twitter.extensions,t)}${i}`)],d=(0,n.normalizePathSep)(e);return u.some(e=>e.test(d))}function u(e){let t=e.replace(/\/route$/,"");return(0,s.isAppRouteRoute)(e)&&c(t,[],!0)&&"/robots.txt"!==t&&"/manifest.webmanifest"!==t&&!t.endsWith("/sitemap.xml")}function d(e){return!(0,s.isAppRouteRoute)(e)&&c(e,[],!1)}function h(e){let t=(0,i.normalizeAppPath)(e).replace(/^\/?app\//,"").replace("/[__metadata_id__]","").replace(/\/route$/,"");return"/"!==t[0]&&(t="/"+t),(0,s.isAppRouteRoute)(e)&&c(t,[],!1)}},8316:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSubchannelPool=t.SubchannelPool=void 0;let n=r(7354),i=r(4353),s=r(3356),a=r(6786),o=r(603),l=1e4;class c{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let r=this.pool[t].filter(e=>!e.subchannel.unrefIfOneRef());r.length>0&&(e=!1),this.pool[t]=r}e&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},l),null==(t=(e=this.cleanupTimer).unref)||t.call(e))}getOrCreateSubchannel(e,t,r,l){this.ensureCleanupTask();let c=(0,a.uriToString)(e);if(c in this.pool){for(let e of this.pool[c])if((0,s.subchannelAddressEqual)(t,e.subchannelAddress)&&(0,n.channelOptionsEqual)(r,e.channelArguments)&&l._equals(e.channelCredentials))return e.subchannel}let u=new i.Subchannel(e,t,r,l,new o.Http2SubchannelConnector(e));return c in this.pool||(this.pool[c]=[]),this.pool[c].push({subchannelAddress:t,channelArguments:r,channelCredentials:l,subchannel:u}),u.ref(),u}}t.SubchannelPool=c;let u=new c;t.getSubchannelPool=function(e){return e?u:new c}},8344:e=>{"use strict";function t(e,r){"string"==typeof e&&(r=e,e=void 0);var n=[];function i(e){if("string"!=typeof e){var r=s();if(t.verbose&&console.log("codegen: "+r),r="return "+r,e){for(var a=Object.keys(e),o=Array(a.length+1),l=Array(a.length),c=0;c<a.length;)o[c]=a[c],l[c]=e[a[c++]];return o[c]=r,Function.apply(null,o).apply(null,l)}return Function(r)()}for(var u=Array(arguments.length-1),d=0;d<u.length;)u[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,function(e,t){var r=u[d++];switch(t){case"d":case"f":return String(Number(r));case"i":return String(Math.floor(r));case"j":return JSON.stringify(r);case"s":return String(r)}return"%"}),d!==u.length)throw Error("parameter count mismatch");return n.push(e),i}function s(t){return"function "+(t||r||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return i.toString=s,i}e.exports=t,t.verbose=!1},8354:e=>{"use strict";e.exports=require("util")},8429:(e,t,r)=>{Promise.resolve().then(r.bind(r,4947))},8453:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelImplementation=void 0;let n=r(3689),i=r(8295);class s{constructor(e,t,r){if("string"!=typeof e)throw TypeError("Channel target must be a string");if(!(t instanceof n.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(r&&"object"!=typeof r)throw TypeError("Channel options must be an object");this.internalChannel=new i.InternalChannel(e,t,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,r){this.internalChannel.watchConnectivityState(e,t,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,r,n,i){if("string"!=typeof e)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,r,n,i)}}t.ChannelImplementation=s},8474:(e,t,r)=>{"use strict";e.exports=r(6771)},8546:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvingCall=void 0;let n=r(1271),i=r(6412),s=r(6777),a=r(1359),o=r(3911),l="resolving_call";class c{constructor(e,t,r,s,a,o){this.channel=e,this.method=t,this.filterStackFactory=s,this.credentials=a,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=r.deadline,this.host=r.host,r.parentCall&&(r.flags&n.Propagate.CANCELLATION&&r.parentCall.on("cancelled",()=>{this.cancelWithStatus(n.Status.CANCELLED,"Cancelled by parent call")}),r.flags&n.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline()),this.deadline=(0,i.minDeadline)(this.deadline,r.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){a.trace(n.LogVerbosity.DEBUG,l,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,i.deadlineToString)(this.deadline));let e=(0,i.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(n.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(e=>e(t)),process.nextTick(()=>{var e;null==(e=this.listener)||e.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw Error("sendMessageonChild called with child not populated");let r=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(t=>{this.writeFilterPending=!1,r.sendMessageWithContext(e,t.message),this.pendingHalfClose&&r.halfClose()},e=>{this.cancelWithStatus(e.code,e.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if("NONE"===e.type)return void this.channel.queueCallForConfig(this);if("ERROR"===e.type)return void(this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error));let t=e.config;if(t.status!==n.Status.OK){let{code:e,details:r}=(0,o.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:e,details:r,metadata:new s.Metadata});return}if(t.methodConfig.timeout){let e=new Date;e.setSeconds(e.getSeconds()+t.methodConfig.timeout.seconds),e.setMilliseconds(e.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,i.minDeadline)(this.deadline,e),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(e=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(e,{onReceiveMetadata:e=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(e))},onReceiveMessage:e=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(e).then(e=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(e),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},e=>{this.cancelWithStatus(e.code,e.details)})},onReceiveStatus:e=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=e:this.outputStatus(e)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},e=>{this.outputStatus(e)})}reportResolverError(e){var t;(null==(t=this.metadata)?void 0:t.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null==(r=this.child)||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new s.Metadata})}getPeer(){var e,t;return null!=(t=null==(e=this.child)?void 0:e.getPeer())?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}}t.ResolvingCall=c},8592:e=>{"use strict";e.exports={rE:"1.9.15"}},8620:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProxiedConnection=t.mapProxyName=void 0;let n=r(1359),i=r(1271),s=r(5674),a=r(1630),o=r(4631),l=r(1359),c=r(3356),u=r(6786),d=r(9551),h=r(4660),f="proxy";function p(e){l.trace(i.LogVerbosity.DEBUG,f,e)}function m(){let e,t="",r="";if(process.env.grpc_proxy)r="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)r="https_proxy",t=process.env.https_proxy;else{if(!process.env.http_proxy)return{};r="http_proxy",t=process.env.http_proxy}try{e=new d.URL(t)}catch(e){return(0,n.log)(i.LogVerbosity.ERROR,`cannot parse value of "${r}" env var`),{}}if("http:"!==e.protocol)return(0,n.log)(i.LogVerbosity.ERROR,`"${e.protocol}" scheme not supported in proxy URI`),{};let s=null;e.username&&(e.password?((0,n.log)(i.LogVerbosity.INFO,"userinfo found in proxy URI"),s=`${e.username}:${e.password}`):s=e.username);let a=e.hostname,o=e.port;""===o&&(o="80");let l={address:`${a}:${o}`};return s&&(l.creds=s),p("Proxy server "+l.address+" set by environment variable "+r),l}function g(){let e=process.env.no_grpc_proxy,t="no_grpc_proxy";return(e||(e=process.env.no_proxy,t="no_proxy"),e)?(p("No proxy server list set by environment variable "+t),e.split(",")):[]}t.mapProxyName=function(e,t){var r;let n={target:e,extraOptions:{}};if((null!=(r=t["grpc.enable_http_proxy"])?r:1)===0||"unix"===e.scheme)return n;let i=m();if(!i.address)return n;let s=(0,u.splitHostPort)(e.path);if(!s)return n;let a=s.host;for(let t of g())if(t===a)return p("Not using proxy for target in no_proxy list: "+(0,u.uriToString)(e)),n;let o={"grpc.http_connect_target":(0,u.uriToString)(e)};return i.creds&&(o["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:o}},t.getProxiedConnection=function(e,t,r){var l;if(!("grpc.http_connect_target"in t))return Promise.resolve({});let d=t["grpc.http_connect_target"],f=(0,u.parseUri)(d);if(null===f)return Promise.resolve({});let m=(0,u.splitHostPort)(f.path);if(null===m)return Promise.resolve({});let g=`${m.host}:${null!=(l=m.port)?l:h.DEFAULT_PORT}`,y={method:"CONNECT",path:g},v={Host:g};(0,c.isTcpSubchannelAddress)(e)?(y.host=e.host,y.port=e.port):y.socketPath=e.path,"grpc.http_connect_creds"in t&&(v["Proxy-Authorization"]="Basic "+Buffer.from(t["grpc.http_connect_creds"]).toString("base64")),y.headers=v;let b=(0,c.subchannelAddressToString)(e);return p("Using proxy "+b+" to connect to "+y.path),new Promise((e,t)=>{let l=a.request(y);l.once("connect",(a,c,d)=>{var h;if(l.removeAllListeners(),c.removeAllListeners(),200===a.statusCode)if(p("Successfully connected to "+y.path+" through proxy "+b),"secureContext"in r){let n=(0,s.getDefaultAuthority)(f),i=(0,u.splitHostPort)(n),a=null!=(h=null==i?void 0:i.host)?h:n,l=o.connect(Object.assign({host:a,servername:a,socket:c},r),()=>{p("Successfully established a TLS connection to "+y.path+" through proxy "+b),e({socket:l,realTarget:f})});l.on("error",e=>{p("Failed to establish a TLS connection to "+y.path+" through proxy "+b+" with error "+e.message),t()})}else p("Successfully established a plaintext connection to "+y.path+" through proxy "+b),e({socket:c,realTarget:f});else(0,n.log)(i.LogVerbosity.ERROR,"Failed to connect to "+y.path+" through proxy "+b+" with status "+a.statusCode),t()}),l.once("error",e=>{l.removeAllListeners(),(0,n.log)(i.LogVerbosity.ERROR,"Failed to connect to proxy "+b+" with error "+e.message),t()}),l.end()})}},8655:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CompressionAlgorithms=void 0,function(e){e[e.identity=0]="identity",e[e.deflate=1]="deflate",e[e.gzip=2]="gzip"}(r||(t.CompressionAlgorithms=r={}))},8707:function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function s(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:Error().stack||""}),r&&i(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=r(5108),n.base64=r(2727),n.EventEmitter=r(4553),n.float=r(3127),n.inquire=r(9644),n.utf8=r(1996),n.pool=r(3273),n.LongBits=r(1156),n.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),n.global=n.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!!(null!=r&&e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(!!t)},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=s,n.ProtocolError=s("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;if(!e){n._Buffer_from=n._Buffer_allocUnsafe=null;return}n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}}},8920:(e,t,r)=>{"use strict";e.exports=i;var n=r(8707);function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,n.toJSONOptions)}},9012:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadBalancingCall=void 0;let n=r(8155),i=r(1271),s=r(6412),a=r(6777),o=r(2910),l=r(6786),c=r(1359),u=r(3911),d=r(3496),h="load_balancing_call";class f{constructor(e,t,r,n,i,s,a){var o,c;this.channel=e,this.callConfig=t,this.methodName=r,this.host=n,this.credentials=i,this.deadline=s,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let u=this.methodName.split("/"),d="";u.length>=2&&(d=u[1]);let h=null!=(c=null==(o=(0,l.splitHostPort)(this.host))?void 0:o.host)?c:"localhost";this.serviceUrl=`https://${h}/${d}`}trace(e){c.trace(i.LogVerbosity.DEBUG,h,"["+this.callNumber+"] "+e)}outputStatus(e,t){var r,n;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let i=Object.assign(Object.assign({},e),{progress:t});null==(r=this.listener)||r.onReceiveStatus(i),null==(n=this.onCallEnded)||n.call(this,i.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let r=this.channel.doPick(this.metadata,this.callConfig.pickInformation),l=r.subchannel?"("+r.subchannel.getChannelzRef().id+") "+r.subchannel.getAddress():""+r.subchannel;switch(this.trace("Pick result: "+o.PickResultType[r.pickResultType]+" subchannel: "+l+" status: "+(null==(e=r.status)?void 0:e.code)+" "+(null==(t=r.status)?void 0:t.details)),r.pickResultType){case o.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(e=>{var t,o,c;if(this.ended)return void this.trace("Credentials metadata generation finished after call ended");let u=this.metadata.clone();if(u.merge(e),u.get("authorization").length>1&&this.outputStatus({code:i.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new a.Metadata},"PROCESSED"),r.subchannel.getConnectivityState()!==n.ConnectivityState.READY){this.trace("Picked subchannel "+l+" has state "+n.ConnectivityState[r.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&u.set("grpc-timeout",(0,s.getDeadlineTimeoutString)(this.deadline));try{this.child=r.subchannel.getRealSubchannel().createCall(u,this.host,this.methodName,{onReceiveMetadata:e=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(e)},onReceiveMessage:e=>{this.trace("Received message"),this.listener.onReceiveMessage(e)},onReceiveStatus:e=>{this.trace("Received status"),e.rstCode===d.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(e,"REFUSED"):this.outputStatus(e,"PROCESSED")}})}catch(e){this.trace("Failed to start call on picked subchannel "+l+" with error "+e.message),this.outputStatus({code:i.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+e.message,metadata:new a.Metadata},"NOT_STARTED");return}null==(o=(t=this.callConfig).onCommitted)||o.call(t),null==(c=r.onCallStarted)||c.call(r),this.onCallEnded=r.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},e=>{let{code:t,details:r}=(0,u.restrictControlPlaneStatusCode)("number"==typeof e.code?e.code:i.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${e.message}`);this.outputStatus({code:t,details:r,metadata:new a.Metadata},"PROCESSED")});break;case o.PickResultType.DROP:let{code:c,details:h}=(0,u.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:c,details:h,metadata:r.status.metadata},"DROP")});break;case o.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:e,details:t}=(0,u.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:e,details:t,metadata:r.status.metadata},"PROCESSED")})}break;case o.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null==(r=this.child)||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new a.Metadata},"PROCESSED")}getPeer(){var e,t;return null!=(t=null==(e=this.child)?void 0:e.getPeer())?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}t.LoadBalancingCall=f},9021:e=>{"use strict";e.exports=require("fs")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9227:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultRootsData=t.CIPHER_SUITES=void 0;let n=r(9021);t.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let i=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,s=null;t.getDefaultRootsData=function(){return i?(null===s&&(s=n.readFileSync(i)),s):null}},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9374:(e,t,r)=>{"use strict";var n=e.exports=r(5477);function i(e,t,r){return"function"==typeof t?(r=t,t=new n.Root):t||(t=new n.Root),t.load(e,r)}function s(e,t){return t||(t=new n.Root),t.loadSync(e)}n.build="light",n.load=i,n.loadSync=s,n.encoder=r(847),n.decoder=r(2823),n.verifier=r(6973),n.converter=r(7659),n.ReflectionObject=r(4824),n.Namespace=r(7968),n.Root=r(2703),n.Enum=r(2110),n.Type=r(4351),n.Field=r(3267),n.OneOf=r(2630),n.MapField=r(5585),n.Service=r(3076),n.Method=r(1202),n.Message=r(8920),n.wrappers=r(3695),n.types=r(1810),n.util=r(3107),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service,n.Enum),n.Root._configure(n.Type),n.Field._configure(n.Type)},9420:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerCredentials=void 0;let n=r(9227);class i{static createInsecure(){return new s}static createSsl(e,t,r=!1){if(null!==e&&!Buffer.isBuffer(e))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof r)throw TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let e=0;e<t.length;e++){let r=t[e];if(null===r||"object"!=typeof r)throw TypeError(`keyCertPair[${e}] must be an object`);if(!Buffer.isBuffer(r.private_key))throw TypeError(`keyCertPair[${e}].private_key must be a Buffer`);if(!Buffer.isBuffer(r.cert_chain))throw TypeError(`keyCertPair[${e}].cert_chain must be a Buffer`);i.push(r.cert_chain),s.push(r.private_key)}return new a({ca:e||(0,n.getDefaultRootsData)()||void 0,cert:i,key:s,requestCert:r,ciphers:n.CIPHER_SUITES})}}t.ServerCredentials=i;class s extends i{_isSecure(){return!1}_getSettings(){return null}}class a extends i{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}},9551:e=>{"use strict";e.exports=require("url")},9644:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},9737:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>n});let n=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call Toaster() from the server but Toaster is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/powellquiring/github.com/powellquiring/accountviewer/src/components/ui/toaster.tsx","Toaster")},9771:e=>{"use strict";e.exports=require("process")},9772:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallCredentials=void 0;let n=r(6777);function i(e){return"getRequestHeaders"in e&&"function"==typeof e.getRequestHeaders}class s{static createFromMetadataGenerator(e){return new o(e)}static createFromGoogleCredential(e){return s.createFromMetadataGenerator((t,r)=>{let s;(s=i(e)?e.getRequestHeaders(t.service_url):new Promise((r,n)=>{e.getRequestMetadata(t.service_url,(e,t)=>e?void n(e):t?void r(t):void n(Error("Headers not set by metadata plugin")))})).then(e=>{let t=new n.Metadata;for(let r of Object.keys(e))t.add(r,e[r]);r(null,t)},e=>{r(e)})})}static createEmpty(){return new l}}t.CallCredentials=s;class a extends s{constructor(e){super(),this.creds=e}async generateMetadata(e){let t=new n.Metadata;for(let r of(await Promise.all(this.creds.map(t=>t.generateMetadata(e)))))t.merge(r);return t}compose(e){return new a(this.creds.concat([e]))}_equals(e){return this===e||e instanceof a&&this.creds.every((t,r)=>t._equals(e.creds[r]))}}class o extends s{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,r)=>{this.metadataGenerator(e,(e,n)=>{void 0!==n?t(n):r(e)})})}compose(e){return new a([this,e])}_equals(e){return this===e||e instanceof o&&this.metadataGenerator===e.metadataGenerator}}class l extends s{generateMetadata(e){return Promise.resolve(new n.Metadata)}compose(e){return e}_equals(e){return e instanceof l}}},9867:(e,t,r)=>{"use strict";r.d(t,{dj:()=>m});var n=r(3210);let i=1,s=1e6,a=0;function o(){return(a=(a+1)%Number.MAX_SAFE_INTEGER).toString()}let l=new Map,c=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),f({type:"REMOVE_TOAST",toastId:e})},s);l.set(e,t)},u=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,i)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?c(r):e.toasts.forEach(e=>{c(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],h={toasts:[]};function f(e){h=u(h,e),d.forEach(e=>{e(h)})}function p({...e}){let t=o(),r=e=>f({type:"UPDATE_TOAST",toast:{...e,id:t}}),n=()=>f({type:"DISMISS_TOAST",toastId:t});return f({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||n()}}}),{id:t,dismiss:n,update:r}}function m(){let[e,t]=n.useState(h);return n.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:p,dismiss:e=>f({type:"DISMISS_TOAST",toastId:e})}}}};var __webpack_require__=require("../webpack-runtime.js");__webpack_require__.C(exports);var __webpack_exec__=e=>__webpack_require__(__webpack_require__.s=e),__webpack_exports__=__webpack_require__.X(0,[447,893],()=>__webpack_exec__(1171));module.exports=__webpack_exports__})();