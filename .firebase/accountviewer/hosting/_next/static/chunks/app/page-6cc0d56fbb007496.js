(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3974:(e,t,s)=>{Promise.resolve().then(s.bind(s,5953))},5953:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eo});var a=s(5155),r=s(2115),i=s(9434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});o.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})}).displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter";var d=s(4439);let u=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(d.bL,{ref:t,className:(0,i.cn)("relative overflow-hidden",s),...n,children:[(0,a.jsx)(d.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(m,{}),(0,a.jsx)(d.OK,{})]})});u.displayName=d.bL.displayName;let m=r.forwardRef((e,t)=>{let{className:s,orientation:r="vertical",...n}=e;return(0,a.jsx)(d.VM,{ref:t,orientation:r,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...n,children:(0,a.jsx)(d.lr,{className:"relative flex-1 rounded-full bg-border"})})});m.displayName=d.VM.displayName;let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",s),...r})})});x.displayName="Table";let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",s),...r})});f.displayName="TableHeader";let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",s),...r})});p.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});h.displayName="TableRow";let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});g.displayName="TableHead";let b=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});function y(e){let{account:t,className:s,style:d,marketPrices:m={}}=e,[y,N]=(0,r.useState)(null),[v,j]=(0,r.useState)("asc"),w=e=>{y===e?j("asc"===v?"desc":"asc"):(N(e),j("asc"))};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(n,{className:(0,i.cn)("shadow-lg hover:shadow-xl transition-shadow duration-300 flex flex-col",s),style:d,children:[(0,a.jsx)(l,{className:"px-2 py-1",children:(0,a.jsx)("div",{className:"flex items-center justify-start",children:(0,a.jsx)(o,{className:"text-sm font-semibold",children:t.name})})}),t.securities&&t.securities.length>0&&(0,a.jsx)(c,{className:"pt-1 pb-2 px-0 flex-grow",children:(0,a.jsx)(u,{className:"rounded-md border w-full overflow-x-auto",children:(0,a.jsxs)(x,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(h,{className:"[&>th]:text-[10px] [&>th]:font-semibold",children:[(0,a.jsxs)(g,{className:"h-8 px-2 cursor-pointer w-1/12",onClick:()=>w("symbol"),children:["Sym ","symbol"===y&&("asc"===v?"▲":"▼")]}),(0,a.jsx)(g,{className:"h-8 px-2 hidden md:table-cell",children:"Description"}),(0,a.jsxs)(g,{className:"h-8 px-2 text-right cursor-pointer hidden md:table-cell",onClick:()=>w("quantity"),children:["Qty ","quantity"===y&&("asc"===v?"▲":"▼")]}),(0,a.jsxs)(g,{className:"h-8 px-2 text-right cursor-pointer hidden lg:table-cell w-[80px]",onClick:()=>w("unitcost"),children:["Unit Cost ","unitcost"===y&&("asc"===v?"▲":"▼")]}),(0,a.jsxs)(g,{className:"h-8 px-2 text-right cursor-pointer w-[100px]",onClick:()=>w("totalCost"),children:["Total Cost ","totalCost"===y&&("asc"===v?"▲":"▼")]}),(0,a.jsxs)(g,{className:"h-8 px-2 text-right cursor-pointer w-[80px]",onClick:()=>w("price"),children:["Price ","price"===y&&("asc"===v?"▲":"▼")]}),(0,a.jsxs)(g,{className:"h-8 px-2 text-right cursor-pointer w-[100px]",onClick:()=>w("value"),children:["Value ","value"===y&&("asc"===v?"▲":"▼")]}),(0,a.jsxs)(g,{className:"h-8 px-2 text-right cursor-pointer w-[100px]",onClick:()=>w("return"),children:["Return ","return"===y&&("asc"===v?"▲":"▼")]})]})}),(0,a.jsx)(p,{children:(0,r.useMemo)(()=>{let e=[...t.securities||[]].sort((e,t)=>{let s="number"==typeof e.unitcost?e.unitcost:0,a="number"==typeof t.unitcost?t.unitcost:0,r="number"==typeof e.quantity?e.quantity:0,i="number"==typeof t.quantity?t.quantity:0,n=m[e.symbol||""]||0,l=m[t.symbol||""]||0,o=r*n,c=i*l,d=r*s,u=i*a,x=o-d,f=c-u;if("value"===y)return"asc"===v?o-c:c-o;if("symbol"===y){let s=e.symbol||"",a=t.symbol||"";return"asc"===v?s.localeCompare(a):a.localeCompare(s)}if("price"===y)return"asc"===v?n-l:l-n;if("totalCost"===y)return"asc"===v?d-u:u-d;if("return"===y)return"asc"===v?x-f:f-x;if(y&&"description"!==y&&y in e&&y in t){let s="number"==typeof e[y]?e[y]:"asc"===v?1/0:-1/0,a="number"==typeof t[y]?t[y]:"asc"===v?1/0:-1/0;return s===a?0:"asc"===v?s<a?-1:1:a<s?-1:1}return 0});return e.map((e,t)=>{let s="number"==typeof e.unitcost?e.unitcost:0,r="number"==typeof e.quantity?e.quantity:0,i=e.symbol||"N/A",n=e.description||"No description",l=m[i]||0,o=r*l,c=r*s,d=o-c;return(0,a.jsxs)(h,{className:"[&>td]:px-2 [&>td]:py-1 [&>td]:text-xs",children:[(0,a.jsx)(b,{className:"font-medium",children:i}),(0,a.jsx)(b,{className:"hidden md:table-cell",children:n}),(0,a.jsx)(b,{className:"text-right tabular-nums hidden md:table-cell",children:r.toFixed(2)}),(0,a.jsx)(b,{className:"text-right tabular-nums hidden lg:table-cell w-[80px]",children:s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[100px]",children:c.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[80px]",children:l.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[100px]",children:o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[100px]",children:d.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]},t)}).concat((0,a.jsxs)(h,{className:"[&>td]:px-2 [&>td]:py-1 [&>td]:text-xs font-bold",children:[(0,a.jsx)(b,{className:"font-medium",children:"Total"}),(0,a.jsx)(b,{className:"hidden md:table-cell"}),(0,a.jsx)(b,{className:"text-right tabular-nums hidden md:table-cell"}),(0,a.jsx)(b,{className:"text-right tabular-nums hidden lg:table-cell w-[80px]"}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[100px]",children:e.reduce((e,t)=>e+("number"==typeof t.quantity?t.quantity:0)*("number"==typeof t.unitcost?t.unitcost:0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[80px]"}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[100px]",children:e.reduce((e,t)=>e+("number"==typeof t.quantity?t.quantity:0)*(m[t.symbol||""]||0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,a.jsx)(b,{className:"text-right tabular-nums w-[100px]",children:e.reduce((e,t)=>{let s="number"==typeof t.quantity?t.quantity:0,a="number"==typeof t.unitcost?t.unitcost:0;return e+s*(m[t.symbol||""]||0)-s*a},0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]},"total"))},[t.securities,m,y,v])})]})})}),(!t.securities||0===t.securities.length)&&(0,a.jsx)(c,{className:"pt-1 pb-2 text-center",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"No securities for this account."})})]})})}b.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption";var N=s(172);function v(e){let{size:t=48,className:s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex justify-center items-center",s),children:(0,a.jsx)(N.A,{className:"animate-spin text-primary",style:{width:t,height:t}})})}var j=s(1133),w=s(2085);let k=(0,w.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),S=r.forwardRef((e,t)=>{let{className:s,variant:r,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(k({variant:r}),s),...n})});S.displayName="Alert";let C=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})});C.displayName="AlertTitle";let D=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...r})});function F(e){let{title:t="An Error Occurred",message:s}=e;return(0,a.jsxs)(S,{variant:"destructive",className:"max-w-md mx-auto",children:[(0,a.jsx)(j.A,{className:"h-4 w-4"}),(0,a.jsx)(C,{children:t}),(0,a.jsx)(D,{children:s})]})}D.displayName="AlertDescription";var A=s(9708);let T=(0,w.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:l=!1,...o}=e,c=l?A.DX:"button";return(0,a.jsx)(c,{className:(0,i.cn)(T({variant:r,size:n,className:s})),ref:t,...o})});E.displayName="Button";var R=s(5317),O=s(3915),I=s(3004);let U=(0,w.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function q(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)(U({variant:s}),t),...r})}let _=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});_.displayName="Input";var L=s(968);let M=(0,w.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),z=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(L.b,{ref:t,className:(0,i.cn)(M(),s),...r})});z.displayName=L.b.displayName;var P=s(4645),V=s(5318);let J=P.bL,H=P.l9,B=P.ZL;P.bm;let W=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(P.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});W.displayName=P.hJ.displayName;let Y=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(B,{children:[(0,a.jsx)(W,{}),(0,a.jsxs)(P.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n,children:[r,(0,a.jsxs)(P.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(V.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});Y.displayName=P.UC.displayName;let G=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};G.displayName="DialogHeader";let K=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(P.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});K.displayName=P.hE.displayName;let Q=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(P.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});Q.displayName=P.VY.displayName;let X=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});X.displayName="Textarea";var Z=s(7481),$=s(1427),ee=s(1764);let et=ee.Kq,es=ee.bL,ea=ee.l9,er=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...n}=e;return(0,a.jsx)(ee.UC,{ref:t,sideOffset:r,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})});er.displayName=ee.UC.displayName;let ei={apiKey:"AIzaSyAglV5rgoSjtpf0W5EY5qeVWO_T1-Z_FI0",authDomain:"accountviewer.firebaseapp.com",projectId:"accountviewer",storageBucket:"accountviewer.firebasestorage.app",messagingSenderId:"693621188843",appId:"1:693621188843:web:9d332a2bb0973d98bcb6ae"},en={functions:5001},el="accountviewer_market_prices";function eo(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[n,l]=(0,r.useState)(!0),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)("firestore"),[m,x]=(0,r.useState)(null),[f,p]=(0,r.useState)(!0),[h,g]=(0,r.useState)(""),[b,N]=(0,r.useState)(""),[j,w]=(0,r.useState)(null),[k,S]=(0,r.useState)(!1),[C,D]=(0,r.useState)(!1),[A,T]=(0,r.useState)(!1),[U,L]=(0,r.useState)(""),[M,P]=(0,r.useState)(null),[V,B]=(0,r.useState)({}),[W,ee]=(0,r.useState)(!1),[eo,ec]=(0,r.useState)(null),[ed,eu]=(0,r.useState)(!1),[em,ex]=(0,r.useState)(!1),{toast:ef}=(0,Z.dj)();(0,r.useEffect)(()=>{D(!0)},[]),(0,r.useEffect)(()=>{try{let e=0===(0,O.Dk)().length?(0,O.Wp)(ei):(0,O.Dk)()[0],t=(0,I.xI)(e),s=(0,I.hg)(t,e=>{x(e),p(!1)});return()=>s()}catch(e){console.error("Firebase auth initialization error:",e),p(!1)}},[]),(0,r.useEffect)(()=>{eu("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)},[]);let ep=(0,r.useCallback)(async()=>{l(!0),c(null),i([]),t([]);try{if("mock"===d)t([{id:"mock-page-1",name:"Mock Brokerage Account",securities:[{description:"Alphabet Inc.",quantity:15,symbol:"GOOGL",unitcost:2500,stock:!0},{description:"Amazon.com Inc.",quantity:3,symbol:"AMZN",unitcost:3200.75,stock:!0}]},{id:"mock-page-2",name:"Mock Savings Account"},{id:"mock-page-3",name:"Mock Investment Portfolio",securities:[{description:"Netflix Inc.",quantity:7,symbol:"NFLX",unitcost:550.2,stock:!0}]},{id:"mock-page-4",name:"Mock College Fund"}]);else{if(!m){t([]),c("Please sign in to view your accounts");return}let e=0===(0,O.Dk)().length?(0,O.Wp)(ei):(0,O.Dk)()[0],s=(0,R.aU)(e),a=(0,R.H9)(s,"users",m.uid),r=await (0,R.x7)(a);if(!r.exists())return void t([]);let i=r.data(),n=[];i.accounts&&Array.isArray(i.accounts)&&i.accounts.forEach(e=>{n.push({id:e.id||"".concat(m.uid,"-").concat(n.length),name:e.name||"N/A",securities:(e.securities||[]).map(e=>({...e,unitcost:e.unitcost||0,quantity:e.quantity||0}))})}),t(n)}}catch(e){console.error("Failed to fetch accounts:",e),c(e.message||"Could not load accounts. Please try again later.")}finally{l(!1)}},[d,m]);(0,r.useEffect)(()=>{ep()},[ep]),(0,r.useEffect)(()=>{if(e.length>0&&s.length<e.length){let t=setTimeout(()=>{i(t=>[...t,e[t.length]])},100);return()=>clearTimeout(t)}},[e,s]);let eh=async()=>{w(null);try{let e=0===(0,O.Dk)().length?(0,O.Wp)(ei):(0,O.Dk)()[0],t=(0,I.xI)(e);await (0,I.x9)(t,h,b),S(!1)}catch(e){console.error("Login error:",e),w(e.message||"Failed to login")}},eg=async()=>{try{let e=(0,O.Dk)()[0],t=(0,I.xI)(e);await (0,I.CI)(t)}catch(e){console.error("Logout error:",e)}},eb=async()=>{P(null);try{let e=JSON.parse(U);if(!m)throw Error("You must be signed in to update user data");let t=(0,O.Dk)()[0],s=(0,R.aU)(t),a=(0,R.H9)(s,"users",m.uid);await (0,R.BN)(a,e,{merge:!0}),T(!1),ef({title:"Success",description:"User data updated successfully"}),ep()}catch(e){console.error("JSON update error:",e),P(e.message||"Invalid JSON or update failed")}},ey=(0,r.useCallback)(()=>{if(!e.length)return[];let t=new Map;return e.forEach(e=>{e.securities&&e.securities.forEach(e=>{if(!e.stock)return;let s=t.get(e.symbol);if(s){let a=s.quantity+e.quantity,r=s.quantity*s.unitcost+e.quantity*e.unitcost;t.set(e.symbol,{symbol:e.symbol,description:e.description,quantity:a,unitcost:r/a,stock:e.stock})}else t.set(e.symbol,{...e})})}),Array.from(t.values())},[e]),eN=async()=>{let e=ey();if(e.length){ee(!0),ec(null);try{let t=e.map(e=>e.symbol),s=(0,O.Dk)()[0],a=(0,$.Uz)(s),r=(0,$.Qg)(a,"getMarketValues"),i=(await r({symbols:t})).data,n={};if(i&&i.length>0&&i[0].values){let e=i[0].values;Object.entries(e).forEach(e=>{let[t,s]=e;n[t]=s})}B(n),localStorage.setItem(el,JSON.stringify(n)),ef({title:"Prices Updated",description:"Market prices have been refreshed"})}catch(e){console.error("Failed to fetch market prices:",e),ec(e.message||"Could not load market prices")}finally{ee(!1)}}};return(0,r.useEffect)(()=>{if(C)try{let e=localStorage.getItem(el);if(e){let t=JSON.parse(e);B(t)}}catch(e){console.error("Failed to load market prices from storage:",e)}},[C]),(0,a.jsxs)("main",{className:"min-h-screen container mx-auto px-2 py-1",children:[(0,a.jsx)(et,{children:C&&(0,a.jsx)("div",{className:"mt-1 mb-1",children:f?(0,a.jsx)(q,{variant:"outline",className:"animate-pulse",children:"Checking auth..."}):m?(0,a.jsx)("div",{className:"flex flex-col items-center gap-1",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(es,{children:[(0,a.jsx)(ea,{asChild:!0,children:(0,a.jsx)(E,{variant:"outline",onClick:eg,className:"h-auto py-[2px] px-3 text-xs",children:"Sign Out"})}),(0,a.jsx)(er,{children:(0,a.jsx)("p",{children:m.email||m.displayName||"User"})})]}),(0,a.jsx)(E,{variant:"outline",onClick:()=>T(!0),className:"h-auto py-[2px] px-3 text-xs",children:"User JSON"}),(0,a.jsx)(E,{onClick:eN,disabled:W||!ey().length,variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:W?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v,{size:16,className:"mr-2"}),"Updating..."]}):"Update Prices"}),(0,a.jsxs)(E,{onClick:()=>{u(e=>"firestore"===e?"mock":"firestore")},variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:["firestore"===d?"Mock":"Live (Firestore)"," Data"]}),ed&&(em?(0,a.jsxs)(q,{variant:"outline",className:"h-auto py-[2px] px-3 text-xs bg-red-100 text-red-800 border-red-300",children:["Functions emulated port ",en.functions]}):(0,a.jsx)(E,{onClick:()=>{try{let e=(0,O.Dk)()[0],t=(0,$.Uz)(e);(0,$.f5)(t,"localhost",en.functions),ex(!0),ef({title:"Emulator Connected",description:"Now using Firebase Functions emulator on localhost:".concat(en.functions)})}catch(e){console.error("Failed to connect to emulator:",e),ef({title:"Connection Failed",description:e.message||"Could not connect to Functions emulator",variant:"destructive"})}},variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:"Emulate Functions"}))]})}):(0,a.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,a.jsx)(q,{variant:"secondary",children:"Not signed in"}),(0,a.jsxs)(J,{open:k,onOpenChange:S,children:[(0,a.jsx)(H,{asChild:!0,children:(0,a.jsx)(E,{variant:"default",className:"h-auto py-[2px] px-3 text-xs",children:"Sign In"})}),(0,a.jsxs)(Y,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(G,{children:[(0,a.jsx)(K,{children:"Sign in to AccountViewer"}),(0,a.jsx)(Q,{children:"Enter your credentials to access your account information."})]}),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),eh()},children:(0,a.jsxs)("div",{className:"grid gap-2 py-2",children:[j&&(0,a.jsx)("div",{className:"text-sm text-destructive",children:j}),(0,a.jsxs)("div",{className:"grid gap-1",children:[(0,a.jsx)(z,{htmlFor:"email",children:"Email"}),(0,a.jsx)(_,{id:"email",type:"email",value:h,onChange:e=>g(e.target.value),placeholder:"your@email.com",autoComplete:"username"})]}),(0,a.jsxs)("div",{className:"grid gap-1",children:[(0,a.jsx)(z,{htmlFor:"password",children:"Password"}),(0,a.jsx)(_,{id:"password",type:"password",value:b,onChange:e=>N(e.target.value),autoComplete:"current-password"})]}),(0,a.jsx)(E,{type:"submit",className:"mt-2 h-auto py-[2px] px-3 text-xs",children:"Sign In"})]})})]})]})]})})}),!n&&!o&&e.length>0&&s.length>0&&(0,a.jsxs)("div",{className:"mb-1",children:[eo&&(0,a.jsx)("div",{className:"mb-1",children:(0,a.jsx)(F,{message:eo})}),(0,a.jsx)(y,{account:{id:"combined-holdings",name:"Combined",securities:ey()},marketPrices:V,className:"animate-in fade-in slide-in-from-bottom-5 duration-500"},"combined-holdings")]}),n&&(0,a.jsx)(v,{className:"my-4"}),o&&!n&&(0,a.jsxs)("div",{className:"my-4 flex flex-col items-center gap-2",children:[(0,a.jsx)(F,{message:o}),(0,a.jsx)(E,{onClick:ep,variant:"outline",className:"h-auto py-[2px] px-3 text-xs",children:"Retry"})]}),!n&&!o&&0===e.length&&(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-3",children:[(0,a.jsxs)("p",{className:"text-lg",children:["No accounts found for ","firestore"===d?"live":"mock"," source."]}),(0,a.jsx)("p",{className:"text-sm",children:"Try adding some accounts or check back later."})]}),!n&&!o&&s.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-1 gap-2",children:s.map((e,t)=>(0,a.jsx)(y,{account:e,marketPrices:V,className:"animate-in fade-in slide-in-from-bottom-5 duration-500 ease-out",style:{animationDelay:"".concat(50*t,"ms")}},e.id))}),!n&&!o&&e.length>0&&s.length<e.length&&(0,a.jsxs)("div",{className:"mt-2 flex justify-center items-center",children:[(0,a.jsx)(v,{size:20}),(0,a.jsx)("p",{className:"ml-2 text-sm text-muted-foreground",children:"Loading more accounts..."})]}),(0,a.jsx)(J,{open:A,onOpenChange:T,children:(0,a.jsxs)(Y,{className:"sm:max-w-[600px]",children:[(0,a.jsxs)(G,{children:[(0,a.jsx)(K,{children:"User Data"}),(0,a.jsx)(Q,{children:"Enter JSON for your user document. This will update or create the document in Firestore."})]}),(0,a.jsxs)("div",{className:"grid gap-2 py-2",children:[M&&(0,a.jsx)("div",{className:"text-sm text-destructive",children:M}),(0,a.jsxs)("div",{className:"grid gap-1",children:[(0,a.jsx)(z,{htmlFor:"userJson",children:"User data"}),(0,a.jsx)(X,{id:"userJson",value:U,onChange:e=>L(e.target.value),placeholder:'{"accounts": [{"id": "account1", "name": "My Account", "securities": [{"description": "Apple Inc.", "quantity": 10, "symbol": "AAPL", "unitcost": 150.00, "stock": true}]}]}',className:"min-h-[150px] font-mono text-xs"})]}),(0,a.jsx)(E,{onClick:eb,className:"h-auto py-[2px] px-3 text-xs",children:"Update User Data"})]})]})})]})}},7481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>m});var a=s(2115);let r=0,i=new Map,n=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(c);return a.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var a=s(2596),r=s(9688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[446,992,641,480,441,684,358],()=>t(3974)),_N_E=e.O()}]);